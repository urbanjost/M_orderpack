<html> 
<head> 
<title> </title>
<style> 
px {font-family: "Lucida Console", Monaco }
p { font-size:100%; line-height:1.1em; }
body {xfont-style: sans-serif}
body {
color:#333; font-family:Verdana, Arial, Helvetica, sans-serif; font-size:1em; line-height:1.3em; }
a:visited { color:#666; }
h1,h2,h3,h4,h5,h6 { color:#333; font-family:georgia, verdana, sans-serif; }
h1 { font-size:150%; page-break-before:auto;background-color: #aaaaff}
h2 { font-size:143%;color:teal; }
h3 { font-size:134%;color:blue; }
h4 { font-size:120%;color:gray; }
img { max-width: 55em}
p{ padding: 0;margin:0; }
p{ padding-right:1.4em; }
p{ padding-bottom:0.1em; }
p{ padding-top:1em; }
p{ whitespace: pre-wrap; }
h5,h6 { font-size:100% }
a.nav,a:link.nav, a:visited.nav { background-color:#FFF; color:#000; }
XXtable { border:double #000; border-collapse:collapse; }
XXtable { border-collapse:collapse; }
XXtd { border:thin solid #888; }
XXtd { border:none; }
li { margin-bottom:0.5em; }
blockquote { display:block; font-size:100%; line-height:1.1em; margin:0 0 0.5em; padding:0 2.5em; }
pre { background-color:#DDD; font-size:100%; overflow:auto; padding:1em; }
a,li span { color:#000; }
a:hover, a.nav:hover, a:hover math { background-color:#000; color:#FFF; }
#Container { margin:0 10px; text-align:center; background-color: #BBB}
#Content { border-top:none; margin:auto; padding:0.3em; text-align:left; width:100%; max-width:55em; background:#FFF}
span.webName { font-size:.5em; }
textarea#content { font-size: 1em; line-height: 1.125; }
h1#pageName { line-height:1em; margin:0.2em 0 0.2em 0; padding:0; }
.property { color:#666; font-size:100%; }
a.existingWikiWord[title]{ //border: 1px dashed #BBB; }
.byline { color:#666; font-size:1.0em; font-style:italic; margin-bottom:1em; padding-top:1px; } 
</style> 
</head>
<BODY bgcolor=#F0F0F0 text=#000000 link=#0000ff vlink=#C000C0 alink=#ff0000><A NAME=top></A>
<h5><a href="https://github.com/urbanjost/M_valnth">[UP]</a></h5>
<div id="Container">
<div id="Content">
<CENTER>
<H1><HR><I>Manual Reference Pages &nbsp;-&nbsp;</I><NOBR>indnth (3orderpack)</NOBR><HR></H1>
</CENTER>
<A name=0>

     <H3>NAME</H3>

</A>
<BLOCKQUOTE>
<B>indnth</B>(3f) - [orderpack:FRACTILE] Return index of Nth value of
array, i.e fractile of order <B>N/SIZE</B>(array).
(LICENSE:CC0-1.0)
<P>
</BLOCKQUOTE>
<A name=contents></A><H3>CONTENTS</H3></A>
<BLOCKQUOTE>
<A HREF=#1>Synopsis</A><BR>
<A HREF=#2>Description</A><BR>
<A HREF=#3>Options</A><BR>
<A HREF=#4>Returns</A><BR>
<A HREF=#5>Examples</A><BR>
<A HREF=#6>Author</A><BR>
<A HREF=#7>License</A><BR>
</BLOCKQUOTE>
<A name=8>

     <H3>SYNOPSIS</H3>

</A>
<BLOCKQUOTE>
Function ${KIND}_indnth (<I>XDONT</I>, <I>NORD</I>) Result (<I>INDNTH</I>)
<P>
<PRE>
      ${TYPE} (kind=${KIND}), Dimension (:), Intent (In) :: XDONT
      Integer :: INDNTH
      Integer, Intent (In) :: NORD
<P>
</PRE>
</BLOCKQUOTE>
Where ${TYPE}(kind=${KIND}) may be
<BLOCKQUOTE>
<TABLE cellpadding=3><!-- tsb: Where ${TYPE}(kind=${KIND}) may be
 -->
<TR></TR><TR></TR>
<TR valign=top><TD width=3%>
o
</TD><TD>
<B>Real</B>(kind=real32)
</TD></TR>
<TR valign=top><TD width=3%>
o
</TD><TD>
<B>Real</B>(kind=real64)
</TD></TR>
<TR valign=top><TD width=3%>
o
</TD><TD>
<B>Integer</B>(kind=int32)
</TD></TR>
<TR></TR></TABLE></BLOCKQUOTE>
<A name=2>

     <H3>DESCRIPTION</H3>

</A>
<BLOCKQUOTE>
Return index of NORDth value of <I>XDONT</I>, i.e fractile of order
<I>NORD</I>/SIZE(<I>XDONT</I>).
<P>
This routine uses a pivoting strategy such as the one of finding the
median based on the quicksort algorithm, but we skew the pivot choice
to try to bring it to <I>NORD</I> as fast as possible. It uses 2 temporary
arrays, where it stores the indices of the values smaller than the
pivot (ILOWT), and the indices of values larger than the pivot that
we might still need later on (IHIGT). It iterates until it can bring
the number of values in ILOWT to exactly <I>NORD</I>, and then finds the
maximum of this set.
</BLOCKQUOTE>
<A name=3>

     <H3>OPTIONS</H3>

</A>
<BLOCKQUOTE>
<TABLE cellpadding=3>
<TR valign=top><TD width=6% nowrap>
<B></B><I>XDONT</I> </TD><TD valign=bottom>
array to search
</TD></TR>
<TR valign=top><TD width=6% nowrap>
<B></B><I>NORD</I> </TD><TD valign=bottom>
Nth value to search for
</TD></TR>
<TR></TR></TABLE></BLOCKQUOTE>
<A name=4>

     <H3>RETURNS</H3>

</A>
<BLOCKQUOTE>
<TABLE cellpadding=3>
<TR valign=top><TD width=6% nowrap>
<B></B><I>INDNTH</I> </TD><TD valign=bottom>
the index of <I>XDONT</I> that contains the requested value
</TD></TR>
<TR></TR></TABLE></BLOCKQUOTE>
<A name=5>

     <H3>EXAMPLES</H3>

</A>
<BLOCKQUOTE>
Sample program:
<P>
<PRE>
   program demo_indnth
   ! find Nth lowest value in an array without sorting entire array
   use M_indnth, only : indnth
   implicit none
   integer,allocatable :: iarr(:)
   character(len=*),parameter :: list= &#146;(*(g0:,", "))&#146;,sp=&#146;(*(g0,1x))&#146;
   integer :: i
      iarr=[80,70,30,40,50,60,20,10,0,-100]
      print list, &#146;ORIGINAL:&#146;,iarr
      ! like minloc() and maxloc()
      print sp,&#146;minloc&#146;,indnth(iarr,1),minloc(iarr)
      print sp,&#146;maxloc&#146;,indnth(iarr,size(iarr)),maxloc(iarr)
      ! but more general so can find location of the Nth lowest value &#46;&#46;&#46;
      call printme(3) ! find location of Nth lowest value
      call printme(1)
      call printme(7)
      ! sort the hard way, one value at a time
      do i=1,size(iarr)
         write(*,sp,advance=&#146;no&#146;) iarr(indnth(iarr,i))
      enddo
      print *
   contains
   subroutine printme(n)
   integer,intent(in) :: n
   integer :: ii
      !
      ii=indnth(iarr,n)
      !
      print sp,&#146;nord=&#146;,n,&#146; index=&#146;,ii,&#146; fractile=&#146;,iarr(ii)
   end subroutine printme
   end program demo_indnth
<P>
</PRE>
Results:
<P>
<PRE>
   ORIGINAL:, 80, 70, 30, 40, 50, 60, 20, 10, 0, -100
   minloc 10 10
   maxloc 1 1
   nord= 3  index= 8  fractile= 10
   nord= 1  index= 10  fractile= -100
   nord= 7  index= 5  fractile= 50
   -100 0 10 20 30 40 50 60 70 80
<P>
</PRE>
</BLOCKQUOTE>
<A name=6>

     <H3>AUTHOR</H3>

</A>
<BLOCKQUOTE>
Michel Olagnon - Aug. 2000
<P>
John Urban, 2022.04.16
<TABLE cellpadding=3><!-- tsb: John Urban, 2022.04.16
 -->
<TR></TR><TR></TR>
<TR valign=top><TD width=3%>
o
</TD><TD>
added man-page and reduced to a template using the
<B>prep</B>(1) preprocessor.
</TD></TR>
<TR></TR></TABLE></BLOCKQUOTE>
<A name=7>

     <H3>LICENSE</H3>

</A>
<BLOCKQUOTE>
CC0-1.0
</BLOCKQUOTE>
<P><HR>
<TABLE width=100%><TR> <TD width=33%><I>Nemo Release 3.1</I></TD> <TD width=33% align=center>indnth (3orderpack)</TD> <TD align=right width=33%><I>April 17, 2022</I></TD> </TR></TABLE><FONT SIZE=-1>Generated by <A HREF="http://www.squarebox.co.uk/download/manServer.shtml">manServer 1.08</A> from 300f9a18-b229-4100-a73f-aececac55f10 using man macros.</FONT>
<br><br><center><img src="images/indnth.gif"></center>
</div>
</div>
</body>
</HTML>
