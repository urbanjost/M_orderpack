<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>orderpack: m_ctrper Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">orderpack
   </div>
   <div id="projectbrief">orderpack module (Fortran)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">m_ctrper Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacem__ctrper_1_1ctrper.html">ctrper</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a6bb8f053025c6b629251b4d84c22b290"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__ctrper.html#a6bb8f053025c6b629251b4d84c22b290">real64_ctrper</a> (XDONT, PCLS)</td></tr>
<tr class="separator:a6bb8f053025c6b629251b4d84c22b290"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aae6265ebcc4097adc1e7222973d889"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__ctrper.html#a1aae6265ebcc4097adc1e7222973d889">real32_ctrper</a> (XDONT, PCLS)</td></tr>
<tr class="separator:a1aae6265ebcc4097adc1e7222973d889"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e72ba3a2743529d71d4a32c0dd7f8d0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__ctrper.html#a4e72ba3a2743529d71d4a32c0dd7f8d0">int32_ctrper</a> (XDONT, PCLS)</td></tr>
<tr class="separator:a4e72ba3a2743529d71d4a32c0dd7f8d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f7cd12bf34134ba02cd01a83b13fe20"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__ctrper.html#a4f7cd12bf34134ba02cd01a83b13fe20">f_char_ctrper</a> (XDONT, PCLS)</td></tr>
<tr class="separator:a4f7cd12bf34134ba02cd01a83b13fe20"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a2549d1e9c7e73b3c0bcc27afe267ecef"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__ctrper.html#a2549d1e9c7e73b3c0bcc27afe267ecef">f_char</a> =selected_char_kind(&quot;DEFAULT&quot;)</td></tr>
<tr class="separator:a2549d1e9c7e73b3c0bcc27afe267ecef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a4f7cd12bf34134ba02cd01a83b13fe20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f7cd12bf34134ba02cd01a83b13fe20">&#9670;&nbsp;</a></span>f_char_ctrper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_ctrper::f_char_ctrper </td>
          <td>(</td>
          <td class="paramtype">character (kind=<a class="el" href="namespacem__ctrper.html#a2549d1e9c7e73b3c0bcc27afe267ecef">f_char</a>,len=*), dimension (:), intent(inout)&#160;</td>
          <td class="paramname"><em>XDONT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>PCLS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">! _________________________________________________________</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keywordtype">character (kind=f_char,len=*)</span>, <span class="keywordtype">Dimension (:)</span>, <span class="keywordtype">Intent (InOut)</span> :: XDONT</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="keywordtype">      Real</span>, <span class="keywordtype">Intent (In)</span> :: PCLS</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">! __________________________________________________________</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keywordtype">      Real</span>, <span class="keywordtype">Dimension (Size(XDONT))</span> :: XINDT</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordtype">Integer</span>, <span class="keywordtype">Dimension (Size(XDONT))</span> :: JWRKT</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keywordtype">      Real</span> :: PWRK</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordtype">Integer</span> :: I</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keyword">Call </span>random_number (xindt(:))</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      pwrk = min(max(0.0, pcls), 1.0)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      xindt = real(<span class="keyword">Size</span>(xdont)) * xindt</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      xindt = pwrk*xindt + (1.0-pwrk)*[ (real(i), i=1,<span class="keyword">size</span>(xdont)) ]</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keyword">Call </span>mrgrnk (xindt, jwrkt)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      xdont = xdont(jwrkt)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">!</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e72ba3a2743529d71d4a32c0dd7f8d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e72ba3a2743529d71d4a32c0dd7f8d0">&#9670;&nbsp;</a></span>int32_ctrper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_ctrper::int32_ctrper </td>
          <td>(</td>
          <td class="paramtype">integer (kind=int32), dimension (:), intent(inout)&#160;</td>
          <td class="paramname"><em>XDONT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>PCLS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">! _________________________________________________________</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keywordtype">Integer (kind=int32)</span>, <span class="keywordtype">Dimension (:)</span>, <span class="keywordtype">Intent (InOut)</span> :: XDONT</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="keywordtype">      Real</span>, <span class="keywordtype">Intent (In)</span> :: PCLS</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">! __________________________________________________________</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keywordtype">      Real</span>, <span class="keywordtype">Dimension (Size(XDONT))</span> :: XINDT</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordtype">Integer</span>, <span class="keywordtype">Dimension (Size(XDONT))</span> :: JWRKT</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keywordtype">      Real</span> :: PWRK</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordtype">Integer</span> :: I</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="keyword">Call </span>random_number (xindt(:))</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      pwrk = min(max(0.0, pcls), 1.0)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      xindt = real(<span class="keyword">Size</span>(xdont)) * xindt</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      xindt = pwrk*xindt + (1.0-pwrk)*[ (real(i), i=1,<span class="keyword">size</span>(xdont)) ]</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keyword">Call </span>mrgrnk (xindt, jwrkt)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      xdont = xdont(jwrkt)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">!</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1aae6265ebcc4097adc1e7222973d889"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1aae6265ebcc4097adc1e7222973d889">&#9670;&nbsp;</a></span>real32_ctrper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_ctrper::real32_ctrper </td>
          <td>(</td>
          <td class="paramtype">real (kind=real32), dimension (:), intent(inout)&#160;</td>
          <td class="paramname"><em>XDONT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>PCLS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">! _________________________________________________________</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keywordtype">      Real</span> (kind=real32), <span class="keywordtype">Dimension (:)</span>, <span class="keywordtype">Intent (InOut)</span> :: xdont</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keywordtype">      Real</span>, <span class="keywordtype">Intent (In)</span> :: PCLS</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">! __________________________________________________________</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keywordtype">      Real</span>, <span class="keywordtype">Dimension (Size(XDONT))</span> :: XINDT</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keywordtype">Integer</span>, <span class="keywordtype">Dimension (Size(XDONT))</span> :: JWRKT</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keywordtype">      Real</span> :: PWRK</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="keywordtype">Integer</span> :: I</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keyword">Call </span>random_number (xindt(:))</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      pwrk = min(max(0.0, pcls), 1.0)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      xindt = real(<span class="keyword">Size</span>(xdont)) * xindt</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      xindt = pwrk*xindt + (1.0-pwrk)*[ (real(i), i=1,<span class="keyword">size</span>(xdont)) ]</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="keyword">Call </span>mrgrnk (xindt, jwrkt)</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      xdont = xdont(jwrkt)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">!</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6bb8f053025c6b629251b4d84c22b290"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bb8f053025c6b629251b4d84c22b290">&#9670;&nbsp;</a></span>real64_ctrper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_ctrper::real64_ctrper </td>
          <td>(</td>
          <td class="paramtype">real (kind=real64), dimension (:), intent(inout)&#160;</td>
          <td class="paramname"><em>XDONT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>PCLS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<h2><a class="anchor" id="autotoc_md0"></a>
NAME</h2>
<p>ctrper(3f) - [orderpack:PERMUTATION] generate a random permutation of an array leaving elements close to initial locations</p>
<h2><a class="anchor" id="autotoc_md1"></a>
SYNOPSIS</h2>
<pre class="fragment"> Subroutine ctrper (XDONT, PCLS)

  ${TYPE} (kind=${KIND}), Intent (InOut) :: XDONT(:)
  Real, Intent (In) :: PCLS

Where ${TYPE}(kind=${KIND}) may be

   o Real(kind=real32)
   o Real(kind=real64)
   o Integer(kind=int32)
   o Character(kind=selected_char_kind("DEFAULT"),len=*)
</pre><h2><a class="anchor" id="autotoc_md2"></a>
DESCRIPTION</h2>
<p>Shuffle the array XDONT randomly, leaving elements close to their initial locations.</p>
<p>Nearbyness is controlled by PCLS. The relative proportion of initial order and random order is defined as 1-PCLS / PCLS, thus when PCLS = 0, there is no change in the order whereas the new order is fully random when PCLS = 1.</p>
<p>Note this differs from adding random noise to the values. The original values remain unchanged, their order is just perturbed.</p>
<p>Internally, the routine creates a real array of the indices of XDONT() perturbed by random values that are based on the size of PCLS. The new array is then ranked and the resulting index is used to permute the input array.</p>
<h2><a class="anchor" id="autotoc_md3"></a>
OPTIONS</h2>
<p>XDONT Array of values to perturb. PCLS Proportion of closeness, constrained to the range 0.0(no change) to 1.0(fully random).</p>
<h2><a class="anchor" id="autotoc_md4"></a>
EXAMPLES</h2>
<p>Sample program:</p>
<p>program demo_ctrper ! generate a random perturbation of an array use M_ctrper, only : ctrper implicit none character(len=*),parameter :: g='(*(g0,1x))' character(len=*),parameter :: list= '(*(g0:,", "))' integer,allocatable :: xdont(:) integer,allocatable :: xout(:,:) integer :: isz, i, j isz=200 ! randomly pertube location of values ! ! make an array with three identical rows if(allocated(xout))deallocate(xout) allocate(xout(3,isz)) xdont=[(i,i=isz,1,-1)]*10 xout(1,:)=xdont xout(2,:)=xdont xout(3,:)=xdont ! pertube each row a different amount call ctrper(xout(1,:),0.0) call ctrper(xout(2,:),0.1) call ctrper(xout(3,:),1.0) ! show values write(*,'(a)')'count unchanged perturbed random' do i=1,size(xdont) write(*,'(*(i8,1x))')i,xout(:,i) enddo char: block character(len=:),allocatable :: cdont(:) cdont=[character(len=20) :: 'a', 'be', 'car', 'dam','fan','gas','egg'] isz=size(cdont) write(*,g)'Original.................:',(trim(cdont(i)),i=1,isz) call ctrper(cdont,1.0) write(*,g)'Perturbed ...............:',(trim(cdont(i)),i=1,isz) write(*,g) endblock char</p>
<p>end program demo_ctrper</p>
<p>Results:</p>
<p>count unchanged perturbed random 1 2000 1980 80 2 1990 1990 580 3 1980 1890 1690 4 1970 1900 1340 5 1960 1920 1260 6 1950 1950 1220 7 1940 1880 160 8 1930 1960 1620 9 1920 1860 540 . . . . . . . . . . . . . . . . 189 120 80 1200 190 110 150 800 191 100 120 1430 192 90 170 1410 193 80 140 370 194 70 90 1720 195 60 10 830 196 50 100 1670 197 40 20 470 198 30 70 1020 199 20 60 1540 200 10 30 1810 Original.................: a be car dam fan gas egg Perturbed ...............: a be gas dam fan car egg</p>
<h2><a class="anchor" id="autotoc_md5"></a>
AUTHOR</h2>
<p>Michel Olagnon, 2000-2012</p>
<p>John Urban, 2022.04.16 o added man-page and reduced to a template using the prep(1) preprocessor.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
LICENSE</h2>
<p>CC0-1.0 </p>
<div class="fragment"><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">! _________________________________________________________</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keywordtype">      Real</span> (kind=real64), <span class="keywordtype">Dimension (:)</span>, <span class="keywordtype">Intent (InOut)</span> :: xdont</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keywordtype">      Real</span>, <span class="keywordtype">Intent (In)</span> :: PCLS</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">! __________________________________________________________</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="keywordtype">      Real</span>, <span class="keywordtype">Dimension (Size(XDONT))</span> :: XINDT</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordtype">Integer</span>, <span class="keywordtype">Dimension (Size(XDONT))</span> :: JWRKT</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keywordtype">      Real</span> :: PWRK</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordtype">Integer</span> :: I</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keyword">Call </span>random_number (xindt(:))</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      pwrk = min(max(0.0, pcls), 1.0)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      xindt = real(<span class="keyword">Size</span>(xdont)) * xindt</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      xindt = pwrk*xindt + (1.0-pwrk)*[ (real(i), i=1,<span class="keyword">size</span>(xdont)) ]</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keyword">Call </span>mrgrnk (xindt, jwrkt)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      xdont = xdont(jwrkt)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">!</span></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a2549d1e9c7e73b3c0bcc27afe267ecef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2549d1e9c7e73b3c0bcc27afe267ecef">&#9670;&nbsp;</a></span>f_char</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter m_ctrper::f_char =selected_char_kind(&quot;DEFAULT&quot;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keywordtype">integer</span>,<span class="keywordtype">parameter</span> :: f_char=selected_char_kind(<span class="stringliteral">&quot;DEFAULT&quot;</span>)</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
