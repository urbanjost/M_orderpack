<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>orderpack: m_ctrper::ctrper Interface Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">orderpack
   </div>
   <div id="projectbrief">orderpack module (Fortran)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacem__ctrper.html">m_ctrper</a></li><li class="navelem"><a class="el" href="interfacem__ctrper_1_1ctrper.html">ctrper</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="interfacem__ctrper_1_1ctrper-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">m_ctrper::ctrper Interface Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a51b0cc9aad64f432043fbdad94503ce1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacem__ctrper_1_1ctrper.html#a51b0cc9aad64f432043fbdad94503ce1">real64_ctrper</a> (INOUTVALS, CLOSENESS)</td></tr>
<tr class="separator:a51b0cc9aad64f432043fbdad94503ce1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7d3cb63528c4c23db92d0c9ce7f6fab"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacem__ctrper_1_1ctrper.html#ac7d3cb63528c4c23db92d0c9ce7f6fab">real32_ctrper</a> (INOUTVALS, CLOSENESS)</td></tr>
<tr class="separator:ac7d3cb63528c4c23db92d0c9ce7f6fab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6a520ee67c000553e31ffee29e04546"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacem__ctrper_1_1ctrper.html#aa6a520ee67c000553e31ffee29e04546">int32_ctrper</a> (INOUTVALS, CLOSENESS)</td></tr>
<tr class="separator:aa6a520ee67c000553e31ffee29e04546"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64f66595c3a35a92a3c0a0be7df391f9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacem__ctrper_1_1ctrper.html#a64f66595c3a35a92a3c0a0be7df391f9">f_char_ctrper</a> (INOUTVALS, CLOSENESS)</td></tr>
<tr class="separator:a64f66595c3a35a92a3c0a0be7df391f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h2><a class="anchor" id="autotoc_md0"></a>
NAME</h2>
<p>perturb(3f) - [orderpack:PERMUTATION] generate a random permutation of an array leaving elements close to initial locations</p>
<h2><a class="anchor" id="autotoc_md1"></a>
SYNOPSIS</h2>
<pre class="fragment"> Subroutine Perturb (INOUTVALS, CLOSENESS)

  ${TYPE} (kind=${KIND}), Intent (InOut) :: INOUTVALS(:)
  Real, Intent (In)                      :: CLOSENESS

Where ${TYPE}(kind=${KIND}) may be

   o Real(kind=real32)
   o Real(kind=real64)
   o Integer(kind=int32)
   o Character(kind=selected_char_kind("DEFAULT"),len=*)
</pre><h2><a class="anchor" id="autotoc_md2"></a>
DESCRIPTION</h2>
<p>Shuffle the array INOUTVALS randomly, leaving elements close to their initial locations.</p>
<p>Nearbyness is controlled by CLOSENESS. The relative proportion of initial order and random order is defined as 1-CLOSENESS / CLOSENESS, thus when CLOSENESS = 0, there is no change in the order whereas the new order is fully random when CLOSENESS = 1.</p>
<p>Note this differs from adding random noise to the values. The original values remain unchanged, their order is just perturbed.</p>
<p>Internally, the routine creates a real array of the indices of INOUTVALS() perturbed by random values that are based on the size of CLOSENESS. The new array is then ranked using RANK(3f) and the resulting index is used to permute the input array.</p>
<h2><a class="anchor" id="autotoc_md3"></a>
OPTIONS</h2>
<p>INOUTVALS Array of values to perturb. CLOSENESS Proportion of closeness, constrained to the range 0.0(no change) to 1.0(fully random).</p>
<h2><a class="anchor" id="autotoc_md4"></a>
EXAMPLES</h2>
<p>Sample program:</p>
<p>program demo_perturb ! generate a random perturbation of an array use M_orderpack, only : perturb implicit none character(len=*),parameter :: g='(*(g0,1x))' character(len=*),parameter :: list= '(*(g0:,", "))' integer,allocatable :: xout(:,:) integer :: isz, i, j isz=200 ! randomly perturb location of values ! ! make an array with three initially identical rows of ! values perturbed by different amounts if(allocated(xout))deallocate(xout) allocate(xout(3,isz)) xout(1,:)=[(i,i=isz,1,-1)]*10 xout(2,:)=xout(1,:) xout(3,:)=xout(1,:) ! perturb each row a different amount call perturb(xout(1,:),0.0) call perturb(xout(2,:),0.1) call perturb(xout(3,:),1.0) ! show values write(*,'(a)')'count unchanged perturbed random' do i=1,size(xout,dim=2) write(*,'(*(i8,1x))')i,xout(:,i) enddo char: block character(len=:),allocatable :: cdont(:) cdont=[character(len=20) :: 'a', 'be', 'car', 'dam','fan','gas','egg'] isz=size(cdont) write(*,g)'Original.................:',(trim(cdont(i)),i=1,isz) call perturb(cdont,1.0) write(*,g)'Perturbed ...............:',(trim(cdont(i)),i=1,isz) write(*,g) endblock char</p>
<p>end program demo_perturb</p>
<p>Results:</p>
<p>count unchanged perturbed random 1 2000 1980 80 2 1990 1990 580 3 1980 1890 1690 4 1970 1900 1340 5 1960 1920 1260 6 1950 1950 1220 7 1940 1880 160 8 1930 1960 1620 9 1920 1860 540 10 1910 1930 1300 11 1900 1940 1190 . . . . . . . . . . . . . . . . 189 120 80 1200 190 110 150 800 191 100 120 1430 192 90 170 1410 193 80 140 370 194 70 90 1720 195 60 10 830 196 50 100 1670 197 40 20 470 198 30 70 1020 199 20 60 1540 200 10 30 1810 Original.................: a be car dam fan gas egg Perturbed ...............: a be gas dam fan car egg</p>
<h2><a class="anchor" id="autotoc_md5"></a>
AUTHOR</h2>
<p>Michel Olagnon, 2000-2012 </p>
<h2><a class="anchor" id="autotoc_md6"></a>
MAINTAINER</h2>
<p>John Urban, 2022.04.16 </p>
<h2><a class="anchor" id="autotoc_md7"></a>
LICENSE</h2>
<p>CC0-1.0 </p>
</div><h2 class="groupheader">Member Function/Subroutine Documentation</h2>
<a id="a64f66595c3a35a92a3c0a0be7df391f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64f66595c3a35a92a3c0a0be7df391f9">&#9670;&nbsp;</a></span>f_char_ctrper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_ctrper::ctrper::f_char_ctrper </td>
          <td>(</td>
          <td class="paramtype">character (kind=<a class="el" href="namespacem__ctrper.html#a2549d1e9c7e73b3c0bcc27afe267ecef">f_char</a>,len=*), dimension (:), intent(inout)&#160;</td>
          <td class="paramname"><em>INOUTVALS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>CLOSENESS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">! _________________________________________________________</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keywordtype">character (kind=f_char,len=*)</span>, <span class="keywordtype">Dimension (:)</span>, <span class="keywordtype">Intent (InOut)</span> :: INOUTVALS</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keywordtype">      Real</span>, <span class="keywordtype">Intent (In)</span> :: CLOSENESS</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">! __________________________________________________________</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="keywordtype">      Real</span>, <span class="keywordtype">Dimension (Size(INOUTVALS))</span> :: XINDT</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keywordtype">Integer</span>, <span class="keywordtype">Dimension (Size(INOUTVALS))</span> :: JWRKT</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keywordtype">      Real</span> :: PWRK</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordtype">Integer</span> :: I</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keyword">Call </span>random_number (xindt(:))</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      pwrk = min(max(0.0, closeness), 1.0)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      xindt = real(<span class="keyword">Size</span>(inoutvals)) * xindt</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      xindt = pwrk*xindt + (1.0-pwrk)*[ (real(i), i=1,<span class="keyword">size</span>(inoutvals)) ]</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keyword">Call </span>mrgrnk (xindt, jwrkt)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      inoutvals = inoutvals(jwrkt)</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">!</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6a520ee67c000553e31ffee29e04546"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6a520ee67c000553e31ffee29e04546">&#9670;&nbsp;</a></span>int32_ctrper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_ctrper::ctrper::int32_ctrper </td>
          <td>(</td>
          <td class="paramtype">integer (kind=int32), dimension (:), intent(inout)&#160;</td>
          <td class="paramname"><em>INOUTVALS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>CLOSENESS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">! _________________________________________________________</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keywordtype">Integer (kind=int32)</span>, <span class="keywordtype">Dimension (:)</span>, <span class="keywordtype">Intent (InOut)</span> :: INOUTVALS</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keywordtype">      Real</span>, <span class="keywordtype">Intent (In)</span> :: CLOSENESS</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">! __________________________________________________________</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="keywordtype">      Real</span>, <span class="keywordtype">Dimension (Size(INOUTVALS))</span> :: XINDT</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordtype">Integer</span>, <span class="keywordtype">Dimension (Size(INOUTVALS))</span> :: JWRKT</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keywordtype">      Real</span> :: PWRK</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordtype">Integer</span> :: I</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keyword">Call </span>random_number (xindt(:))</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      pwrk = min(max(0.0, closeness), 1.0)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      xindt = real(<span class="keyword">Size</span>(inoutvals)) * xindt</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      xindt = pwrk*xindt + (1.0-pwrk)*[ (real(i), i=1,<span class="keyword">size</span>(inoutvals)) ]</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keyword">Call </span>mrgrnk (xindt, jwrkt)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      inoutvals = inoutvals(jwrkt)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">!</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac7d3cb63528c4c23db92d0c9ce7f6fab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7d3cb63528c4c23db92d0c9ce7f6fab">&#9670;&nbsp;</a></span>real32_ctrper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_ctrper::ctrper::real32_ctrper </td>
          <td>(</td>
          <td class="paramtype">real (kind=real32), dimension (:), intent(inout)&#160;</td>
          <td class="paramname"><em>INOUTVALS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>CLOSENESS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">! _________________________________________________________</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keywordtype">      Real</span> (kind=real32), <span class="keywordtype">Dimension (:)</span>, <span class="keywordtype">Intent (InOut)</span> :: inoutvals</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="keywordtype">      Real</span>, <span class="keywordtype">Intent (In)</span> :: CLOSENESS</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">! __________________________________________________________</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="keywordtype">      Real</span>, <span class="keywordtype">Dimension (Size(INOUTVALS))</span> :: XINDT</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordtype">Integer</span>, <span class="keywordtype">Dimension (Size(INOUTVALS))</span> :: JWRKT</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keywordtype">      Real</span> :: PWRK</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keywordtype">Integer</span> :: I</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="keyword">Call </span>random_number (xindt(:))</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      pwrk = min(max(0.0, closeness), 1.0)</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      xindt = real(<span class="keyword">Size</span>(inoutvals)) * xindt</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      xindt = pwrk*xindt + (1.0-pwrk)*[ (real(i), i=1,<span class="keyword">size</span>(inoutvals)) ]</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keyword">Call </span>mrgrnk (xindt, jwrkt)</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      inoutvals = inoutvals(jwrkt)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">!</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a51b0cc9aad64f432043fbdad94503ce1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51b0cc9aad64f432043fbdad94503ce1">&#9670;&nbsp;</a></span>real64_ctrper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_ctrper::ctrper::real64_ctrper </td>
          <td>(</td>
          <td class="paramtype">real (kind=real64), dimension (:), intent(inout)&#160;</td>
          <td class="paramname"><em>INOUTVALS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>CLOSENESS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">! _________________________________________________________</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="keywordtype">      Real</span> (kind=real64), <span class="keywordtype">Dimension (:)</span>, <span class="keywordtype">Intent (InOut)</span> :: inoutvals</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="keywordtype">      Real</span>, <span class="keywordtype">Intent (In)</span> :: CLOSENESS</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">! __________________________________________________________</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keywordtype">      Real</span>, <span class="keywordtype">Dimension (Size(INOUTVALS))</span> :: XINDT</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="keywordtype">Integer</span>, <span class="keywordtype">Dimension (Size(INOUTVALS))</span> :: JWRKT</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="keywordtype">      Real</span> :: PWRK</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordtype">Integer</span> :: I</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keyword">Call </span>random_number (xindt(:))</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      pwrk = min(max(0.0, closeness), 1.0)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      xindt = real(<span class="keyword">Size</span>(inoutvals)) * xindt</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      xindt = pwrk*xindt + (1.0-pwrk)*[ (real(i), i=1,<span class="keyword">size</span>(inoutvals)) ]</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keyword">Call </span>mrgrnk (xindt, jwrkt)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      inoutvals = inoutvals(jwrkt)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">!</span></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this interface was generated from the following file:<ul>
<li>/home/urbanjs/venus/V600/github/orderpack/src/<a class="el" href="M__ctrper_8f90.html">M_ctrper.f90</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
