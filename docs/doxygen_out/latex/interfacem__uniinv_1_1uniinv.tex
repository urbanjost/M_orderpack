\hypertarget{interfacem__uniinv_1_1uniinv}{}\doxysection{m\+\_\+uniinv\+::uniinv Interface Reference}
\label{interfacem__uniinv_1_1uniinv}\index{m\_uniinv::uniinv@{m\_uniinv::uniinv}}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{interfacem__uniinv_1_1uniinv_a8718cf328e2b659c4bb2deb5c1115a2a}{real64\+\_\+uniinv}} (I\+N\+V\+A\+LS, I\+G\+O\+E\+ST)
\item 
subroutine \mbox{\hyperlink{interfacem__uniinv_1_1uniinv_af14682c1296f7dde881c124d80a7ac43}{real32\+\_\+uniinv}} (I\+N\+V\+A\+LS, I\+G\+O\+E\+ST)
\item 
subroutine \mbox{\hyperlink{interfacem__uniinv_1_1uniinv_a1d957d14af3f9f7615a24ffc9d622ebc}{int32\+\_\+uniinv}} (I\+N\+V\+A\+LS, I\+G\+O\+E\+ST)
\item 
subroutine \mbox{\hyperlink{interfacem__uniinv_1_1uniinv_a2eb414dba86136dc3e37f539db7d433c}{f\+\_\+char\+\_\+uniinv}} (I\+N\+V\+A\+LS, I\+G\+O\+E\+ST)
\end{DoxyCompactItemize}


\doxysubsection{Member Function/\+Subroutine Documentation}
\mbox{\Hypertarget{interfacem__uniinv_1_1uniinv_a2eb414dba86136dc3e37f539db7d433c}\label{interfacem__uniinv_1_1uniinv_a2eb414dba86136dc3e37f539db7d433c}} 
\index{m\_uniinv::uniinv@{m\_uniinv::uniinv}!f\_char\_uniinv@{f\_char\_uniinv}}
\index{f\_char\_uniinv@{f\_char\_uniinv}!m\_uniinv::uniinv@{m\_uniinv::uniinv}}
\doxysubsubsection{\texorpdfstring{f\_char\_uniinv()}{f\_char\_uniinv()}}
{\footnotesize\ttfamily subroutine m\+\_\+uniinv\+::uniinv\+::f\+\_\+char\+\_\+uniinv (\begin{DoxyParamCaption}\item[{character (kind=\mbox{\hyperlink{namespacem__uniinv_aae3df561c217bf871a83bafbc46f27ba}{f\+\_\+char}},len=$\ast$), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, dimension (\+:), intent(out)}]{I\+G\+O\+E\+ST }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{843       \textcolor{keywordtype}{character (kind=f\_char,len=*)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: INVALS}
\DoxyCodeLine{844       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IGOEST}
\DoxyCodeLine{845 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{846       \textcolor{keywordtype}{character (kind=f\_char,len=len(INVALS))} :: XTST, XDONA, XDONB}
\DoxyCodeLine{847 \textcolor{comment}{!}}
\DoxyCodeLine{848 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{849       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IGOEST))} :: JWRKT, IRNGT}
\DoxyCodeLine{850       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2, NUNI}
\DoxyCodeLine{851       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{852 \textcolor{comment}{!}}
\DoxyCodeLine{853       nval = min(\textcolor{keyword}{SIZE}(invals), \textcolor{keyword}{SIZE}(igoest))}
\DoxyCodeLine{854 \textcolor{comment}{!}}
\DoxyCodeLine{855       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{856       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{857          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{858       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{859          igoest(1) = 1}
\DoxyCodeLine{860          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{861 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{862          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{863 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{864 \textcolor{comment}{!}}
\DoxyCodeLine{865 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{866 \textcolor{comment}{!}}
\DoxyCodeLine{867       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{868          \textcolor{keywordflow}{If} (invals(iind-\/1) < invals(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{869             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{870             irngt(iind) = iind}
\DoxyCodeLine{871          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{872             irngt(iind-\/1) = iind}
\DoxyCodeLine{873             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{874 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{875 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{876       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{877          irngt(nval) = nval}
\DoxyCodeLine{878 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{879 \textcolor{comment}{!}}
\DoxyCodeLine{880 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{881 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{882 \textcolor{comment}{!}}
\DoxyCodeLine{883       lmtna = 2}
\DoxyCodeLine{884       lmtnc = 4}
\DoxyCodeLine{885 \textcolor{comment}{!}}
\DoxyCodeLine{886 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{887 \textcolor{comment}{!}}
\DoxyCodeLine{888       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{889          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{890 \textcolor{comment}{!}}
\DoxyCodeLine{891 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{892 \textcolor{comment}{!}}
\DoxyCodeLine{893          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{894             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{895                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{896 \textcolor{comment}{!}}
\DoxyCodeLine{897 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{898 \textcolor{comment}{!}}
\DoxyCodeLine{899                \textcolor{keywordflow}{If} (invals(irngt(iwrkd+2)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{900 \textcolor{comment}{!}}
\DoxyCodeLine{901 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{902 \textcolor{comment}{!}}
\DoxyCodeLine{903                \textcolor{keywordflow}{If} (invals(irngt(iwrkd+1)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{904                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{905                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{906                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{907 \textcolor{comment}{!}}
\DoxyCodeLine{908 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{909 \textcolor{comment}{!}}
\DoxyCodeLine{910                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{911                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{912                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{913                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{914                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{915 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{916                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{917 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{918 \textcolor{comment}{!}}
\DoxyCodeLine{919 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{920 \textcolor{comment}{!}}
\DoxyCodeLine{921             \textcolor{keywordflow}{If} (invals(irngt(iwrkd+2)) <= invals(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{922 \textcolor{comment}{!}}
\DoxyCodeLine{923 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{924 \textcolor{comment}{!}}
\DoxyCodeLine{925             \textcolor{keywordflow}{If} (invals(irngt(iwrkd+1)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{926                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{927                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{928                \textcolor{keywordflow}{If} (invals(irng2) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{929 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{930                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{931                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{932 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{933                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{934                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{935 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{936 \textcolor{comment}{!}}
\DoxyCodeLine{937 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{938 \textcolor{comment}{!}}
\DoxyCodeLine{939             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{940                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{941                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{942                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{943                \textcolor{keywordflow}{If} (invals(irng1) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{944                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{945                   \textcolor{keywordflow}{If} (invals(irng2) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{946 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{947                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{948                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{949 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{950                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{951                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{952 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{953                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{954 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{955                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{956                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{957                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{958 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{959 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{960 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{961 \textcolor{comment}{!}}
\DoxyCodeLine{962 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{963 \textcolor{comment}{!}}
\DoxyCodeLine{964          lmtna = 4}
\DoxyCodeLine{965          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{966 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{967 \textcolor{comment}{!}}
\DoxyCodeLine{968 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{969 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{970 \textcolor{comment}{!}}
\DoxyCodeLine{971       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{972          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{973          iwrkf = 0}
\DoxyCodeLine{974          lmtnc = 2 * lmtnc}
\DoxyCodeLine{975 \textcolor{comment}{!}}
\DoxyCodeLine{976 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{977 \textcolor{comment}{!}}
\DoxyCodeLine{978          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{979             iwrk = iwrkf}
\DoxyCodeLine{980             iwrkd = iwrkf + 1}
\DoxyCodeLine{981             jinda = iwrkf + lmtna}
\DoxyCodeLine{982             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{983             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{984                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{985                iwrkf = nval}
\DoxyCodeLine{986 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{987             iinda = 1}
\DoxyCodeLine{988             iindb = jinda + 1}
\DoxyCodeLine{989 \textcolor{comment}{!}}
\DoxyCodeLine{990 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{991 \textcolor{comment}{!}}
\DoxyCodeLine{992 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{993 \textcolor{comment}{!}}
\DoxyCodeLine{994             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{995             xdona = invals(jwrkt(iinda))}
\DoxyCodeLine{996             xdonb = invals(irngt(iindb))}
\DoxyCodeLine{997 \textcolor{comment}{!}}
\DoxyCodeLine{998             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{999                iwrk = iwrk + 1}
\DoxyCodeLine{1000 \textcolor{comment}{!}}
\DoxyCodeLine{1001 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{1002 \textcolor{comment}{!}}
\DoxyCodeLine{1003                \textcolor{keywordflow}{If} (xdona > xdonb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1004                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{1005                   iindb = iindb + 1}
\DoxyCodeLine{1006                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1007 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{1008                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{1009                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1010 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1011                   xdonb = invals(irngt(iindb))}
\DoxyCodeLine{1012                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1013                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{1014                   iinda = iinda + 1}
\DoxyCodeLine{1015                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{1016                   xdona = invals(jwrkt(iinda))}
\DoxyCodeLine{1017 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1018 \textcolor{comment}{!}}
\DoxyCodeLine{1019 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1020 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1021 \textcolor{comment}{!}}
\DoxyCodeLine{1022 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{1023 \textcolor{comment}{!}}
\DoxyCodeLine{1024          lmtna = 2 * lmtna}
\DoxyCodeLine{1025 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{1026 \textcolor{comment}{!}}
\DoxyCodeLine{1027 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{1028 \textcolor{comment}{!}}
\DoxyCodeLine{1029       iinda = 1}
\DoxyCodeLine{1030       iindb = lmtna + 1}
\DoxyCodeLine{1031       nuni = 0}
\DoxyCodeLine{1032 \textcolor{comment}{!}}
\DoxyCodeLine{1033 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{1034 \textcolor{comment}{!}}
\DoxyCodeLine{1035       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{1036       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1037         \textcolor{keywordflow}{If} (invals(jwrkt(1)) < invals(irngt(iindb)) ) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1038            xtst = nearless(invals(jwrkt(1)))}
\DoxyCodeLine{1039         \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1040            xtst = nearless(invals(irngt(iindb)))}
\DoxyCodeLine{1041 \textcolor{keywordflow}{        Endif}}
\DoxyCodeLine{1042       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1043         xtst = nearless(invals(jwrkt(1)))}
\DoxyCodeLine{1044 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{1045       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{1046 \textcolor{comment}{!}}
\DoxyCodeLine{1047 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{1048 \textcolor{comment}{!}}
\DoxyCodeLine{1049          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1050             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1051                \textcolor{keywordflow}{If} (invals(jwrkt(iinda)) > invals(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1052                   irng = irngt(iindb)}
\DoxyCodeLine{1053                   iindb = iindb + 1}
\DoxyCodeLine{1054                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1055                   irng = jwrkt(iinda)}
\DoxyCodeLine{1056                   iinda = iinda + 1}
\DoxyCodeLine{1057 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1058             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1059 \textcolor{comment}{!}}
\DoxyCodeLine{1060 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{1061 \textcolor{comment}{!}}
\DoxyCodeLine{1062                irng = jwrkt(iinda)}
\DoxyCodeLine{1063                iinda = iinda + 1}
\DoxyCodeLine{1064 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1065          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1066 \textcolor{comment}{!}}
\DoxyCodeLine{1067 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{1068 \textcolor{comment}{!}}
\DoxyCodeLine{1069             irng = irngt(iwrk)}
\DoxyCodeLine{1070 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1071          \textcolor{keywordflow}{If} (invals(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1072             xtst = invals(irng)}
\DoxyCodeLine{1073             nuni = nuni + 1}
\DoxyCodeLine{1074 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1075          igoest(irng) = nuni}
\DoxyCodeLine{1076 \textcolor{comment}{!}}
\DoxyCodeLine{1077 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{1078 \textcolor{comment}{!}}
\DoxyCodeLine{1079    igoest=igoest+1}
\DoxyCodeLine{1080 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{interfacem__uniinv_1_1uniinv_a1d957d14af3f9f7615a24ffc9d622ebc}\label{interfacem__uniinv_1_1uniinv_a1d957d14af3f9f7615a24ffc9d622ebc}} 
\index{m\_uniinv::uniinv@{m\_uniinv::uniinv}!int32\_uniinv@{int32\_uniinv}}
\index{int32\_uniinv@{int32\_uniinv}!m\_uniinv::uniinv@{m\_uniinv::uniinv}}
\doxysubsubsection{\texorpdfstring{int32\_uniinv()}{int32\_uniinv()}}
{\footnotesize\ttfamily subroutine m\+\_\+uniinv\+::uniinv\+::int32\+\_\+uniinv (\begin{DoxyParamCaption}\item[{integer (kind=int32), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, dimension (\+:), intent(out)}]{I\+G\+O\+E\+ST }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{596       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: INVALS}
\DoxyCodeLine{597       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IGOEST}
\DoxyCodeLine{598 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{599       \textcolor{keywordtype}{Integer (kind=int32)} :: XTST, XDONA, XDONB}
\DoxyCodeLine{600 \textcolor{comment}{!}}
\DoxyCodeLine{601 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{602       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IGOEST))} :: JWRKT, IRNGT}
\DoxyCodeLine{603       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2, NUNI}
\DoxyCodeLine{604       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{605 \textcolor{comment}{!}}
\DoxyCodeLine{606       nval = min(\textcolor{keyword}{SIZE}(invals), \textcolor{keyword}{SIZE}(igoest))}
\DoxyCodeLine{607 \textcolor{comment}{!}}
\DoxyCodeLine{608       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{609       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{610          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{611       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{612          igoest(1) = 1}
\DoxyCodeLine{613          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{614 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{615          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{616 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{617 \textcolor{comment}{!}}
\DoxyCodeLine{618 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{619 \textcolor{comment}{!}}
\DoxyCodeLine{620       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{621          \textcolor{keywordflow}{If} (invals(iind-\/1) < invals(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{622             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{623             irngt(iind) = iind}
\DoxyCodeLine{624          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{625             irngt(iind-\/1) = iind}
\DoxyCodeLine{626             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{627 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{628 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{629       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{630          irngt(nval) = nval}
\DoxyCodeLine{631 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{632 \textcolor{comment}{!}}
\DoxyCodeLine{633 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{634 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{635 \textcolor{comment}{!}}
\DoxyCodeLine{636       lmtna = 2}
\DoxyCodeLine{637       lmtnc = 4}
\DoxyCodeLine{638 \textcolor{comment}{!}}
\DoxyCodeLine{639 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{640 \textcolor{comment}{!}}
\DoxyCodeLine{641       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{642          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{643 \textcolor{comment}{!}}
\DoxyCodeLine{644 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{645 \textcolor{comment}{!}}
\DoxyCodeLine{646          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{647             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{648                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{649 \textcolor{comment}{!}}
\DoxyCodeLine{650 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{651 \textcolor{comment}{!}}
\DoxyCodeLine{652                \textcolor{keywordflow}{If} (invals(irngt(iwrkd+2)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{653 \textcolor{comment}{!}}
\DoxyCodeLine{654 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{655 \textcolor{comment}{!}}
\DoxyCodeLine{656                \textcolor{keywordflow}{If} (invals(irngt(iwrkd+1)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{657                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{658                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{659                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{660 \textcolor{comment}{!}}
\DoxyCodeLine{661 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{662 \textcolor{comment}{!}}
\DoxyCodeLine{663                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{664                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{665                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{666                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{667                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{668 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{669                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{670 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{671 \textcolor{comment}{!}}
\DoxyCodeLine{672 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{673 \textcolor{comment}{!}}
\DoxyCodeLine{674             \textcolor{keywordflow}{If} (invals(irngt(iwrkd+2)) <= invals(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{675 \textcolor{comment}{!}}
\DoxyCodeLine{676 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{677 \textcolor{comment}{!}}
\DoxyCodeLine{678             \textcolor{keywordflow}{If} (invals(irngt(iwrkd+1)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{679                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{680                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{681                \textcolor{keywordflow}{If} (invals(irng2) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{682 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{683                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{684                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{685 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{686                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{687                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{688 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{689 \textcolor{comment}{!}}
\DoxyCodeLine{690 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{691 \textcolor{comment}{!}}
\DoxyCodeLine{692             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{693                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{694                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{695                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{696                \textcolor{keywordflow}{If} (invals(irng1) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{697                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{698                   \textcolor{keywordflow}{If} (invals(irng2) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{699 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{700                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{701                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{702 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{703                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{704                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{705 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{706                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{707 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{708                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{709                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{710                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{711 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{712 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{713 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{714 \textcolor{comment}{!}}
\DoxyCodeLine{715 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{716 \textcolor{comment}{!}}
\DoxyCodeLine{717          lmtna = 4}
\DoxyCodeLine{718          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{719 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{720 \textcolor{comment}{!}}
\DoxyCodeLine{721 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{722 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{723 \textcolor{comment}{!}}
\DoxyCodeLine{724       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{725          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{726          iwrkf = 0}
\DoxyCodeLine{727          lmtnc = 2 * lmtnc}
\DoxyCodeLine{728 \textcolor{comment}{!}}
\DoxyCodeLine{729 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{730 \textcolor{comment}{!}}
\DoxyCodeLine{731          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{732             iwrk = iwrkf}
\DoxyCodeLine{733             iwrkd = iwrkf + 1}
\DoxyCodeLine{734             jinda = iwrkf + lmtna}
\DoxyCodeLine{735             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{736             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{737                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{738                iwrkf = nval}
\DoxyCodeLine{739 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{740             iinda = 1}
\DoxyCodeLine{741             iindb = jinda + 1}
\DoxyCodeLine{742 \textcolor{comment}{!}}
\DoxyCodeLine{743 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{744 \textcolor{comment}{!}}
\DoxyCodeLine{745 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{746 \textcolor{comment}{!}}
\DoxyCodeLine{747             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{748             xdona = invals(jwrkt(iinda))}
\DoxyCodeLine{749             xdonb = invals(irngt(iindb))}
\DoxyCodeLine{750 \textcolor{comment}{!}}
\DoxyCodeLine{751             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{752                iwrk = iwrk + 1}
\DoxyCodeLine{753 \textcolor{comment}{!}}
\DoxyCodeLine{754 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{755 \textcolor{comment}{!}}
\DoxyCodeLine{756                \textcolor{keywordflow}{If} (xdona > xdonb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{757                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{758                   iindb = iindb + 1}
\DoxyCodeLine{759                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{760 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{761                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{762                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{763 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{764                   xdonb = invals(irngt(iindb))}
\DoxyCodeLine{765                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{766                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{767                   iinda = iinda + 1}
\DoxyCodeLine{768                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{769                   xdona = invals(jwrkt(iinda))}
\DoxyCodeLine{770 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{771 \textcolor{comment}{!}}
\DoxyCodeLine{772 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{773 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{774 \textcolor{comment}{!}}
\DoxyCodeLine{775 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{776 \textcolor{comment}{!}}
\DoxyCodeLine{777          lmtna = 2 * lmtna}
\DoxyCodeLine{778 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{779 \textcolor{comment}{!}}
\DoxyCodeLine{780 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{781 \textcolor{comment}{!}}
\DoxyCodeLine{782       iinda = 1}
\DoxyCodeLine{783       iindb = lmtna + 1}
\DoxyCodeLine{784       nuni = 0}
\DoxyCodeLine{785 \textcolor{comment}{!}}
\DoxyCodeLine{786 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{787 \textcolor{comment}{!}}
\DoxyCodeLine{788       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{789       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{790         \textcolor{keywordflow}{If} (invals(jwrkt(1)) < invals(irngt(iindb)) ) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{791            xtst = nearless(invals(jwrkt(1)))}
\DoxyCodeLine{792         \textcolor{keywordflow}{Else}}
\DoxyCodeLine{793            xtst = nearless(invals(irngt(iindb)))}
\DoxyCodeLine{794 \textcolor{keywordflow}{        Endif}}
\DoxyCodeLine{795       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{796         xtst = nearless(invals(jwrkt(1)))}
\DoxyCodeLine{797 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{798       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{799 \textcolor{comment}{!}}
\DoxyCodeLine{800 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{801 \textcolor{comment}{!}}
\DoxyCodeLine{802          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{803             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{804                \textcolor{keywordflow}{If} (invals(jwrkt(iinda)) > invals(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{805                   irng = irngt(iindb)}
\DoxyCodeLine{806                   iindb = iindb + 1}
\DoxyCodeLine{807                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{808                   irng = jwrkt(iinda)}
\DoxyCodeLine{809                   iinda = iinda + 1}
\DoxyCodeLine{810 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{811             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{812 \textcolor{comment}{!}}
\DoxyCodeLine{813 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{814 \textcolor{comment}{!}}
\DoxyCodeLine{815                irng = jwrkt(iinda)}
\DoxyCodeLine{816                iinda = iinda + 1}
\DoxyCodeLine{817 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{818          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{819 \textcolor{comment}{!}}
\DoxyCodeLine{820 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{821 \textcolor{comment}{!}}
\DoxyCodeLine{822             irng = irngt(iwrk)}
\DoxyCodeLine{823 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{824          \textcolor{keywordflow}{If} (invals(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{825             xtst = invals(irng)}
\DoxyCodeLine{826             nuni = nuni + 1}
\DoxyCodeLine{827 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{828          igoest(irng) = nuni}
\DoxyCodeLine{829 \textcolor{comment}{!}}
\DoxyCodeLine{830 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{831 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{interfacem__uniinv_1_1uniinv_af14682c1296f7dde881c124d80a7ac43}\label{interfacem__uniinv_1_1uniinv_af14682c1296f7dde881c124d80a7ac43}} 
\index{m\_uniinv::uniinv@{m\_uniinv::uniinv}!real32\_uniinv@{real32\_uniinv}}
\index{real32\_uniinv@{real32\_uniinv}!m\_uniinv::uniinv@{m\_uniinv::uniinv}}
\doxysubsubsection{\texorpdfstring{real32\_uniinv()}{real32\_uniinv()}}
{\footnotesize\ttfamily subroutine m\+\_\+uniinv\+::uniinv\+::real32\+\_\+uniinv (\begin{DoxyParamCaption}\item[{real (kind=real32), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, dimension (\+:), intent(out)}]{I\+G\+O\+E\+ST }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{349 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: invals}
\DoxyCodeLine{350       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IGOEST}
\DoxyCodeLine{351 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{352 \textcolor{keywordtype}{      Real} (kind=real32) :: xtst, xdona, xdonb}
\DoxyCodeLine{353 \textcolor{comment}{!}}
\DoxyCodeLine{354 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{355       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IGOEST))} :: JWRKT, IRNGT}
\DoxyCodeLine{356       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2, NUNI}
\DoxyCodeLine{357       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{358 \textcolor{comment}{!}}
\DoxyCodeLine{359       nval = min(\textcolor{keyword}{SIZE}(invals), \textcolor{keyword}{SIZE}(igoest))}
\DoxyCodeLine{360 \textcolor{comment}{!}}
\DoxyCodeLine{361       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{362       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{363          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{364       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{365          igoest(1) = 1}
\DoxyCodeLine{366          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{367 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{368          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{369 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{370 \textcolor{comment}{!}}
\DoxyCodeLine{371 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{372 \textcolor{comment}{!}}
\DoxyCodeLine{373       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{374          \textcolor{keywordflow}{If} (invals(iind-\/1) < invals(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{375             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{376             irngt(iind) = iind}
\DoxyCodeLine{377          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{378             irngt(iind-\/1) = iind}
\DoxyCodeLine{379             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{380 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{381 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{382       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{383          irngt(nval) = nval}
\DoxyCodeLine{384 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{385 \textcolor{comment}{!}}
\DoxyCodeLine{386 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{387 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{388 \textcolor{comment}{!}}
\DoxyCodeLine{389       lmtna = 2}
\DoxyCodeLine{390       lmtnc = 4}
\DoxyCodeLine{391 \textcolor{comment}{!}}
\DoxyCodeLine{392 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{393 \textcolor{comment}{!}}
\DoxyCodeLine{394       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{395          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{396 \textcolor{comment}{!}}
\DoxyCodeLine{397 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{398 \textcolor{comment}{!}}
\DoxyCodeLine{399          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{400             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{401                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{402 \textcolor{comment}{!}}
\DoxyCodeLine{403 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{404 \textcolor{comment}{!}}
\DoxyCodeLine{405                \textcolor{keywordflow}{If} (invals(irngt(iwrkd+2)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{406 \textcolor{comment}{!}}
\DoxyCodeLine{407 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{408 \textcolor{comment}{!}}
\DoxyCodeLine{409                \textcolor{keywordflow}{If} (invals(irngt(iwrkd+1)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{410                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{411                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{412                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{413 \textcolor{comment}{!}}
\DoxyCodeLine{414 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{415 \textcolor{comment}{!}}
\DoxyCodeLine{416                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{417                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{418                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{419                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{420                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{421 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{422                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{423 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{424 \textcolor{comment}{!}}
\DoxyCodeLine{425 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{426 \textcolor{comment}{!}}
\DoxyCodeLine{427             \textcolor{keywordflow}{If} (invals(irngt(iwrkd+2)) <= invals(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{428 \textcolor{comment}{!}}
\DoxyCodeLine{429 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{430 \textcolor{comment}{!}}
\DoxyCodeLine{431             \textcolor{keywordflow}{If} (invals(irngt(iwrkd+1)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{432                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{433                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{434                \textcolor{keywordflow}{If} (invals(irng2) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{435 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{436                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{437                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{438 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{439                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{440                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{441 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{442 \textcolor{comment}{!}}
\DoxyCodeLine{443 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{444 \textcolor{comment}{!}}
\DoxyCodeLine{445             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{446                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{447                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{448                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{449                \textcolor{keywordflow}{If} (invals(irng1) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{450                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{451                   \textcolor{keywordflow}{If} (invals(irng2) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{452 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{453                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{454                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{455 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{456                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{457                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{458 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{459                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{460 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{461                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{462                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{463                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{464 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{465 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{466 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{467 \textcolor{comment}{!}}
\DoxyCodeLine{468 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{469 \textcolor{comment}{!}}
\DoxyCodeLine{470          lmtna = 4}
\DoxyCodeLine{471          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{472 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{473 \textcolor{comment}{!}}
\DoxyCodeLine{474 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{475 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{476 \textcolor{comment}{!}}
\DoxyCodeLine{477       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{478          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{479          iwrkf = 0}
\DoxyCodeLine{480          lmtnc = 2 * lmtnc}
\DoxyCodeLine{481 \textcolor{comment}{!}}
\DoxyCodeLine{482 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{483 \textcolor{comment}{!}}
\DoxyCodeLine{484          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{485             iwrk = iwrkf}
\DoxyCodeLine{486             iwrkd = iwrkf + 1}
\DoxyCodeLine{487             jinda = iwrkf + lmtna}
\DoxyCodeLine{488             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{489             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{490                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{491                iwrkf = nval}
\DoxyCodeLine{492 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{493             iinda = 1}
\DoxyCodeLine{494             iindb = jinda + 1}
\DoxyCodeLine{495 \textcolor{comment}{!}}
\DoxyCodeLine{496 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{497 \textcolor{comment}{!}}
\DoxyCodeLine{498 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{499 \textcolor{comment}{!}}
\DoxyCodeLine{500             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{501             xdona = invals(jwrkt(iinda))}
\DoxyCodeLine{502             xdonb = invals(irngt(iindb))}
\DoxyCodeLine{503 \textcolor{comment}{!}}
\DoxyCodeLine{504             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{505                iwrk = iwrk + 1}
\DoxyCodeLine{506 \textcolor{comment}{!}}
\DoxyCodeLine{507 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{508 \textcolor{comment}{!}}
\DoxyCodeLine{509                \textcolor{keywordflow}{If} (xdona > xdonb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{510                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{511                   iindb = iindb + 1}
\DoxyCodeLine{512                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{513 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{514                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{515                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{516 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{517                   xdonb = invals(irngt(iindb))}
\DoxyCodeLine{518                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{519                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{520                   iinda = iinda + 1}
\DoxyCodeLine{521                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{522                   xdona = invals(jwrkt(iinda))}
\DoxyCodeLine{523 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{524 \textcolor{comment}{!}}
\DoxyCodeLine{525 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{526 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{527 \textcolor{comment}{!}}
\DoxyCodeLine{528 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{529 \textcolor{comment}{!}}
\DoxyCodeLine{530          lmtna = 2 * lmtna}
\DoxyCodeLine{531 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{532 \textcolor{comment}{!}}
\DoxyCodeLine{533 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{534 \textcolor{comment}{!}}
\DoxyCodeLine{535       iinda = 1}
\DoxyCodeLine{536       iindb = lmtna + 1}
\DoxyCodeLine{537       nuni = 0}
\DoxyCodeLine{538 \textcolor{comment}{!}}
\DoxyCodeLine{539 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{540 \textcolor{comment}{!}}
\DoxyCodeLine{541       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{542       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{543         \textcolor{keywordflow}{If} (invals(jwrkt(1)) < invals(irngt(iindb)) ) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{544            xtst = nearless(invals(jwrkt(1)))}
\DoxyCodeLine{545         \textcolor{keywordflow}{Else}}
\DoxyCodeLine{546            xtst = nearless(invals(irngt(iindb)))}
\DoxyCodeLine{547 \textcolor{keywordflow}{        Endif}}
\DoxyCodeLine{548       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{549         xtst = nearless(invals(jwrkt(1)))}
\DoxyCodeLine{550 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{551       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{552 \textcolor{comment}{!}}
\DoxyCodeLine{553 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{554 \textcolor{comment}{!}}
\DoxyCodeLine{555          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{556             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{557                \textcolor{keywordflow}{If} (invals(jwrkt(iinda)) > invals(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{558                   irng = irngt(iindb)}
\DoxyCodeLine{559                   iindb = iindb + 1}
\DoxyCodeLine{560                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{561                   irng = jwrkt(iinda)}
\DoxyCodeLine{562                   iinda = iinda + 1}
\DoxyCodeLine{563 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{564             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{565 \textcolor{comment}{!}}
\DoxyCodeLine{566 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{567 \textcolor{comment}{!}}
\DoxyCodeLine{568                irng = jwrkt(iinda)}
\DoxyCodeLine{569                iinda = iinda + 1}
\DoxyCodeLine{570 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{571          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{572 \textcolor{comment}{!}}
\DoxyCodeLine{573 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{574 \textcolor{comment}{!}}
\DoxyCodeLine{575             irng = irngt(iwrk)}
\DoxyCodeLine{576 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{577          \textcolor{keywordflow}{If} (invals(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{578             xtst = invals(irng)}
\DoxyCodeLine{579             nuni = nuni + 1}
\DoxyCodeLine{580 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{581          igoest(irng) = nuni}
\DoxyCodeLine{582 \textcolor{comment}{!}}
\DoxyCodeLine{583 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{584 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{interfacem__uniinv_1_1uniinv_a8718cf328e2b659c4bb2deb5c1115a2a}\label{interfacem__uniinv_1_1uniinv_a8718cf328e2b659c4bb2deb5c1115a2a}} 
\index{m\_uniinv::uniinv@{m\_uniinv::uniinv}!real64\_uniinv@{real64\_uniinv}}
\index{real64\_uniinv@{real64\_uniinv}!m\_uniinv::uniinv@{m\_uniinv::uniinv}}
\doxysubsubsection{\texorpdfstring{real64\_uniinv()}{real64\_uniinv()}}
{\footnotesize\ttfamily subroutine m\+\_\+uniinv\+::uniinv\+::real64\+\_\+uniinv (\begin{DoxyParamCaption}\item[{real (kind=real64), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, dimension (\+:), intent(out)}]{I\+G\+O\+E\+ST }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\hypertarget{namespacem__uniinv_autotoc_md138}{}\doxysubsubsection{N\+A\+ME}\label{namespacem__uniinv_autotoc_md138}
rank\+\_\+rank\+\_\+decreasing(3f) -\/ \mbox{[}orderpack\+:\+R\+A\+NK\+:U\+N\+I\+Q\+UE\mbox{]} ranks an array in decreasing order, with duplicate entries assigned the same rank(\+Merge\+Sort)\hypertarget{namespacem__uniinv_autotoc_md139}{}\doxysubsubsection{S\+Y\+N\+O\+P\+S\+IS}\label{namespacem__uniinv_autotoc_md139}
\begin{DoxyVerb} Subroutine Rank_Decreasing (INVALS, IGOEST)

   ${TYPE} (kind=${KIND}), Intent (In) :: INVALS(:)
   Integer, Intent (Out)               :: IGOEST(:)

Where ${TYPE}(kind=${KIND}) may be

   o Real(kind=real32)
   o Real(kind=real64)
   o Integer(kind=int32)
   o Character(kind=selected_char_kind("DEFAULT"),len=*)
\end{DoxyVerb}
\hypertarget{namespacem__uniinv_autotoc_md140}{}\doxysubsubsection{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}\label{namespacem__uniinv_autotoc_md140}
\begin{DoxyVerb}RANK_DECREASING(3f) generates an inverse ranking of an array, but with duplicate
entries assigned the same rank.

Internally, the routine is similar to pure merge-sort ranking, but on
the last pass, it sets indices in IGOEST to the rank of the original
value in an ordered set with duplicates removed. For performance
reasons, the first two passes are taken out of the standard loop,
and use dedicated coding.
\end{DoxyVerb}
\hypertarget{namespacem__uniinv_autotoc_md141}{}\doxysubsubsection{O\+P\+T\+I\+O\+NS}\label{namespacem__uniinv_autotoc_md141}
I\+N\+V\+A\+LS array to rank I\+G\+O\+E\+ST returned rank array\hypertarget{namespacem__uniinv_autotoc_md142}{}\doxysubsubsection{E\+X\+A\+M\+P\+L\+ES}\label{namespacem__uniinv_autotoc_md142}
Sample program\+:

program demo\+\_\+rank\+\_\+decreasing ! rank input array ranking duplicates the same use M\+\_\+orderpack, only \+: rank\+\_\+decreasing implicit none character(len=$\ast$),parameter \+:: fmt=\textquotesingle{}(a,$\ast$(g3.\+3,1x))\textquotesingle{} integer,allocatable,dimension(\+:) \+:: I\+N\+V\+A\+LS, igoest, distinct, count integer \+:: imx, i ! create an input array I\+N\+V\+A\+LS=\mbox{[}11, 11, 22, 11, 33, 33, 22, 33, 33\mbox{]} ! make an index array of the same size if(allocated(igoest))deallocate(igoest) allocate(igoest(size(\+I\+N\+V\+A\+L\+S))) print fmt, \textquotesingle{}Original\+: \textquotesingle{},I\+N\+V\+A\+LS print fmt, \textquotesingle{}Number of indices to sort\+:\textquotesingle{},size(\+I\+N\+V\+A\+L\+S) ! rank input array ranking duplicates the same call rank\+\_\+decreasing(\+I\+N\+V\+A\+L\+S,igoest) print fmt, \textquotesingle{}Returned Indices\+: \textquotesingle{},igoest(\+:) ! ! interrogate the results ! imx=maxval(igoest) print fmt, \textquotesingle{}Number of unique indices \+:\textquotesingle{},imx ! squeeze it down to just I\+MX unique values count=\mbox{[}(0,i=1,imx)\mbox{]} ! count how many times a value occurs distinct=count ! array to set of unique values do i=1,size(\+I\+N\+V\+A\+L\+S) distinct(igoest(i))=I\+N\+V\+A\+L\+S(i) count(igoest(i))= count(igoest(i))+1 enddo print fmt, \textquotesingle{}Sorted unique values\+: \textquotesingle{},distinct print fmt, \textquotesingle{}count of occurrences\+: \textquotesingle{},count end program demo\+\_\+rank\+\_\+decreasing

Results\+:

Original\+: 11 11 22 11 33 33 22 33 33 Number of indices to sort\+: 9 Returned Indices\+: 1 1 2 1 3 3 2 3 3 Number of unique indices \+: 3 Sorted unique values\+: 11 22 33 count of occurrences\+: 3 2 4\hypertarget{namespacem__uniinv_autotoc_md143}{}\doxysubsubsection{A\+U\+T\+H\+OR}\label{namespacem__uniinv_autotoc_md143}
Michel Olagnon, 2000-\/2012 \hypertarget{namespacem__uniinv_autotoc_md144}{}\doxysubsubsection{M\+A\+I\+N\+T\+A\+I\+N\+ER}\label{namespacem__uniinv_autotoc_md144}
John Urban, 2022.\+04.\+16 \hypertarget{namespacem__uniinv_autotoc_md145}{}\doxysubsubsection{L\+I\+C\+E\+N\+SE}\label{namespacem__uniinv_autotoc_md145}
C\+C0-\/1.\+0 
\begin{DoxyCode}{0}
\DoxyCodeLine{102 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: invals}
\DoxyCodeLine{103       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IGOEST}
\DoxyCodeLine{104 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{105 \textcolor{keywordtype}{      Real} (kind=real64) :: xtst, xdona, xdonb}
\DoxyCodeLine{106 \textcolor{comment}{!}}
\DoxyCodeLine{107 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{108       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IGOEST))} :: JWRKT, IRNGT}
\DoxyCodeLine{109       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2, NUNI}
\DoxyCodeLine{110       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{111 \textcolor{comment}{!}}
\DoxyCodeLine{112       nval = min(\textcolor{keyword}{SIZE}(invals), \textcolor{keyword}{SIZE}(igoest))}
\DoxyCodeLine{113 \textcolor{comment}{!}}
\DoxyCodeLine{114       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{115       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{116          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{117       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{118          igoest(1) = 1}
\DoxyCodeLine{119          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{120 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{121          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{122 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{123 \textcolor{comment}{!}}
\DoxyCodeLine{124 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{125 \textcolor{comment}{!}}
\DoxyCodeLine{126       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{127          \textcolor{keywordflow}{If} (invals(iind-\/1) < invals(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{128             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{129             irngt(iind) = iind}
\DoxyCodeLine{130          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{131             irngt(iind-\/1) = iind}
\DoxyCodeLine{132             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{133 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{134 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{135       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{136          irngt(nval) = nval}
\DoxyCodeLine{137 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{138 \textcolor{comment}{!}}
\DoxyCodeLine{139 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{140 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{141 \textcolor{comment}{!}}
\DoxyCodeLine{142       lmtna = 2}
\DoxyCodeLine{143       lmtnc = 4}
\DoxyCodeLine{144 \textcolor{comment}{!}}
\DoxyCodeLine{145 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{146 \textcolor{comment}{!}}
\DoxyCodeLine{147       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{148          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{149 \textcolor{comment}{!}}
\DoxyCodeLine{150 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{151 \textcolor{comment}{!}}
\DoxyCodeLine{152          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{153             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{154                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{155 \textcolor{comment}{!}}
\DoxyCodeLine{156 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{157 \textcolor{comment}{!}}
\DoxyCodeLine{158                \textcolor{keywordflow}{If} (invals(irngt(iwrkd+2)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{159 \textcolor{comment}{!}}
\DoxyCodeLine{160 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{161 \textcolor{comment}{!}}
\DoxyCodeLine{162                \textcolor{keywordflow}{If} (invals(irngt(iwrkd+1)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{163                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{164                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{165                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{166 \textcolor{comment}{!}}
\DoxyCodeLine{167 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{168 \textcolor{comment}{!}}
\DoxyCodeLine{169                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{170                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{171                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{172                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{173                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{174 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{175                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{176 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{177 \textcolor{comment}{!}}
\DoxyCodeLine{178 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{179 \textcolor{comment}{!}}
\DoxyCodeLine{180             \textcolor{keywordflow}{If} (invals(irngt(iwrkd+2)) <= invals(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{181 \textcolor{comment}{!}}
\DoxyCodeLine{182 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{183 \textcolor{comment}{!}}
\DoxyCodeLine{184             \textcolor{keywordflow}{If} (invals(irngt(iwrkd+1)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{185                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{186                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{187                \textcolor{keywordflow}{If} (invals(irng2) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{188 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{189                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{190                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{191 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{192                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{193                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{194 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{195 \textcolor{comment}{!}}
\DoxyCodeLine{196 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{197 \textcolor{comment}{!}}
\DoxyCodeLine{198             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{199                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{200                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{201                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{202                \textcolor{keywordflow}{If} (invals(irng1) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{203                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{204                   \textcolor{keywordflow}{If} (invals(irng2) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{205 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{206                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{207                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{208 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{209                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{210                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{211 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{212                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{213 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{214                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{215                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{216                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{217 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{218 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{219 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{220 \textcolor{comment}{!}}
\DoxyCodeLine{221 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{222 \textcolor{comment}{!}}
\DoxyCodeLine{223          lmtna = 4}
\DoxyCodeLine{224          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{225 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{226 \textcolor{comment}{!}}
\DoxyCodeLine{227 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{228 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{229 \textcolor{comment}{!}}
\DoxyCodeLine{230       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{231          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{232          iwrkf = 0}
\DoxyCodeLine{233          lmtnc = 2 * lmtnc}
\DoxyCodeLine{234 \textcolor{comment}{!}}
\DoxyCodeLine{235 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{236 \textcolor{comment}{!}}
\DoxyCodeLine{237          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{238             iwrk = iwrkf}
\DoxyCodeLine{239             iwrkd = iwrkf + 1}
\DoxyCodeLine{240             jinda = iwrkf + lmtna}
\DoxyCodeLine{241             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{242             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{243                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{244                iwrkf = nval}
\DoxyCodeLine{245 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{246             iinda = 1}
\DoxyCodeLine{247             iindb = jinda + 1}
\DoxyCodeLine{248 \textcolor{comment}{!}}
\DoxyCodeLine{249 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{250 \textcolor{comment}{!}}
\DoxyCodeLine{251 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{252 \textcolor{comment}{!}}
\DoxyCodeLine{253             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{254             xdona = invals(jwrkt(iinda))}
\DoxyCodeLine{255             xdonb = invals(irngt(iindb))}
\DoxyCodeLine{256 \textcolor{comment}{!}}
\DoxyCodeLine{257             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{258                iwrk = iwrk + 1}
\DoxyCodeLine{259 \textcolor{comment}{!}}
\DoxyCodeLine{260 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{261 \textcolor{comment}{!}}
\DoxyCodeLine{262                \textcolor{keywordflow}{If} (xdona > xdonb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{263                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{264                   iindb = iindb + 1}
\DoxyCodeLine{265                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{266 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{267                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{268                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{269 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{270                   xdonb = invals(irngt(iindb))}
\DoxyCodeLine{271                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{272                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{273                   iinda = iinda + 1}
\DoxyCodeLine{274                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{275                   xdona = invals(jwrkt(iinda))}
\DoxyCodeLine{276 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{277 \textcolor{comment}{!}}
\DoxyCodeLine{278 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{279 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{280 \textcolor{comment}{!}}
\DoxyCodeLine{281 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{282 \textcolor{comment}{!}}
\DoxyCodeLine{283          lmtna = 2 * lmtna}
\DoxyCodeLine{284 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{285 \textcolor{comment}{!}}
\DoxyCodeLine{286 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{287 \textcolor{comment}{!}}
\DoxyCodeLine{288       iinda = 1}
\DoxyCodeLine{289       iindb = lmtna + 1}
\DoxyCodeLine{290       nuni = 0}
\DoxyCodeLine{291 \textcolor{comment}{!}}
\DoxyCodeLine{292 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{293 \textcolor{comment}{!}}
\DoxyCodeLine{294       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{295       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{296         \textcolor{keywordflow}{If} (invals(jwrkt(1)) < invals(irngt(iindb)) ) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{297            xtst = nearless(invals(jwrkt(1)))}
\DoxyCodeLine{298         \textcolor{keywordflow}{Else}}
\DoxyCodeLine{299            xtst = nearless(invals(irngt(iindb)))}
\DoxyCodeLine{300 \textcolor{keywordflow}{        Endif}}
\DoxyCodeLine{301       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{302         xtst = nearless(invals(jwrkt(1)))}
\DoxyCodeLine{303 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{304       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{305 \textcolor{comment}{!}}
\DoxyCodeLine{306 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{307 \textcolor{comment}{!}}
\DoxyCodeLine{308          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{309             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{310                \textcolor{keywordflow}{If} (invals(jwrkt(iinda)) > invals(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{311                   irng = irngt(iindb)}
\DoxyCodeLine{312                   iindb = iindb + 1}
\DoxyCodeLine{313                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{314                   irng = jwrkt(iinda)}
\DoxyCodeLine{315                   iinda = iinda + 1}
\DoxyCodeLine{316 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{317             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{318 \textcolor{comment}{!}}
\DoxyCodeLine{319 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{320 \textcolor{comment}{!}}
\DoxyCodeLine{321                irng = jwrkt(iinda)}
\DoxyCodeLine{322                iinda = iinda + 1}
\DoxyCodeLine{323 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{324          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{325 \textcolor{comment}{!}}
\DoxyCodeLine{326 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{327 \textcolor{comment}{!}}
\DoxyCodeLine{328             irng = irngt(iwrk)}
\DoxyCodeLine{329 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{330          \textcolor{keywordflow}{If} (invals(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{331             xtst = invals(irng)}
\DoxyCodeLine{332             nuni = nuni + 1}
\DoxyCodeLine{333 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{334          igoest(irng) = nuni}
\DoxyCodeLine{335 \textcolor{comment}{!}}
\DoxyCodeLine{336 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{337 \textcolor{comment}{!}}

\end{DoxyCode}


The documentation for this interface was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/home/urbanjs/venus/\+V600/github/orderpack/src/\mbox{\hyperlink{M__uniinv_8f90}{M\+\_\+uniinv.\+f90}}\end{DoxyCompactItemize}
