\hypertarget{interfacem__uniinv_1_1uniinv}{}\doxysection{m\+\_\+uniinv\+::uniinv Interface Reference}
\label{interfacem__uniinv_1_1uniinv}\index{m\_uniinv::uniinv@{m\_uniinv::uniinv}}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{interfacem__uniinv_1_1uniinv_ae11f1b95cfead57b18c48874b5d0a990}{d\+\_\+uniinv}} (X\+D\+O\+NT, I\+G\+O\+E\+ST)
\item 
subroutine \mbox{\hyperlink{interfacem__uniinv_1_1uniinv_a276a8d2c5c96a2ee926ba4df3aec48e6}{r\+\_\+uniinv}} (X\+D\+O\+NT, I\+G\+O\+E\+ST)
\item 
subroutine \mbox{\hyperlink{interfacem__uniinv_1_1uniinv_a98f96b30b5290b4ed9351db1406e2353}{i\+\_\+uniinv}} (X\+D\+O\+NT, I\+G\+O\+E\+ST)
\end{DoxyCompactItemize}


\doxysubsection{Member Function/\+Subroutine Documentation}
\mbox{\Hypertarget{interfacem__uniinv_1_1uniinv_ae11f1b95cfead57b18c48874b5d0a990}\label{interfacem__uniinv_1_1uniinv_ae11f1b95cfead57b18c48874b5d0a990}} 
\index{m\_uniinv::uniinv@{m\_uniinv::uniinv}!d\_uniinv@{d\_uniinv}}
\index{d\_uniinv@{d\_uniinv}!m\_uniinv::uniinv@{m\_uniinv::uniinv}}
\doxysubsubsection{\texorpdfstring{d\_uniinv()}{d\_uniinv()}}
{\footnotesize\ttfamily subroutine m\+\_\+uniinv\+::uniinv\+::d\+\_\+uniinv (\begin{DoxyParamCaption}\item[{real (kind=\mbox{\hyperlink{namespacem__uniinv_afc48601cada0352bc378a76e4a42b22d}{kdp}}), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, dimension (\+:), intent(out)}]{I\+G\+O\+E\+ST }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{18 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{19 \textcolor{comment}{!!  UNIINV = Merge-\/sort inverse ranking of an array, with removal of}}
\DoxyCodeLine{20 \textcolor{comment}{!!  duplicate entries.}}
\DoxyCodeLine{21 \textcolor{comment}{!!  The routine is similar to pure merge-\/sort ranking, but on}}
\DoxyCodeLine{22 \textcolor{comment}{!!  the last pass, it sets indices in IGOEST to the rank}}
\DoxyCodeLine{23 \textcolor{comment}{!!  of the value in the ordered set with duplicates removed.}}
\DoxyCodeLine{24 \textcolor{comment}{!!  For performance reasons, the first 2 passes are taken}}
\DoxyCodeLine{25 \textcolor{comment}{!!  out of the standard loop, and use dedicated coding.}}
\DoxyCodeLine{26 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{27 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{28 \textcolor{keywordtype}{      Real} (kind=kdp), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{29       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IGOEST}
\DoxyCodeLine{30 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{31 \textcolor{keywordtype}{      Real} (kind=kdp) :: xtst, xdona, xdonb}
\DoxyCodeLine{32 \textcolor{comment}{!}}
\DoxyCodeLine{33 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{34       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IGOEST))} :: JWRKT, IRNGT}
\DoxyCodeLine{35       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2, NUNI}
\DoxyCodeLine{36       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{37 \textcolor{comment}{!}}
\DoxyCodeLine{38       nval = min(\textcolor{keyword}{SIZE}(xdont), \textcolor{keyword}{SIZE}(igoest))}
\DoxyCodeLine{39 \textcolor{comment}{!}}
\DoxyCodeLine{40       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{41       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{42          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{43       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{44          igoest(1) = 1}
\DoxyCodeLine{45          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{46 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{47          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{48 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{49 \textcolor{comment}{!}}
\DoxyCodeLine{50 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{51 \textcolor{comment}{!}}
\DoxyCodeLine{52       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{53          \textcolor{keywordflow}{If} (xdont(iind-\/1) < xdont(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{54             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{55             irngt(iind) = iind}
\DoxyCodeLine{56          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{57             irngt(iind-\/1) = iind}
\DoxyCodeLine{58             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{59 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{60 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{61       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{62          irngt(nval) = nval}
\DoxyCodeLine{63 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{64 \textcolor{comment}{!}}
\DoxyCodeLine{65 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{66 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{67 \textcolor{comment}{!}}
\DoxyCodeLine{68       lmtna = 2}
\DoxyCodeLine{69       lmtnc = 4}
\DoxyCodeLine{70 \textcolor{comment}{!}}
\DoxyCodeLine{71 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{72 \textcolor{comment}{!}}
\DoxyCodeLine{73       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{74          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{75 \textcolor{comment}{!}}
\DoxyCodeLine{76 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{77 \textcolor{comment}{!}}
\DoxyCodeLine{78          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{79             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{80                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{81 \textcolor{comment}{!}}
\DoxyCodeLine{82 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{83 \textcolor{comment}{!}}
\DoxyCodeLine{84                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{85 \textcolor{comment}{!}}
\DoxyCodeLine{86 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{87 \textcolor{comment}{!}}
\DoxyCodeLine{88                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{89                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{90                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{91                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{92 \textcolor{comment}{!}}
\DoxyCodeLine{93 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{94 \textcolor{comment}{!}}
\DoxyCodeLine{95                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{96                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{97                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{98                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{99                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{100 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{101                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{102 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{103 \textcolor{comment}{!}}
\DoxyCodeLine{104 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{105 \textcolor{comment}{!}}
\DoxyCodeLine{106             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{107 \textcolor{comment}{!}}
\DoxyCodeLine{108 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{109 \textcolor{comment}{!}}
\DoxyCodeLine{110             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{111                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{112                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{113                \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{114 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{115                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{116                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{117 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{118                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{119                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{120 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{121 \textcolor{comment}{!}}
\DoxyCodeLine{122 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{123 \textcolor{comment}{!}}
\DoxyCodeLine{124             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{125                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{126                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{127                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{128                \textcolor{keywordflow}{If} (xdont(irng1) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{129                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{130                   \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{131 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{132                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{133                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{134 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{135                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{136                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{137 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{138                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{139 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{140                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{141                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{142                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{143 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{144 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{145 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{146 \textcolor{comment}{!}}
\DoxyCodeLine{147 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{148 \textcolor{comment}{!}}
\DoxyCodeLine{149          lmtna = 4}
\DoxyCodeLine{150          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{151 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{152 \textcolor{comment}{!}}
\DoxyCodeLine{153 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{154 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{155 \textcolor{comment}{!}}
\DoxyCodeLine{156       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{157          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{158          iwrkf = 0}
\DoxyCodeLine{159          lmtnc = 2 * lmtnc}
\DoxyCodeLine{160 \textcolor{comment}{!}}
\DoxyCodeLine{161 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{162 \textcolor{comment}{!}}
\DoxyCodeLine{163          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{164             iwrk = iwrkf}
\DoxyCodeLine{165             iwrkd = iwrkf + 1}
\DoxyCodeLine{166             jinda = iwrkf + lmtna}
\DoxyCodeLine{167             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{168             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{169                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{170                iwrkf = nval}
\DoxyCodeLine{171 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{172             iinda = 1}
\DoxyCodeLine{173             iindb = jinda + 1}
\DoxyCodeLine{174 \textcolor{comment}{!}}
\DoxyCodeLine{175 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{176 \textcolor{comment}{!}}
\DoxyCodeLine{177 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{178 \textcolor{comment}{!}}
\DoxyCodeLine{179             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{180             xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{181             xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{182 \textcolor{comment}{!}}
\DoxyCodeLine{183             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{184                iwrk = iwrk + 1}
\DoxyCodeLine{185 \textcolor{comment}{!}}
\DoxyCodeLine{186 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{187 \textcolor{comment}{!}}
\DoxyCodeLine{188                \textcolor{keywordflow}{If} (xdona > xdonb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{189                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{190                   iindb = iindb + 1}
\DoxyCodeLine{191                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{192 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{193                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{194                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{195 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{196                   xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{197                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{198                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{199                   iinda = iinda + 1}
\DoxyCodeLine{200                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{201                   xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{202 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{203 \textcolor{comment}{!}}
\DoxyCodeLine{204 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{205 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{206 \textcolor{comment}{!}}
\DoxyCodeLine{207 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{208 \textcolor{comment}{!}}
\DoxyCodeLine{209          lmtna = 2 * lmtna}
\DoxyCodeLine{210 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{211 \textcolor{comment}{!}}
\DoxyCodeLine{212 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{213 \textcolor{comment}{!}}
\DoxyCodeLine{214       iinda = 1}
\DoxyCodeLine{215       iindb = lmtna + 1}
\DoxyCodeLine{216       nuni = 0}
\DoxyCodeLine{217 \textcolor{comment}{!}}
\DoxyCodeLine{218 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{219 \textcolor{comment}{!}}
\DoxyCodeLine{220       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{221       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{222         xtst = nearless(min(xdont(jwrkt(1)), xdont(irngt(iindb))))}
\DoxyCodeLine{223       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{224         xtst = nearless(xdont(jwrkt(1)))}
\DoxyCodeLine{225 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{226       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{227 \textcolor{comment}{!}}
\DoxyCodeLine{228 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{229 \textcolor{comment}{!}}
\DoxyCodeLine{230          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{231             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{232                \textcolor{keywordflow}{If} (xdont(jwrkt(iinda)) > xdont(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{233                   irng = irngt(iindb)}
\DoxyCodeLine{234                   iindb = iindb + 1}
\DoxyCodeLine{235                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{236                   irng = jwrkt(iinda)}
\DoxyCodeLine{237                   iinda = iinda + 1}
\DoxyCodeLine{238 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{239             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{240 \textcolor{comment}{!}}
\DoxyCodeLine{241 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{242 \textcolor{comment}{!}}
\DoxyCodeLine{243                irng = jwrkt(iinda)}
\DoxyCodeLine{244                iinda = iinda + 1}
\DoxyCodeLine{245 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{246          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{247 \textcolor{comment}{!}}
\DoxyCodeLine{248 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{249 \textcolor{comment}{!}}
\DoxyCodeLine{250             irng = irngt(iwrk)}
\DoxyCodeLine{251 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{252          \textcolor{keywordflow}{If} (xdont(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{253             xtst = xdont(irng)}
\DoxyCodeLine{254             nuni = nuni + 1}
\DoxyCodeLine{255 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{256          igoest(irng) = nuni}
\DoxyCodeLine{257 \textcolor{comment}{!}}
\DoxyCodeLine{258 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{259 \textcolor{comment}{!}}
\DoxyCodeLine{260       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{261 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{interfacem__uniinv_1_1uniinv_a98f96b30b5290b4ed9351db1406e2353}\label{interfacem__uniinv_1_1uniinv_a98f96b30b5290b4ed9351db1406e2353}} 
\index{m\_uniinv::uniinv@{m\_uniinv::uniinv}!i\_uniinv@{i\_uniinv}}
\index{i\_uniinv@{i\_uniinv}!m\_uniinv::uniinv@{m\_uniinv::uniinv}}
\doxysubsubsection{\texorpdfstring{i\_uniinv()}{i\_uniinv()}}
{\footnotesize\ttfamily subroutine m\+\_\+uniinv\+::uniinv\+::i\+\_\+uniinv (\begin{DoxyParamCaption}\item[{integer, dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, dimension (\+:), intent(out)}]{I\+G\+O\+E\+ST }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{511 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{512 \textcolor{comment}{!!  UNIINV = Merge-\/sort inverse ranking of an array, with removal of}}
\DoxyCodeLine{513 \textcolor{comment}{!!  duplicate entries.}}
\DoxyCodeLine{514 \textcolor{comment}{!!  The routine is similar to pure merge-\/sort ranking, but on}}
\DoxyCodeLine{515 \textcolor{comment}{!!  the last pass, it sets indices in IGOEST to the rank}}
\DoxyCodeLine{516 \textcolor{comment}{!!  of the value in the ordered set with duplicates removed.}}
\DoxyCodeLine{517 \textcolor{comment}{!!  For performance reasons, the first 2 passes are taken}}
\DoxyCodeLine{518 \textcolor{comment}{!!  out of the standard loop, and use dedicated coding.}}
\DoxyCodeLine{519 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{520 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{521       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)}  :: XDONT}
\DoxyCodeLine{522       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IGOEST}
\DoxyCodeLine{523 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{524       \textcolor{keywordtype}{Integer} :: XTST, XDONA, XDONB}
\DoxyCodeLine{525 \textcolor{comment}{!}}
\DoxyCodeLine{526 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{527       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IGOEST))} :: JWRKT, IRNGT}
\DoxyCodeLine{528       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2, NUNI}
\DoxyCodeLine{529       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{530 \textcolor{comment}{!}}
\DoxyCodeLine{531       nval = min(\textcolor{keyword}{SIZE}(xdont), \textcolor{keyword}{SIZE}(igoest))}
\DoxyCodeLine{532 \textcolor{comment}{!}}
\DoxyCodeLine{533       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{534       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{535          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{536       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{537          igoest(1) = 1}
\DoxyCodeLine{538          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{539 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{540          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{541 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{542 \textcolor{comment}{!}}
\DoxyCodeLine{543 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{544 \textcolor{comment}{!}}
\DoxyCodeLine{545       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{546          \textcolor{keywordflow}{If} (xdont(iind-\/1) < xdont(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{547             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{548             irngt(iind) = iind}
\DoxyCodeLine{549          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{550             irngt(iind-\/1) = iind}
\DoxyCodeLine{551             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{552 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{553 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{554       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{555          irngt(nval) = nval}
\DoxyCodeLine{556 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{557 \textcolor{comment}{!}}
\DoxyCodeLine{558 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{559 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{560 \textcolor{comment}{!}}
\DoxyCodeLine{561       lmtna = 2}
\DoxyCodeLine{562       lmtnc = 4}
\DoxyCodeLine{563 \textcolor{comment}{!}}
\DoxyCodeLine{564 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{565 \textcolor{comment}{!}}
\DoxyCodeLine{566       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{567          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{568 \textcolor{comment}{!}}
\DoxyCodeLine{569 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{570 \textcolor{comment}{!}}
\DoxyCodeLine{571          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{572             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{573                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{574 \textcolor{comment}{!}}
\DoxyCodeLine{575 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{576 \textcolor{comment}{!}}
\DoxyCodeLine{577                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{578 \textcolor{comment}{!}}
\DoxyCodeLine{579 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{580 \textcolor{comment}{!}}
\DoxyCodeLine{581                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{582                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{583                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{584                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{585 \textcolor{comment}{!}}
\DoxyCodeLine{586 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{587 \textcolor{comment}{!}}
\DoxyCodeLine{588                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{589                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{590                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{591                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{592                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{593 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{594                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{595 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{596 \textcolor{comment}{!}}
\DoxyCodeLine{597 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{598 \textcolor{comment}{!}}
\DoxyCodeLine{599             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{600 \textcolor{comment}{!}}
\DoxyCodeLine{601 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{602 \textcolor{comment}{!}}
\DoxyCodeLine{603             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{604                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{605                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{606                \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{607 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{608                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{609                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{610 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{611                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{612                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{613 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{614 \textcolor{comment}{!}}
\DoxyCodeLine{615 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{616 \textcolor{comment}{!}}
\DoxyCodeLine{617             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{618                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{619                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{620                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{621                \textcolor{keywordflow}{If} (xdont(irng1) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{622                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{623                   \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{624 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{625                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{626                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{627 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{628                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{629                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{630 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{631                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{632 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{633                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{634                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{635                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{636 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{637 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{638 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{639 \textcolor{comment}{!}}
\DoxyCodeLine{640 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{641 \textcolor{comment}{!}}
\DoxyCodeLine{642          lmtna = 4}
\DoxyCodeLine{643          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{644 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{645 \textcolor{comment}{!}}
\DoxyCodeLine{646 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{647 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{648 \textcolor{comment}{!}}
\DoxyCodeLine{649       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{650          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{651          iwrkf = 0}
\DoxyCodeLine{652          lmtnc = 2 * lmtnc}
\DoxyCodeLine{653 \textcolor{comment}{!}}
\DoxyCodeLine{654 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{655 \textcolor{comment}{!}}
\DoxyCodeLine{656          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{657             iwrk = iwrkf}
\DoxyCodeLine{658             iwrkd = iwrkf + 1}
\DoxyCodeLine{659             jinda = iwrkf + lmtna}
\DoxyCodeLine{660             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{661             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{662                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{663                iwrkf = nval}
\DoxyCodeLine{664 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{665             iinda = 1}
\DoxyCodeLine{666             iindb = jinda + 1}
\DoxyCodeLine{667 \textcolor{comment}{!}}
\DoxyCodeLine{668 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{669 \textcolor{comment}{!}}
\DoxyCodeLine{670 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{671 \textcolor{comment}{!}}
\DoxyCodeLine{672             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{673             xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{674             xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{675 \textcolor{comment}{!}}
\DoxyCodeLine{676             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{677                iwrk = iwrk + 1}
\DoxyCodeLine{678 \textcolor{comment}{!}}
\DoxyCodeLine{679 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{680 \textcolor{comment}{!}}
\DoxyCodeLine{681                \textcolor{keywordflow}{If} (xdona > xdonb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{682                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{683                   iindb = iindb + 1}
\DoxyCodeLine{684                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{685 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{686                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{687                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{688 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{689                   xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{690                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{691                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{692                   iinda = iinda + 1}
\DoxyCodeLine{693                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{694                   xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{695 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{696 \textcolor{comment}{!}}
\DoxyCodeLine{697 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{698 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{699 \textcolor{comment}{!}}
\DoxyCodeLine{700 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{701 \textcolor{comment}{!}}
\DoxyCodeLine{702          lmtna = 2 * lmtna}
\DoxyCodeLine{703 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{704 \textcolor{comment}{!}}
\DoxyCodeLine{705 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{706 \textcolor{comment}{!}}
\DoxyCodeLine{707       iinda = 1}
\DoxyCodeLine{708       iindb = lmtna + 1}
\DoxyCodeLine{709       nuni = 0}
\DoxyCodeLine{710 \textcolor{comment}{!}}
\DoxyCodeLine{711 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{712 \textcolor{comment}{!}}
\DoxyCodeLine{713       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{714       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{715         xtst = nearless(min(xdont(jwrkt(1)), xdont(irngt(iindb))))}
\DoxyCodeLine{716       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{717         xtst = nearless(xdont(jwrkt(1)))}
\DoxyCodeLine{718 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{719       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{720 \textcolor{comment}{!}}
\DoxyCodeLine{721 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{722 \textcolor{comment}{!}}
\DoxyCodeLine{723          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{724             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{725                \textcolor{keywordflow}{If} (xdont(jwrkt(iinda)) > xdont(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{726                   irng = irngt(iindb)}
\DoxyCodeLine{727                   iindb = iindb + 1}
\DoxyCodeLine{728                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{729                   irng = jwrkt(iinda)}
\DoxyCodeLine{730                   iinda = iinda + 1}
\DoxyCodeLine{731 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{732             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{733 \textcolor{comment}{!}}
\DoxyCodeLine{734 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{735 \textcolor{comment}{!}}
\DoxyCodeLine{736                irng = jwrkt(iinda)}
\DoxyCodeLine{737                iinda = iinda + 1}
\DoxyCodeLine{738 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{739          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{740 \textcolor{comment}{!}}
\DoxyCodeLine{741 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{742 \textcolor{comment}{!}}
\DoxyCodeLine{743             irng = irngt(iwrk)}
\DoxyCodeLine{744 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{745          \textcolor{keywordflow}{If} (xdont(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{746             xtst = xdont(irng)}
\DoxyCodeLine{747             nuni = nuni + 1}
\DoxyCodeLine{748 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{749          igoest(irng) = nuni}
\DoxyCodeLine{750 \textcolor{comment}{!}}
\DoxyCodeLine{751 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{752 \textcolor{comment}{!}}
\DoxyCodeLine{753       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{754 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{interfacem__uniinv_1_1uniinv_a276a8d2c5c96a2ee926ba4df3aec48e6}\label{interfacem__uniinv_1_1uniinv_a276a8d2c5c96a2ee926ba4df3aec48e6}} 
\index{m\_uniinv::uniinv@{m\_uniinv::uniinv}!r\_uniinv@{r\_uniinv}}
\index{r\_uniinv@{r\_uniinv}!m\_uniinv::uniinv@{m\_uniinv::uniinv}}
\doxysubsubsection{\texorpdfstring{r\_uniinv()}{r\_uniinv()}}
{\footnotesize\ttfamily subroutine m\+\_\+uniinv\+::uniinv\+::r\+\_\+uniinv (\begin{DoxyParamCaption}\item[{real, dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, dimension (\+:), intent(out)}]{I\+G\+O\+E\+ST }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{265 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{266 \textcolor{comment}{!!  UNIINV = Merge-\/sort inverse ranking of an array, with removal of}}
\DoxyCodeLine{267 \textcolor{comment}{!!  duplicate entries.}}
\DoxyCodeLine{268 \textcolor{comment}{!!  The routine is similar to pure merge-\/sort ranking, but on}}
\DoxyCodeLine{269 \textcolor{comment}{!!  the last pass, it sets indices in IGOEST to the rank}}
\DoxyCodeLine{270 \textcolor{comment}{!!  of the value in the ordered set with duplicates removed.}}
\DoxyCodeLine{271 \textcolor{comment}{!!  For performance reasons, the first 2 passes are taken}}
\DoxyCodeLine{272 \textcolor{comment}{!!  out of the standard loop, and use dedicated coding.}}
\DoxyCodeLine{273 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{274 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{275 \textcolor{keywordtype}{      Real}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDONT}
\DoxyCodeLine{276       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IGOEST}
\DoxyCodeLine{277 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{278 \textcolor{keywordtype}{      Real}    :: XTST, XDONA, XDONB}
\DoxyCodeLine{279 \textcolor{comment}{!}}
\DoxyCodeLine{280 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{281       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IGOEST))} :: JWRKT, IRNGT}
\DoxyCodeLine{282       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2, NUNI}
\DoxyCodeLine{283       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{284 \textcolor{comment}{!}}
\DoxyCodeLine{285       nval = min(\textcolor{keyword}{SIZE}(xdont), \textcolor{keyword}{SIZE}(igoest))}
\DoxyCodeLine{286 \textcolor{comment}{!}}
\DoxyCodeLine{287       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{288       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{289          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{290       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{291          igoest(1) = 1}
\DoxyCodeLine{292          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{293 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{294          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{295 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{296 \textcolor{comment}{!}}
\DoxyCodeLine{297 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{298 \textcolor{comment}{!}}
\DoxyCodeLine{299       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{300          \textcolor{keywordflow}{If} (xdont(iind-\/1) < xdont(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{301             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{302             irngt(iind) = iind}
\DoxyCodeLine{303          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{304             irngt(iind-\/1) = iind}
\DoxyCodeLine{305             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{306 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{307 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{308       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{309          irngt(nval) = nval}
\DoxyCodeLine{310 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{311 \textcolor{comment}{!}}
\DoxyCodeLine{312 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{313 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{314 \textcolor{comment}{!}}
\DoxyCodeLine{315       lmtna = 2}
\DoxyCodeLine{316       lmtnc = 4}
\DoxyCodeLine{317 \textcolor{comment}{!}}
\DoxyCodeLine{318 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{319 \textcolor{comment}{!}}
\DoxyCodeLine{320       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{321          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{322 \textcolor{comment}{!}}
\DoxyCodeLine{323 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{324 \textcolor{comment}{!}}
\DoxyCodeLine{325          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{326             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{327                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{328 \textcolor{comment}{!}}
\DoxyCodeLine{329 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{330 \textcolor{comment}{!}}
\DoxyCodeLine{331                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{332 \textcolor{comment}{!}}
\DoxyCodeLine{333 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{334 \textcolor{comment}{!}}
\DoxyCodeLine{335                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{336                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{337                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{338                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{339 \textcolor{comment}{!}}
\DoxyCodeLine{340 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{341 \textcolor{comment}{!}}
\DoxyCodeLine{342                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{343                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{344                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{345                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{346                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{347 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{348                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{349 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{350 \textcolor{comment}{!}}
\DoxyCodeLine{351 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{352 \textcolor{comment}{!}}
\DoxyCodeLine{353             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{354 \textcolor{comment}{!}}
\DoxyCodeLine{355 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{356 \textcolor{comment}{!}}
\DoxyCodeLine{357             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{358                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{359                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{360                \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{361 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{362                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{363                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{364 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{365                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{366                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{367 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{368 \textcolor{comment}{!}}
\DoxyCodeLine{369 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{370 \textcolor{comment}{!}}
\DoxyCodeLine{371             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{372                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{373                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{374                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{375                \textcolor{keywordflow}{If} (xdont(irng1) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{376                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{377                   \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{378 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{379                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{380                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{381 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{382                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{383                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{384 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{385                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{386 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{387                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{388                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{389                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{390 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{391 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{392 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{393 \textcolor{comment}{!}}
\DoxyCodeLine{394 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{395 \textcolor{comment}{!}}
\DoxyCodeLine{396          lmtna = 4}
\DoxyCodeLine{397          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{398 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{399 \textcolor{comment}{!}}
\DoxyCodeLine{400 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{401 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{402 \textcolor{comment}{!}}
\DoxyCodeLine{403       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{404          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{405          iwrkf = 0}
\DoxyCodeLine{406          lmtnc = 2 * lmtnc}
\DoxyCodeLine{407 \textcolor{comment}{!}}
\DoxyCodeLine{408 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{409 \textcolor{comment}{!}}
\DoxyCodeLine{410          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{411             iwrk = iwrkf}
\DoxyCodeLine{412             iwrkd = iwrkf + 1}
\DoxyCodeLine{413             jinda = iwrkf + lmtna}
\DoxyCodeLine{414             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{415             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{416                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{417                iwrkf = nval}
\DoxyCodeLine{418 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{419             iinda = 1}
\DoxyCodeLine{420             iindb = jinda + 1}
\DoxyCodeLine{421 \textcolor{comment}{!}}
\DoxyCodeLine{422 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{423 \textcolor{comment}{!}}
\DoxyCodeLine{424 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{425 \textcolor{comment}{!}}
\DoxyCodeLine{426             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{427             xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{428             xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{429 \textcolor{comment}{!}}
\DoxyCodeLine{430             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{431                iwrk = iwrk + 1}
\DoxyCodeLine{432 \textcolor{comment}{!}}
\DoxyCodeLine{433 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{434 \textcolor{comment}{!}}
\DoxyCodeLine{435                \textcolor{keywordflow}{If} (xdona > xdonb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{436                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{437                   iindb = iindb + 1}
\DoxyCodeLine{438                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{439 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{440                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{441                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{442 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{443                   xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{444                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{445                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{446                   iinda = iinda + 1}
\DoxyCodeLine{447                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{448                   xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{449 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{450 \textcolor{comment}{!}}
\DoxyCodeLine{451 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{452 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{453 \textcolor{comment}{!}}
\DoxyCodeLine{454 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{455 \textcolor{comment}{!}}
\DoxyCodeLine{456          lmtna = 2 * lmtna}
\DoxyCodeLine{457 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{458 \textcolor{comment}{!}}
\DoxyCodeLine{459 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{460 \textcolor{comment}{!}}
\DoxyCodeLine{461       iinda = 1}
\DoxyCodeLine{462       iindb = lmtna + 1}
\DoxyCodeLine{463       nuni = 0}
\DoxyCodeLine{464 \textcolor{comment}{!}}
\DoxyCodeLine{465 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{466 \textcolor{comment}{!}}
\DoxyCodeLine{467       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{468       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{469         xtst = nearless(min(xdont(jwrkt(1)), xdont(irngt(iindb))))}
\DoxyCodeLine{470       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{471         xtst = nearless(xdont(jwrkt(1)))}
\DoxyCodeLine{472 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{473       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{474 \textcolor{comment}{!}}
\DoxyCodeLine{475 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{476 \textcolor{comment}{!}}
\DoxyCodeLine{477          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{478             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{479                \textcolor{keywordflow}{If} (xdont(jwrkt(iinda)) > xdont(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{480                   irng = irngt(iindb)}
\DoxyCodeLine{481                   iindb = iindb + 1}
\DoxyCodeLine{482                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{483                   irng = jwrkt(iinda)}
\DoxyCodeLine{484                   iinda = iinda + 1}
\DoxyCodeLine{485 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{486             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{487 \textcolor{comment}{!}}
\DoxyCodeLine{488 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{489 \textcolor{comment}{!}}
\DoxyCodeLine{490                irng = jwrkt(iinda)}
\DoxyCodeLine{491                iinda = iinda + 1}
\DoxyCodeLine{492 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{493          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{494 \textcolor{comment}{!}}
\DoxyCodeLine{495 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{496 \textcolor{comment}{!}}
\DoxyCodeLine{497             irng = irngt(iwrk)}
\DoxyCodeLine{498 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{499          \textcolor{keywordflow}{If} (xdont(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{500             xtst = xdont(irng)}
\DoxyCodeLine{501             nuni = nuni + 1}
\DoxyCodeLine{502 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{503          igoest(irng) = nuni}
\DoxyCodeLine{504 \textcolor{comment}{!}}
\DoxyCodeLine{505 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{506 \textcolor{comment}{!}}
\DoxyCodeLine{507       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{508 \textcolor{comment}{!}}

\end{DoxyCode}


The documentation for this interface was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/home/urbanjs/venus/\+V600/github/orderpack/src/\mbox{\hyperlink{M__uniinv_8f90}{M\+\_\+uniinv.\+f90}}\end{DoxyCompactItemize}
