\hypertarget{namespacem__mrgrnk}{}\doxysection{m\+\_\+mrgrnk Module Reference}
\label{namespacem__mrgrnk}\index{m\_mrgrnk@{m\_mrgrnk}}
\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface \mbox{\hyperlink{interfacem__mrgrnk_1_1mrgrnk}{mrgrnk}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacem__mrgrnk_a17af6a91e6d51d637895ad20238cc74d}{real64\+\_\+mrgrnk}} (X\+D\+O\+NT, I\+R\+N\+GT)
\item 
subroutine \mbox{\hyperlink{namespacem__mrgrnk_a15d27291ce0974973101340781c34b66}{real32\+\_\+mrgrnk}} (X\+D\+O\+NT, I\+R\+N\+GT)
\item 
subroutine \mbox{\hyperlink{namespacem__mrgrnk_a663a1d821c1294eb012543c6364ad929}{int32\+\_\+mrgrnk}} (X\+D\+O\+NT, I\+R\+N\+GT)
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacem__mrgrnk_a663a1d821c1294eb012543c6364ad929}\label{namespacem__mrgrnk_a663a1d821c1294eb012543c6364ad929}} 
\index{m\_mrgrnk@{m\_mrgrnk}!int32\_mrgrnk@{int32\_mrgrnk}}
\index{int32\_mrgrnk@{int32\_mrgrnk}!m\_mrgrnk@{m\_mrgrnk}}
\doxysubsubsection{\texorpdfstring{int32\_mrgrnk()}{int32\_mrgrnk()}}
{\footnotesize\ttfamily subroutine m\+\_\+mrgrnk\+::int32\+\_\+mrgrnk (\begin{DoxyParamCaption}\item[{integer (kind=int32), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, dimension (\+:), intent(out)}]{I\+R\+N\+GT }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{490 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{491       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDONT}
\DoxyCodeLine{492       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IRNGT}
\DoxyCodeLine{493 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{494       \textcolor{keywordtype}{Integer (kind=int32)} :: XVALA, XVALB}
\DoxyCodeLine{495 \textcolor{comment}{!}}
\DoxyCodeLine{496       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IRNGT))} :: JWRKT}
\DoxyCodeLine{497       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG1, IRNG2}
\DoxyCodeLine{498       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{499 \textcolor{comment}{!}}
\DoxyCodeLine{500       nval = min(\textcolor{keyword}{SIZE}(xdont), \textcolor{keyword}{SIZE}(irngt))}
\DoxyCodeLine{501       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{502       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{503          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{504       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{505          irngt(1) = 1}
\DoxyCodeLine{506          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{507 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{508          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{509 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{510 \textcolor{comment}{!}}
\DoxyCodeLine{511 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{512 \textcolor{comment}{!}}
\DoxyCodeLine{513       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{514          \textcolor{keywordflow}{If} (xdont(iind-\/1) <= xdont(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{515             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{516             irngt(iind) = iind}
\DoxyCodeLine{517          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{518             irngt(iind-\/1) = iind}
\DoxyCodeLine{519             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{520 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{521 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{522       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{523          irngt(nval) = nval}
\DoxyCodeLine{524 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{525 \textcolor{comment}{!}}
\DoxyCodeLine{526 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{527 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{528 \textcolor{comment}{!}}
\DoxyCodeLine{529       lmtna = 2}
\DoxyCodeLine{530       lmtnc = 4}
\DoxyCodeLine{531 \textcolor{comment}{!}}
\DoxyCodeLine{532 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{533 \textcolor{comment}{!}}
\DoxyCodeLine{534       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{535          \textcolor{keywordflow}{If} (nval <= 2) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{536 \textcolor{comment}{!}}
\DoxyCodeLine{537 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{538 \textcolor{comment}{!}}
\DoxyCodeLine{539          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{540             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{541                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{542 \textcolor{comment}{!}}
\DoxyCodeLine{543 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{544 \textcolor{comment}{!}}
\DoxyCodeLine{545                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{546 \textcolor{comment}{!}}
\DoxyCodeLine{547 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{548 \textcolor{comment}{!}}
\DoxyCodeLine{549                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{550                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{551                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{552                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{553 \textcolor{comment}{!}}
\DoxyCodeLine{554 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{555 \textcolor{comment}{!}}
\DoxyCodeLine{556                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{557                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{558                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{559                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{560                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{561 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{562                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{563 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{564 \textcolor{comment}{!}}
\DoxyCodeLine{565 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{566 \textcolor{comment}{!}}
\DoxyCodeLine{567             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{568 \textcolor{comment}{!}}
\DoxyCodeLine{569 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{570 \textcolor{comment}{!}}
\DoxyCodeLine{571             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{572                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{573                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{574                \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{575 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{576                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{577                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{578 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{579                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{580                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{581 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{582 \textcolor{comment}{!}}
\DoxyCodeLine{583 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{584 \textcolor{comment}{!}}
\DoxyCodeLine{585             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{586                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{587                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{588                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{589                \textcolor{keywordflow}{If} (xdont(irng1) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{590                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{591                   \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{592 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{593                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{594                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{595 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{596                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{597                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{598 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{599                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{600 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{601                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{602                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{603                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{604 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{605 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{606 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{607 \textcolor{comment}{!}}
\DoxyCodeLine{608 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{609 \textcolor{comment}{!}}
\DoxyCodeLine{610          lmtna = 4}
\DoxyCodeLine{611          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{612 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{613 \textcolor{comment}{!}}
\DoxyCodeLine{614 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{615 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{616 \textcolor{comment}{!}}
\DoxyCodeLine{617       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{618          \textcolor{keywordflow}{If} (lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{619          iwrkf = 0}
\DoxyCodeLine{620          lmtnc = 2 * lmtnc}
\DoxyCodeLine{621 \textcolor{comment}{!}}
\DoxyCodeLine{622 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{623 \textcolor{comment}{!}}
\DoxyCodeLine{624          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{625             iwrk = iwrkf}
\DoxyCodeLine{626             iwrkd = iwrkf + 1}
\DoxyCodeLine{627             jinda = iwrkf + lmtna}
\DoxyCodeLine{628             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{629             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{630                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{631                iwrkf = nval}
\DoxyCodeLine{632 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{633             iinda = 1}
\DoxyCodeLine{634             iindb = jinda + 1}
\DoxyCodeLine{635 \textcolor{comment}{!}}
\DoxyCodeLine{636 \textcolor{comment}{!   Shortcut for the case when the max of A is smaller}}
\DoxyCodeLine{637 \textcolor{comment}{!   than the min of B. This line may be activated when the}}
\DoxyCodeLine{638 \textcolor{comment}{!   initial set is already close to sorted.}}
\DoxyCodeLine{639 \textcolor{comment}{!}}
\DoxyCodeLine{640 \textcolor{comment}{!          IF (XDONT(IRNGT(JINDA)) <= XDONT(IRNGT(IINDB))) CYCLE}}
\DoxyCodeLine{641 \textcolor{comment}{!}}
\DoxyCodeLine{642 \textcolor{comment}{!  One steps in the C subset, that we build in the final rank array}}
\DoxyCodeLine{643 \textcolor{comment}{!}}
\DoxyCodeLine{644 \textcolor{comment}{!  Make a copy of the rank array for the merge iteration}}
\DoxyCodeLine{645 \textcolor{comment}{!}}
\DoxyCodeLine{646             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{647 \textcolor{comment}{!}}
\DoxyCodeLine{648             xvala = xdont(jwrkt(iinda))}
\DoxyCodeLine{649             xvalb = xdont(irngt(iindb))}
\DoxyCodeLine{650 \textcolor{comment}{!}}
\DoxyCodeLine{651             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{652                iwrk = iwrk + 1}
\DoxyCodeLine{653 \textcolor{comment}{!}}
\DoxyCodeLine{654 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{655 \textcolor{comment}{!}}
\DoxyCodeLine{656                \textcolor{keywordflow}{If} (xvala > xvalb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{657                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{658                   iindb = iindb + 1}
\DoxyCodeLine{659                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{660 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{661                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{662                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{663 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{664                   xvalb = xdont(irngt(iindb))}
\DoxyCodeLine{665                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{666                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{667                   iinda = iinda + 1}
\DoxyCodeLine{668                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{669                   xvala = xdont(jwrkt(iinda))}
\DoxyCodeLine{670 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{671 \textcolor{comment}{!}}
\DoxyCodeLine{672 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{673 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{674 \textcolor{comment}{!}}
\DoxyCodeLine{675 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{676 \textcolor{comment}{!}}
\DoxyCodeLine{677          lmtna = 2 * lmtna}
\DoxyCodeLine{678 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{679 \textcolor{comment}{!}}
\DoxyCodeLine{680       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{681 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__mrgrnk_a15d27291ce0974973101340781c34b66}\label{namespacem__mrgrnk_a15d27291ce0974973101340781c34b66}} 
\index{m\_mrgrnk@{m\_mrgrnk}!real32\_mrgrnk@{real32\_mrgrnk}}
\index{real32\_mrgrnk@{real32\_mrgrnk}!m\_mrgrnk@{m\_mrgrnk}}
\doxysubsubsection{\texorpdfstring{real32\_mrgrnk()}{real32\_mrgrnk()}}
{\footnotesize\ttfamily subroutine m\+\_\+mrgrnk\+::real32\+\_\+mrgrnk (\begin{DoxyParamCaption}\item[{real (kind=real32), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, dimension (\+:), intent(out)}]{I\+R\+N\+GT }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{296 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{297 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{298       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IRNGT}
\DoxyCodeLine{299 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{300 \textcolor{keywordtype}{      Real} (kind=real32) :: xvala, xvalb}
\DoxyCodeLine{301 \textcolor{comment}{!}}
\DoxyCodeLine{302       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IRNGT))} :: JWRKT}
\DoxyCodeLine{303       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG1, IRNG2}
\DoxyCodeLine{304       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{305 \textcolor{comment}{!}}
\DoxyCodeLine{306       nval = min(\textcolor{keyword}{SIZE}(xdont), \textcolor{keyword}{SIZE}(irngt))}
\DoxyCodeLine{307       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{308       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{309          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{310       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{311          irngt(1) = 1}
\DoxyCodeLine{312          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{313 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{314          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{315 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{316 \textcolor{comment}{!}}
\DoxyCodeLine{317 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{318 \textcolor{comment}{!}}
\DoxyCodeLine{319       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{320          \textcolor{keywordflow}{If} (xdont(iind-\/1) <= xdont(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{321             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{322             irngt(iind) = iind}
\DoxyCodeLine{323          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{324             irngt(iind-\/1) = iind}
\DoxyCodeLine{325             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{326 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{327 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{328       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{329          irngt(nval) = nval}
\DoxyCodeLine{330 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{331 \textcolor{comment}{!}}
\DoxyCodeLine{332 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{333 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{334 \textcolor{comment}{!}}
\DoxyCodeLine{335       lmtna = 2}
\DoxyCodeLine{336       lmtnc = 4}
\DoxyCodeLine{337 \textcolor{comment}{!}}
\DoxyCodeLine{338 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{339 \textcolor{comment}{!}}
\DoxyCodeLine{340       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{341          \textcolor{keywordflow}{If} (nval <= 2) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{342 \textcolor{comment}{!}}
\DoxyCodeLine{343 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{344 \textcolor{comment}{!}}
\DoxyCodeLine{345          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{346             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{347                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{348 \textcolor{comment}{!}}
\DoxyCodeLine{349 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{350 \textcolor{comment}{!}}
\DoxyCodeLine{351                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{352 \textcolor{comment}{!}}
\DoxyCodeLine{353 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{354 \textcolor{comment}{!}}
\DoxyCodeLine{355                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{356                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{357                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{358                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{359 \textcolor{comment}{!}}
\DoxyCodeLine{360 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{361 \textcolor{comment}{!}}
\DoxyCodeLine{362                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{363                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{364                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{365                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{366                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{367 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{368                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{369 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{370 \textcolor{comment}{!}}
\DoxyCodeLine{371 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{372 \textcolor{comment}{!}}
\DoxyCodeLine{373             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{374 \textcolor{comment}{!}}
\DoxyCodeLine{375 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{376 \textcolor{comment}{!}}
\DoxyCodeLine{377             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{378                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{379                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{380                \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{381 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{382                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{383                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{384 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{385                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{386                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{387 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{388 \textcolor{comment}{!}}
\DoxyCodeLine{389 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{390 \textcolor{comment}{!}}
\DoxyCodeLine{391             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{392                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{393                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{394                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{395                \textcolor{keywordflow}{If} (xdont(irng1) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{396                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{397                   \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{398 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{399                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{400                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{401 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{402                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{403                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{404 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{405                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{406 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{407                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{408                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{409                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{410 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{411 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{412 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{413 \textcolor{comment}{!}}
\DoxyCodeLine{414 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{415 \textcolor{comment}{!}}
\DoxyCodeLine{416          lmtna = 4}
\DoxyCodeLine{417          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{418 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{419 \textcolor{comment}{!}}
\DoxyCodeLine{420 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{421 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{422 \textcolor{comment}{!}}
\DoxyCodeLine{423       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{424          \textcolor{keywordflow}{If} (lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{425          iwrkf = 0}
\DoxyCodeLine{426          lmtnc = 2 * lmtnc}
\DoxyCodeLine{427 \textcolor{comment}{!}}
\DoxyCodeLine{428 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{429 \textcolor{comment}{!}}
\DoxyCodeLine{430          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{431             iwrk = iwrkf}
\DoxyCodeLine{432             iwrkd = iwrkf + 1}
\DoxyCodeLine{433             jinda = iwrkf + lmtna}
\DoxyCodeLine{434             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{435             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{436                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{437                iwrkf = nval}
\DoxyCodeLine{438 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{439             iinda = 1}
\DoxyCodeLine{440             iindb = jinda + 1}
\DoxyCodeLine{441 \textcolor{comment}{!}}
\DoxyCodeLine{442 \textcolor{comment}{!   Shortcut for the case when the max of A is smaller}}
\DoxyCodeLine{443 \textcolor{comment}{!   than the min of B. This line may be activated when the}}
\DoxyCodeLine{444 \textcolor{comment}{!   initial set is already close to sorted.}}
\DoxyCodeLine{445 \textcolor{comment}{!}}
\DoxyCodeLine{446 \textcolor{comment}{!          IF (XDONT(IRNGT(JINDA)) <= XDONT(IRNGT(IINDB))) CYCLE}}
\DoxyCodeLine{447 \textcolor{comment}{!}}
\DoxyCodeLine{448 \textcolor{comment}{!  One steps in the C subset, that we build in the final rank array}}
\DoxyCodeLine{449 \textcolor{comment}{!}}
\DoxyCodeLine{450 \textcolor{comment}{!  Make a copy of the rank array for the merge iteration}}
\DoxyCodeLine{451 \textcolor{comment}{!}}
\DoxyCodeLine{452             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{453 \textcolor{comment}{!}}
\DoxyCodeLine{454             xvala = xdont(jwrkt(iinda))}
\DoxyCodeLine{455             xvalb = xdont(irngt(iindb))}
\DoxyCodeLine{456 \textcolor{comment}{!}}
\DoxyCodeLine{457             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{458                iwrk = iwrk + 1}
\DoxyCodeLine{459 \textcolor{comment}{!}}
\DoxyCodeLine{460 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{461 \textcolor{comment}{!}}
\DoxyCodeLine{462                \textcolor{keywordflow}{If} (xvala > xvalb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{463                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{464                   iindb = iindb + 1}
\DoxyCodeLine{465                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{466 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{467                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{468                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{469 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{470                   xvalb = xdont(irngt(iindb))}
\DoxyCodeLine{471                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{472                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{473                   iinda = iinda + 1}
\DoxyCodeLine{474                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{475                   xvala = xdont(jwrkt(iinda))}
\DoxyCodeLine{476 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{477 \textcolor{comment}{!}}
\DoxyCodeLine{478 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{479 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{480 \textcolor{comment}{!}}
\DoxyCodeLine{481 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{482 \textcolor{comment}{!}}
\DoxyCodeLine{483          lmtna = 2 * lmtna}
\DoxyCodeLine{484 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{485 \textcolor{comment}{!}}
\DoxyCodeLine{486       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{487 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__mrgrnk_a17af6a91e6d51d637895ad20238cc74d}\label{namespacem__mrgrnk_a17af6a91e6d51d637895ad20238cc74d}} 
\index{m\_mrgrnk@{m\_mrgrnk}!real64\_mrgrnk@{real64\_mrgrnk}}
\index{real64\_mrgrnk@{real64\_mrgrnk}!m\_mrgrnk@{m\_mrgrnk}}
\doxysubsubsection{\texorpdfstring{real64\_mrgrnk()}{real64\_mrgrnk()}}
{\footnotesize\ttfamily subroutine m\+\_\+mrgrnk\+::real64\+\_\+mrgrnk (\begin{DoxyParamCaption}\item[{real (kind=real64), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, dimension (\+:), intent(out)}]{I\+R\+N\+GT }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\hypertarget{namespacem__mrgrnk_autotoc_md60}{}\doxysubsubsection{N\+A\+ME}\label{namespacem__mrgrnk_autotoc_md60}
mrgrnk(3f) -\/ \mbox{[}orderpack\+:R\+A\+NK\mbox{]} ranks an array using a merge-\/sort algorithm (L\+I\+C\+E\+N\+SE\+:C\+C0-\/1.\+0)\hypertarget{namespacem__mrgrnk_autotoc_md61}{}\doxysubsubsection{S\+Y\+N\+O\+P\+S\+IS}\label{namespacem__mrgrnk_autotoc_md61}
\begin{DoxyVerb} Subroutine ${KIND}_mrgrnk (XDONT, IRNGT)

   ${TYPE} (kind=${KIND}), Dimension (:), Intent (In) :: XDONT
   Integer, Dimension (:), Intent (Out) :: IRNGT

Where ${TYPE}(kind=${KIND}) may be

   o Real(kind=real32)
   o Real(kind=real64)
   o Integer(kind=int32)
\end{DoxyVerb}
\hypertarget{namespacem__mrgrnk_autotoc_md62}{}\doxysubsubsection{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}\label{namespacem__mrgrnk_autotoc_md62}
M\+R\+G\+R\+NK produces a Merge-\/sort ranking of an array.

For performance reasons, the first 2 passes are taken out of the standard loop, and use dedicated coding.\hypertarget{namespacem__mrgrnk_autotoc_md63}{}\doxysubsubsection{O\+P\+T\+I\+O\+NS}\label{namespacem__mrgrnk_autotoc_md63}
X\+D\+O\+NT The array to sort I\+R\+N\+GT The rank index returned\hypertarget{namespacem__mrgrnk_autotoc_md64}{}\doxysubsubsection{E\+X\+A\+M\+P\+L\+ES}\label{namespacem__mrgrnk_autotoc_md64}
Sample program\+:

program demo\+\_\+mrgrnk use M\+\_\+mrgrnk, only \+: mrgrnk implicit none character(len=$\ast$),parameter \+:: g=\textquotesingle{}($\ast$(g0,1x))\textquotesingle{} integer,parameter \+:: dp=kind(0.\+0d0) integer,parameter \+:: isz=1000000 real(kind=dp) \+:: dd(isz) real(kind=dp) \+:: pp integer \+:: indx(isz) integer \+:: i,j,k ! make some random numbers call random\+\_\+seed() call random\+\_\+number(dd) dd=dd-\/0.\+50\+\_\+dp k=int(log(huge(0.\+0\+\_\+dp))/log(2.\+0\+\_\+dp))-\/1 do i=1,isz call random\+\_\+number(pp) j=floor((k+1)$\ast$pp) dd(i)=dd(i)$\ast$(2.\+0\+\_\+dp$\ast$$\ast$j) enddo ! rank data call mrgrnk(dd,indx) ! check order do i=1,isz-\/1 if(dd(indx(i)).gt.\+dd(indx(i+1)))then write($\ast$,g)\textquotesingle{}E\+R\+R\+OR\+: data not sorted i=\textquotesingle{},i,\textquotesingle{}index=\textquotesingle{},indx(i), \& \& \textquotesingle{}values \textquotesingle{},dd(indx(i)),dd(indx(i+1)) stop 1 endif enddo ! sort data using rank values dd=dd(indx) write($\ast$,g)\textquotesingle{}sorted \textquotesingle{},isz,\textquotesingle{}values\textquotesingle{} write($\ast$,g)\textquotesingle{}from\textquotesingle{},dd(1),\textquotesingle{}to\textquotesingle{},dd(isz) write($\ast$,$\ast$)minval(dd).eq.\+dd(1) write($\ast$,$\ast$)maxval(dd).eq.\+dd(isz) write($\ast$,$\ast$)minloc(dd).eq.\+1 write($\ast$,$\ast$)maxloc(dd).eq.\+isz end program demo\+\_\+mrgrnk

Results\+:

$>$ sorted 1000000 values $>$ from -\/0.\+44921023328051548E+308 to 0.\+44715236470073772E+308 $>$ T $>$ T $>$ T $>$ T\hypertarget{namespacem__mrgrnk_autotoc_md65}{}\doxysubsubsection{A\+U\+T\+H\+OR}\label{namespacem__mrgrnk_autotoc_md65}
Michel Olagnon, 2000-\/2012

John Urban, 2022.\+04.\+16 o added man-\/page and reduced to a template using the prep(1) preprocessor.\hypertarget{namespacem__mrgrnk_autotoc_md66}{}\doxysubsubsection{L\+I\+C\+E\+N\+SE}\label{namespacem__mrgrnk_autotoc_md66}
C\+C0-\/1.\+0 
\begin{DoxyCode}{0}
\DoxyCodeLine{102 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{103 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{104       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IRNGT}
\DoxyCodeLine{105 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{106 \textcolor{keywordtype}{      Real} (kind=real64) :: xvala, xvalb}
\DoxyCodeLine{107 \textcolor{comment}{!}}
\DoxyCodeLine{108       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IRNGT))} :: JWRKT}
\DoxyCodeLine{109       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG1, IRNG2}
\DoxyCodeLine{110       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{111 \textcolor{comment}{!}}
\DoxyCodeLine{112       nval = min(\textcolor{keyword}{SIZE}(xdont), \textcolor{keyword}{SIZE}(irngt))}
\DoxyCodeLine{113       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{114       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{115          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{116       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{117          irngt(1) = 1}
\DoxyCodeLine{118          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{119 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{120          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{121 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{122 \textcolor{comment}{!}}
\DoxyCodeLine{123 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{124 \textcolor{comment}{!}}
\DoxyCodeLine{125       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{126          \textcolor{keywordflow}{If} (xdont(iind-\/1) <= xdont(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{127             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{128             irngt(iind) = iind}
\DoxyCodeLine{129          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{130             irngt(iind-\/1) = iind}
\DoxyCodeLine{131             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{132 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{133 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{134       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{135          irngt(nval) = nval}
\DoxyCodeLine{136 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{137 \textcolor{comment}{!}}
\DoxyCodeLine{138 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{139 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{140 \textcolor{comment}{!}}
\DoxyCodeLine{141       lmtna = 2}
\DoxyCodeLine{142       lmtnc = 4}
\DoxyCodeLine{143 \textcolor{comment}{!}}
\DoxyCodeLine{144 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{145 \textcolor{comment}{!}}
\DoxyCodeLine{146       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{147          \textcolor{keywordflow}{If} (nval <= 2) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{148 \textcolor{comment}{!}}
\DoxyCodeLine{149 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{150 \textcolor{comment}{!}}
\DoxyCodeLine{151          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{152             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{153                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{154 \textcolor{comment}{!}}
\DoxyCodeLine{155 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{156 \textcolor{comment}{!}}
\DoxyCodeLine{157                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{158 \textcolor{comment}{!}}
\DoxyCodeLine{159 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{160 \textcolor{comment}{!}}
\DoxyCodeLine{161                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{162                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{163                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{164                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{165 \textcolor{comment}{!}}
\DoxyCodeLine{166 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{167 \textcolor{comment}{!}}
\DoxyCodeLine{168                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{169                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{170                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{171                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{172                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{173 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{174                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{175 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{176 \textcolor{comment}{!}}
\DoxyCodeLine{177 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{178 \textcolor{comment}{!}}
\DoxyCodeLine{179             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{180 \textcolor{comment}{!}}
\DoxyCodeLine{181 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{182 \textcolor{comment}{!}}
\DoxyCodeLine{183             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{184                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{185                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{186                \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{187 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{188                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{189                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{190 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{191                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{192                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{193 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{194 \textcolor{comment}{!}}
\DoxyCodeLine{195 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{196 \textcolor{comment}{!}}
\DoxyCodeLine{197             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{198                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{199                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{200                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{201                \textcolor{keywordflow}{If} (xdont(irng1) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{202                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{203                   \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{204 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{205                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{206                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{207 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{208                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{209                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{210 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{211                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{212 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{213                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{214                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{215                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{216 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{217 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{218 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{219 \textcolor{comment}{!}}
\DoxyCodeLine{220 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{221 \textcolor{comment}{!}}
\DoxyCodeLine{222          lmtna = 4}
\DoxyCodeLine{223          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{224 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{225 \textcolor{comment}{!}}
\DoxyCodeLine{226 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{227 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{228 \textcolor{comment}{!}}
\DoxyCodeLine{229       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{230          \textcolor{keywordflow}{If} (lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{231          iwrkf = 0}
\DoxyCodeLine{232          lmtnc = 2 * lmtnc}
\DoxyCodeLine{233 \textcolor{comment}{!}}
\DoxyCodeLine{234 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{235 \textcolor{comment}{!}}
\DoxyCodeLine{236          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{237             iwrk = iwrkf}
\DoxyCodeLine{238             iwrkd = iwrkf + 1}
\DoxyCodeLine{239             jinda = iwrkf + lmtna}
\DoxyCodeLine{240             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{241             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{242                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{243                iwrkf = nval}
\DoxyCodeLine{244 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{245             iinda = 1}
\DoxyCodeLine{246             iindb = jinda + 1}
\DoxyCodeLine{247 \textcolor{comment}{!}}
\DoxyCodeLine{248 \textcolor{comment}{!   Shortcut for the case when the max of A is smaller}}
\DoxyCodeLine{249 \textcolor{comment}{!   than the min of B. This line may be activated when the}}
\DoxyCodeLine{250 \textcolor{comment}{!   initial set is already close to sorted.}}
\DoxyCodeLine{251 \textcolor{comment}{!}}
\DoxyCodeLine{252 \textcolor{comment}{!          IF (XDONT(IRNGT(JINDA)) <= XDONT(IRNGT(IINDB))) CYCLE}}
\DoxyCodeLine{253 \textcolor{comment}{!}}
\DoxyCodeLine{254 \textcolor{comment}{!  One steps in the C subset, that we build in the final rank array}}
\DoxyCodeLine{255 \textcolor{comment}{!}}
\DoxyCodeLine{256 \textcolor{comment}{!  Make a copy of the rank array for the merge iteration}}
\DoxyCodeLine{257 \textcolor{comment}{!}}
\DoxyCodeLine{258             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{259 \textcolor{comment}{!}}
\DoxyCodeLine{260             xvala = xdont(jwrkt(iinda))}
\DoxyCodeLine{261             xvalb = xdont(irngt(iindb))}
\DoxyCodeLine{262 \textcolor{comment}{!}}
\DoxyCodeLine{263             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{264                iwrk = iwrk + 1}
\DoxyCodeLine{265 \textcolor{comment}{!}}
\DoxyCodeLine{266 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{267 \textcolor{comment}{!}}
\DoxyCodeLine{268                \textcolor{keywordflow}{If} (xvala > xvalb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{269                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{270                   iindb = iindb + 1}
\DoxyCodeLine{271                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{272 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{273                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{274                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{275 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{276                   xvalb = xdont(irngt(iindb))}
\DoxyCodeLine{277                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{278                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{279                   iinda = iinda + 1}
\DoxyCodeLine{280                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{281                   xvala = xdont(jwrkt(iinda))}
\DoxyCodeLine{282 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{283 \textcolor{comment}{!}}
\DoxyCodeLine{284 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{285 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{286 \textcolor{comment}{!}}
\DoxyCodeLine{287 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{288 \textcolor{comment}{!}}
\DoxyCodeLine{289          lmtna = 2 * lmtna}
\DoxyCodeLine{290 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{291 \textcolor{comment}{!}}
\DoxyCodeLine{292       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{293 \textcolor{comment}{!}}

\end{DoxyCode}
