\hypertarget{namespacem__orderpack____unipar}{}\doxysection{m\+\_\+orderpack\+\_\+\+\_\+unipar Module Reference}
\label{namespacem__orderpack____unipar}\index{m\_orderpack\_\_unipar@{m\_orderpack\_\_unipar}}
\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface \mbox{\hyperlink{interfacem__orderpack____unipar_1_1unipar}{unipar}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacem__orderpack____unipar_ac911b16c612f75c4fa8dac25a4e50318}{real64\+\_\+unipar}} (I\+N\+V\+A\+LS, I\+R\+N\+GT, N\+O\+RD)
\item 
subroutine \mbox{\hyperlink{namespacem__orderpack____unipar_afe2840f6c55b9cfe51f672d3f05f555c}{real32\+\_\+unipar}} (I\+N\+V\+A\+LS, I\+R\+N\+GT, N\+O\+RD)
\item 
subroutine \mbox{\hyperlink{namespacem__orderpack____unipar_a24bf30b2866813810a58f5e33dbfddf3}{int16\+\_\+unipar}} (I\+N\+V\+A\+LS, I\+R\+N\+GT, N\+O\+RD)
\item 
subroutine \mbox{\hyperlink{namespacem__orderpack____unipar_ad71165c2ac66bdd3df2bf43abe6973c4}{int32\+\_\+unipar}} (I\+N\+V\+A\+LS, I\+R\+N\+GT, N\+O\+RD)
\item 
subroutine \mbox{\hyperlink{namespacem__orderpack____unipar_ab8b2a825259781eb3dc0c3804316404f}{int64\+\_\+unipar}} (I\+N\+V\+A\+LS, I\+R\+N\+GT, N\+O\+RD)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
integer, parameter \mbox{\hyperlink{namespacem__orderpack____unipar_a192ff7cf342557a2f2c76667c999ce21}{f\+\_\+char}} =selected\+\_\+char\+\_\+kind(\char`\"{}D\+E\+F\+A\+U\+LT\char`\"{})
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacem__orderpack____unipar_a24bf30b2866813810a58f5e33dbfddf3}\label{namespacem__orderpack____unipar_a24bf30b2866813810a58f5e33dbfddf3}} 
\index{m\_orderpack\_\_unipar@{m\_orderpack\_\_unipar}!int16\_unipar@{int16\_unipar}}
\index{int16\_unipar@{int16\_unipar}!m\_orderpack\_\_unipar@{m\_orderpack\_\_unipar}}
\doxysubsubsection{\texorpdfstring{int16\_unipar()}{int16\_unipar()}}
{\footnotesize\ttfamily subroutine m\+\_\+orderpack\+\_\+\+\_\+unipar\+::int16\+\_\+unipar (\begin{DoxyParamCaption}\item[{integer (kind=int16), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, dimension (\+:), intent(out)}]{I\+R\+N\+GT,  }\item[{integer, intent(inout)}]{N\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{1286 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1287    \textcolor{keywordtype}{Integer (kind=int16)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: INVALS}
\DoxyCodeLine{1288    \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IRNGT}
\DoxyCodeLine{1289    \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (InOut)} :: NORD}
\DoxyCodeLine{1290 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1291    \textcolor{keywordtype}{Integer (kind=int16)} :: XPIV, XWRK, XWRK1, XMIN, XMAX, XPIV0}
\DoxyCodeLine{1292 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1293    \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(INVALS))} :: ILOWT, IHIGT}
\DoxyCodeLine{1294    \textcolor{keywordtype}{Integer} :: NDON, JHIG, JLOW, IHIG, IWRK, IWRK1, IWRK2, IWRK3}
\DoxyCodeLine{1295    \textcolor{keywordtype}{Integer} :: IDEB, JDEB, IMIL, IFIN, NWRK, ICRS, IDCR, ILOW}
\DoxyCodeLine{1296    \textcolor{keywordtype}{Integer} :: JLM2, JLM1, JHM2, JHM1}
\DoxyCodeLine{1297 \textcolor{comment}{!}}
\DoxyCodeLine{1298       ndon = \textcolor{keyword}{SIZE} (invals)}
\DoxyCodeLine{1299 \textcolor{comment}{!}}
\DoxyCodeLine{1300 \textcolor{comment}{!    First loop is used to fill-\/in ILOWT, IHIGT at the same time}}
\DoxyCodeLine{1301 \textcolor{comment}{!}}
\DoxyCodeLine{1302       \textcolor{keywordflow}{If} (ndon < 2) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1303          \textcolor{keywordflow}{If} (nord >= 1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1304             nord = 1}
\DoxyCodeLine{1305             irngt(1) = 1}
\DoxyCodeLine{1306 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1307          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1308 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1309 \textcolor{comment}{!}}
\DoxyCodeLine{1310 \textcolor{comment}{!  One chooses a pivot, best estimate possible to put fractile near}}
\DoxyCodeLine{1311 \textcolor{comment}{!  mid-\/point of the set of low values.}}
\DoxyCodeLine{1312 \textcolor{comment}{!}}
\DoxyCodeLine{1313      ihigt=1}
\DoxyCodeLine{1314      ilowt=1}
\DoxyCodeLine{1315 }
\DoxyCodeLine{1316      \textcolor{keywordflow}{Do} icrs = 2, ndon}
\DoxyCodeLine{1317         \textcolor{keywordflow}{If} (invals(icrs) == invals(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1318           cycle}
\DoxyCodeLine{1319         \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (invals(icrs) < invals(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1320            ilowt(1) = icrs}
\DoxyCodeLine{1321            ihigt(1) = 1}
\DoxyCodeLine{1322         \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1323            ilowt(1) = 1}
\DoxyCodeLine{1324            ihigt(1) = icrs}
\DoxyCodeLine{1325 \textcolor{keywordflow}{        End If}}
\DoxyCodeLine{1326         \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1327 \textcolor{keywordflow}{     End Do}}
\DoxyCodeLine{1328 \textcolor{comment}{!}}
\DoxyCodeLine{1329       \textcolor{keywordflow}{If} (ndon <= icrs) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1330          nord = min(nord, 2)}
\DoxyCodeLine{1331          \textcolor{keywordflow}{If} (nord >= 1) irngt(1) = ilowt(1)}
\DoxyCodeLine{1332          \textcolor{keywordflow}{If} (nord >= 2) irngt(2) = ihigt(1)}
\DoxyCodeLine{1333          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1334 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1335 \textcolor{comment}{!}}
\DoxyCodeLine{1336       icrs = icrs + 1}
\DoxyCodeLine{1337       jhig = 1}
\DoxyCodeLine{1338       \textcolor{keywordflow}{If} (invals(icrs) < invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1339          \textcolor{keywordflow}{If} (invals(icrs) < invals(ilowt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1340             jhig = jhig + 1}
\DoxyCodeLine{1341             ihigt(jhig) = ihigt(1)}
\DoxyCodeLine{1342             ihigt(1) = ilowt(1)}
\DoxyCodeLine{1343             ilowt(1) = icrs}
\DoxyCodeLine{1344          \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (invals(icrs) > invals(ilowt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1345             jhig = jhig + 1}
\DoxyCodeLine{1346             ihigt(jhig) = ihigt(1)}
\DoxyCodeLine{1347             ihigt(1) = icrs}
\DoxyCodeLine{1348 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1349       \textcolor{keywordflow}{ElseIf} (invals(icrs) > invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1350          jhig = jhig + 1}
\DoxyCodeLine{1351          ihigt(jhig) = icrs}
\DoxyCodeLine{1352 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1353 \textcolor{comment}{!}}
\DoxyCodeLine{1354       \textcolor{keywordflow}{If} (ndon <= icrs) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1355          nord = min(nord, jhig+1)}
\DoxyCodeLine{1356          \textcolor{keywordflow}{If} (nord >= 1) irngt(1) = ilowt(1)}
\DoxyCodeLine{1357          \textcolor{keywordflow}{If} (nord >= 2) irngt(2) = ihigt(1)}
\DoxyCodeLine{1358          \textcolor{keywordflow}{If} (nord >= 3) irngt(3) = ihigt(2)}
\DoxyCodeLine{1359          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1360 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1361 \textcolor{comment}{!}}
\DoxyCodeLine{1362       \textcolor{keywordflow}{If} (invals(ndon) < invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1363          \textcolor{keywordflow}{If} (invals(ndon) < invals(ilowt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1364             \textcolor{keywordflow}{Do} idcr = jhig, 1, -\/1}
\DoxyCodeLine{1365               ihigt(idcr+1) = ihigt(idcr)}
\DoxyCodeLine{1366 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1367             ihigt(1) = ilowt(1)}
\DoxyCodeLine{1368             ilowt(1) = ndon}
\DoxyCodeLine{1369             jhig = jhig + 1}
\DoxyCodeLine{1370          \textcolor{keywordflow}{ElseIf} (invals(ndon) > invals(ilowt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1371             \textcolor{keywordflow}{Do} idcr = jhig, 1, -\/1}
\DoxyCodeLine{1372               ihigt(idcr+1) = ihigt(idcr)}
\DoxyCodeLine{1373 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1374             ihigt(1) = ndon}
\DoxyCodeLine{1375             jhig = jhig + 1}
\DoxyCodeLine{1376 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1377       \textcolor{keywordflow}{ElseIf} (invals(ndon) > invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1378          jhig = jhig + 1}
\DoxyCodeLine{1379          ihigt(jhig) = ndon}
\DoxyCodeLine{1380 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1381 \textcolor{comment}{!}}
\DoxyCodeLine{1382       \textcolor{keywordflow}{If} (ndon <= icrs+1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1383          nord = min(nord, jhig+1)}
\DoxyCodeLine{1384          \textcolor{keywordflow}{If} (nord >= 1) irngt(1) = ilowt(1)}
\DoxyCodeLine{1385          \textcolor{keywordflow}{If} (nord >= 2) irngt(2) = ihigt(1)}
\DoxyCodeLine{1386          \textcolor{keywordflow}{If} (nord >= 3) irngt(3) = ihigt(2)}
\DoxyCodeLine{1387          \textcolor{keywordflow}{If} (nord >= 4) irngt(4) = ihigt(3)}
\DoxyCodeLine{1388          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1389 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1390 \textcolor{comment}{!}}
\DoxyCodeLine{1391       jdeb = 0}
\DoxyCodeLine{1392       ideb = jdeb + 1}
\DoxyCodeLine{1393       jlow = ideb}
\DoxyCodeLine{1394       xpiv = invals(ilowt(ideb)) + real(2*nord)/real(ndon+nord) * \&}
\DoxyCodeLine{1395                                    (invals(ihigt(3))-\/invals(ilowt(ideb)))}
\DoxyCodeLine{1396       \textcolor{keywordflow}{If} (xpiv >= invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1397          xpiv = invals(ilowt(ideb)) + real(2*nord)/real(ndon+nord) * \&}
\DoxyCodeLine{1398                                       (invals(ihigt(2))-\/invals(ilowt(ideb)))}
\DoxyCodeLine{1399          \textcolor{keywordflow}{If} (xpiv >= invals(ihigt(1))) \&}
\DoxyCodeLine{1400              xpiv = invals(ilowt(ideb)) + real(2*nord) / real(ndon+nord) * \&}
\DoxyCodeLine{1401                                           (invals(ihigt(1))-\/invals(ilowt(ideb)))}
\DoxyCodeLine{1402 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1403       xpiv0 = xpiv}
\DoxyCodeLine{1404 \textcolor{comment}{!}}
\DoxyCodeLine{1405 \textcolor{comment}{!  One puts values > pivot in the end and those <= pivot}}
\DoxyCodeLine{1406 \textcolor{comment}{!  at the beginning. This is split in 2 cases, so that}}
\DoxyCodeLine{1407 \textcolor{comment}{!  we can skip the loop test a number of times.}}
\DoxyCodeLine{1408 \textcolor{comment}{!  As we are also filling in the work arrays at the same time}}
\DoxyCodeLine{1409 \textcolor{comment}{!  we stop filling in the IHIGT array as soon as we have more}}
\DoxyCodeLine{1410 \textcolor{comment}{!  than enough values in ILOWT, i.e. one more than}}
\DoxyCodeLine{1411 \textcolor{comment}{!  strictly necessary so as to be able to come out of the}}
\DoxyCodeLine{1412 \textcolor{comment}{!  case where JLOWT would be NORD distinct values followed}}
\DoxyCodeLine{1413 \textcolor{comment}{!  by values that are exclusively duplicates of these.}}
\DoxyCodeLine{1414 \textcolor{comment}{!}}
\DoxyCodeLine{1415 \textcolor{comment}{!}}
\DoxyCodeLine{1416       \textcolor{keywordflow}{If} (invals(ndon) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1417          lowloop1: \textcolor{keywordflow}{Do}}
\DoxyCodeLine{1418             icrs = icrs + 1}
\DoxyCodeLine{1419             \textcolor{keywordflow}{If} (invals(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1420                \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1421                jhig = jhig + 1}
\DoxyCodeLine{1422                ihigt(jhig) = icrs}
\DoxyCodeLine{1423             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1424                \textcolor{keywordflow}{Do} ilow = 1, jlow}
\DoxyCodeLine{1425                  \textcolor{keywordflow}{If} (invals(icrs) == invals(ilowt(ilow))) cycle lowloop1}
\DoxyCodeLine{1426 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1427                jlow = jlow + 1}
\DoxyCodeLine{1428                ilowt(jlow) = icrs}
\DoxyCodeLine{1429                \textcolor{keywordflow}{If} (jlow >= nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1430 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1431 \textcolor{keywordflow}{         End Do} lowloop1}
\DoxyCodeLine{1432 \textcolor{comment}{!}}
\DoxyCodeLine{1433 \textcolor{comment}{!  One restricts further processing because it is no use}}
\DoxyCodeLine{1434 \textcolor{comment}{!  to store more high values}}
\DoxyCodeLine{1435 \textcolor{comment}{!}}
\DoxyCodeLine{1436          \textcolor{keywordflow}{If} (icrs < ndon-\/1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1437             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{1438                icrs = icrs + 1}
\DoxyCodeLine{1439                \textcolor{keywordflow}{If} (invals(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1440                   jlow = jlow + 1}
\DoxyCodeLine{1441                   ilowt(jlow) = icrs}
\DoxyCodeLine{1442                \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1443                   \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1444 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1445 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1446 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1447 \textcolor{comment}{!}}
\DoxyCodeLine{1448 \textcolor{comment}{!}}
\DoxyCodeLine{1449       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1450 \textcolor{comment}{!}}
\DoxyCodeLine{1451 \textcolor{comment}{!  Same as above, but this is not as easy to optimize, so the}}
\DoxyCodeLine{1452 \textcolor{comment}{!  DO-\/loop is kept}}
\DoxyCodeLine{1453 \textcolor{comment}{!}}
\DoxyCodeLine{1454          lowloop2: \textcolor{keywordflow}{Do} icrs = icrs + 1, ndon -\/ 1}
\DoxyCodeLine{1455             \textcolor{keywordflow}{If} (invals(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1456                jhig = jhig + 1}
\DoxyCodeLine{1457                ihigt(jhig) = icrs}
\DoxyCodeLine{1458             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1459                \textcolor{keywordflow}{Do} ilow = 1, jlow}
\DoxyCodeLine{1460                  \textcolor{keywordflow}{If} (invals(icrs) == invals(ilowt(ilow))) cycle lowloop2}
\DoxyCodeLine{1461 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1462                jlow = jlow + 1}
\DoxyCodeLine{1463                ilowt(jlow) = icrs}
\DoxyCodeLine{1464                \textcolor{keywordflow}{If} (jlow >= nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1465 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1466 \textcolor{keywordflow}{         End Do} lowloop2}
\DoxyCodeLine{1467 \textcolor{comment}{!}}
\DoxyCodeLine{1468          \textcolor{keywordflow}{If} (icrs < ndon-\/1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1469             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{1470                icrs = icrs + 1}
\DoxyCodeLine{1471                \textcolor{keywordflow}{If} (invals(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1472                   \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1473                   jlow = jlow + 1}
\DoxyCodeLine{1474                   ilowt(jlow) = icrs}
\DoxyCodeLine{1475 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1476 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1477 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1478 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1479 \textcolor{comment}{!}}
\DoxyCodeLine{1480       jlm2 = 0}
\DoxyCodeLine{1481       jlm1 = 0}
\DoxyCodeLine{1482       jhm2 = 0}
\DoxyCodeLine{1483       jhm1 = 0}
\DoxyCodeLine{1484       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{1485          \textcolor{keywordflow}{if} (jlow == nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1486          \textcolor{keywordflow}{If} (jlm2 == jlow .And. jhm2 == jhig) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1487 \textcolor{comment}{!}}
\DoxyCodeLine{1488 \textcolor{comment}{!   We are oscillating. Perturbate by bringing JLOW closer by one}}
\DoxyCodeLine{1489 \textcolor{comment}{!   to NORD}}
\DoxyCodeLine{1490 \textcolor{comment}{!}}
\DoxyCodeLine{1491            \textcolor{keywordflow}{If} (nord > jlow) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1492                 xmin = invals(ihigt(1))}
\DoxyCodeLine{1493                 ihig = 1}
\DoxyCodeLine{1494                 \textcolor{keywordflow}{Do} icrs = 2, jhig}
\DoxyCodeLine{1495                    \textcolor{keywordflow}{If} (invals(ihigt(icrs)) < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1496                       xmin = invals(ihigt(icrs))}
\DoxyCodeLine{1497                       ihig = icrs}
\DoxyCodeLine{1498 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{1499 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{1500 \textcolor{comment}{!}}
\DoxyCodeLine{1501                 jlow = jlow + 1}
\DoxyCodeLine{1502                 ilowt(jlow) = ihigt(ihig)}
\DoxyCodeLine{1503                 ihig = 0}
\DoxyCodeLine{1504                 \textcolor{keywordflow}{Do} icrs = 1, jhig}
\DoxyCodeLine{1505                    \textcolor{keywordflow}{If} (invals(ihigt(icrs)) /= xmin) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1506                       ihig = ihig + 1}
\DoxyCodeLine{1507                       ihigt(ihig ) = ihigt(icrs)}
\DoxyCodeLine{1508 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{1509 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{1510                 jhig = ihig}
\DoxyCodeLine{1511              \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1512                 ilow = ilowt(jlow)}
\DoxyCodeLine{1513                 xmax = invals(ilow)}
\DoxyCodeLine{1514                 \textcolor{keywordflow}{Do} icrs = 1, jlow}
\DoxyCodeLine{1515                    \textcolor{keywordflow}{If} (invals(ilowt(icrs)) > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1516                       iwrk = ilowt(icrs)}
\DoxyCodeLine{1517                       xmax = invals(iwrk)}
\DoxyCodeLine{1518                       ilowt(icrs) = ilow}
\DoxyCodeLine{1519                       ilow = iwrk}
\DoxyCodeLine{1520 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{1521 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{1522                 jlow = jlow -\/ 1}
\DoxyCodeLine{1523 \textcolor{keywordflow}{             End If}}
\DoxyCodeLine{1524 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1525          jlm2 = jlm1}
\DoxyCodeLine{1526          jlm1 = jlow}
\DoxyCodeLine{1527          jhm2 = jhm1}
\DoxyCodeLine{1528          jhm1 = jhig}
\DoxyCodeLine{1529 \textcolor{comment}{!}}
\DoxyCodeLine{1530 \textcolor{comment}{!   We try to bring the number of values in the low values set}}
\DoxyCodeLine{1531 \textcolor{comment}{!   closer to NORD. In order to make better pivot choices, we}}
\DoxyCodeLine{1532 \textcolor{comment}{!   decrease NORD if we already know that we don't have that}}
\DoxyCodeLine{1533 \textcolor{comment}{!   many distinct values as a whole.}}
\DoxyCodeLine{1534 \textcolor{comment}{!}}
\DoxyCodeLine{1535          \textcolor{keywordflow}{IF} (jlow+jhig < nord) nord = jlow+jhig}
\DoxyCodeLine{1536          \textcolor{keywordflow}{Select Case} (nord-\/jlow)}
\DoxyCodeLine{1537 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1538          \textcolor{keywordflow}{Case} (2:)}
\DoxyCodeLine{1539 \textcolor{comment}{!}}
\DoxyCodeLine{1540 \textcolor{comment}{!   Not enough values in low part, at least 2 are missing}}
\DoxyCodeLine{1541 \textcolor{comment}{!}}
\DoxyCodeLine{1542             \textcolor{keywordflow}{Select Case} (jhig)}
\DoxyCodeLine{1543 \textcolor{comment}{!}}
\DoxyCodeLine{1544 \textcolor{comment}{!   Not enough values in high part either (too many duplicates)}}
\DoxyCodeLine{1545 \textcolor{comment}{!}}
\DoxyCodeLine{1546             \textcolor{keywordflow}{Case} (0)}
\DoxyCodeLine{1547                nord = jlow}
\DoxyCodeLine{1548 \textcolor{comment}{!}}
\DoxyCodeLine{1549             \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{1550                jlow = jlow + 1}
\DoxyCodeLine{1551                ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{1552                nord = jlow}
\DoxyCodeLine{1553 \textcolor{comment}{!}}
\DoxyCodeLine{1554 \textcolor{comment}{!   We make a special case when we have so few values in}}
\DoxyCodeLine{1555 \textcolor{comment}{!   the high values set that it is bad performance to choose a pivot}}
\DoxyCodeLine{1556 \textcolor{comment}{!   and apply the general algorithm.}}
\DoxyCodeLine{1557 \textcolor{comment}{!}}
\DoxyCodeLine{1558             \textcolor{keywordflow}{Case} (2)}
\DoxyCodeLine{1559                \textcolor{keywordflow}{If} (invals(ihigt(1)) <= invals(ihigt(2))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1560                   jlow = jlow + 1}
\DoxyCodeLine{1561                   ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{1562                   jlow = jlow + 1}
\DoxyCodeLine{1563                   ilowt(jlow) = ihigt(2)}
\DoxyCodeLine{1564                \textcolor{keywordflow}{ElseIf} (invals(ihigt(1)) == invals(ihigt(2))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1565                   jlow = jlow + 1}
\DoxyCodeLine{1566                   ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{1567                   nord = jlow}
\DoxyCodeLine{1568                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1569                   jlow = jlow + 1}
\DoxyCodeLine{1570                   ilowt(jlow) = ihigt(2)}
\DoxyCodeLine{1571                   jlow = jlow + 1}
\DoxyCodeLine{1572                   ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{1573 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1574                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1575 \textcolor{comment}{!}}
\DoxyCodeLine{1576             \textcolor{keywordflow}{Case} (3)}
\DoxyCodeLine{1577 \textcolor{comment}{!}}
\DoxyCodeLine{1578 \textcolor{comment}{!}}
\DoxyCodeLine{1579                iwrk1 = ihigt(1)}
\DoxyCodeLine{1580                iwrk2 = ihigt(2)}
\DoxyCodeLine{1581                iwrk3 = ihigt(3)}
\DoxyCodeLine{1582                \textcolor{keywordflow}{If} (invals(iwrk2) < invals(iwrk1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1583                   ihigt(1) = iwrk2}
\DoxyCodeLine{1584                   ihigt(2) = iwrk1}
\DoxyCodeLine{1585                   iwrk2 = iwrk1}
\DoxyCodeLine{1586 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1587                \textcolor{keywordflow}{If} (invals(iwrk2) > invals(iwrk3)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1588                   ihigt(3) = iwrk2}
\DoxyCodeLine{1589                   ihigt(2) = iwrk3}
\DoxyCodeLine{1590                   iwrk2 = iwrk3}
\DoxyCodeLine{1591                   \textcolor{keywordflow}{If} (invals(iwrk2) < invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1592                      ihigt(2) = ihigt(1)}
\DoxyCodeLine{1593                      ihigt(1) = iwrk2}
\DoxyCodeLine{1594 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1595 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1596                jhig = 1}
\DoxyCodeLine{1597                jlow = jlow + 1}
\DoxyCodeLine{1598                ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{1599                jhig = jhig + 1}
\DoxyCodeLine{1600                \textcolor{keywordflow}{IF} (invals(ihigt(jhig)) /= invals(ilowt(jlow))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1601                  jlow = jlow + 1}
\DoxyCodeLine{1602                  ilowt(jlow) = ihigt(jhig)}
\DoxyCodeLine{1603 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1604                jhig = jhig + 1}
\DoxyCodeLine{1605                \textcolor{keywordflow}{IF} (invals(ihigt(jhig)) /= invals(ilowt(jlow))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1606                  jlow = jlow + 1}
\DoxyCodeLine{1607                  ilowt(jlow) = ihigt(jhig)}
\DoxyCodeLine{1608 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1609                nord = min(jlow, nord)}
\DoxyCodeLine{1610                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1611 \textcolor{comment}{!}}
\DoxyCodeLine{1612             \textcolor{keywordflow}{Case} (4:)}
\DoxyCodeLine{1613 \textcolor{comment}{!}}
\DoxyCodeLine{1614 \textcolor{comment}{!}}
\DoxyCodeLine{1615                xpiv0 = xpiv}
\DoxyCodeLine{1616                ifin = jhig}
\DoxyCodeLine{1617 \textcolor{comment}{!}}
\DoxyCodeLine{1618 \textcolor{comment}{!  One chooses a pivot from the 2 first values and the last one.}}
\DoxyCodeLine{1619 \textcolor{comment}{!  This should ensure sufficient renewal between iterations to}}
\DoxyCodeLine{1620 \textcolor{comment}{!  avoid worst case behavior effects.}}
\DoxyCodeLine{1621 \textcolor{comment}{!}}
\DoxyCodeLine{1622                iwrk1 = ihigt(1)}
\DoxyCodeLine{1623                iwrk2 = ihigt(2)}
\DoxyCodeLine{1624                iwrk3 = ihigt(ifin)}
\DoxyCodeLine{1625                \textcolor{keywordflow}{If} (invals(iwrk2) < invals(iwrk1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1626                   ihigt(1) = iwrk2}
\DoxyCodeLine{1627                   ihigt(2) = iwrk1}
\DoxyCodeLine{1628                   iwrk2 = iwrk1}
\DoxyCodeLine{1629 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1630                \textcolor{keywordflow}{If} (invals(iwrk2) > invals(iwrk3)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1631                   ihigt(ifin) = iwrk2}
\DoxyCodeLine{1632                   ihigt(2) = iwrk3}
\DoxyCodeLine{1633                   iwrk2 = iwrk3}
\DoxyCodeLine{1634                   \textcolor{keywordflow}{If} (invals(iwrk2) < invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1635                      ihigt(2) = ihigt(1)}
\DoxyCodeLine{1636                      ihigt(1) = iwrk2}
\DoxyCodeLine{1637 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1638 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1639 \textcolor{comment}{!}}
\DoxyCodeLine{1640                jdeb = jlow}
\DoxyCodeLine{1641                nwrk = nord -\/ jlow}
\DoxyCodeLine{1642                iwrk1 = ihigt(1)}
\DoxyCodeLine{1643                xpiv = invals(iwrk1) + real(nwrk) / real(nord+nwrk) * \&}
\DoxyCodeLine{1644                                       (invals(ihigt(ifin))-\/invals(iwrk1))}
\DoxyCodeLine{1645 \textcolor{comment}{!}}
\DoxyCodeLine{1646 \textcolor{comment}{!  One takes values <= pivot to ILOWT}}
\DoxyCodeLine{1647 \textcolor{comment}{!  Again, 2 parts, one where we take care of the remaining}}
\DoxyCodeLine{1648 \textcolor{comment}{!  high values because we might still need them, and the}}
\DoxyCodeLine{1649 \textcolor{comment}{!  other when we know that we will have more than enough}}
\DoxyCodeLine{1650 \textcolor{comment}{!  low values in the end.}}
\DoxyCodeLine{1651 \textcolor{comment}{!}}
\DoxyCodeLine{1652                jhig = 0}
\DoxyCodeLine{1653                lowloop3: \textcolor{keywordflow}{Do} icrs = 1, ifin}
\DoxyCodeLine{1654                   \textcolor{keywordflow}{If} (invals(ihigt(icrs)) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1655                      \textcolor{keywordflow}{Do} ilow = 1, jlow}
\DoxyCodeLine{1656                         \textcolor{keywordflow}{If} (invals(ihigt(icrs)) == invals(ilowt(ilow))) \&}
\DoxyCodeLine{1657                             cycle lowloop3}
\DoxyCodeLine{1658 \textcolor{keywordflow}{                     End Do}}
\DoxyCodeLine{1659                      jlow = jlow + 1}
\DoxyCodeLine{1660                      ilowt(jlow) = ihigt(icrs)}
\DoxyCodeLine{1661                      \textcolor{keywordflow}{If} (jlow > nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1662                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1663                      jhig = jhig + 1}
\DoxyCodeLine{1664                      ihigt(jhig) = ihigt(icrs)}
\DoxyCodeLine{1665 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1666 \textcolor{keywordflow}{               End Do} lowloop3}
\DoxyCodeLine{1667 \textcolor{comment}{!}}
\DoxyCodeLine{1668                \textcolor{keywordflow}{Do} icrs = icrs + 1, ifin}
\DoxyCodeLine{1669                   \textcolor{keywordflow}{If} (invals(ihigt(icrs)) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1670                      jlow = jlow + 1}
\DoxyCodeLine{1671                      ilowt(jlow) = ihigt(icrs)}
\DoxyCodeLine{1672 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1673 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1674 \textcolor{keywordflow}{           End Select}}
\DoxyCodeLine{1675 \textcolor{comment}{!}}
\DoxyCodeLine{1676 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1677 \textcolor{comment}{!}}
\DoxyCodeLine{1678          \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{1679 \textcolor{comment}{!}}
\DoxyCodeLine{1680 \textcolor{comment}{!  Only 1 value is missing in low part}}
\DoxyCodeLine{1681 \textcolor{comment}{!}}
\DoxyCodeLine{1682             xmin = invals(ihigt(1))}
\DoxyCodeLine{1683             ihig = 1}
\DoxyCodeLine{1684             \textcolor{keywordflow}{Do} icrs = 2, jhig}
\DoxyCodeLine{1685                \textcolor{keywordflow}{If} (invals(ihigt(icrs)) < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1686                   xmin = invals(ihigt(icrs))}
\DoxyCodeLine{1687                   ihig = icrs}
\DoxyCodeLine{1688 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1689 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1690 \textcolor{comment}{!}}
\DoxyCodeLine{1691             jlow = jlow + 1}
\DoxyCodeLine{1692             ilowt(jlow) = ihigt(ihig)}
\DoxyCodeLine{1693             \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1694 \textcolor{comment}{!}}
\DoxyCodeLine{1695 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1696 \textcolor{comment}{!}}
\DoxyCodeLine{1697          \textcolor{keywordflow}{Case} (0)}
\DoxyCodeLine{1698 \textcolor{comment}{!}}
\DoxyCodeLine{1699 \textcolor{comment}{!  Low part is exactly what we want}}
\DoxyCodeLine{1700 \textcolor{comment}{!}}
\DoxyCodeLine{1701             \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1702 \textcolor{comment}{!}}
\DoxyCodeLine{1703 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1704 \textcolor{comment}{!}}
\DoxyCodeLine{1705          \textcolor{keywordflow}{Case} (-\/5:-\/1)}
\DoxyCodeLine{1706 \textcolor{comment}{!}}
\DoxyCodeLine{1707 \textcolor{comment}{!  Only few values too many in low part}}
\DoxyCodeLine{1708 \textcolor{comment}{!}}
\DoxyCodeLine{1709             irngt(1) = ilowt(1)}
\DoxyCodeLine{1710             \textcolor{keywordflow}{Do} icrs = 2, nord}
\DoxyCodeLine{1711                iwrk = ilowt(icrs)}
\DoxyCodeLine{1712                xwrk = invals(iwrk)}
\DoxyCodeLine{1713                \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1714                   \textcolor{keywordflow}{If} (xwrk < invals(irngt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1715                      irngt(idcr+1) = irngt(idcr)}
\DoxyCodeLine{1716                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1717                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1718 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1719 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1720                irngt(idcr+1) = iwrk}
\DoxyCodeLine{1721 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1722 \textcolor{comment}{!}}
\DoxyCodeLine{1723             xwrk1 = invals(irngt(nord))}
\DoxyCodeLine{1724             insert1: \textcolor{keywordflow}{Do} icrs = nord + 1, jlow}
\DoxyCodeLine{1725                \textcolor{keywordflow}{If} (invals(ilowt(icrs)) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1726                   xwrk = invals(ilowt(icrs))}
\DoxyCodeLine{1727                   \textcolor{keywordflow}{Do} ilow = 1, nord -\/ 1}
\DoxyCodeLine{1728                      \textcolor{keywordflow}{If} (xwrk <= invals(irngt(ilow))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1729                         \textcolor{keywordflow}{If} (xwrk == invals(irngt(ilow))) cycle insert1}
\DoxyCodeLine{1730                         \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1731 \textcolor{keywordflow}{                     End If}}
\DoxyCodeLine{1732 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{1733                   \textcolor{keywordflow}{Do} idcr = nord -\/ 1, ilow, -\/ 1}
\DoxyCodeLine{1734                      irngt(idcr+1) = irngt(idcr)}
\DoxyCodeLine{1735 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{1736                   irngt(idcr+1) = ilowt(icrs)}
\DoxyCodeLine{1737                   xwrk1 = invals(irngt(nord))}
\DoxyCodeLine{1738 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1739 \textcolor{keywordflow}{            End Do} insert1}
\DoxyCodeLine{1740 \textcolor{comment}{!}}
\DoxyCodeLine{1741             \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1742 \textcolor{comment}{!}}
\DoxyCodeLine{1743 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1744 \textcolor{comment}{!}}
\DoxyCodeLine{1745          \textcolor{keywordflow}{Case} (:-\/6)}
\DoxyCodeLine{1746 \textcolor{comment}{!}}
\DoxyCodeLine{1747 \textcolor{comment}{! last case: too many values in low part}}
\DoxyCodeLine{1748 \textcolor{comment}{!}}
\DoxyCodeLine{1749             ideb = jdeb + 1}
\DoxyCodeLine{1750             imil = min((jlow+ideb) / 2, nord)}
\DoxyCodeLine{1751             ifin = min(jlow, nord+1)}
\DoxyCodeLine{1752 \textcolor{comment}{!}}
\DoxyCodeLine{1753 \textcolor{comment}{!  One chooses a pivot from 1st, last, and middle values}}
\DoxyCodeLine{1754 \textcolor{comment}{!}}
\DoxyCodeLine{1755             \textcolor{keywordflow}{If} (invals(ilowt(imil)) < invals(ilowt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1756                iwrk = ilowt(ideb)}
\DoxyCodeLine{1757                ilowt(ideb) = ilowt(imil)}
\DoxyCodeLine{1758                ilowt(imil) = iwrk}
\DoxyCodeLine{1759 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1760             \textcolor{keywordflow}{If} (invals(ilowt(imil)) > invals(ilowt(ifin))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1761                iwrk = ilowt(ifin)}
\DoxyCodeLine{1762                ilowt(ifin) = ilowt(imil)}
\DoxyCodeLine{1763                ilowt(imil) = iwrk}
\DoxyCodeLine{1764                \textcolor{keywordflow}{If} (invals(ilowt(imil)) < invals(ilowt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1765                   iwrk = ilowt(ideb)}
\DoxyCodeLine{1766                   ilowt(ideb) = ilowt(imil)}
\DoxyCodeLine{1767                   ilowt(imil) = iwrk}
\DoxyCodeLine{1768 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1769 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1770             \textcolor{keywordflow}{If} (ifin <= 3) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1771 \textcolor{comment}{!}}
\DoxyCodeLine{1772             xpiv = invals(ilowt(ideb)) + real(nord)/real(jlow+nord) * \&}
\DoxyCodeLine{1773                                       (invals(ilowt(ifin))-\/invals(ilowt(1)))}
\DoxyCodeLine{1774             \textcolor{keywordflow}{If} (jdeb > 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1775                \textcolor{keywordflow}{If} (xpiv <= xpiv0) \&}
\DoxyCodeLine{1776                    xpiv = xpiv0 + real(2*nord-\/jdeb)/real(jlow+nord) * \&}
\DoxyCodeLine{1777                                   (invals(ilowt(ifin))-\/xpiv0)}
\DoxyCodeLine{1778             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1779                ideb = 1}
\DoxyCodeLine{1780 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1781 \textcolor{comment}{!}}
\DoxyCodeLine{1782 \textcolor{comment}{!  One takes values > XPIV to IHIGT}}
\DoxyCodeLine{1783 \textcolor{comment}{!  However, we do not process the first values if we have been}}
\DoxyCodeLine{1784 \textcolor{comment}{!  through the case when we did not have enough low values}}
\DoxyCodeLine{1785 \textcolor{comment}{!}}
\DoxyCodeLine{1786             jhig = 0}
\DoxyCodeLine{1787             ifin = jlow}
\DoxyCodeLine{1788             jlow = jdeb}
\DoxyCodeLine{1789 \textcolor{comment}{!}}
\DoxyCodeLine{1790             \textcolor{keywordflow}{If} (invals(ilowt(ifin)) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1791                icrs = jdeb}
\DoxyCodeLine{1792               lowloop4: \textcolor{keywordflow}{Do}}
\DoxyCodeLine{1793                  icrs = icrs + 1}
\DoxyCodeLine{1794                   \textcolor{keywordflow}{If} (invals(ilowt(icrs)) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1795                      jhig = jhig + 1}
\DoxyCodeLine{1796                      ihigt(jhig) = ilowt(icrs)}
\DoxyCodeLine{1797                      \textcolor{keywordflow}{If} (icrs >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1798                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1799                      xwrk1 = invals(ilowt(icrs))}
\DoxyCodeLine{1800                      \textcolor{keywordflow}{Do} ilow = ideb, jlow}
\DoxyCodeLine{1801                         \textcolor{keywordflow}{If} (xwrk1 == invals(ilowt(ilow))) \&}
\DoxyCodeLine{1802                             cycle lowloop4}
\DoxyCodeLine{1803 \textcolor{keywordflow}{                     End Do}}
\DoxyCodeLine{1804                      jlow = jlow + 1}
\DoxyCodeLine{1805                      ilowt(jlow) = ilowt(icrs)}
\DoxyCodeLine{1806                      \textcolor{keywordflow}{If} (jlow >= nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1807 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1808 \textcolor{keywordflow}{               End Do} lowloop4}
\DoxyCodeLine{1809 \textcolor{comment}{!}}
\DoxyCodeLine{1810                \textcolor{keywordflow}{If} (icrs < ifin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1811                   \textcolor{keywordflow}{Do}}
\DoxyCodeLine{1812                      icrs = icrs + 1}
\DoxyCodeLine{1813                      \textcolor{keywordflow}{If} (invals(ilowt(icrs)) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1814                         jlow = jlow + 1}
\DoxyCodeLine{1815                         ilowt(jlow) = ilowt(icrs)}
\DoxyCodeLine{1816                      \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1817                         \textcolor{keywordflow}{If} (icrs >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1818 \textcolor{keywordflow}{                     End If}}
\DoxyCodeLine{1819 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{1820 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1821            \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1822               lowloop5: \textcolor{keywordflow}{Do} icrs = ideb, ifin}
\DoxyCodeLine{1823                   \textcolor{keywordflow}{If} (invals(ilowt(icrs)) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1824                      jhig = jhig + 1}
\DoxyCodeLine{1825                      ihigt(jhig) = ilowt(icrs)}
\DoxyCodeLine{1826                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1827                      xwrk1 = invals(ilowt(icrs))}
\DoxyCodeLine{1828                      \textcolor{keywordflow}{Do} ilow = ideb, jlow}
\DoxyCodeLine{1829                         \textcolor{keywordflow}{If} (xwrk1 == invals(ilowt(ilow))) \&}
\DoxyCodeLine{1830                             cycle lowloop5}
\DoxyCodeLine{1831 \textcolor{keywordflow}{                     End Do}}
\DoxyCodeLine{1832                      jlow = jlow + 1}
\DoxyCodeLine{1833                      ilowt(jlow) = ilowt(icrs)}
\DoxyCodeLine{1834                      \textcolor{keywordflow}{If} (jlow >= nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1835 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1836 \textcolor{keywordflow}{               End Do} lowloop5}
\DoxyCodeLine{1837 \textcolor{comment}{!}}
\DoxyCodeLine{1838                \textcolor{keywordflow}{Do} icrs = icrs + 1, ifin}
\DoxyCodeLine{1839                   \textcolor{keywordflow}{If} (invals(ilowt(icrs)) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1840                      jlow = jlow + 1}
\DoxyCodeLine{1841                      ilowt(jlow) = ilowt(icrs)}
\DoxyCodeLine{1842 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1843 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1844 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1845 \textcolor{comment}{!}}
\DoxyCodeLine{1846 \textcolor{keywordflow}{         End Select}}
\DoxyCodeLine{1847 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1848 \textcolor{comment}{!}}
\DoxyCodeLine{1849 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{1850 \textcolor{comment}{!}}
\DoxyCodeLine{1851 \textcolor{comment}{!  Now, we only need to complete ranking of the 1:NORD set}}
\DoxyCodeLine{1852 \textcolor{comment}{!  Assuming NORD is small, we use a simple insertion sort}}
\DoxyCodeLine{1853 \textcolor{comment}{!}}
\DoxyCodeLine{1854       irngt(1) = ilowt(1)}
\DoxyCodeLine{1855       \textcolor{keywordflow}{Do} icrs = 2, nord}
\DoxyCodeLine{1856          iwrk = ilowt(icrs)}
\DoxyCodeLine{1857          xwrk = invals(iwrk)}
\DoxyCodeLine{1858          \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1859             \textcolor{keywordflow}{If} (xwrk < invals(irngt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1860                irngt(idcr+1) = irngt(idcr)}
\DoxyCodeLine{1861             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1862                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1863 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1864 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1865          irngt(idcr+1) = iwrk}
\DoxyCodeLine{1866 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{1867      \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1868 \textcolor{comment}{!}}
\DoxyCodeLine{1869 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__orderpack____unipar_ad71165c2ac66bdd3df2bf43abe6973c4}\label{namespacem__orderpack____unipar_ad71165c2ac66bdd3df2bf43abe6973c4}} 
\index{m\_orderpack\_\_unipar@{m\_orderpack\_\_unipar}!int32\_unipar@{int32\_unipar}}
\index{int32\_unipar@{int32\_unipar}!m\_orderpack\_\_unipar@{m\_orderpack\_\_unipar}}
\doxysubsubsection{\texorpdfstring{int32\_unipar()}{int32\_unipar()}}
{\footnotesize\ttfamily subroutine m\+\_\+orderpack\+\_\+\+\_\+unipar\+::int32\+\_\+unipar (\begin{DoxyParamCaption}\item[{integer (kind=int32), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, dimension (\+:), intent(out)}]{I\+R\+N\+GT,  }\item[{integer, intent(inout)}]{N\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{1873 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1874    \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: INVALS}
\DoxyCodeLine{1875    \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IRNGT}
\DoxyCodeLine{1876    \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (InOut)} :: NORD}
\DoxyCodeLine{1877 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1878    \textcolor{keywordtype}{Integer (kind=int32)} :: XPIV, XWRK, XWRK1, XMIN, XMAX, XPIV0}
\DoxyCodeLine{1879 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1880    \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(INVALS))} :: ILOWT, IHIGT}
\DoxyCodeLine{1881    \textcolor{keywordtype}{Integer} :: NDON, JHIG, JLOW, IHIG, IWRK, IWRK1, IWRK2, IWRK3}
\DoxyCodeLine{1882    \textcolor{keywordtype}{Integer} :: IDEB, JDEB, IMIL, IFIN, NWRK, ICRS, IDCR, ILOW}
\DoxyCodeLine{1883    \textcolor{keywordtype}{Integer} :: JLM2, JLM1, JHM2, JHM1}
\DoxyCodeLine{1884 \textcolor{comment}{!}}
\DoxyCodeLine{1885       ndon = \textcolor{keyword}{SIZE} (invals)}
\DoxyCodeLine{1886 \textcolor{comment}{!}}
\DoxyCodeLine{1887 \textcolor{comment}{!    First loop is used to fill-\/in ILOWT, IHIGT at the same time}}
\DoxyCodeLine{1888 \textcolor{comment}{!}}
\DoxyCodeLine{1889       \textcolor{keywordflow}{If} (ndon < 2) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1890          \textcolor{keywordflow}{If} (nord >= 1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1891             nord = 1}
\DoxyCodeLine{1892             irngt(1) = 1}
\DoxyCodeLine{1893 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1894          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1895 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1896 \textcolor{comment}{!}}
\DoxyCodeLine{1897 \textcolor{comment}{!  One chooses a pivot, best estimate possible to put fractile near}}
\DoxyCodeLine{1898 \textcolor{comment}{!  mid-\/point of the set of low values.}}
\DoxyCodeLine{1899 \textcolor{comment}{!}}
\DoxyCodeLine{1900      ihigt=1}
\DoxyCodeLine{1901      ilowt=1}
\DoxyCodeLine{1902 }
\DoxyCodeLine{1903      \textcolor{keywordflow}{Do} icrs = 2, ndon}
\DoxyCodeLine{1904         \textcolor{keywordflow}{If} (invals(icrs) == invals(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1905           cycle}
\DoxyCodeLine{1906         \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (invals(icrs) < invals(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1907            ilowt(1) = icrs}
\DoxyCodeLine{1908            ihigt(1) = 1}
\DoxyCodeLine{1909         \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1910            ilowt(1) = 1}
\DoxyCodeLine{1911            ihigt(1) = icrs}
\DoxyCodeLine{1912 \textcolor{keywordflow}{        End If}}
\DoxyCodeLine{1913         \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1914 \textcolor{keywordflow}{     End Do}}
\DoxyCodeLine{1915 \textcolor{comment}{!}}
\DoxyCodeLine{1916       \textcolor{keywordflow}{If} (ndon <= icrs) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1917          nord = min(nord, 2)}
\DoxyCodeLine{1918          \textcolor{keywordflow}{If} (nord >= 1) irngt(1) = ilowt(1)}
\DoxyCodeLine{1919          \textcolor{keywordflow}{If} (nord >= 2) irngt(2) = ihigt(1)}
\DoxyCodeLine{1920          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1921 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1922 \textcolor{comment}{!}}
\DoxyCodeLine{1923       icrs = icrs + 1}
\DoxyCodeLine{1924       jhig = 1}
\DoxyCodeLine{1925       \textcolor{keywordflow}{If} (invals(icrs) < invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1926          \textcolor{keywordflow}{If} (invals(icrs) < invals(ilowt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1927             jhig = jhig + 1}
\DoxyCodeLine{1928             ihigt(jhig) = ihigt(1)}
\DoxyCodeLine{1929             ihigt(1) = ilowt(1)}
\DoxyCodeLine{1930             ilowt(1) = icrs}
\DoxyCodeLine{1931          \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (invals(icrs) > invals(ilowt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1932             jhig = jhig + 1}
\DoxyCodeLine{1933             ihigt(jhig) = ihigt(1)}
\DoxyCodeLine{1934             ihigt(1) = icrs}
\DoxyCodeLine{1935 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1936       \textcolor{keywordflow}{ElseIf} (invals(icrs) > invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1937          jhig = jhig + 1}
\DoxyCodeLine{1938          ihigt(jhig) = icrs}
\DoxyCodeLine{1939 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1940 \textcolor{comment}{!}}
\DoxyCodeLine{1941       \textcolor{keywordflow}{If} (ndon <= icrs) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1942          nord = min(nord, jhig+1)}
\DoxyCodeLine{1943          \textcolor{keywordflow}{If} (nord >= 1) irngt(1) = ilowt(1)}
\DoxyCodeLine{1944          \textcolor{keywordflow}{If} (nord >= 2) irngt(2) = ihigt(1)}
\DoxyCodeLine{1945          \textcolor{keywordflow}{If} (nord >= 3) irngt(3) = ihigt(2)}
\DoxyCodeLine{1946          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1947 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1948 \textcolor{comment}{!}}
\DoxyCodeLine{1949       \textcolor{keywordflow}{If} (invals(ndon) < invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1950          \textcolor{keywordflow}{If} (invals(ndon) < invals(ilowt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1951             \textcolor{keywordflow}{Do} idcr = jhig, 1, -\/1}
\DoxyCodeLine{1952               ihigt(idcr+1) = ihigt(idcr)}
\DoxyCodeLine{1953 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1954             ihigt(1) = ilowt(1)}
\DoxyCodeLine{1955             ilowt(1) = ndon}
\DoxyCodeLine{1956             jhig = jhig + 1}
\DoxyCodeLine{1957          \textcolor{keywordflow}{ElseIf} (invals(ndon) > invals(ilowt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1958             \textcolor{keywordflow}{Do} idcr = jhig, 1, -\/1}
\DoxyCodeLine{1959               ihigt(idcr+1) = ihigt(idcr)}
\DoxyCodeLine{1960 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1961             ihigt(1) = ndon}
\DoxyCodeLine{1962             jhig = jhig + 1}
\DoxyCodeLine{1963 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1964       \textcolor{keywordflow}{ElseIf} (invals(ndon) > invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1965          jhig = jhig + 1}
\DoxyCodeLine{1966          ihigt(jhig) = ndon}
\DoxyCodeLine{1967 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1968 \textcolor{comment}{!}}
\DoxyCodeLine{1969       \textcolor{keywordflow}{If} (ndon <= icrs+1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1970          nord = min(nord, jhig+1)}
\DoxyCodeLine{1971          \textcolor{keywordflow}{If} (nord >= 1) irngt(1) = ilowt(1)}
\DoxyCodeLine{1972          \textcolor{keywordflow}{If} (nord >= 2) irngt(2) = ihigt(1)}
\DoxyCodeLine{1973          \textcolor{keywordflow}{If} (nord >= 3) irngt(3) = ihigt(2)}
\DoxyCodeLine{1974          \textcolor{keywordflow}{If} (nord >= 4) irngt(4) = ihigt(3)}
\DoxyCodeLine{1975          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1976 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1977 \textcolor{comment}{!}}
\DoxyCodeLine{1978       jdeb = 0}
\DoxyCodeLine{1979       ideb = jdeb + 1}
\DoxyCodeLine{1980       jlow = ideb}
\DoxyCodeLine{1981       xpiv = invals(ilowt(ideb)) + real(2*nord)/real(ndon+nord) * \&}
\DoxyCodeLine{1982                                    (invals(ihigt(3))-\/invals(ilowt(ideb)))}
\DoxyCodeLine{1983       \textcolor{keywordflow}{If} (xpiv >= invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1984          xpiv = invals(ilowt(ideb)) + real(2*nord)/real(ndon+nord) * \&}
\DoxyCodeLine{1985                                       (invals(ihigt(2))-\/invals(ilowt(ideb)))}
\DoxyCodeLine{1986          \textcolor{keywordflow}{If} (xpiv >= invals(ihigt(1))) \&}
\DoxyCodeLine{1987              xpiv = invals(ilowt(ideb)) + real(2*nord) / real(ndon+nord) * \&}
\DoxyCodeLine{1988                                           (invals(ihigt(1))-\/invals(ilowt(ideb)))}
\DoxyCodeLine{1989 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1990       xpiv0 = xpiv}
\DoxyCodeLine{1991 \textcolor{comment}{!}}
\DoxyCodeLine{1992 \textcolor{comment}{!  One puts values > pivot in the end and those <= pivot}}
\DoxyCodeLine{1993 \textcolor{comment}{!  at the beginning. This is split in 2 cases, so that}}
\DoxyCodeLine{1994 \textcolor{comment}{!  we can skip the loop test a number of times.}}
\DoxyCodeLine{1995 \textcolor{comment}{!  As we are also filling in the work arrays at the same time}}
\DoxyCodeLine{1996 \textcolor{comment}{!  we stop filling in the IHIGT array as soon as we have more}}
\DoxyCodeLine{1997 \textcolor{comment}{!  than enough values in ILOWT, i.e. one more than}}
\DoxyCodeLine{1998 \textcolor{comment}{!  strictly necessary so as to be able to come out of the}}
\DoxyCodeLine{1999 \textcolor{comment}{!  case where JLOWT would be NORD distinct values followed}}
\DoxyCodeLine{2000 \textcolor{comment}{!  by values that are exclusively duplicates of these.}}
\DoxyCodeLine{2001 \textcolor{comment}{!}}
\DoxyCodeLine{2002 \textcolor{comment}{!}}
\DoxyCodeLine{2003       \textcolor{keywordflow}{If} (invals(ndon) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2004          lowloop1: \textcolor{keywordflow}{Do}}
\DoxyCodeLine{2005             icrs = icrs + 1}
\DoxyCodeLine{2006             \textcolor{keywordflow}{If} (invals(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2007                \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2008                jhig = jhig + 1}
\DoxyCodeLine{2009                ihigt(jhig) = icrs}
\DoxyCodeLine{2010             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2011                \textcolor{keywordflow}{Do} ilow = 1, jlow}
\DoxyCodeLine{2012                  \textcolor{keywordflow}{If} (invals(icrs) == invals(ilowt(ilow))) cycle lowloop1}
\DoxyCodeLine{2013 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{2014                jlow = jlow + 1}
\DoxyCodeLine{2015                ilowt(jlow) = icrs}
\DoxyCodeLine{2016                \textcolor{keywordflow}{If} (jlow >= nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2017 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{2018 \textcolor{keywordflow}{         End Do} lowloop1}
\DoxyCodeLine{2019 \textcolor{comment}{!}}
\DoxyCodeLine{2020 \textcolor{comment}{!  One restricts further processing because it is no use}}
\DoxyCodeLine{2021 \textcolor{comment}{!  to store more high values}}
\DoxyCodeLine{2022 \textcolor{comment}{!}}
\DoxyCodeLine{2023          \textcolor{keywordflow}{If} (icrs < ndon-\/1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2024             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{2025                icrs = icrs + 1}
\DoxyCodeLine{2026                \textcolor{keywordflow}{If} (invals(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2027                   jlow = jlow + 1}
\DoxyCodeLine{2028                   ilowt(jlow) = icrs}
\DoxyCodeLine{2029                \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2030                   \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2031 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2032 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{2033 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{2034 \textcolor{comment}{!}}
\DoxyCodeLine{2035 \textcolor{comment}{!}}
\DoxyCodeLine{2036       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2037 \textcolor{comment}{!}}
\DoxyCodeLine{2038 \textcolor{comment}{!  Same as above, but this is not as easy to optimize, so the}}
\DoxyCodeLine{2039 \textcolor{comment}{!  DO-\/loop is kept}}
\DoxyCodeLine{2040 \textcolor{comment}{!}}
\DoxyCodeLine{2041          lowloop2: \textcolor{keywordflow}{Do} icrs = icrs + 1, ndon -\/ 1}
\DoxyCodeLine{2042             \textcolor{keywordflow}{If} (invals(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2043                jhig = jhig + 1}
\DoxyCodeLine{2044                ihigt(jhig) = icrs}
\DoxyCodeLine{2045             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2046                \textcolor{keywordflow}{Do} ilow = 1, jlow}
\DoxyCodeLine{2047                  \textcolor{keywordflow}{If} (invals(icrs) == invals(ilowt(ilow))) cycle lowloop2}
\DoxyCodeLine{2048 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{2049                jlow = jlow + 1}
\DoxyCodeLine{2050                ilowt(jlow) = icrs}
\DoxyCodeLine{2051                \textcolor{keywordflow}{If} (jlow >= nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2052 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{2053 \textcolor{keywordflow}{         End Do} lowloop2}
\DoxyCodeLine{2054 \textcolor{comment}{!}}
\DoxyCodeLine{2055          \textcolor{keywordflow}{If} (icrs < ndon-\/1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2056             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{2057                icrs = icrs + 1}
\DoxyCodeLine{2058                \textcolor{keywordflow}{If} (invals(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2059                   \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2060                   jlow = jlow + 1}
\DoxyCodeLine{2061                   ilowt(jlow) = icrs}
\DoxyCodeLine{2062 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2063 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{2064 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{2065 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{2066 \textcolor{comment}{!}}
\DoxyCodeLine{2067       jlm2 = 0}
\DoxyCodeLine{2068       jlm1 = 0}
\DoxyCodeLine{2069       jhm2 = 0}
\DoxyCodeLine{2070       jhm1 = 0}
\DoxyCodeLine{2071       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{2072          \textcolor{keywordflow}{if} (jlow == nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2073          \textcolor{keywordflow}{If} (jlm2 == jlow .And. jhm2 == jhig) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2074 \textcolor{comment}{!}}
\DoxyCodeLine{2075 \textcolor{comment}{!   We are oscillating. Perturbate by bringing JLOW closer by one}}
\DoxyCodeLine{2076 \textcolor{comment}{!   to NORD}}
\DoxyCodeLine{2077 \textcolor{comment}{!}}
\DoxyCodeLine{2078            \textcolor{keywordflow}{If} (nord > jlow) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2079                 xmin = invals(ihigt(1))}
\DoxyCodeLine{2080                 ihig = 1}
\DoxyCodeLine{2081                 \textcolor{keywordflow}{Do} icrs = 2, jhig}
\DoxyCodeLine{2082                    \textcolor{keywordflow}{If} (invals(ihigt(icrs)) < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2083                       xmin = invals(ihigt(icrs))}
\DoxyCodeLine{2084                       ihig = icrs}
\DoxyCodeLine{2085 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{2086 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{2087 \textcolor{comment}{!}}
\DoxyCodeLine{2088                 jlow = jlow + 1}
\DoxyCodeLine{2089                 ilowt(jlow) = ihigt(ihig)}
\DoxyCodeLine{2090                 ihig = 0}
\DoxyCodeLine{2091                 \textcolor{keywordflow}{Do} icrs = 1, jhig}
\DoxyCodeLine{2092                    \textcolor{keywordflow}{If} (invals(ihigt(icrs)) /= xmin) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2093                       ihig = ihig + 1}
\DoxyCodeLine{2094                       ihigt(ihig ) = ihigt(icrs)}
\DoxyCodeLine{2095 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{2096 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{2097                 jhig = ihig}
\DoxyCodeLine{2098              \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2099                 ilow = ilowt(jlow)}
\DoxyCodeLine{2100                 xmax = invals(ilow)}
\DoxyCodeLine{2101                 \textcolor{keywordflow}{Do} icrs = 1, jlow}
\DoxyCodeLine{2102                    \textcolor{keywordflow}{If} (invals(ilowt(icrs)) > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2103                       iwrk = ilowt(icrs)}
\DoxyCodeLine{2104                       xmax = invals(iwrk)}
\DoxyCodeLine{2105                       ilowt(icrs) = ilow}
\DoxyCodeLine{2106                       ilow = iwrk}
\DoxyCodeLine{2107 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{2108 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{2109                 jlow = jlow -\/ 1}
\DoxyCodeLine{2110 \textcolor{keywordflow}{             End If}}
\DoxyCodeLine{2111 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{2112          jlm2 = jlm1}
\DoxyCodeLine{2113          jlm1 = jlow}
\DoxyCodeLine{2114          jhm2 = jhm1}
\DoxyCodeLine{2115          jhm1 = jhig}
\DoxyCodeLine{2116 \textcolor{comment}{!}}
\DoxyCodeLine{2117 \textcolor{comment}{!   We try to bring the number of values in the low values set}}
\DoxyCodeLine{2118 \textcolor{comment}{!   closer to NORD. In order to make better pivot choices, we}}
\DoxyCodeLine{2119 \textcolor{comment}{!   decrease NORD if we already know that we don't have that}}
\DoxyCodeLine{2120 \textcolor{comment}{!   many distinct values as a whole.}}
\DoxyCodeLine{2121 \textcolor{comment}{!}}
\DoxyCodeLine{2122          \textcolor{keywordflow}{IF} (jlow+jhig < nord) nord = jlow+jhig}
\DoxyCodeLine{2123          \textcolor{keywordflow}{Select Case} (nord-\/jlow)}
\DoxyCodeLine{2124 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{2125          \textcolor{keywordflow}{Case} (2:)}
\DoxyCodeLine{2126 \textcolor{comment}{!}}
\DoxyCodeLine{2127 \textcolor{comment}{!   Not enough values in low part, at least 2 are missing}}
\DoxyCodeLine{2128 \textcolor{comment}{!}}
\DoxyCodeLine{2129             \textcolor{keywordflow}{Select Case} (jhig)}
\DoxyCodeLine{2130 \textcolor{comment}{!}}
\DoxyCodeLine{2131 \textcolor{comment}{!   Not enough values in high part either (too many duplicates)}}
\DoxyCodeLine{2132 \textcolor{comment}{!}}
\DoxyCodeLine{2133             \textcolor{keywordflow}{Case} (0)}
\DoxyCodeLine{2134                nord = jlow}
\DoxyCodeLine{2135 \textcolor{comment}{!}}
\DoxyCodeLine{2136             \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{2137                jlow = jlow + 1}
\DoxyCodeLine{2138                ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{2139                nord = jlow}
\DoxyCodeLine{2140 \textcolor{comment}{!}}
\DoxyCodeLine{2141 \textcolor{comment}{!   We make a special case when we have so few values in}}
\DoxyCodeLine{2142 \textcolor{comment}{!   the high values set that it is bad performance to choose a pivot}}
\DoxyCodeLine{2143 \textcolor{comment}{!   and apply the general algorithm.}}
\DoxyCodeLine{2144 \textcolor{comment}{!}}
\DoxyCodeLine{2145             \textcolor{keywordflow}{Case} (2)}
\DoxyCodeLine{2146                \textcolor{keywordflow}{If} (invals(ihigt(1)) <= invals(ihigt(2))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2147                   jlow = jlow + 1}
\DoxyCodeLine{2148                   ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{2149                   jlow = jlow + 1}
\DoxyCodeLine{2150                   ilowt(jlow) = ihigt(2)}
\DoxyCodeLine{2151                \textcolor{keywordflow}{ElseIf} (invals(ihigt(1)) == invals(ihigt(2))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2152                   jlow = jlow + 1}
\DoxyCodeLine{2153                   ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{2154                   nord = jlow}
\DoxyCodeLine{2155                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2156                   jlow = jlow + 1}
\DoxyCodeLine{2157                   ilowt(jlow) = ihigt(2)}
\DoxyCodeLine{2158                   jlow = jlow + 1}
\DoxyCodeLine{2159                   ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{2160 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2161                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2162 \textcolor{comment}{!}}
\DoxyCodeLine{2163             \textcolor{keywordflow}{Case} (3)}
\DoxyCodeLine{2164 \textcolor{comment}{!}}
\DoxyCodeLine{2165 \textcolor{comment}{!}}
\DoxyCodeLine{2166                iwrk1 = ihigt(1)}
\DoxyCodeLine{2167                iwrk2 = ihigt(2)}
\DoxyCodeLine{2168                iwrk3 = ihigt(3)}
\DoxyCodeLine{2169                \textcolor{keywordflow}{If} (invals(iwrk2) < invals(iwrk1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2170                   ihigt(1) = iwrk2}
\DoxyCodeLine{2171                   ihigt(2) = iwrk1}
\DoxyCodeLine{2172                   iwrk2 = iwrk1}
\DoxyCodeLine{2173 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2174                \textcolor{keywordflow}{If} (invals(iwrk2) > invals(iwrk3)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2175                   ihigt(3) = iwrk2}
\DoxyCodeLine{2176                   ihigt(2) = iwrk3}
\DoxyCodeLine{2177                   iwrk2 = iwrk3}
\DoxyCodeLine{2178                   \textcolor{keywordflow}{If} (invals(iwrk2) < invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2179                      ihigt(2) = ihigt(1)}
\DoxyCodeLine{2180                      ihigt(1) = iwrk2}
\DoxyCodeLine{2181 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{2182 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2183                jhig = 1}
\DoxyCodeLine{2184                jlow = jlow + 1}
\DoxyCodeLine{2185                ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{2186                jhig = jhig + 1}
\DoxyCodeLine{2187                \textcolor{keywordflow}{IF} (invals(ihigt(jhig)) /= invals(ilowt(jlow))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2188                  jlow = jlow + 1}
\DoxyCodeLine{2189                  ilowt(jlow) = ihigt(jhig)}
\DoxyCodeLine{2190 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2191                jhig = jhig + 1}
\DoxyCodeLine{2192                \textcolor{keywordflow}{IF} (invals(ihigt(jhig)) /= invals(ilowt(jlow))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2193                  jlow = jlow + 1}
\DoxyCodeLine{2194                  ilowt(jlow) = ihigt(jhig)}
\DoxyCodeLine{2195 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2196                nord = min(jlow, nord)}
\DoxyCodeLine{2197                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2198 \textcolor{comment}{!}}
\DoxyCodeLine{2199             \textcolor{keywordflow}{Case} (4:)}
\DoxyCodeLine{2200 \textcolor{comment}{!}}
\DoxyCodeLine{2201 \textcolor{comment}{!}}
\DoxyCodeLine{2202                xpiv0 = xpiv}
\DoxyCodeLine{2203                ifin = jhig}
\DoxyCodeLine{2204 \textcolor{comment}{!}}
\DoxyCodeLine{2205 \textcolor{comment}{!  One chooses a pivot from the 2 first values and the last one.}}
\DoxyCodeLine{2206 \textcolor{comment}{!  This should ensure sufficient renewal between iterations to}}
\DoxyCodeLine{2207 \textcolor{comment}{!  avoid worst case behavior effects.}}
\DoxyCodeLine{2208 \textcolor{comment}{!}}
\DoxyCodeLine{2209                iwrk1 = ihigt(1)}
\DoxyCodeLine{2210                iwrk2 = ihigt(2)}
\DoxyCodeLine{2211                iwrk3 = ihigt(ifin)}
\DoxyCodeLine{2212                \textcolor{keywordflow}{If} (invals(iwrk2) < invals(iwrk1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2213                   ihigt(1) = iwrk2}
\DoxyCodeLine{2214                   ihigt(2) = iwrk1}
\DoxyCodeLine{2215                   iwrk2 = iwrk1}
\DoxyCodeLine{2216 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2217                \textcolor{keywordflow}{If} (invals(iwrk2) > invals(iwrk3)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2218                   ihigt(ifin) = iwrk2}
\DoxyCodeLine{2219                   ihigt(2) = iwrk3}
\DoxyCodeLine{2220                   iwrk2 = iwrk3}
\DoxyCodeLine{2221                   \textcolor{keywordflow}{If} (invals(iwrk2) < invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2222                      ihigt(2) = ihigt(1)}
\DoxyCodeLine{2223                      ihigt(1) = iwrk2}
\DoxyCodeLine{2224 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{2225 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2226 \textcolor{comment}{!}}
\DoxyCodeLine{2227                jdeb = jlow}
\DoxyCodeLine{2228                nwrk = nord -\/ jlow}
\DoxyCodeLine{2229                iwrk1 = ihigt(1)}
\DoxyCodeLine{2230                xpiv = invals(iwrk1) + real(nwrk) / real(nord+nwrk) * \&}
\DoxyCodeLine{2231                                       (invals(ihigt(ifin))-\/invals(iwrk1))}
\DoxyCodeLine{2232 \textcolor{comment}{!}}
\DoxyCodeLine{2233 \textcolor{comment}{!  One takes values <= pivot to ILOWT}}
\DoxyCodeLine{2234 \textcolor{comment}{!  Again, 2 parts, one where we take care of the remaining}}
\DoxyCodeLine{2235 \textcolor{comment}{!  high values because we might still need them, and the}}
\DoxyCodeLine{2236 \textcolor{comment}{!  other when we know that we will have more than enough}}
\DoxyCodeLine{2237 \textcolor{comment}{!  low values in the end.}}
\DoxyCodeLine{2238 \textcolor{comment}{!}}
\DoxyCodeLine{2239                jhig = 0}
\DoxyCodeLine{2240                lowloop3: \textcolor{keywordflow}{Do} icrs = 1, ifin}
\DoxyCodeLine{2241                   \textcolor{keywordflow}{If} (invals(ihigt(icrs)) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2242                      \textcolor{keywordflow}{Do} ilow = 1, jlow}
\DoxyCodeLine{2243                         \textcolor{keywordflow}{If} (invals(ihigt(icrs)) == invals(ilowt(ilow))) \&}
\DoxyCodeLine{2244                             cycle lowloop3}
\DoxyCodeLine{2245 \textcolor{keywordflow}{                     End Do}}
\DoxyCodeLine{2246                      jlow = jlow + 1}
\DoxyCodeLine{2247                      ilowt(jlow) = ihigt(icrs)}
\DoxyCodeLine{2248                      \textcolor{keywordflow}{If} (jlow > nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2249                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2250                      jhig = jhig + 1}
\DoxyCodeLine{2251                      ihigt(jhig) = ihigt(icrs)}
\DoxyCodeLine{2252 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{2253 \textcolor{keywordflow}{               End Do} lowloop3}
\DoxyCodeLine{2254 \textcolor{comment}{!}}
\DoxyCodeLine{2255                \textcolor{keywordflow}{Do} icrs = icrs + 1, ifin}
\DoxyCodeLine{2256                   \textcolor{keywordflow}{If} (invals(ihigt(icrs)) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2257                      jlow = jlow + 1}
\DoxyCodeLine{2258                      ilowt(jlow) = ihigt(icrs)}
\DoxyCodeLine{2259 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{2260 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{2261 \textcolor{keywordflow}{           End Select}}
\DoxyCodeLine{2262 \textcolor{comment}{!}}
\DoxyCodeLine{2263 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{2264 \textcolor{comment}{!}}
\DoxyCodeLine{2265          \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{2266 \textcolor{comment}{!}}
\DoxyCodeLine{2267 \textcolor{comment}{!  Only 1 value is missing in low part}}
\DoxyCodeLine{2268 \textcolor{comment}{!}}
\DoxyCodeLine{2269             xmin = invals(ihigt(1))}
\DoxyCodeLine{2270             ihig = 1}
\DoxyCodeLine{2271             \textcolor{keywordflow}{Do} icrs = 2, jhig}
\DoxyCodeLine{2272                \textcolor{keywordflow}{If} (invals(ihigt(icrs)) < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2273                   xmin = invals(ihigt(icrs))}
\DoxyCodeLine{2274                   ihig = icrs}
\DoxyCodeLine{2275 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2276 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{2277 \textcolor{comment}{!}}
\DoxyCodeLine{2278             jlow = jlow + 1}
\DoxyCodeLine{2279             ilowt(jlow) = ihigt(ihig)}
\DoxyCodeLine{2280             \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2281 \textcolor{comment}{!}}
\DoxyCodeLine{2282 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{2283 \textcolor{comment}{!}}
\DoxyCodeLine{2284          \textcolor{keywordflow}{Case} (0)}
\DoxyCodeLine{2285 \textcolor{comment}{!}}
\DoxyCodeLine{2286 \textcolor{comment}{!  Low part is exactly what we want}}
\DoxyCodeLine{2287 \textcolor{comment}{!}}
\DoxyCodeLine{2288             \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2289 \textcolor{comment}{!}}
\DoxyCodeLine{2290 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{2291 \textcolor{comment}{!}}
\DoxyCodeLine{2292          \textcolor{keywordflow}{Case} (-\/5:-\/1)}
\DoxyCodeLine{2293 \textcolor{comment}{!}}
\DoxyCodeLine{2294 \textcolor{comment}{!  Only few values too many in low part}}
\DoxyCodeLine{2295 \textcolor{comment}{!}}
\DoxyCodeLine{2296             irngt(1) = ilowt(1)}
\DoxyCodeLine{2297             \textcolor{keywordflow}{Do} icrs = 2, nord}
\DoxyCodeLine{2298                iwrk = ilowt(icrs)}
\DoxyCodeLine{2299                xwrk = invals(iwrk)}
\DoxyCodeLine{2300                \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{2301                   \textcolor{keywordflow}{If} (xwrk < invals(irngt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2302                      irngt(idcr+1) = irngt(idcr)}
\DoxyCodeLine{2303                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2304                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2305 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{2306 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{2307                irngt(idcr+1) = iwrk}
\DoxyCodeLine{2308 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{2309 \textcolor{comment}{!}}
\DoxyCodeLine{2310             xwrk1 = invals(irngt(nord))}
\DoxyCodeLine{2311             insert1: \textcolor{keywordflow}{Do} icrs = nord + 1, jlow}
\DoxyCodeLine{2312                \textcolor{keywordflow}{If} (invals(ilowt(icrs)) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2313                   xwrk = invals(ilowt(icrs))}
\DoxyCodeLine{2314                   \textcolor{keywordflow}{Do} ilow = 1, nord -\/ 1}
\DoxyCodeLine{2315                      \textcolor{keywordflow}{If} (xwrk <= invals(irngt(ilow))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2316                         \textcolor{keywordflow}{If} (xwrk == invals(irngt(ilow))) cycle insert1}
\DoxyCodeLine{2317                         \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2318 \textcolor{keywordflow}{                     End If}}
\DoxyCodeLine{2319 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{2320                   \textcolor{keywordflow}{Do} idcr = nord -\/ 1, ilow, -\/ 1}
\DoxyCodeLine{2321                      irngt(idcr+1) = irngt(idcr)}
\DoxyCodeLine{2322 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{2323                   irngt(idcr+1) = ilowt(icrs)}
\DoxyCodeLine{2324                   xwrk1 = invals(irngt(nord))}
\DoxyCodeLine{2325 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2326 \textcolor{keywordflow}{            End Do} insert1}
\DoxyCodeLine{2327 \textcolor{comment}{!}}
\DoxyCodeLine{2328             \textcolor{keywordflow}{Return}}
\DoxyCodeLine{2329 \textcolor{comment}{!}}
\DoxyCodeLine{2330 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{2331 \textcolor{comment}{!}}
\DoxyCodeLine{2332          \textcolor{keywordflow}{Case} (:-\/6)}
\DoxyCodeLine{2333 \textcolor{comment}{!}}
\DoxyCodeLine{2334 \textcolor{comment}{! last case: too many values in low part}}
\DoxyCodeLine{2335 \textcolor{comment}{!}}
\DoxyCodeLine{2336             ideb = jdeb + 1}
\DoxyCodeLine{2337             imil = min((jlow+ideb) / 2, nord)}
\DoxyCodeLine{2338             ifin = min(jlow, nord+1)}
\DoxyCodeLine{2339 \textcolor{comment}{!}}
\DoxyCodeLine{2340 \textcolor{comment}{!  One chooses a pivot from 1st, last, and middle values}}
\DoxyCodeLine{2341 \textcolor{comment}{!}}
\DoxyCodeLine{2342             \textcolor{keywordflow}{If} (invals(ilowt(imil)) < invals(ilowt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2343                iwrk = ilowt(ideb)}
\DoxyCodeLine{2344                ilowt(ideb) = ilowt(imil)}
\DoxyCodeLine{2345                ilowt(imil) = iwrk}
\DoxyCodeLine{2346 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{2347             \textcolor{keywordflow}{If} (invals(ilowt(imil)) > invals(ilowt(ifin))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2348                iwrk = ilowt(ifin)}
\DoxyCodeLine{2349                ilowt(ifin) = ilowt(imil)}
\DoxyCodeLine{2350                ilowt(imil) = iwrk}
\DoxyCodeLine{2351                \textcolor{keywordflow}{If} (invals(ilowt(imil)) < invals(ilowt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2352                   iwrk = ilowt(ideb)}
\DoxyCodeLine{2353                   ilowt(ideb) = ilowt(imil)}
\DoxyCodeLine{2354                   ilowt(imil) = iwrk}
\DoxyCodeLine{2355 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2356 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{2357             \textcolor{keywordflow}{If} (ifin <= 3) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2358 \textcolor{comment}{!}}
\DoxyCodeLine{2359             xpiv = invals(ilowt(ideb)) + real(nord)/real(jlow+nord) * \&}
\DoxyCodeLine{2360                                       (invals(ilowt(ifin))-\/invals(ilowt(1)))}
\DoxyCodeLine{2361             \textcolor{keywordflow}{If} (jdeb > 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2362                \textcolor{keywordflow}{If} (xpiv <= xpiv0) \&}
\DoxyCodeLine{2363                    xpiv = xpiv0 + real(2*nord-\/jdeb)/real(jlow+nord) * \&}
\DoxyCodeLine{2364                                   (invals(ilowt(ifin))-\/xpiv0)}
\DoxyCodeLine{2365             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2366                ideb = 1}
\DoxyCodeLine{2367 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{2368 \textcolor{comment}{!}}
\DoxyCodeLine{2369 \textcolor{comment}{!  One takes values > XPIV to IHIGT}}
\DoxyCodeLine{2370 \textcolor{comment}{!  However, we do not process the first values if we have been}}
\DoxyCodeLine{2371 \textcolor{comment}{!  through the case when we did not have enough low values}}
\DoxyCodeLine{2372 \textcolor{comment}{!}}
\DoxyCodeLine{2373             jhig = 0}
\DoxyCodeLine{2374             ifin = jlow}
\DoxyCodeLine{2375             jlow = jdeb}
\DoxyCodeLine{2376 \textcolor{comment}{!}}
\DoxyCodeLine{2377             \textcolor{keywordflow}{If} (invals(ilowt(ifin)) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2378                icrs = jdeb}
\DoxyCodeLine{2379               lowloop4: \textcolor{keywordflow}{Do}}
\DoxyCodeLine{2380                  icrs = icrs + 1}
\DoxyCodeLine{2381                   \textcolor{keywordflow}{If} (invals(ilowt(icrs)) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2382                      jhig = jhig + 1}
\DoxyCodeLine{2383                      ihigt(jhig) = ilowt(icrs)}
\DoxyCodeLine{2384                      \textcolor{keywordflow}{If} (icrs >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2385                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2386                      xwrk1 = invals(ilowt(icrs))}
\DoxyCodeLine{2387                      \textcolor{keywordflow}{Do} ilow = ideb, jlow}
\DoxyCodeLine{2388                         \textcolor{keywordflow}{If} (xwrk1 == invals(ilowt(ilow))) \&}
\DoxyCodeLine{2389                             cycle lowloop4}
\DoxyCodeLine{2390 \textcolor{keywordflow}{                     End Do}}
\DoxyCodeLine{2391                      jlow = jlow + 1}
\DoxyCodeLine{2392                      ilowt(jlow) = ilowt(icrs)}
\DoxyCodeLine{2393                      \textcolor{keywordflow}{If} (jlow >= nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2394 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{2395 \textcolor{keywordflow}{               End Do} lowloop4}
\DoxyCodeLine{2396 \textcolor{comment}{!}}
\DoxyCodeLine{2397                \textcolor{keywordflow}{If} (icrs < ifin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2398                   \textcolor{keywordflow}{Do}}
\DoxyCodeLine{2399                      icrs = icrs + 1}
\DoxyCodeLine{2400                      \textcolor{keywordflow}{If} (invals(ilowt(icrs)) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2401                         jlow = jlow + 1}
\DoxyCodeLine{2402                         ilowt(jlow) = ilowt(icrs)}
\DoxyCodeLine{2403                      \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2404                         \textcolor{keywordflow}{If} (icrs >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2405 \textcolor{keywordflow}{                     End If}}
\DoxyCodeLine{2406 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{2407 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2408            \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2409               lowloop5: \textcolor{keywordflow}{Do} icrs = ideb, ifin}
\DoxyCodeLine{2410                   \textcolor{keywordflow}{If} (invals(ilowt(icrs)) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2411                      jhig = jhig + 1}
\DoxyCodeLine{2412                      ihigt(jhig) = ilowt(icrs)}
\DoxyCodeLine{2413                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2414                      xwrk1 = invals(ilowt(icrs))}
\DoxyCodeLine{2415                      \textcolor{keywordflow}{Do} ilow = ideb, jlow}
\DoxyCodeLine{2416                         \textcolor{keywordflow}{If} (xwrk1 == invals(ilowt(ilow))) \&}
\DoxyCodeLine{2417                             cycle lowloop5}
\DoxyCodeLine{2418 \textcolor{keywordflow}{                     End Do}}
\DoxyCodeLine{2419                      jlow = jlow + 1}
\DoxyCodeLine{2420                      ilowt(jlow) = ilowt(icrs)}
\DoxyCodeLine{2421                      \textcolor{keywordflow}{If} (jlow >= nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2422 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{2423 \textcolor{keywordflow}{               End Do} lowloop5}
\DoxyCodeLine{2424 \textcolor{comment}{!}}
\DoxyCodeLine{2425                \textcolor{keywordflow}{Do} icrs = icrs + 1, ifin}
\DoxyCodeLine{2426                   \textcolor{keywordflow}{If} (invals(ilowt(icrs)) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2427                      jlow = jlow + 1}
\DoxyCodeLine{2428                      ilowt(jlow) = ilowt(icrs)}
\DoxyCodeLine{2429 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{2430 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{2431 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{2432 \textcolor{comment}{!}}
\DoxyCodeLine{2433 \textcolor{keywordflow}{         End Select}}
\DoxyCodeLine{2434 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{2435 \textcolor{comment}{!}}
\DoxyCodeLine{2436 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{2437 \textcolor{comment}{!}}
\DoxyCodeLine{2438 \textcolor{comment}{!  Now, we only need to complete ranking of the 1:NORD set}}
\DoxyCodeLine{2439 \textcolor{comment}{!  Assuming NORD is small, we use a simple insertion sort}}
\DoxyCodeLine{2440 \textcolor{comment}{!}}
\DoxyCodeLine{2441       irngt(1) = ilowt(1)}
\DoxyCodeLine{2442       \textcolor{keywordflow}{Do} icrs = 2, nord}
\DoxyCodeLine{2443          iwrk = ilowt(icrs)}
\DoxyCodeLine{2444          xwrk = invals(iwrk)}
\DoxyCodeLine{2445          \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{2446             \textcolor{keywordflow}{If} (xwrk < invals(irngt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2447                irngt(idcr+1) = irngt(idcr)}
\DoxyCodeLine{2448             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2449                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2450 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{2451 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{2452          irngt(idcr+1) = iwrk}
\DoxyCodeLine{2453 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{2454      \textcolor{keywordflow}{Return}}
\DoxyCodeLine{2455 \textcolor{comment}{!}}
\DoxyCodeLine{2456 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__orderpack____unipar_ab8b2a825259781eb3dc0c3804316404f}\label{namespacem__orderpack____unipar_ab8b2a825259781eb3dc0c3804316404f}} 
\index{m\_orderpack\_\_unipar@{m\_orderpack\_\_unipar}!int64\_unipar@{int64\_unipar}}
\index{int64\_unipar@{int64\_unipar}!m\_orderpack\_\_unipar@{m\_orderpack\_\_unipar}}
\doxysubsubsection{\texorpdfstring{int64\_unipar()}{int64\_unipar()}}
{\footnotesize\ttfamily subroutine m\+\_\+orderpack\+\_\+\+\_\+unipar\+::int64\+\_\+unipar (\begin{DoxyParamCaption}\item[{integer (kind=int64), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, dimension (\+:), intent(out)}]{I\+R\+N\+GT,  }\item[{integer, intent(inout)}]{N\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{2460 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{2461    \textcolor{keywordtype}{Integer (kind=int64)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: INVALS}
\DoxyCodeLine{2462    \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IRNGT}
\DoxyCodeLine{2463    \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (InOut)} :: NORD}
\DoxyCodeLine{2464 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{2465    \textcolor{keywordtype}{Integer (kind=int64)} :: XPIV, XWRK, XWRK1, XMIN, XMAX, XPIV0}
\DoxyCodeLine{2466 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{2467    \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(INVALS))} :: ILOWT, IHIGT}
\DoxyCodeLine{2468    \textcolor{keywordtype}{Integer} :: NDON, JHIG, JLOW, IHIG, IWRK, IWRK1, IWRK2, IWRK3}
\DoxyCodeLine{2469    \textcolor{keywordtype}{Integer} :: IDEB, JDEB, IMIL, IFIN, NWRK, ICRS, IDCR, ILOW}
\DoxyCodeLine{2470    \textcolor{keywordtype}{Integer} :: JLM2, JLM1, JHM2, JHM1}
\DoxyCodeLine{2471 \textcolor{comment}{!}}
\DoxyCodeLine{2472       ndon = \textcolor{keyword}{SIZE} (invals)}
\DoxyCodeLine{2473 \textcolor{comment}{!}}
\DoxyCodeLine{2474 \textcolor{comment}{!    First loop is used to fill-\/in ILOWT, IHIGT at the same time}}
\DoxyCodeLine{2475 \textcolor{comment}{!}}
\DoxyCodeLine{2476       \textcolor{keywordflow}{If} (ndon < 2) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2477          \textcolor{keywordflow}{If} (nord >= 1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2478             nord = 1}
\DoxyCodeLine{2479             irngt(1) = 1}
\DoxyCodeLine{2480 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{2481          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{2482 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{2483 \textcolor{comment}{!}}
\DoxyCodeLine{2484 \textcolor{comment}{!  One chooses a pivot, best estimate possible to put fractile near}}
\DoxyCodeLine{2485 \textcolor{comment}{!  mid-\/point of the set of low values.}}
\DoxyCodeLine{2486 \textcolor{comment}{!}}
\DoxyCodeLine{2487      ihigt=1}
\DoxyCodeLine{2488      ilowt=1}
\DoxyCodeLine{2489 }
\DoxyCodeLine{2490      \textcolor{keywordflow}{Do} icrs = 2, ndon}
\DoxyCodeLine{2491         \textcolor{keywordflow}{If} (invals(icrs) == invals(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2492           cycle}
\DoxyCodeLine{2493         \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (invals(icrs) < invals(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2494            ilowt(1) = icrs}
\DoxyCodeLine{2495            ihigt(1) = 1}
\DoxyCodeLine{2496         \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2497            ilowt(1) = 1}
\DoxyCodeLine{2498            ihigt(1) = icrs}
\DoxyCodeLine{2499 \textcolor{keywordflow}{        End If}}
\DoxyCodeLine{2500         \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2501 \textcolor{keywordflow}{     End Do}}
\DoxyCodeLine{2502 \textcolor{comment}{!}}
\DoxyCodeLine{2503       \textcolor{keywordflow}{If} (ndon <= icrs) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2504          nord = min(nord, 2)}
\DoxyCodeLine{2505          \textcolor{keywordflow}{If} (nord >= 1) irngt(1) = ilowt(1)}
\DoxyCodeLine{2506          \textcolor{keywordflow}{If} (nord >= 2) irngt(2) = ihigt(1)}
\DoxyCodeLine{2507          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{2508 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{2509 \textcolor{comment}{!}}
\DoxyCodeLine{2510       icrs = icrs + 1}
\DoxyCodeLine{2511       jhig = 1}
\DoxyCodeLine{2512       \textcolor{keywordflow}{If} (invals(icrs) < invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2513          \textcolor{keywordflow}{If} (invals(icrs) < invals(ilowt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2514             jhig = jhig + 1}
\DoxyCodeLine{2515             ihigt(jhig) = ihigt(1)}
\DoxyCodeLine{2516             ihigt(1) = ilowt(1)}
\DoxyCodeLine{2517             ilowt(1) = icrs}
\DoxyCodeLine{2518          \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (invals(icrs) > invals(ilowt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2519             jhig = jhig + 1}
\DoxyCodeLine{2520             ihigt(jhig) = ihigt(1)}
\DoxyCodeLine{2521             ihigt(1) = icrs}
\DoxyCodeLine{2522 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{2523       \textcolor{keywordflow}{ElseIf} (invals(icrs) > invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2524          jhig = jhig + 1}
\DoxyCodeLine{2525          ihigt(jhig) = icrs}
\DoxyCodeLine{2526 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{2527 \textcolor{comment}{!}}
\DoxyCodeLine{2528       \textcolor{keywordflow}{If} (ndon <= icrs) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2529          nord = min(nord, jhig+1)}
\DoxyCodeLine{2530          \textcolor{keywordflow}{If} (nord >= 1) irngt(1) = ilowt(1)}
\DoxyCodeLine{2531          \textcolor{keywordflow}{If} (nord >= 2) irngt(2) = ihigt(1)}
\DoxyCodeLine{2532          \textcolor{keywordflow}{If} (nord >= 3) irngt(3) = ihigt(2)}
\DoxyCodeLine{2533          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{2534 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{2535 \textcolor{comment}{!}}
\DoxyCodeLine{2536       \textcolor{keywordflow}{If} (invals(ndon) < invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2537          \textcolor{keywordflow}{If} (invals(ndon) < invals(ilowt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2538             \textcolor{keywordflow}{Do} idcr = jhig, 1, -\/1}
\DoxyCodeLine{2539               ihigt(idcr+1) = ihigt(idcr)}
\DoxyCodeLine{2540 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{2541             ihigt(1) = ilowt(1)}
\DoxyCodeLine{2542             ilowt(1) = ndon}
\DoxyCodeLine{2543             jhig = jhig + 1}
\DoxyCodeLine{2544          \textcolor{keywordflow}{ElseIf} (invals(ndon) > invals(ilowt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2545             \textcolor{keywordflow}{Do} idcr = jhig, 1, -\/1}
\DoxyCodeLine{2546               ihigt(idcr+1) = ihigt(idcr)}
\DoxyCodeLine{2547 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{2548             ihigt(1) = ndon}
\DoxyCodeLine{2549             jhig = jhig + 1}
\DoxyCodeLine{2550 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{2551       \textcolor{keywordflow}{ElseIf} (invals(ndon) > invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2552          jhig = jhig + 1}
\DoxyCodeLine{2553          ihigt(jhig) = ndon}
\DoxyCodeLine{2554 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{2555 \textcolor{comment}{!}}
\DoxyCodeLine{2556       \textcolor{keywordflow}{If} (ndon <= icrs+1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2557          nord = min(nord, jhig+1)}
\DoxyCodeLine{2558          \textcolor{keywordflow}{If} (nord >= 1) irngt(1) = ilowt(1)}
\DoxyCodeLine{2559          \textcolor{keywordflow}{If} (nord >= 2) irngt(2) = ihigt(1)}
\DoxyCodeLine{2560          \textcolor{keywordflow}{If} (nord >= 3) irngt(3) = ihigt(2)}
\DoxyCodeLine{2561          \textcolor{keywordflow}{If} (nord >= 4) irngt(4) = ihigt(3)}
\DoxyCodeLine{2562          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{2563 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{2564 \textcolor{comment}{!}}
\DoxyCodeLine{2565       jdeb = 0}
\DoxyCodeLine{2566       ideb = jdeb + 1}
\DoxyCodeLine{2567       jlow = ideb}
\DoxyCodeLine{2568       xpiv = invals(ilowt(ideb)) + real(2*nord)/real(ndon+nord) * \&}
\DoxyCodeLine{2569                                    (invals(ihigt(3))-\/invals(ilowt(ideb)))}
\DoxyCodeLine{2570       \textcolor{keywordflow}{If} (xpiv >= invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2571          xpiv = invals(ilowt(ideb)) + real(2*nord)/real(ndon+nord) * \&}
\DoxyCodeLine{2572                                       (invals(ihigt(2))-\/invals(ilowt(ideb)))}
\DoxyCodeLine{2573          \textcolor{keywordflow}{If} (xpiv >= invals(ihigt(1))) \&}
\DoxyCodeLine{2574              xpiv = invals(ilowt(ideb)) + real(2*nord) / real(ndon+nord) * \&}
\DoxyCodeLine{2575                                           (invals(ihigt(1))-\/invals(ilowt(ideb)))}
\DoxyCodeLine{2576 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{2577       xpiv0 = xpiv}
\DoxyCodeLine{2578 \textcolor{comment}{!}}
\DoxyCodeLine{2579 \textcolor{comment}{!  One puts values > pivot in the end and those <= pivot}}
\DoxyCodeLine{2580 \textcolor{comment}{!  at the beginning. This is split in 2 cases, so that}}
\DoxyCodeLine{2581 \textcolor{comment}{!  we can skip the loop test a number of times.}}
\DoxyCodeLine{2582 \textcolor{comment}{!  As we are also filling in the work arrays at the same time}}
\DoxyCodeLine{2583 \textcolor{comment}{!  we stop filling in the IHIGT array as soon as we have more}}
\DoxyCodeLine{2584 \textcolor{comment}{!  than enough values in ILOWT, i.e. one more than}}
\DoxyCodeLine{2585 \textcolor{comment}{!  strictly necessary so as to be able to come out of the}}
\DoxyCodeLine{2586 \textcolor{comment}{!  case where JLOWT would be NORD distinct values followed}}
\DoxyCodeLine{2587 \textcolor{comment}{!  by values that are exclusively duplicates of these.}}
\DoxyCodeLine{2588 \textcolor{comment}{!}}
\DoxyCodeLine{2589 \textcolor{comment}{!}}
\DoxyCodeLine{2590       \textcolor{keywordflow}{If} (invals(ndon) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2591          lowloop1: \textcolor{keywordflow}{Do}}
\DoxyCodeLine{2592             icrs = icrs + 1}
\DoxyCodeLine{2593             \textcolor{keywordflow}{If} (invals(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2594                \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2595                jhig = jhig + 1}
\DoxyCodeLine{2596                ihigt(jhig) = icrs}
\DoxyCodeLine{2597             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2598                \textcolor{keywordflow}{Do} ilow = 1, jlow}
\DoxyCodeLine{2599                  \textcolor{keywordflow}{If} (invals(icrs) == invals(ilowt(ilow))) cycle lowloop1}
\DoxyCodeLine{2600 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{2601                jlow = jlow + 1}
\DoxyCodeLine{2602                ilowt(jlow) = icrs}
\DoxyCodeLine{2603                \textcolor{keywordflow}{If} (jlow >= nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2604 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{2605 \textcolor{keywordflow}{         End Do} lowloop1}
\DoxyCodeLine{2606 \textcolor{comment}{!}}
\DoxyCodeLine{2607 \textcolor{comment}{!  One restricts further processing because it is no use}}
\DoxyCodeLine{2608 \textcolor{comment}{!  to store more high values}}
\DoxyCodeLine{2609 \textcolor{comment}{!}}
\DoxyCodeLine{2610          \textcolor{keywordflow}{If} (icrs < ndon-\/1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2611             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{2612                icrs = icrs + 1}
\DoxyCodeLine{2613                \textcolor{keywordflow}{If} (invals(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2614                   jlow = jlow + 1}
\DoxyCodeLine{2615                   ilowt(jlow) = icrs}
\DoxyCodeLine{2616                \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2617                   \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2618 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2619 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{2620 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{2621 \textcolor{comment}{!}}
\DoxyCodeLine{2622 \textcolor{comment}{!}}
\DoxyCodeLine{2623       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2624 \textcolor{comment}{!}}
\DoxyCodeLine{2625 \textcolor{comment}{!  Same as above, but this is not as easy to optimize, so the}}
\DoxyCodeLine{2626 \textcolor{comment}{!  DO-\/loop is kept}}
\DoxyCodeLine{2627 \textcolor{comment}{!}}
\DoxyCodeLine{2628          lowloop2: \textcolor{keywordflow}{Do} icrs = icrs + 1, ndon -\/ 1}
\DoxyCodeLine{2629             \textcolor{keywordflow}{If} (invals(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2630                jhig = jhig + 1}
\DoxyCodeLine{2631                ihigt(jhig) = icrs}
\DoxyCodeLine{2632             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2633                \textcolor{keywordflow}{Do} ilow = 1, jlow}
\DoxyCodeLine{2634                  \textcolor{keywordflow}{If} (invals(icrs) == invals(ilowt(ilow))) cycle lowloop2}
\DoxyCodeLine{2635 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{2636                jlow = jlow + 1}
\DoxyCodeLine{2637                ilowt(jlow) = icrs}
\DoxyCodeLine{2638                \textcolor{keywordflow}{If} (jlow >= nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2639 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{2640 \textcolor{keywordflow}{         End Do} lowloop2}
\DoxyCodeLine{2641 \textcolor{comment}{!}}
\DoxyCodeLine{2642          \textcolor{keywordflow}{If} (icrs < ndon-\/1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2643             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{2644                icrs = icrs + 1}
\DoxyCodeLine{2645                \textcolor{keywordflow}{If} (invals(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2646                   \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2647                   jlow = jlow + 1}
\DoxyCodeLine{2648                   ilowt(jlow) = icrs}
\DoxyCodeLine{2649 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2650 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{2651 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{2652 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{2653 \textcolor{comment}{!}}
\DoxyCodeLine{2654       jlm2 = 0}
\DoxyCodeLine{2655       jlm1 = 0}
\DoxyCodeLine{2656       jhm2 = 0}
\DoxyCodeLine{2657       jhm1 = 0}
\DoxyCodeLine{2658       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{2659          \textcolor{keywordflow}{if} (jlow == nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2660          \textcolor{keywordflow}{If} (jlm2 == jlow .And. jhm2 == jhig) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2661 \textcolor{comment}{!}}
\DoxyCodeLine{2662 \textcolor{comment}{!   We are oscillating. Perturbate by bringing JLOW closer by one}}
\DoxyCodeLine{2663 \textcolor{comment}{!   to NORD}}
\DoxyCodeLine{2664 \textcolor{comment}{!}}
\DoxyCodeLine{2665            \textcolor{keywordflow}{If} (nord > jlow) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2666                 xmin = invals(ihigt(1))}
\DoxyCodeLine{2667                 ihig = 1}
\DoxyCodeLine{2668                 \textcolor{keywordflow}{Do} icrs = 2, jhig}
\DoxyCodeLine{2669                    \textcolor{keywordflow}{If} (invals(ihigt(icrs)) < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2670                       xmin = invals(ihigt(icrs))}
\DoxyCodeLine{2671                       ihig = icrs}
\DoxyCodeLine{2672 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{2673 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{2674 \textcolor{comment}{!}}
\DoxyCodeLine{2675                 jlow = jlow + 1}
\DoxyCodeLine{2676                 ilowt(jlow) = ihigt(ihig)}
\DoxyCodeLine{2677                 ihig = 0}
\DoxyCodeLine{2678                 \textcolor{keywordflow}{Do} icrs = 1, jhig}
\DoxyCodeLine{2679                    \textcolor{keywordflow}{If} (invals(ihigt(icrs)) /= xmin) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2680                       ihig = ihig + 1}
\DoxyCodeLine{2681                       ihigt(ihig ) = ihigt(icrs)}
\DoxyCodeLine{2682 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{2683 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{2684                 jhig = ihig}
\DoxyCodeLine{2685              \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2686                 ilow = ilowt(jlow)}
\DoxyCodeLine{2687                 xmax = invals(ilow)}
\DoxyCodeLine{2688                 \textcolor{keywordflow}{Do} icrs = 1, jlow}
\DoxyCodeLine{2689                    \textcolor{keywordflow}{If} (invals(ilowt(icrs)) > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2690                       iwrk = ilowt(icrs)}
\DoxyCodeLine{2691                       xmax = invals(iwrk)}
\DoxyCodeLine{2692                       ilowt(icrs) = ilow}
\DoxyCodeLine{2693                       ilow = iwrk}
\DoxyCodeLine{2694 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{2695 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{2696                 jlow = jlow -\/ 1}
\DoxyCodeLine{2697 \textcolor{keywordflow}{             End If}}
\DoxyCodeLine{2698 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{2699          jlm2 = jlm1}
\DoxyCodeLine{2700          jlm1 = jlow}
\DoxyCodeLine{2701          jhm2 = jhm1}
\DoxyCodeLine{2702          jhm1 = jhig}
\DoxyCodeLine{2703 \textcolor{comment}{!}}
\DoxyCodeLine{2704 \textcolor{comment}{!   We try to bring the number of values in the low values set}}
\DoxyCodeLine{2705 \textcolor{comment}{!   closer to NORD. In order to make better pivot choices, we}}
\DoxyCodeLine{2706 \textcolor{comment}{!   decrease NORD if we already know that we don't have that}}
\DoxyCodeLine{2707 \textcolor{comment}{!   many distinct values as a whole.}}
\DoxyCodeLine{2708 \textcolor{comment}{!}}
\DoxyCodeLine{2709          \textcolor{keywordflow}{IF} (jlow+jhig < nord) nord = jlow+jhig}
\DoxyCodeLine{2710          \textcolor{keywordflow}{Select Case} (nord-\/jlow)}
\DoxyCodeLine{2711 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{2712          \textcolor{keywordflow}{Case} (2:)}
\DoxyCodeLine{2713 \textcolor{comment}{!}}
\DoxyCodeLine{2714 \textcolor{comment}{!   Not enough values in low part, at least 2 are missing}}
\DoxyCodeLine{2715 \textcolor{comment}{!}}
\DoxyCodeLine{2716             \textcolor{keywordflow}{Select Case} (jhig)}
\DoxyCodeLine{2717 \textcolor{comment}{!}}
\DoxyCodeLine{2718 \textcolor{comment}{!   Not enough values in high part either (too many duplicates)}}
\DoxyCodeLine{2719 \textcolor{comment}{!}}
\DoxyCodeLine{2720             \textcolor{keywordflow}{Case} (0)}
\DoxyCodeLine{2721                nord = jlow}
\DoxyCodeLine{2722 \textcolor{comment}{!}}
\DoxyCodeLine{2723             \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{2724                jlow = jlow + 1}
\DoxyCodeLine{2725                ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{2726                nord = jlow}
\DoxyCodeLine{2727 \textcolor{comment}{!}}
\DoxyCodeLine{2728 \textcolor{comment}{!   We make a special case when we have so few values in}}
\DoxyCodeLine{2729 \textcolor{comment}{!   the high values set that it is bad performance to choose a pivot}}
\DoxyCodeLine{2730 \textcolor{comment}{!   and apply the general algorithm.}}
\DoxyCodeLine{2731 \textcolor{comment}{!}}
\DoxyCodeLine{2732             \textcolor{keywordflow}{Case} (2)}
\DoxyCodeLine{2733                \textcolor{keywordflow}{If} (invals(ihigt(1)) <= invals(ihigt(2))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2734                   jlow = jlow + 1}
\DoxyCodeLine{2735                   ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{2736                   jlow = jlow + 1}
\DoxyCodeLine{2737                   ilowt(jlow) = ihigt(2)}
\DoxyCodeLine{2738                \textcolor{keywordflow}{ElseIf} (invals(ihigt(1)) == invals(ihigt(2))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2739                   jlow = jlow + 1}
\DoxyCodeLine{2740                   ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{2741                   nord = jlow}
\DoxyCodeLine{2742                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2743                   jlow = jlow + 1}
\DoxyCodeLine{2744                   ilowt(jlow) = ihigt(2)}
\DoxyCodeLine{2745                   jlow = jlow + 1}
\DoxyCodeLine{2746                   ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{2747 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2748                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2749 \textcolor{comment}{!}}
\DoxyCodeLine{2750             \textcolor{keywordflow}{Case} (3)}
\DoxyCodeLine{2751 \textcolor{comment}{!}}
\DoxyCodeLine{2752 \textcolor{comment}{!}}
\DoxyCodeLine{2753                iwrk1 = ihigt(1)}
\DoxyCodeLine{2754                iwrk2 = ihigt(2)}
\DoxyCodeLine{2755                iwrk3 = ihigt(3)}
\DoxyCodeLine{2756                \textcolor{keywordflow}{If} (invals(iwrk2) < invals(iwrk1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2757                   ihigt(1) = iwrk2}
\DoxyCodeLine{2758                   ihigt(2) = iwrk1}
\DoxyCodeLine{2759                   iwrk2 = iwrk1}
\DoxyCodeLine{2760 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2761                \textcolor{keywordflow}{If} (invals(iwrk2) > invals(iwrk3)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2762                   ihigt(3) = iwrk2}
\DoxyCodeLine{2763                   ihigt(2) = iwrk3}
\DoxyCodeLine{2764                   iwrk2 = iwrk3}
\DoxyCodeLine{2765                   \textcolor{keywordflow}{If} (invals(iwrk2) < invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2766                      ihigt(2) = ihigt(1)}
\DoxyCodeLine{2767                      ihigt(1) = iwrk2}
\DoxyCodeLine{2768 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{2769 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2770                jhig = 1}
\DoxyCodeLine{2771                jlow = jlow + 1}
\DoxyCodeLine{2772                ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{2773                jhig = jhig + 1}
\DoxyCodeLine{2774                \textcolor{keywordflow}{IF} (invals(ihigt(jhig)) /= invals(ilowt(jlow))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2775                  jlow = jlow + 1}
\DoxyCodeLine{2776                  ilowt(jlow) = ihigt(jhig)}
\DoxyCodeLine{2777 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2778                jhig = jhig + 1}
\DoxyCodeLine{2779                \textcolor{keywordflow}{IF} (invals(ihigt(jhig)) /= invals(ilowt(jlow))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2780                  jlow = jlow + 1}
\DoxyCodeLine{2781                  ilowt(jlow) = ihigt(jhig)}
\DoxyCodeLine{2782 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2783                nord = min(jlow, nord)}
\DoxyCodeLine{2784                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2785 \textcolor{comment}{!}}
\DoxyCodeLine{2786             \textcolor{keywordflow}{Case} (4:)}
\DoxyCodeLine{2787 \textcolor{comment}{!}}
\DoxyCodeLine{2788 \textcolor{comment}{!}}
\DoxyCodeLine{2789                xpiv0 = xpiv}
\DoxyCodeLine{2790                ifin = jhig}
\DoxyCodeLine{2791 \textcolor{comment}{!}}
\DoxyCodeLine{2792 \textcolor{comment}{!  One chooses a pivot from the 2 first values and the last one.}}
\DoxyCodeLine{2793 \textcolor{comment}{!  This should ensure sufficient renewal between iterations to}}
\DoxyCodeLine{2794 \textcolor{comment}{!  avoid worst case behavior effects.}}
\DoxyCodeLine{2795 \textcolor{comment}{!}}
\DoxyCodeLine{2796                iwrk1 = ihigt(1)}
\DoxyCodeLine{2797                iwrk2 = ihigt(2)}
\DoxyCodeLine{2798                iwrk3 = ihigt(ifin)}
\DoxyCodeLine{2799                \textcolor{keywordflow}{If} (invals(iwrk2) < invals(iwrk1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2800                   ihigt(1) = iwrk2}
\DoxyCodeLine{2801                   ihigt(2) = iwrk1}
\DoxyCodeLine{2802                   iwrk2 = iwrk1}
\DoxyCodeLine{2803 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2804                \textcolor{keywordflow}{If} (invals(iwrk2) > invals(iwrk3)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2805                   ihigt(ifin) = iwrk2}
\DoxyCodeLine{2806                   ihigt(2) = iwrk3}
\DoxyCodeLine{2807                   iwrk2 = iwrk3}
\DoxyCodeLine{2808                   \textcolor{keywordflow}{If} (invals(iwrk2) < invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2809                      ihigt(2) = ihigt(1)}
\DoxyCodeLine{2810                      ihigt(1) = iwrk2}
\DoxyCodeLine{2811 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{2812 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2813 \textcolor{comment}{!}}
\DoxyCodeLine{2814                jdeb = jlow}
\DoxyCodeLine{2815                nwrk = nord -\/ jlow}
\DoxyCodeLine{2816                iwrk1 = ihigt(1)}
\DoxyCodeLine{2817                xpiv = invals(iwrk1) + real(nwrk) / real(nord+nwrk) * \&}
\DoxyCodeLine{2818                                       (invals(ihigt(ifin))-\/invals(iwrk1))}
\DoxyCodeLine{2819 \textcolor{comment}{!}}
\DoxyCodeLine{2820 \textcolor{comment}{!  One takes values <= pivot to ILOWT}}
\DoxyCodeLine{2821 \textcolor{comment}{!  Again, 2 parts, one where we take care of the remaining}}
\DoxyCodeLine{2822 \textcolor{comment}{!  high values because we might still need them, and the}}
\DoxyCodeLine{2823 \textcolor{comment}{!  other when we know that we will have more than enough}}
\DoxyCodeLine{2824 \textcolor{comment}{!  low values in the end.}}
\DoxyCodeLine{2825 \textcolor{comment}{!}}
\DoxyCodeLine{2826                jhig = 0}
\DoxyCodeLine{2827                lowloop3: \textcolor{keywordflow}{Do} icrs = 1, ifin}
\DoxyCodeLine{2828                   \textcolor{keywordflow}{If} (invals(ihigt(icrs)) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2829                      \textcolor{keywordflow}{Do} ilow = 1, jlow}
\DoxyCodeLine{2830                         \textcolor{keywordflow}{If} (invals(ihigt(icrs)) == invals(ilowt(ilow))) \&}
\DoxyCodeLine{2831                             cycle lowloop3}
\DoxyCodeLine{2832 \textcolor{keywordflow}{                     End Do}}
\DoxyCodeLine{2833                      jlow = jlow + 1}
\DoxyCodeLine{2834                      ilowt(jlow) = ihigt(icrs)}
\DoxyCodeLine{2835                      \textcolor{keywordflow}{If} (jlow > nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2836                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2837                      jhig = jhig + 1}
\DoxyCodeLine{2838                      ihigt(jhig) = ihigt(icrs)}
\DoxyCodeLine{2839 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{2840 \textcolor{keywordflow}{               End Do} lowloop3}
\DoxyCodeLine{2841 \textcolor{comment}{!}}
\DoxyCodeLine{2842                \textcolor{keywordflow}{Do} icrs = icrs + 1, ifin}
\DoxyCodeLine{2843                   \textcolor{keywordflow}{If} (invals(ihigt(icrs)) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2844                      jlow = jlow + 1}
\DoxyCodeLine{2845                      ilowt(jlow) = ihigt(icrs)}
\DoxyCodeLine{2846 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{2847 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{2848 \textcolor{keywordflow}{           End Select}}
\DoxyCodeLine{2849 \textcolor{comment}{!}}
\DoxyCodeLine{2850 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{2851 \textcolor{comment}{!}}
\DoxyCodeLine{2852          \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{2853 \textcolor{comment}{!}}
\DoxyCodeLine{2854 \textcolor{comment}{!  Only 1 value is missing in low part}}
\DoxyCodeLine{2855 \textcolor{comment}{!}}
\DoxyCodeLine{2856             xmin = invals(ihigt(1))}
\DoxyCodeLine{2857             ihig = 1}
\DoxyCodeLine{2858             \textcolor{keywordflow}{Do} icrs = 2, jhig}
\DoxyCodeLine{2859                \textcolor{keywordflow}{If} (invals(ihigt(icrs)) < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2860                   xmin = invals(ihigt(icrs))}
\DoxyCodeLine{2861                   ihig = icrs}
\DoxyCodeLine{2862 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2863 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{2864 \textcolor{comment}{!}}
\DoxyCodeLine{2865             jlow = jlow + 1}
\DoxyCodeLine{2866             ilowt(jlow) = ihigt(ihig)}
\DoxyCodeLine{2867             \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2868 \textcolor{comment}{!}}
\DoxyCodeLine{2869 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{2870 \textcolor{comment}{!}}
\DoxyCodeLine{2871          \textcolor{keywordflow}{Case} (0)}
\DoxyCodeLine{2872 \textcolor{comment}{!}}
\DoxyCodeLine{2873 \textcolor{comment}{!  Low part is exactly what we want}}
\DoxyCodeLine{2874 \textcolor{comment}{!}}
\DoxyCodeLine{2875             \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2876 \textcolor{comment}{!}}
\DoxyCodeLine{2877 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{2878 \textcolor{comment}{!}}
\DoxyCodeLine{2879          \textcolor{keywordflow}{Case} (-\/5:-\/1)}
\DoxyCodeLine{2880 \textcolor{comment}{!}}
\DoxyCodeLine{2881 \textcolor{comment}{!  Only few values too many in low part}}
\DoxyCodeLine{2882 \textcolor{comment}{!}}
\DoxyCodeLine{2883             irngt(1) = ilowt(1)}
\DoxyCodeLine{2884             \textcolor{keywordflow}{Do} icrs = 2, nord}
\DoxyCodeLine{2885                iwrk = ilowt(icrs)}
\DoxyCodeLine{2886                xwrk = invals(iwrk)}
\DoxyCodeLine{2887                \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{2888                   \textcolor{keywordflow}{If} (xwrk < invals(irngt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2889                      irngt(idcr+1) = irngt(idcr)}
\DoxyCodeLine{2890                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2891                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2892 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{2893 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{2894                irngt(idcr+1) = iwrk}
\DoxyCodeLine{2895 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{2896 \textcolor{comment}{!}}
\DoxyCodeLine{2897             xwrk1 = invals(irngt(nord))}
\DoxyCodeLine{2898             insert1: \textcolor{keywordflow}{Do} icrs = nord + 1, jlow}
\DoxyCodeLine{2899                \textcolor{keywordflow}{If} (invals(ilowt(icrs)) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2900                   xwrk = invals(ilowt(icrs))}
\DoxyCodeLine{2901                   \textcolor{keywordflow}{Do} ilow = 1, nord -\/ 1}
\DoxyCodeLine{2902                      \textcolor{keywordflow}{If} (xwrk <= invals(irngt(ilow))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2903                         \textcolor{keywordflow}{If} (xwrk == invals(irngt(ilow))) cycle insert1}
\DoxyCodeLine{2904                         \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2905 \textcolor{keywordflow}{                     End If}}
\DoxyCodeLine{2906 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{2907                   \textcolor{keywordflow}{Do} idcr = nord -\/ 1, ilow, -\/ 1}
\DoxyCodeLine{2908                      irngt(idcr+1) = irngt(idcr)}
\DoxyCodeLine{2909 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{2910                   irngt(idcr+1) = ilowt(icrs)}
\DoxyCodeLine{2911                   xwrk1 = invals(irngt(nord))}
\DoxyCodeLine{2912 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2913 \textcolor{keywordflow}{            End Do} insert1}
\DoxyCodeLine{2914 \textcolor{comment}{!}}
\DoxyCodeLine{2915             \textcolor{keywordflow}{Return}}
\DoxyCodeLine{2916 \textcolor{comment}{!}}
\DoxyCodeLine{2917 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{2918 \textcolor{comment}{!}}
\DoxyCodeLine{2919          \textcolor{keywordflow}{Case} (:-\/6)}
\DoxyCodeLine{2920 \textcolor{comment}{!}}
\DoxyCodeLine{2921 \textcolor{comment}{! last case: too many values in low part}}
\DoxyCodeLine{2922 \textcolor{comment}{!}}
\DoxyCodeLine{2923             ideb = jdeb + 1}
\DoxyCodeLine{2924             imil = min((jlow+ideb) / 2, nord)}
\DoxyCodeLine{2925             ifin = min(jlow, nord+1)}
\DoxyCodeLine{2926 \textcolor{comment}{!}}
\DoxyCodeLine{2927 \textcolor{comment}{!  One chooses a pivot from 1st, last, and middle values}}
\DoxyCodeLine{2928 \textcolor{comment}{!}}
\DoxyCodeLine{2929             \textcolor{keywordflow}{If} (invals(ilowt(imil)) < invals(ilowt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2930                iwrk = ilowt(ideb)}
\DoxyCodeLine{2931                ilowt(ideb) = ilowt(imil)}
\DoxyCodeLine{2932                ilowt(imil) = iwrk}
\DoxyCodeLine{2933 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{2934             \textcolor{keywordflow}{If} (invals(ilowt(imil)) > invals(ilowt(ifin))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2935                iwrk = ilowt(ifin)}
\DoxyCodeLine{2936                ilowt(ifin) = ilowt(imil)}
\DoxyCodeLine{2937                ilowt(imil) = iwrk}
\DoxyCodeLine{2938                \textcolor{keywordflow}{If} (invals(ilowt(imil)) < invals(ilowt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2939                   iwrk = ilowt(ideb)}
\DoxyCodeLine{2940                   ilowt(ideb) = ilowt(imil)}
\DoxyCodeLine{2941                   ilowt(imil) = iwrk}
\DoxyCodeLine{2942 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2943 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{2944             \textcolor{keywordflow}{If} (ifin <= 3) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2945 \textcolor{comment}{!}}
\DoxyCodeLine{2946             xpiv = invals(ilowt(ideb)) + real(nord)/real(jlow+nord) * \&}
\DoxyCodeLine{2947                                       (invals(ilowt(ifin))-\/invals(ilowt(1)))}
\DoxyCodeLine{2948             \textcolor{keywordflow}{If} (jdeb > 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2949                \textcolor{keywordflow}{If} (xpiv <= xpiv0) \&}
\DoxyCodeLine{2950                    xpiv = xpiv0 + real(2*nord-\/jdeb)/real(jlow+nord) * \&}
\DoxyCodeLine{2951                                   (invals(ilowt(ifin))-\/xpiv0)}
\DoxyCodeLine{2952             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2953                ideb = 1}
\DoxyCodeLine{2954 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{2955 \textcolor{comment}{!}}
\DoxyCodeLine{2956 \textcolor{comment}{!  One takes values > XPIV to IHIGT}}
\DoxyCodeLine{2957 \textcolor{comment}{!  However, we do not process the first values if we have been}}
\DoxyCodeLine{2958 \textcolor{comment}{!  through the case when we did not have enough low values}}
\DoxyCodeLine{2959 \textcolor{comment}{!}}
\DoxyCodeLine{2960             jhig = 0}
\DoxyCodeLine{2961             ifin = jlow}
\DoxyCodeLine{2962             jlow = jdeb}
\DoxyCodeLine{2963 \textcolor{comment}{!}}
\DoxyCodeLine{2964             \textcolor{keywordflow}{If} (invals(ilowt(ifin)) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2965                icrs = jdeb}
\DoxyCodeLine{2966               lowloop4: \textcolor{keywordflow}{Do}}
\DoxyCodeLine{2967                  icrs = icrs + 1}
\DoxyCodeLine{2968                   \textcolor{keywordflow}{If} (invals(ilowt(icrs)) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2969                      jhig = jhig + 1}
\DoxyCodeLine{2970                      ihigt(jhig) = ilowt(icrs)}
\DoxyCodeLine{2971                      \textcolor{keywordflow}{If} (icrs >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2972                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2973                      xwrk1 = invals(ilowt(icrs))}
\DoxyCodeLine{2974                      \textcolor{keywordflow}{Do} ilow = ideb, jlow}
\DoxyCodeLine{2975                         \textcolor{keywordflow}{If} (xwrk1 == invals(ilowt(ilow))) \&}
\DoxyCodeLine{2976                             cycle lowloop4}
\DoxyCodeLine{2977 \textcolor{keywordflow}{                     End Do}}
\DoxyCodeLine{2978                      jlow = jlow + 1}
\DoxyCodeLine{2979                      ilowt(jlow) = ilowt(icrs)}
\DoxyCodeLine{2980                      \textcolor{keywordflow}{If} (jlow >= nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2981 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{2982 \textcolor{keywordflow}{               End Do} lowloop4}
\DoxyCodeLine{2983 \textcolor{comment}{!}}
\DoxyCodeLine{2984                \textcolor{keywordflow}{If} (icrs < ifin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2985                   \textcolor{keywordflow}{Do}}
\DoxyCodeLine{2986                      icrs = icrs + 1}
\DoxyCodeLine{2987                      \textcolor{keywordflow}{If} (invals(ilowt(icrs)) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2988                         jlow = jlow + 1}
\DoxyCodeLine{2989                         ilowt(jlow) = ilowt(icrs)}
\DoxyCodeLine{2990                      \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2991                         \textcolor{keywordflow}{If} (icrs >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{2992 \textcolor{keywordflow}{                     End If}}
\DoxyCodeLine{2993 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{2994 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{2995            \textcolor{keywordflow}{Else}}
\DoxyCodeLine{2996               lowloop5: \textcolor{keywordflow}{Do} icrs = ideb, ifin}
\DoxyCodeLine{2997                   \textcolor{keywordflow}{If} (invals(ilowt(icrs)) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{2998                      jhig = jhig + 1}
\DoxyCodeLine{2999                      ihigt(jhig) = ilowt(icrs)}
\DoxyCodeLine{3000                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{3001                      xwrk1 = invals(ilowt(icrs))}
\DoxyCodeLine{3002                      \textcolor{keywordflow}{Do} ilow = ideb, jlow}
\DoxyCodeLine{3003                         \textcolor{keywordflow}{If} (xwrk1 == invals(ilowt(ilow))) \&}
\DoxyCodeLine{3004                             cycle lowloop5}
\DoxyCodeLine{3005 \textcolor{keywordflow}{                     End Do}}
\DoxyCodeLine{3006                      jlow = jlow + 1}
\DoxyCodeLine{3007                      ilowt(jlow) = ilowt(icrs)}
\DoxyCodeLine{3008                      \textcolor{keywordflow}{If} (jlow >= nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{3009 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{3010 \textcolor{keywordflow}{               End Do} lowloop5}
\DoxyCodeLine{3011 \textcolor{comment}{!}}
\DoxyCodeLine{3012                \textcolor{keywordflow}{Do} icrs = icrs + 1, ifin}
\DoxyCodeLine{3013                   \textcolor{keywordflow}{If} (invals(ilowt(icrs)) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{3014                      jlow = jlow + 1}
\DoxyCodeLine{3015                      ilowt(jlow) = ilowt(icrs)}
\DoxyCodeLine{3016 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{3017 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{3018 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{3019 \textcolor{comment}{!}}
\DoxyCodeLine{3020 \textcolor{keywordflow}{         End Select}}
\DoxyCodeLine{3021 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{3022 \textcolor{comment}{!}}
\DoxyCodeLine{3023 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{3024 \textcolor{comment}{!}}
\DoxyCodeLine{3025 \textcolor{comment}{!  Now, we only need to complete ranking of the 1:NORD set}}
\DoxyCodeLine{3026 \textcolor{comment}{!  Assuming NORD is small, we use a simple insertion sort}}
\DoxyCodeLine{3027 \textcolor{comment}{!}}
\DoxyCodeLine{3028       irngt(1) = ilowt(1)}
\DoxyCodeLine{3029       \textcolor{keywordflow}{Do} icrs = 2, nord}
\DoxyCodeLine{3030          iwrk = ilowt(icrs)}
\DoxyCodeLine{3031          xwrk = invals(iwrk)}
\DoxyCodeLine{3032          \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{3033             \textcolor{keywordflow}{If} (xwrk < invals(irngt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{3034                irngt(idcr+1) = irngt(idcr)}
\DoxyCodeLine{3035             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{3036                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{3037 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{3038 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{3039          irngt(idcr+1) = iwrk}
\DoxyCodeLine{3040 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{3041      \textcolor{keywordflow}{Return}}
\DoxyCodeLine{3042 \textcolor{comment}{!}}
\DoxyCodeLine{3043 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__orderpack____unipar_afe2840f6c55b9cfe51f672d3f05f555c}\label{namespacem__orderpack____unipar_afe2840f6c55b9cfe51f672d3f05f555c}} 
\index{m\_orderpack\_\_unipar@{m\_orderpack\_\_unipar}!real32\_unipar@{real32\_unipar}}
\index{real32\_unipar@{real32\_unipar}!m\_orderpack\_\_unipar@{m\_orderpack\_\_unipar}}
\doxysubsubsection{\texorpdfstring{real32\_unipar()}{real32\_unipar()}}
{\footnotesize\ttfamily subroutine m\+\_\+orderpack\+\_\+\+\_\+unipar\+::real32\+\_\+unipar (\begin{DoxyParamCaption}\item[{real (kind=real32), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, dimension (\+:), intent(out)}]{I\+R\+N\+GT,  }\item[{integer, intent(inout)}]{N\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{700 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{701 \textcolor{keywordtype}{   Real} (kind=real32), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: invals}
\DoxyCodeLine{702    \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IRNGT}
\DoxyCodeLine{703    \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (InOut)} :: NORD}
\DoxyCodeLine{704 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{705 \textcolor{keywordtype}{   Real} (kind=real32) :: xpiv, xwrk, xwrk1, xmin, xmax, xpiv0}
\DoxyCodeLine{706 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{707    \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(INVALS))} :: ILOWT, IHIGT}
\DoxyCodeLine{708    \textcolor{keywordtype}{Integer} :: NDON, JHIG, JLOW, IHIG, IWRK, IWRK1, IWRK2, IWRK3}
\DoxyCodeLine{709    \textcolor{keywordtype}{Integer} :: IDEB, JDEB, IMIL, IFIN, NWRK, ICRS, IDCR, ILOW}
\DoxyCodeLine{710    \textcolor{keywordtype}{Integer} :: JLM2, JLM1, JHM2, JHM1}
\DoxyCodeLine{711 \textcolor{comment}{!}}
\DoxyCodeLine{712       ndon = \textcolor{keyword}{SIZE} (invals)}
\DoxyCodeLine{713 \textcolor{comment}{!}}
\DoxyCodeLine{714 \textcolor{comment}{!    First loop is used to fill-\/in ILOWT, IHIGT at the same time}}
\DoxyCodeLine{715 \textcolor{comment}{!}}
\DoxyCodeLine{716       \textcolor{keywordflow}{If} (ndon < 2) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{717          \textcolor{keywordflow}{If} (nord >= 1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{718             nord = 1}
\DoxyCodeLine{719             irngt(1) = 1}
\DoxyCodeLine{720 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{721          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{722 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{723 \textcolor{comment}{!}}
\DoxyCodeLine{724 \textcolor{comment}{!  One chooses a pivot, best estimate possible to put fractile near}}
\DoxyCodeLine{725 \textcolor{comment}{!  mid-\/point of the set of low values.}}
\DoxyCodeLine{726 \textcolor{comment}{!}}
\DoxyCodeLine{727      ihigt=1}
\DoxyCodeLine{728      ilowt=1}
\DoxyCodeLine{729 }
\DoxyCodeLine{730      \textcolor{keywordflow}{Do} icrs = 2, ndon}
\DoxyCodeLine{731         \textcolor{keywordflow}{If} (invals(icrs) == invals(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{732           cycle}
\DoxyCodeLine{733         \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (invals(icrs) < invals(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{734            ilowt(1) = icrs}
\DoxyCodeLine{735            ihigt(1) = 1}
\DoxyCodeLine{736         \textcolor{keywordflow}{Else}}
\DoxyCodeLine{737            ilowt(1) = 1}
\DoxyCodeLine{738            ihigt(1) = icrs}
\DoxyCodeLine{739 \textcolor{keywordflow}{        End If}}
\DoxyCodeLine{740         \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{741 \textcolor{keywordflow}{     End Do}}
\DoxyCodeLine{742 \textcolor{comment}{!}}
\DoxyCodeLine{743       \textcolor{keywordflow}{If} (ndon <= icrs) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{744          nord = min(nord, 2)}
\DoxyCodeLine{745          \textcolor{keywordflow}{If} (nord >= 1) irngt(1) = ilowt(1)}
\DoxyCodeLine{746          \textcolor{keywordflow}{If} (nord >= 2) irngt(2) = ihigt(1)}
\DoxyCodeLine{747          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{748 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{749 \textcolor{comment}{!}}
\DoxyCodeLine{750       icrs = icrs + 1}
\DoxyCodeLine{751       jhig = 1}
\DoxyCodeLine{752       \textcolor{keywordflow}{If} (invals(icrs) < invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{753          \textcolor{keywordflow}{If} (invals(icrs) < invals(ilowt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{754             jhig = jhig + 1}
\DoxyCodeLine{755             ihigt(jhig) = ihigt(1)}
\DoxyCodeLine{756             ihigt(1) = ilowt(1)}
\DoxyCodeLine{757             ilowt(1) = icrs}
\DoxyCodeLine{758          \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (invals(icrs) > invals(ilowt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{759             jhig = jhig + 1}
\DoxyCodeLine{760             ihigt(jhig) = ihigt(1)}
\DoxyCodeLine{761             ihigt(1) = icrs}
\DoxyCodeLine{762 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{763       \textcolor{keywordflow}{ElseIf} (invals(icrs) > invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{764          jhig = jhig + 1}
\DoxyCodeLine{765          ihigt(jhig) = icrs}
\DoxyCodeLine{766 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{767 \textcolor{comment}{!}}
\DoxyCodeLine{768       \textcolor{keywordflow}{If} (ndon <= icrs) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{769          nord = min(nord, jhig+1)}
\DoxyCodeLine{770          \textcolor{keywordflow}{If} (nord >= 1) irngt(1) = ilowt(1)}
\DoxyCodeLine{771          \textcolor{keywordflow}{If} (nord >= 2) irngt(2) = ihigt(1)}
\DoxyCodeLine{772          \textcolor{keywordflow}{If} (nord >= 3) irngt(3) = ihigt(2)}
\DoxyCodeLine{773          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{774 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{775 \textcolor{comment}{!}}
\DoxyCodeLine{776       \textcolor{keywordflow}{If} (invals(ndon) < invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{777          \textcolor{keywordflow}{If} (invals(ndon) < invals(ilowt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{778             \textcolor{keywordflow}{Do} idcr = jhig, 1, -\/1}
\DoxyCodeLine{779               ihigt(idcr+1) = ihigt(idcr)}
\DoxyCodeLine{780 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{781             ihigt(1) = ilowt(1)}
\DoxyCodeLine{782             ilowt(1) = ndon}
\DoxyCodeLine{783             jhig = jhig + 1}
\DoxyCodeLine{784          \textcolor{keywordflow}{ElseIf} (invals(ndon) > invals(ilowt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{785             \textcolor{keywordflow}{Do} idcr = jhig, 1, -\/1}
\DoxyCodeLine{786               ihigt(idcr+1) = ihigt(idcr)}
\DoxyCodeLine{787 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{788             ihigt(1) = ndon}
\DoxyCodeLine{789             jhig = jhig + 1}
\DoxyCodeLine{790 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{791       \textcolor{keywordflow}{ElseIf} (invals(ndon) > invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{792          jhig = jhig + 1}
\DoxyCodeLine{793          ihigt(jhig) = ndon}
\DoxyCodeLine{794 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{795 \textcolor{comment}{!}}
\DoxyCodeLine{796       \textcolor{keywordflow}{If} (ndon <= icrs+1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{797          nord = min(nord, jhig+1)}
\DoxyCodeLine{798          \textcolor{keywordflow}{If} (nord >= 1) irngt(1) = ilowt(1)}
\DoxyCodeLine{799          \textcolor{keywordflow}{If} (nord >= 2) irngt(2) = ihigt(1)}
\DoxyCodeLine{800          \textcolor{keywordflow}{If} (nord >= 3) irngt(3) = ihigt(2)}
\DoxyCodeLine{801          \textcolor{keywordflow}{If} (nord >= 4) irngt(4) = ihigt(3)}
\DoxyCodeLine{802          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{803 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{804 \textcolor{comment}{!}}
\DoxyCodeLine{805       jdeb = 0}
\DoxyCodeLine{806       ideb = jdeb + 1}
\DoxyCodeLine{807       jlow = ideb}
\DoxyCodeLine{808       xpiv = invals(ilowt(ideb)) + real(2*nord)/real(ndon+nord) * \&}
\DoxyCodeLine{809                                    (invals(ihigt(3))-\/invals(ilowt(ideb)))}
\DoxyCodeLine{810       \textcolor{keywordflow}{If} (xpiv >= invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{811          xpiv = invals(ilowt(ideb)) + real(2*nord)/real(ndon+nord) * \&}
\DoxyCodeLine{812                                       (invals(ihigt(2))-\/invals(ilowt(ideb)))}
\DoxyCodeLine{813          \textcolor{keywordflow}{If} (xpiv >= invals(ihigt(1))) \&}
\DoxyCodeLine{814              xpiv = invals(ilowt(ideb)) + real(2*nord) / real(ndon+nord) * \&}
\DoxyCodeLine{815                                           (invals(ihigt(1))-\/invals(ilowt(ideb)))}
\DoxyCodeLine{816 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{817       xpiv0 = xpiv}
\DoxyCodeLine{818 \textcolor{comment}{!}}
\DoxyCodeLine{819 \textcolor{comment}{!  One puts values > pivot in the end and those <= pivot}}
\DoxyCodeLine{820 \textcolor{comment}{!  at the beginning. This is split in 2 cases, so that}}
\DoxyCodeLine{821 \textcolor{comment}{!  we can skip the loop test a number of times.}}
\DoxyCodeLine{822 \textcolor{comment}{!  As we are also filling in the work arrays at the same time}}
\DoxyCodeLine{823 \textcolor{comment}{!  we stop filling in the IHIGT array as soon as we have more}}
\DoxyCodeLine{824 \textcolor{comment}{!  than enough values in ILOWT, i.e. one more than}}
\DoxyCodeLine{825 \textcolor{comment}{!  strictly necessary so as to be able to come out of the}}
\DoxyCodeLine{826 \textcolor{comment}{!  case where JLOWT would be NORD distinct values followed}}
\DoxyCodeLine{827 \textcolor{comment}{!  by values that are exclusively duplicates of these.}}
\DoxyCodeLine{828 \textcolor{comment}{!}}
\DoxyCodeLine{829 \textcolor{comment}{!}}
\DoxyCodeLine{830       \textcolor{keywordflow}{If} (invals(ndon) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{831          lowloop1: \textcolor{keywordflow}{Do}}
\DoxyCodeLine{832             icrs = icrs + 1}
\DoxyCodeLine{833             \textcolor{keywordflow}{If} (invals(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{834                \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{835                jhig = jhig + 1}
\DoxyCodeLine{836                ihigt(jhig) = icrs}
\DoxyCodeLine{837             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{838                \textcolor{keywordflow}{Do} ilow = 1, jlow}
\DoxyCodeLine{839                  \textcolor{keywordflow}{If} (invals(icrs) == invals(ilowt(ilow))) cycle lowloop1}
\DoxyCodeLine{840 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{841                jlow = jlow + 1}
\DoxyCodeLine{842                ilowt(jlow) = icrs}
\DoxyCodeLine{843                \textcolor{keywordflow}{If} (jlow >= nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{844 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{845 \textcolor{keywordflow}{         End Do} lowloop1}
\DoxyCodeLine{846 \textcolor{comment}{!}}
\DoxyCodeLine{847 \textcolor{comment}{!  One restricts further processing because it is no use}}
\DoxyCodeLine{848 \textcolor{comment}{!  to store more high values}}
\DoxyCodeLine{849 \textcolor{comment}{!}}
\DoxyCodeLine{850          \textcolor{keywordflow}{If} (icrs < ndon-\/1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{851             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{852                icrs = icrs + 1}
\DoxyCodeLine{853                \textcolor{keywordflow}{If} (invals(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{854                   jlow = jlow + 1}
\DoxyCodeLine{855                   ilowt(jlow) = icrs}
\DoxyCodeLine{856                \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{857                   \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{858 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{859 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{860 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{861 \textcolor{comment}{!}}
\DoxyCodeLine{862 \textcolor{comment}{!}}
\DoxyCodeLine{863       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{864 \textcolor{comment}{!}}
\DoxyCodeLine{865 \textcolor{comment}{!  Same as above, but this is not as easy to optimize, so the}}
\DoxyCodeLine{866 \textcolor{comment}{!  DO-\/loop is kept}}
\DoxyCodeLine{867 \textcolor{comment}{!}}
\DoxyCodeLine{868          lowloop2: \textcolor{keywordflow}{Do} icrs = icrs + 1, ndon -\/ 1}
\DoxyCodeLine{869             \textcolor{keywordflow}{If} (invals(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{870                jhig = jhig + 1}
\DoxyCodeLine{871                ihigt(jhig) = icrs}
\DoxyCodeLine{872             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{873                \textcolor{keywordflow}{Do} ilow = 1, jlow}
\DoxyCodeLine{874                  \textcolor{keywordflow}{If} (invals(icrs) == invals(ilowt(ilow))) cycle lowloop2}
\DoxyCodeLine{875 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{876                jlow = jlow + 1}
\DoxyCodeLine{877                ilowt(jlow) = icrs}
\DoxyCodeLine{878                \textcolor{keywordflow}{If} (jlow >= nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{879 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{880 \textcolor{keywordflow}{         End Do} lowloop2}
\DoxyCodeLine{881 \textcolor{comment}{!}}
\DoxyCodeLine{882          \textcolor{keywordflow}{If} (icrs < ndon-\/1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{883             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{884                icrs = icrs + 1}
\DoxyCodeLine{885                \textcolor{keywordflow}{If} (invals(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{886                   \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{887                   jlow = jlow + 1}
\DoxyCodeLine{888                   ilowt(jlow) = icrs}
\DoxyCodeLine{889 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{890 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{891 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{892 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{893 \textcolor{comment}{!}}
\DoxyCodeLine{894       jlm2 = 0}
\DoxyCodeLine{895       jlm1 = 0}
\DoxyCodeLine{896       jhm2 = 0}
\DoxyCodeLine{897       jhm1 = 0}
\DoxyCodeLine{898       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{899          \textcolor{keywordflow}{if} (jlow == nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{900          \textcolor{keywordflow}{If} (jlm2 == jlow .And. jhm2 == jhig) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{901 \textcolor{comment}{!}}
\DoxyCodeLine{902 \textcolor{comment}{!   We are oscillating. Perturbate by bringing JLOW closer by one}}
\DoxyCodeLine{903 \textcolor{comment}{!   to NORD}}
\DoxyCodeLine{904 \textcolor{comment}{!}}
\DoxyCodeLine{905            \textcolor{keywordflow}{If} (nord > jlow) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{906                 xmin = invals(ihigt(1))}
\DoxyCodeLine{907                 ihig = 1}
\DoxyCodeLine{908                 \textcolor{keywordflow}{Do} icrs = 2, jhig}
\DoxyCodeLine{909                    \textcolor{keywordflow}{If} (invals(ihigt(icrs)) < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{910                       xmin = invals(ihigt(icrs))}
\DoxyCodeLine{911                       ihig = icrs}
\DoxyCodeLine{912 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{913 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{914 \textcolor{comment}{!}}
\DoxyCodeLine{915                 jlow = jlow + 1}
\DoxyCodeLine{916                 ilowt(jlow) = ihigt(ihig)}
\DoxyCodeLine{917                 ihig = 0}
\DoxyCodeLine{918                 \textcolor{keywordflow}{Do} icrs = 1, jhig}
\DoxyCodeLine{919                    \textcolor{keywordflow}{If} (invals(ihigt(icrs)) /= xmin) \textcolor{keywordflow}{then}}
\DoxyCodeLine{920                       ihig = ihig + 1}
\DoxyCodeLine{921                       ihigt(ihig ) = ihigt(icrs)}
\DoxyCodeLine{922 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{923 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{924                 jhig = ihig}
\DoxyCodeLine{925              \textcolor{keywordflow}{Else}}
\DoxyCodeLine{926                 ilow = ilowt(jlow)}
\DoxyCodeLine{927                 xmax = invals(ilow)}
\DoxyCodeLine{928                 \textcolor{keywordflow}{Do} icrs = 1, jlow}
\DoxyCodeLine{929                    \textcolor{keywordflow}{If} (invals(ilowt(icrs)) > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{930                       iwrk = ilowt(icrs)}
\DoxyCodeLine{931                       xmax = invals(iwrk)}
\DoxyCodeLine{932                       ilowt(icrs) = ilow}
\DoxyCodeLine{933                       ilow = iwrk}
\DoxyCodeLine{934 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{935 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{936                 jlow = jlow -\/ 1}
\DoxyCodeLine{937 \textcolor{keywordflow}{             End If}}
\DoxyCodeLine{938 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{939          jlm2 = jlm1}
\DoxyCodeLine{940          jlm1 = jlow}
\DoxyCodeLine{941          jhm2 = jhm1}
\DoxyCodeLine{942          jhm1 = jhig}
\DoxyCodeLine{943 \textcolor{comment}{!}}
\DoxyCodeLine{944 \textcolor{comment}{!   We try to bring the number of values in the low values set}}
\DoxyCodeLine{945 \textcolor{comment}{!   closer to NORD. In order to make better pivot choices, we}}
\DoxyCodeLine{946 \textcolor{comment}{!   decrease NORD if we already know that we don't have that}}
\DoxyCodeLine{947 \textcolor{comment}{!   many distinct values as a whole.}}
\DoxyCodeLine{948 \textcolor{comment}{!}}
\DoxyCodeLine{949          \textcolor{keywordflow}{IF} (jlow+jhig < nord) nord = jlow+jhig}
\DoxyCodeLine{950          \textcolor{keywordflow}{Select Case} (nord-\/jlow)}
\DoxyCodeLine{951 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{952          \textcolor{keywordflow}{Case} (2:)}
\DoxyCodeLine{953 \textcolor{comment}{!}}
\DoxyCodeLine{954 \textcolor{comment}{!   Not enough values in low part, at least 2 are missing}}
\DoxyCodeLine{955 \textcolor{comment}{!}}
\DoxyCodeLine{956             \textcolor{keywordflow}{Select Case} (jhig)}
\DoxyCodeLine{957 \textcolor{comment}{!}}
\DoxyCodeLine{958 \textcolor{comment}{!   Not enough values in high part either (too many duplicates)}}
\DoxyCodeLine{959 \textcolor{comment}{!}}
\DoxyCodeLine{960             \textcolor{keywordflow}{Case} (0)}
\DoxyCodeLine{961                nord = jlow}
\DoxyCodeLine{962 \textcolor{comment}{!}}
\DoxyCodeLine{963             \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{964                jlow = jlow + 1}
\DoxyCodeLine{965                ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{966                nord = jlow}
\DoxyCodeLine{967 \textcolor{comment}{!}}
\DoxyCodeLine{968 \textcolor{comment}{!   We make a special case when we have so few values in}}
\DoxyCodeLine{969 \textcolor{comment}{!   the high values set that it is bad performance to choose a pivot}}
\DoxyCodeLine{970 \textcolor{comment}{!   and apply the general algorithm.}}
\DoxyCodeLine{971 \textcolor{comment}{!}}
\DoxyCodeLine{972             \textcolor{keywordflow}{Case} (2)}
\DoxyCodeLine{973                \textcolor{keywordflow}{If} (invals(ihigt(1)) <= invals(ihigt(2))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{974                   jlow = jlow + 1}
\DoxyCodeLine{975                   ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{976                   jlow = jlow + 1}
\DoxyCodeLine{977                   ilowt(jlow) = ihigt(2)}
\DoxyCodeLine{978                \textcolor{keywordflow}{ElseIf} (invals(ihigt(1)) == invals(ihigt(2))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{979                   jlow = jlow + 1}
\DoxyCodeLine{980                   ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{981                   nord = jlow}
\DoxyCodeLine{982                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{983                   jlow = jlow + 1}
\DoxyCodeLine{984                   ilowt(jlow) = ihigt(2)}
\DoxyCodeLine{985                   jlow = jlow + 1}
\DoxyCodeLine{986                   ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{987 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{988                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{989 \textcolor{comment}{!}}
\DoxyCodeLine{990             \textcolor{keywordflow}{Case} (3)}
\DoxyCodeLine{991 \textcolor{comment}{!}}
\DoxyCodeLine{992 \textcolor{comment}{!}}
\DoxyCodeLine{993                iwrk1 = ihigt(1)}
\DoxyCodeLine{994                iwrk2 = ihigt(2)}
\DoxyCodeLine{995                iwrk3 = ihigt(3)}
\DoxyCodeLine{996                \textcolor{keywordflow}{If} (invals(iwrk2) < invals(iwrk1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{997                   ihigt(1) = iwrk2}
\DoxyCodeLine{998                   ihigt(2) = iwrk1}
\DoxyCodeLine{999                   iwrk2 = iwrk1}
\DoxyCodeLine{1000 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1001                \textcolor{keywordflow}{If} (invals(iwrk2) > invals(iwrk3)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1002                   ihigt(3) = iwrk2}
\DoxyCodeLine{1003                   ihigt(2) = iwrk3}
\DoxyCodeLine{1004                   iwrk2 = iwrk3}
\DoxyCodeLine{1005                   \textcolor{keywordflow}{If} (invals(iwrk2) < invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1006                      ihigt(2) = ihigt(1)}
\DoxyCodeLine{1007                      ihigt(1) = iwrk2}
\DoxyCodeLine{1008 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1009 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1010                jhig = 1}
\DoxyCodeLine{1011                jlow = jlow + 1}
\DoxyCodeLine{1012                ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{1013                jhig = jhig + 1}
\DoxyCodeLine{1014                \textcolor{keywordflow}{IF} (invals(ihigt(jhig)) /= invals(ilowt(jlow))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1015                  jlow = jlow + 1}
\DoxyCodeLine{1016                  ilowt(jlow) = ihigt(jhig)}
\DoxyCodeLine{1017 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1018                jhig = jhig + 1}
\DoxyCodeLine{1019                \textcolor{keywordflow}{IF} (invals(ihigt(jhig)) /= invals(ilowt(jlow))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1020                  jlow = jlow + 1}
\DoxyCodeLine{1021                  ilowt(jlow) = ihigt(jhig)}
\DoxyCodeLine{1022 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1023                nord = min(jlow, nord)}
\DoxyCodeLine{1024                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1025 \textcolor{comment}{!}}
\DoxyCodeLine{1026             \textcolor{keywordflow}{Case} (4:)}
\DoxyCodeLine{1027 \textcolor{comment}{!}}
\DoxyCodeLine{1028 \textcolor{comment}{!}}
\DoxyCodeLine{1029                xpiv0 = xpiv}
\DoxyCodeLine{1030                ifin = jhig}
\DoxyCodeLine{1031 \textcolor{comment}{!}}
\DoxyCodeLine{1032 \textcolor{comment}{!  One chooses a pivot from the 2 first values and the last one.}}
\DoxyCodeLine{1033 \textcolor{comment}{!  This should ensure sufficient renewal between iterations to}}
\DoxyCodeLine{1034 \textcolor{comment}{!  avoid worst case behavior effects.}}
\DoxyCodeLine{1035 \textcolor{comment}{!}}
\DoxyCodeLine{1036                iwrk1 = ihigt(1)}
\DoxyCodeLine{1037                iwrk2 = ihigt(2)}
\DoxyCodeLine{1038                iwrk3 = ihigt(ifin)}
\DoxyCodeLine{1039                \textcolor{keywordflow}{If} (invals(iwrk2) < invals(iwrk1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1040                   ihigt(1) = iwrk2}
\DoxyCodeLine{1041                   ihigt(2) = iwrk1}
\DoxyCodeLine{1042                   iwrk2 = iwrk1}
\DoxyCodeLine{1043 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1044                \textcolor{keywordflow}{If} (invals(iwrk2) > invals(iwrk3)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1045                   ihigt(ifin) = iwrk2}
\DoxyCodeLine{1046                   ihigt(2) = iwrk3}
\DoxyCodeLine{1047                   iwrk2 = iwrk3}
\DoxyCodeLine{1048                   \textcolor{keywordflow}{If} (invals(iwrk2) < invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1049                      ihigt(2) = ihigt(1)}
\DoxyCodeLine{1050                      ihigt(1) = iwrk2}
\DoxyCodeLine{1051 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1052 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1053 \textcolor{comment}{!}}
\DoxyCodeLine{1054                jdeb = jlow}
\DoxyCodeLine{1055                nwrk = nord -\/ jlow}
\DoxyCodeLine{1056                iwrk1 = ihigt(1)}
\DoxyCodeLine{1057                xpiv = invals(iwrk1) + real(nwrk) / real(nord+nwrk) * \&}
\DoxyCodeLine{1058                                       (invals(ihigt(ifin))-\/invals(iwrk1))}
\DoxyCodeLine{1059 \textcolor{comment}{!}}
\DoxyCodeLine{1060 \textcolor{comment}{!  One takes values <= pivot to ILOWT}}
\DoxyCodeLine{1061 \textcolor{comment}{!  Again, 2 parts, one where we take care of the remaining}}
\DoxyCodeLine{1062 \textcolor{comment}{!  high values because we might still need them, and the}}
\DoxyCodeLine{1063 \textcolor{comment}{!  other when we know that we will have more than enough}}
\DoxyCodeLine{1064 \textcolor{comment}{!  low values in the end.}}
\DoxyCodeLine{1065 \textcolor{comment}{!}}
\DoxyCodeLine{1066                jhig = 0}
\DoxyCodeLine{1067                lowloop3: \textcolor{keywordflow}{Do} icrs = 1, ifin}
\DoxyCodeLine{1068                   \textcolor{keywordflow}{If} (invals(ihigt(icrs)) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1069                      \textcolor{keywordflow}{Do} ilow = 1, jlow}
\DoxyCodeLine{1070                         \textcolor{keywordflow}{If} (invals(ihigt(icrs)) == invals(ilowt(ilow))) \&}
\DoxyCodeLine{1071                             cycle lowloop3}
\DoxyCodeLine{1072 \textcolor{keywordflow}{                     End Do}}
\DoxyCodeLine{1073                      jlow = jlow + 1}
\DoxyCodeLine{1074                      ilowt(jlow) = ihigt(icrs)}
\DoxyCodeLine{1075                      \textcolor{keywordflow}{If} (jlow > nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1076                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1077                      jhig = jhig + 1}
\DoxyCodeLine{1078                      ihigt(jhig) = ihigt(icrs)}
\DoxyCodeLine{1079 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1080 \textcolor{keywordflow}{               End Do} lowloop3}
\DoxyCodeLine{1081 \textcolor{comment}{!}}
\DoxyCodeLine{1082                \textcolor{keywordflow}{Do} icrs = icrs + 1, ifin}
\DoxyCodeLine{1083                   \textcolor{keywordflow}{If} (invals(ihigt(icrs)) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1084                      jlow = jlow + 1}
\DoxyCodeLine{1085                      ilowt(jlow) = ihigt(icrs)}
\DoxyCodeLine{1086 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1087 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1088 \textcolor{keywordflow}{           End Select}}
\DoxyCodeLine{1089 \textcolor{comment}{!}}
\DoxyCodeLine{1090 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1091 \textcolor{comment}{!}}
\DoxyCodeLine{1092          \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{1093 \textcolor{comment}{!}}
\DoxyCodeLine{1094 \textcolor{comment}{!  Only 1 value is missing in low part}}
\DoxyCodeLine{1095 \textcolor{comment}{!}}
\DoxyCodeLine{1096             xmin = invals(ihigt(1))}
\DoxyCodeLine{1097             ihig = 1}
\DoxyCodeLine{1098             \textcolor{keywordflow}{Do} icrs = 2, jhig}
\DoxyCodeLine{1099                \textcolor{keywordflow}{If} (invals(ihigt(icrs)) < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1100                   xmin = invals(ihigt(icrs))}
\DoxyCodeLine{1101                   ihig = icrs}
\DoxyCodeLine{1102 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1103 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1104 \textcolor{comment}{!}}
\DoxyCodeLine{1105             jlow = jlow + 1}
\DoxyCodeLine{1106             ilowt(jlow) = ihigt(ihig)}
\DoxyCodeLine{1107             \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1108 \textcolor{comment}{!}}
\DoxyCodeLine{1109 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1110 \textcolor{comment}{!}}
\DoxyCodeLine{1111          \textcolor{keywordflow}{Case} (0)}
\DoxyCodeLine{1112 \textcolor{comment}{!}}
\DoxyCodeLine{1113 \textcolor{comment}{!  Low part is exactly what we want}}
\DoxyCodeLine{1114 \textcolor{comment}{!}}
\DoxyCodeLine{1115             \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1116 \textcolor{comment}{!}}
\DoxyCodeLine{1117 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1118 \textcolor{comment}{!}}
\DoxyCodeLine{1119          \textcolor{keywordflow}{Case} (-\/5:-\/1)}
\DoxyCodeLine{1120 \textcolor{comment}{!}}
\DoxyCodeLine{1121 \textcolor{comment}{!  Only few values too many in low part}}
\DoxyCodeLine{1122 \textcolor{comment}{!}}
\DoxyCodeLine{1123             irngt(1) = ilowt(1)}
\DoxyCodeLine{1124             \textcolor{keywordflow}{Do} icrs = 2, nord}
\DoxyCodeLine{1125                iwrk = ilowt(icrs)}
\DoxyCodeLine{1126                xwrk = invals(iwrk)}
\DoxyCodeLine{1127                \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1128                   \textcolor{keywordflow}{If} (xwrk < invals(irngt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1129                      irngt(idcr+1) = irngt(idcr)}
\DoxyCodeLine{1130                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1131                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1132 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1133 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1134                irngt(idcr+1) = iwrk}
\DoxyCodeLine{1135 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1136 \textcolor{comment}{!}}
\DoxyCodeLine{1137             xwrk1 = invals(irngt(nord))}
\DoxyCodeLine{1138             insert1: \textcolor{keywordflow}{Do} icrs = nord + 1, jlow}
\DoxyCodeLine{1139                \textcolor{keywordflow}{If} (invals(ilowt(icrs)) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1140                   xwrk = invals(ilowt(icrs))}
\DoxyCodeLine{1141                   \textcolor{keywordflow}{Do} ilow = 1, nord -\/ 1}
\DoxyCodeLine{1142                      \textcolor{keywordflow}{If} (xwrk <= invals(irngt(ilow))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1143                         \textcolor{keywordflow}{If} (xwrk == invals(irngt(ilow))) cycle insert1}
\DoxyCodeLine{1144                         \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1145 \textcolor{keywordflow}{                     End If}}
\DoxyCodeLine{1146 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{1147                   \textcolor{keywordflow}{Do} idcr = nord -\/ 1, ilow, -\/ 1}
\DoxyCodeLine{1148                      irngt(idcr+1) = irngt(idcr)}
\DoxyCodeLine{1149 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{1150                   irngt(idcr+1) = ilowt(icrs)}
\DoxyCodeLine{1151                   xwrk1 = invals(irngt(nord))}
\DoxyCodeLine{1152 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1153 \textcolor{keywordflow}{            End Do} insert1}
\DoxyCodeLine{1154 \textcolor{comment}{!}}
\DoxyCodeLine{1155             \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1156 \textcolor{comment}{!}}
\DoxyCodeLine{1157 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1158 \textcolor{comment}{!}}
\DoxyCodeLine{1159          \textcolor{keywordflow}{Case} (:-\/6)}
\DoxyCodeLine{1160 \textcolor{comment}{!}}
\DoxyCodeLine{1161 \textcolor{comment}{! last case: too many values in low part}}
\DoxyCodeLine{1162 \textcolor{comment}{!}}
\DoxyCodeLine{1163             ideb = jdeb + 1}
\DoxyCodeLine{1164             imil = min((jlow+ideb) / 2, nord)}
\DoxyCodeLine{1165             ifin = min(jlow, nord+1)}
\DoxyCodeLine{1166 \textcolor{comment}{!}}
\DoxyCodeLine{1167 \textcolor{comment}{!  One chooses a pivot from 1st, last, and middle values}}
\DoxyCodeLine{1168 \textcolor{comment}{!}}
\DoxyCodeLine{1169             \textcolor{keywordflow}{If} (invals(ilowt(imil)) < invals(ilowt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1170                iwrk = ilowt(ideb)}
\DoxyCodeLine{1171                ilowt(ideb) = ilowt(imil)}
\DoxyCodeLine{1172                ilowt(imil) = iwrk}
\DoxyCodeLine{1173 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1174             \textcolor{keywordflow}{If} (invals(ilowt(imil)) > invals(ilowt(ifin))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1175                iwrk = ilowt(ifin)}
\DoxyCodeLine{1176                ilowt(ifin) = ilowt(imil)}
\DoxyCodeLine{1177                ilowt(imil) = iwrk}
\DoxyCodeLine{1178                \textcolor{keywordflow}{If} (invals(ilowt(imil)) < invals(ilowt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1179                   iwrk = ilowt(ideb)}
\DoxyCodeLine{1180                   ilowt(ideb) = ilowt(imil)}
\DoxyCodeLine{1181                   ilowt(imil) = iwrk}
\DoxyCodeLine{1182 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1183 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1184             \textcolor{keywordflow}{If} (ifin <= 3) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1185 \textcolor{comment}{!}}
\DoxyCodeLine{1186             xpiv = invals(ilowt(ideb)) + real(nord)/real(jlow+nord) * \&}
\DoxyCodeLine{1187                                       (invals(ilowt(ifin))-\/invals(ilowt(1)))}
\DoxyCodeLine{1188             \textcolor{keywordflow}{If} (jdeb > 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1189                \textcolor{keywordflow}{If} (xpiv <= xpiv0) \&}
\DoxyCodeLine{1190                    xpiv = xpiv0 + real(2*nord-\/jdeb)/real(jlow+nord) * \&}
\DoxyCodeLine{1191                                   (invals(ilowt(ifin))-\/xpiv0)}
\DoxyCodeLine{1192             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1193                ideb = 1}
\DoxyCodeLine{1194 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1195 \textcolor{comment}{!}}
\DoxyCodeLine{1196 \textcolor{comment}{!  One takes values > XPIV to IHIGT}}
\DoxyCodeLine{1197 \textcolor{comment}{!  However, we do not process the first values if we have been}}
\DoxyCodeLine{1198 \textcolor{comment}{!  through the case when we did not have enough low values}}
\DoxyCodeLine{1199 \textcolor{comment}{!}}
\DoxyCodeLine{1200             jhig = 0}
\DoxyCodeLine{1201             ifin = jlow}
\DoxyCodeLine{1202             jlow = jdeb}
\DoxyCodeLine{1203 \textcolor{comment}{!}}
\DoxyCodeLine{1204             \textcolor{keywordflow}{If} (invals(ilowt(ifin)) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1205                icrs = jdeb}
\DoxyCodeLine{1206               lowloop4: \textcolor{keywordflow}{Do}}
\DoxyCodeLine{1207                  icrs = icrs + 1}
\DoxyCodeLine{1208                   \textcolor{keywordflow}{If} (invals(ilowt(icrs)) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1209                      jhig = jhig + 1}
\DoxyCodeLine{1210                      ihigt(jhig) = ilowt(icrs)}
\DoxyCodeLine{1211                      \textcolor{keywordflow}{If} (icrs >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1212                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1213                      xwrk1 = invals(ilowt(icrs))}
\DoxyCodeLine{1214                      \textcolor{keywordflow}{Do} ilow = ideb, jlow}
\DoxyCodeLine{1215                         \textcolor{keywordflow}{If} (xwrk1 == invals(ilowt(ilow))) \&}
\DoxyCodeLine{1216                             cycle lowloop4}
\DoxyCodeLine{1217 \textcolor{keywordflow}{                     End Do}}
\DoxyCodeLine{1218                      jlow = jlow + 1}
\DoxyCodeLine{1219                      ilowt(jlow) = ilowt(icrs)}
\DoxyCodeLine{1220                      \textcolor{keywordflow}{If} (jlow >= nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1221 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1222 \textcolor{keywordflow}{               End Do} lowloop4}
\DoxyCodeLine{1223 \textcolor{comment}{!}}
\DoxyCodeLine{1224                \textcolor{keywordflow}{If} (icrs < ifin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1225                   \textcolor{keywordflow}{Do}}
\DoxyCodeLine{1226                      icrs = icrs + 1}
\DoxyCodeLine{1227                      \textcolor{keywordflow}{If} (invals(ilowt(icrs)) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1228                         jlow = jlow + 1}
\DoxyCodeLine{1229                         ilowt(jlow) = ilowt(icrs)}
\DoxyCodeLine{1230                      \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1231                         \textcolor{keywordflow}{If} (icrs >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1232 \textcolor{keywordflow}{                     End If}}
\DoxyCodeLine{1233 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{1234 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1235            \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1236               lowloop5: \textcolor{keywordflow}{Do} icrs = ideb, ifin}
\DoxyCodeLine{1237                   \textcolor{keywordflow}{If} (invals(ilowt(icrs)) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1238                      jhig = jhig + 1}
\DoxyCodeLine{1239                      ihigt(jhig) = ilowt(icrs)}
\DoxyCodeLine{1240                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1241                      xwrk1 = invals(ilowt(icrs))}
\DoxyCodeLine{1242                      \textcolor{keywordflow}{Do} ilow = ideb, jlow}
\DoxyCodeLine{1243                         \textcolor{keywordflow}{If} (xwrk1 == invals(ilowt(ilow))) \&}
\DoxyCodeLine{1244                             cycle lowloop5}
\DoxyCodeLine{1245 \textcolor{keywordflow}{                     End Do}}
\DoxyCodeLine{1246                      jlow = jlow + 1}
\DoxyCodeLine{1247                      ilowt(jlow) = ilowt(icrs)}
\DoxyCodeLine{1248                      \textcolor{keywordflow}{If} (jlow >= nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1249 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1250 \textcolor{keywordflow}{               End Do} lowloop5}
\DoxyCodeLine{1251 \textcolor{comment}{!}}
\DoxyCodeLine{1252                \textcolor{keywordflow}{Do} icrs = icrs + 1, ifin}
\DoxyCodeLine{1253                   \textcolor{keywordflow}{If} (invals(ilowt(icrs)) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1254                      jlow = jlow + 1}
\DoxyCodeLine{1255                      ilowt(jlow) = ilowt(icrs)}
\DoxyCodeLine{1256 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1257 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1258 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1259 \textcolor{comment}{!}}
\DoxyCodeLine{1260 \textcolor{keywordflow}{         End Select}}
\DoxyCodeLine{1261 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1262 \textcolor{comment}{!}}
\DoxyCodeLine{1263 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{1264 \textcolor{comment}{!}}
\DoxyCodeLine{1265 \textcolor{comment}{!  Now, we only need to complete ranking of the 1:NORD set}}
\DoxyCodeLine{1266 \textcolor{comment}{!  Assuming NORD is small, we use a simple insertion sort}}
\DoxyCodeLine{1267 \textcolor{comment}{!}}
\DoxyCodeLine{1268       irngt(1) = ilowt(1)}
\DoxyCodeLine{1269       \textcolor{keywordflow}{Do} icrs = 2, nord}
\DoxyCodeLine{1270          iwrk = ilowt(icrs)}
\DoxyCodeLine{1271          xwrk = invals(iwrk)}
\DoxyCodeLine{1272          \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1273             \textcolor{keywordflow}{If} (xwrk < invals(irngt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1274                irngt(idcr+1) = irngt(idcr)}
\DoxyCodeLine{1275             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1276                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1277 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1278 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1279          irngt(idcr+1) = iwrk}
\DoxyCodeLine{1280 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{1281      \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1282 \textcolor{comment}{!}}
\DoxyCodeLine{1283 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__orderpack____unipar_ac911b16c612f75c4fa8dac25a4e50318}\label{namespacem__orderpack____unipar_ac911b16c612f75c4fa8dac25a4e50318}} 
\index{m\_orderpack\_\_unipar@{m\_orderpack\_\_unipar}!real64\_unipar@{real64\_unipar}}
\index{real64\_unipar@{real64\_unipar}!m\_orderpack\_\_unipar@{m\_orderpack\_\_unipar}}
\doxysubsubsection{\texorpdfstring{real64\_unipar()}{real64\_unipar()}}
{\footnotesize\ttfamily subroutine m\+\_\+orderpack\+\_\+\+\_\+unipar\+::real64\+\_\+unipar (\begin{DoxyParamCaption}\item[{real (kind=real64), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, dimension (\+:), intent(out)}]{I\+R\+N\+GT,  }\item[{integer, intent(inout)}]{N\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{114 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{115 \textcolor{keywordtype}{   Real} (kind=real64), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: invals}
\DoxyCodeLine{116    \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IRNGT}
\DoxyCodeLine{117    \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (InOut)} :: NORD}
\DoxyCodeLine{118 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{119 \textcolor{keywordtype}{   Real} (kind=real64) :: xpiv, xwrk, xwrk1, xmin, xmax, xpiv0}
\DoxyCodeLine{120 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{121    \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(INVALS))} :: ILOWT, IHIGT}
\DoxyCodeLine{122    \textcolor{keywordtype}{Integer} :: NDON, JHIG, JLOW, IHIG, IWRK, IWRK1, IWRK2, IWRK3}
\DoxyCodeLine{123    \textcolor{keywordtype}{Integer} :: IDEB, JDEB, IMIL, IFIN, NWRK, ICRS, IDCR, ILOW}
\DoxyCodeLine{124    \textcolor{keywordtype}{Integer} :: JLM2, JLM1, JHM2, JHM1}
\DoxyCodeLine{125 \textcolor{comment}{!}}
\DoxyCodeLine{126       ndon = \textcolor{keyword}{SIZE} (invals)}
\DoxyCodeLine{127 \textcolor{comment}{!}}
\DoxyCodeLine{128 \textcolor{comment}{!    First loop is used to fill-\/in ILOWT, IHIGT at the same time}}
\DoxyCodeLine{129 \textcolor{comment}{!}}
\DoxyCodeLine{130       \textcolor{keywordflow}{If} (ndon < 2) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{131          \textcolor{keywordflow}{If} (nord >= 1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{132             nord = 1}
\DoxyCodeLine{133             irngt(1) = 1}
\DoxyCodeLine{134 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{135          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{136 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{137 \textcolor{comment}{!}}
\DoxyCodeLine{138 \textcolor{comment}{!  One chooses a pivot, best estimate possible to put fractile near}}
\DoxyCodeLine{139 \textcolor{comment}{!  mid-\/point of the set of low values.}}
\DoxyCodeLine{140 \textcolor{comment}{!}}
\DoxyCodeLine{141      ihigt=1}
\DoxyCodeLine{142      ilowt=1}
\DoxyCodeLine{143 }
\DoxyCodeLine{144      \textcolor{keywordflow}{Do} icrs = 2, ndon}
\DoxyCodeLine{145         \textcolor{keywordflow}{If} (invals(icrs) == invals(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{146           cycle}
\DoxyCodeLine{147         \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (invals(icrs) < invals(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{148            ilowt(1) = icrs}
\DoxyCodeLine{149            ihigt(1) = 1}
\DoxyCodeLine{150         \textcolor{keywordflow}{Else}}
\DoxyCodeLine{151            ilowt(1) = 1}
\DoxyCodeLine{152            ihigt(1) = icrs}
\DoxyCodeLine{153 \textcolor{keywordflow}{        End If}}
\DoxyCodeLine{154         \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{155 \textcolor{keywordflow}{     End Do}}
\DoxyCodeLine{156 \textcolor{comment}{!}}
\DoxyCodeLine{157       \textcolor{keywordflow}{If} (ndon <= icrs) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{158          nord = min(nord, 2)}
\DoxyCodeLine{159          \textcolor{keywordflow}{If} (nord >= 1) irngt(1) = ilowt(1)}
\DoxyCodeLine{160          \textcolor{keywordflow}{If} (nord >= 2) irngt(2) = ihigt(1)}
\DoxyCodeLine{161          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{162 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{163 \textcolor{comment}{!}}
\DoxyCodeLine{164       icrs = icrs + 1}
\DoxyCodeLine{165       jhig = 1}
\DoxyCodeLine{166       \textcolor{keywordflow}{If} (invals(icrs) < invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{167          \textcolor{keywordflow}{If} (invals(icrs) < invals(ilowt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{168             jhig = jhig + 1}
\DoxyCodeLine{169             ihigt(jhig) = ihigt(1)}
\DoxyCodeLine{170             ihigt(1) = ilowt(1)}
\DoxyCodeLine{171             ilowt(1) = icrs}
\DoxyCodeLine{172          \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (invals(icrs) > invals(ilowt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{173             jhig = jhig + 1}
\DoxyCodeLine{174             ihigt(jhig) = ihigt(1)}
\DoxyCodeLine{175             ihigt(1) = icrs}
\DoxyCodeLine{176 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{177       \textcolor{keywordflow}{ElseIf} (invals(icrs) > invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{178          jhig = jhig + 1}
\DoxyCodeLine{179          ihigt(jhig) = icrs}
\DoxyCodeLine{180 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{181 \textcolor{comment}{!}}
\DoxyCodeLine{182       \textcolor{keywordflow}{If} (ndon <= icrs) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{183          nord = min(nord, jhig+1)}
\DoxyCodeLine{184          \textcolor{keywordflow}{If} (nord >= 1) irngt(1) = ilowt(1)}
\DoxyCodeLine{185          \textcolor{keywordflow}{If} (nord >= 2) irngt(2) = ihigt(1)}
\DoxyCodeLine{186          \textcolor{keywordflow}{If} (nord >= 3) irngt(3) = ihigt(2)}
\DoxyCodeLine{187          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{188 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{189 \textcolor{comment}{!}}
\DoxyCodeLine{190       \textcolor{keywordflow}{If} (invals(ndon) < invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{191          \textcolor{keywordflow}{If} (invals(ndon) < invals(ilowt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{192             \textcolor{keywordflow}{Do} idcr = jhig, 1, -\/1}
\DoxyCodeLine{193               ihigt(idcr+1) = ihigt(idcr)}
\DoxyCodeLine{194 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{195             ihigt(1) = ilowt(1)}
\DoxyCodeLine{196             ilowt(1) = ndon}
\DoxyCodeLine{197             jhig = jhig + 1}
\DoxyCodeLine{198          \textcolor{keywordflow}{ElseIf} (invals(ndon) > invals(ilowt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{199             \textcolor{keywordflow}{Do} idcr = jhig, 1, -\/1}
\DoxyCodeLine{200               ihigt(idcr+1) = ihigt(idcr)}
\DoxyCodeLine{201 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{202             ihigt(1) = ndon}
\DoxyCodeLine{203             jhig = jhig + 1}
\DoxyCodeLine{204 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{205       \textcolor{keywordflow}{ElseIf} (invals(ndon) > invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{206          jhig = jhig + 1}
\DoxyCodeLine{207          ihigt(jhig) = ndon}
\DoxyCodeLine{208 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{209 \textcolor{comment}{!}}
\DoxyCodeLine{210       \textcolor{keywordflow}{If} (ndon <= icrs+1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{211          nord = min(nord, jhig+1)}
\DoxyCodeLine{212          \textcolor{keywordflow}{If} (nord >= 1) irngt(1) = ilowt(1)}
\DoxyCodeLine{213          \textcolor{keywordflow}{If} (nord >= 2) irngt(2) = ihigt(1)}
\DoxyCodeLine{214          \textcolor{keywordflow}{If} (nord >= 3) irngt(3) = ihigt(2)}
\DoxyCodeLine{215          \textcolor{keywordflow}{If} (nord >= 4) irngt(4) = ihigt(3)}
\DoxyCodeLine{216          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{217 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{218 \textcolor{comment}{!}}
\DoxyCodeLine{219       jdeb = 0}
\DoxyCodeLine{220       ideb = jdeb + 1}
\DoxyCodeLine{221       jlow = ideb}
\DoxyCodeLine{222       xpiv = invals(ilowt(ideb)) + real(2*nord)/real(ndon+nord) * \&}
\DoxyCodeLine{223                                    (invals(ihigt(3))-\/invals(ilowt(ideb)))}
\DoxyCodeLine{224       \textcolor{keywordflow}{If} (xpiv >= invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{225          xpiv = invals(ilowt(ideb)) + real(2*nord)/real(ndon+nord) * \&}
\DoxyCodeLine{226                                       (invals(ihigt(2))-\/invals(ilowt(ideb)))}
\DoxyCodeLine{227          \textcolor{keywordflow}{If} (xpiv >= invals(ihigt(1))) \&}
\DoxyCodeLine{228              xpiv = invals(ilowt(ideb)) + real(2*nord) / real(ndon+nord) * \&}
\DoxyCodeLine{229                                           (invals(ihigt(1))-\/invals(ilowt(ideb)))}
\DoxyCodeLine{230 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{231       xpiv0 = xpiv}
\DoxyCodeLine{232 \textcolor{comment}{!}}
\DoxyCodeLine{233 \textcolor{comment}{!  One puts values > pivot in the end and those <= pivot}}
\DoxyCodeLine{234 \textcolor{comment}{!  at the beginning. This is split in 2 cases, so that}}
\DoxyCodeLine{235 \textcolor{comment}{!  we can skip the loop test a number of times.}}
\DoxyCodeLine{236 \textcolor{comment}{!  As we are also filling in the work arrays at the same time}}
\DoxyCodeLine{237 \textcolor{comment}{!  we stop filling in the IHIGT array as soon as we have more}}
\DoxyCodeLine{238 \textcolor{comment}{!  than enough values in ILOWT, i.e. one more than}}
\DoxyCodeLine{239 \textcolor{comment}{!  strictly necessary so as to be able to come out of the}}
\DoxyCodeLine{240 \textcolor{comment}{!  case where JLOWT would be NORD distinct values followed}}
\DoxyCodeLine{241 \textcolor{comment}{!  by values that are exclusively duplicates of these.}}
\DoxyCodeLine{242 \textcolor{comment}{!}}
\DoxyCodeLine{243 \textcolor{comment}{!}}
\DoxyCodeLine{244       \textcolor{keywordflow}{If} (invals(ndon) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{245          lowloop1: \textcolor{keywordflow}{Do}}
\DoxyCodeLine{246             icrs = icrs + 1}
\DoxyCodeLine{247             \textcolor{keywordflow}{If} (invals(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{248                \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{249                jhig = jhig + 1}
\DoxyCodeLine{250                ihigt(jhig) = icrs}
\DoxyCodeLine{251             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{252                \textcolor{keywordflow}{Do} ilow = 1, jlow}
\DoxyCodeLine{253                  \textcolor{keywordflow}{If} (invals(icrs) == invals(ilowt(ilow))) cycle lowloop1}
\DoxyCodeLine{254 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{255                jlow = jlow + 1}
\DoxyCodeLine{256                ilowt(jlow) = icrs}
\DoxyCodeLine{257                \textcolor{keywordflow}{If} (jlow >= nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{258 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{259 \textcolor{keywordflow}{         End Do} lowloop1}
\DoxyCodeLine{260 \textcolor{comment}{!}}
\DoxyCodeLine{261 \textcolor{comment}{!  One restricts further processing because it is no use}}
\DoxyCodeLine{262 \textcolor{comment}{!  to store more high values}}
\DoxyCodeLine{263 \textcolor{comment}{!}}
\DoxyCodeLine{264          \textcolor{keywordflow}{If} (icrs < ndon-\/1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{265             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{266                icrs = icrs + 1}
\DoxyCodeLine{267                \textcolor{keywordflow}{If} (invals(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{268                   jlow = jlow + 1}
\DoxyCodeLine{269                   ilowt(jlow) = icrs}
\DoxyCodeLine{270                \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{271                   \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{272 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{273 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{274 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{275 \textcolor{comment}{!}}
\DoxyCodeLine{276 \textcolor{comment}{!}}
\DoxyCodeLine{277       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{278 \textcolor{comment}{!}}
\DoxyCodeLine{279 \textcolor{comment}{!  Same as above, but this is not as easy to optimize, so the}}
\DoxyCodeLine{280 \textcolor{comment}{!  DO-\/loop is kept}}
\DoxyCodeLine{281 \textcolor{comment}{!}}
\DoxyCodeLine{282          lowloop2: \textcolor{keywordflow}{Do} icrs = icrs + 1, ndon -\/ 1}
\DoxyCodeLine{283             \textcolor{keywordflow}{If} (invals(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{284                jhig = jhig + 1}
\DoxyCodeLine{285                ihigt(jhig) = icrs}
\DoxyCodeLine{286             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{287                \textcolor{keywordflow}{Do} ilow = 1, jlow}
\DoxyCodeLine{288                  \textcolor{keywordflow}{If} (invals(icrs) == invals(ilowt(ilow))) cycle lowloop2}
\DoxyCodeLine{289 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{290                jlow = jlow + 1}
\DoxyCodeLine{291                ilowt(jlow) = icrs}
\DoxyCodeLine{292                \textcolor{keywordflow}{If} (jlow >= nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{293 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{294 \textcolor{keywordflow}{         End Do} lowloop2}
\DoxyCodeLine{295 \textcolor{comment}{!}}
\DoxyCodeLine{296          \textcolor{keywordflow}{If} (icrs < ndon-\/1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{297             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{298                icrs = icrs + 1}
\DoxyCodeLine{299                \textcolor{keywordflow}{If} (invals(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{300                   \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{301                   jlow = jlow + 1}
\DoxyCodeLine{302                   ilowt(jlow) = icrs}
\DoxyCodeLine{303 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{304 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{305 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{306 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{307 \textcolor{comment}{!}}
\DoxyCodeLine{308       jlm2 = 0}
\DoxyCodeLine{309       jlm1 = 0}
\DoxyCodeLine{310       jhm2 = 0}
\DoxyCodeLine{311       jhm1 = 0}
\DoxyCodeLine{312       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{313          \textcolor{keywordflow}{if} (jlow == nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{314          \textcolor{keywordflow}{If} (jlm2 == jlow .And. jhm2 == jhig) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{315 \textcolor{comment}{!}}
\DoxyCodeLine{316 \textcolor{comment}{!   We are oscillating. Perturbate by bringing JLOW closer by one}}
\DoxyCodeLine{317 \textcolor{comment}{!   to NORD}}
\DoxyCodeLine{318 \textcolor{comment}{!}}
\DoxyCodeLine{319            \textcolor{keywordflow}{If} (nord > jlow) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{320                 xmin = invals(ihigt(1))}
\DoxyCodeLine{321                 ihig = 1}
\DoxyCodeLine{322                 \textcolor{keywordflow}{Do} icrs = 2, jhig}
\DoxyCodeLine{323                    \textcolor{keywordflow}{If} (invals(ihigt(icrs)) < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{324                       xmin = invals(ihigt(icrs))}
\DoxyCodeLine{325                       ihig = icrs}
\DoxyCodeLine{326 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{327 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{328 \textcolor{comment}{!}}
\DoxyCodeLine{329                 jlow = jlow + 1}
\DoxyCodeLine{330                 ilowt(jlow) = ihigt(ihig)}
\DoxyCodeLine{331                 ihig = 0}
\DoxyCodeLine{332                 \textcolor{keywordflow}{Do} icrs = 1, jhig}
\DoxyCodeLine{333                    \textcolor{keywordflow}{If} (invals(ihigt(icrs)) /= xmin) \textcolor{keywordflow}{then}}
\DoxyCodeLine{334                       ihig = ihig + 1}
\DoxyCodeLine{335                       ihigt(ihig ) = ihigt(icrs)}
\DoxyCodeLine{336 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{337 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{338                 jhig = ihig}
\DoxyCodeLine{339              \textcolor{keywordflow}{Else}}
\DoxyCodeLine{340                 ilow = ilowt(jlow)}
\DoxyCodeLine{341                 xmax = invals(ilow)}
\DoxyCodeLine{342                 \textcolor{keywordflow}{Do} icrs = 1, jlow}
\DoxyCodeLine{343                    \textcolor{keywordflow}{If} (invals(ilowt(icrs)) > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{344                       iwrk = ilowt(icrs)}
\DoxyCodeLine{345                       xmax = invals(iwrk)}
\DoxyCodeLine{346                       ilowt(icrs) = ilow}
\DoxyCodeLine{347                       ilow = iwrk}
\DoxyCodeLine{348 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{349 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{350                 jlow = jlow -\/ 1}
\DoxyCodeLine{351 \textcolor{keywordflow}{             End If}}
\DoxyCodeLine{352 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{353          jlm2 = jlm1}
\DoxyCodeLine{354          jlm1 = jlow}
\DoxyCodeLine{355          jhm2 = jhm1}
\DoxyCodeLine{356          jhm1 = jhig}
\DoxyCodeLine{357 \textcolor{comment}{!}}
\DoxyCodeLine{358 \textcolor{comment}{!   We try to bring the number of values in the low values set}}
\DoxyCodeLine{359 \textcolor{comment}{!   closer to NORD. In order to make better pivot choices, we}}
\DoxyCodeLine{360 \textcolor{comment}{!   decrease NORD if we already know that we don't have that}}
\DoxyCodeLine{361 \textcolor{comment}{!   many distinct values as a whole.}}
\DoxyCodeLine{362 \textcolor{comment}{!}}
\DoxyCodeLine{363          \textcolor{keywordflow}{IF} (jlow+jhig < nord) nord = jlow+jhig}
\DoxyCodeLine{364          \textcolor{keywordflow}{Select Case} (nord-\/jlow)}
\DoxyCodeLine{365 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{366          \textcolor{keywordflow}{Case} (2:)}
\DoxyCodeLine{367 \textcolor{comment}{!}}
\DoxyCodeLine{368 \textcolor{comment}{!   Not enough values in low part, at least 2 are missing}}
\DoxyCodeLine{369 \textcolor{comment}{!}}
\DoxyCodeLine{370             \textcolor{keywordflow}{Select Case} (jhig)}
\DoxyCodeLine{371 \textcolor{comment}{!}}
\DoxyCodeLine{372 \textcolor{comment}{!   Not enough values in high part either (too many duplicates)}}
\DoxyCodeLine{373 \textcolor{comment}{!}}
\DoxyCodeLine{374             \textcolor{keywordflow}{Case} (0)}
\DoxyCodeLine{375                nord = jlow}
\DoxyCodeLine{376 \textcolor{comment}{!}}
\DoxyCodeLine{377             \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{378                jlow = jlow + 1}
\DoxyCodeLine{379                ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{380                nord = jlow}
\DoxyCodeLine{381 \textcolor{comment}{!}}
\DoxyCodeLine{382 \textcolor{comment}{!   We make a special case when we have so few values in}}
\DoxyCodeLine{383 \textcolor{comment}{!   the high values set that it is bad performance to choose a pivot}}
\DoxyCodeLine{384 \textcolor{comment}{!   and apply the general algorithm.}}
\DoxyCodeLine{385 \textcolor{comment}{!}}
\DoxyCodeLine{386             \textcolor{keywordflow}{Case} (2)}
\DoxyCodeLine{387                \textcolor{keywordflow}{If} (invals(ihigt(1)) <= invals(ihigt(2))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{388                   jlow = jlow + 1}
\DoxyCodeLine{389                   ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{390                   jlow = jlow + 1}
\DoxyCodeLine{391                   ilowt(jlow) = ihigt(2)}
\DoxyCodeLine{392                \textcolor{keywordflow}{ElseIf} (invals(ihigt(1)) == invals(ihigt(2))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{393                   jlow = jlow + 1}
\DoxyCodeLine{394                   ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{395                   nord = jlow}
\DoxyCodeLine{396                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{397                   jlow = jlow + 1}
\DoxyCodeLine{398                   ilowt(jlow) = ihigt(2)}
\DoxyCodeLine{399                   jlow = jlow + 1}
\DoxyCodeLine{400                   ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{401 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{402                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{403 \textcolor{comment}{!}}
\DoxyCodeLine{404             \textcolor{keywordflow}{Case} (3)}
\DoxyCodeLine{405 \textcolor{comment}{!}}
\DoxyCodeLine{406 \textcolor{comment}{!}}
\DoxyCodeLine{407                iwrk1 = ihigt(1)}
\DoxyCodeLine{408                iwrk2 = ihigt(2)}
\DoxyCodeLine{409                iwrk3 = ihigt(3)}
\DoxyCodeLine{410                \textcolor{keywordflow}{If} (invals(iwrk2) < invals(iwrk1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{411                   ihigt(1) = iwrk2}
\DoxyCodeLine{412                   ihigt(2) = iwrk1}
\DoxyCodeLine{413                   iwrk2 = iwrk1}
\DoxyCodeLine{414 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{415                \textcolor{keywordflow}{If} (invals(iwrk2) > invals(iwrk3)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{416                   ihigt(3) = iwrk2}
\DoxyCodeLine{417                   ihigt(2) = iwrk3}
\DoxyCodeLine{418                   iwrk2 = iwrk3}
\DoxyCodeLine{419                   \textcolor{keywordflow}{If} (invals(iwrk2) < invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{420                      ihigt(2) = ihigt(1)}
\DoxyCodeLine{421                      ihigt(1) = iwrk2}
\DoxyCodeLine{422 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{423 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{424                jhig = 1}
\DoxyCodeLine{425                jlow = jlow + 1}
\DoxyCodeLine{426                ilowt(jlow) = ihigt(1)}
\DoxyCodeLine{427                jhig = jhig + 1}
\DoxyCodeLine{428                \textcolor{keywordflow}{IF} (invals(ihigt(jhig)) /= invals(ilowt(jlow))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{429                  jlow = jlow + 1}
\DoxyCodeLine{430                  ilowt(jlow) = ihigt(jhig)}
\DoxyCodeLine{431 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{432                jhig = jhig + 1}
\DoxyCodeLine{433                \textcolor{keywordflow}{IF} (invals(ihigt(jhig)) /= invals(ilowt(jlow))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{434                  jlow = jlow + 1}
\DoxyCodeLine{435                  ilowt(jlow) = ihigt(jhig)}
\DoxyCodeLine{436 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{437                nord = min(jlow, nord)}
\DoxyCodeLine{438                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{439 \textcolor{comment}{!}}
\DoxyCodeLine{440             \textcolor{keywordflow}{Case} (4:)}
\DoxyCodeLine{441 \textcolor{comment}{!}}
\DoxyCodeLine{442 \textcolor{comment}{!}}
\DoxyCodeLine{443                xpiv0 = xpiv}
\DoxyCodeLine{444                ifin = jhig}
\DoxyCodeLine{445 \textcolor{comment}{!}}
\DoxyCodeLine{446 \textcolor{comment}{!  One chooses a pivot from the 2 first values and the last one.}}
\DoxyCodeLine{447 \textcolor{comment}{!  This should ensure sufficient renewal between iterations to}}
\DoxyCodeLine{448 \textcolor{comment}{!  avoid worst case behavior effects.}}
\DoxyCodeLine{449 \textcolor{comment}{!}}
\DoxyCodeLine{450                iwrk1 = ihigt(1)}
\DoxyCodeLine{451                iwrk2 = ihigt(2)}
\DoxyCodeLine{452                iwrk3 = ihigt(ifin)}
\DoxyCodeLine{453                \textcolor{keywordflow}{If} (invals(iwrk2) < invals(iwrk1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{454                   ihigt(1) = iwrk2}
\DoxyCodeLine{455                   ihigt(2) = iwrk1}
\DoxyCodeLine{456                   iwrk2 = iwrk1}
\DoxyCodeLine{457 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{458                \textcolor{keywordflow}{If} (invals(iwrk2) > invals(iwrk3)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{459                   ihigt(ifin) = iwrk2}
\DoxyCodeLine{460                   ihigt(2) = iwrk3}
\DoxyCodeLine{461                   iwrk2 = iwrk3}
\DoxyCodeLine{462                   \textcolor{keywordflow}{If} (invals(iwrk2) < invals(ihigt(1))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{463                      ihigt(2) = ihigt(1)}
\DoxyCodeLine{464                      ihigt(1) = iwrk2}
\DoxyCodeLine{465 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{466 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{467 \textcolor{comment}{!}}
\DoxyCodeLine{468                jdeb = jlow}
\DoxyCodeLine{469                nwrk = nord -\/ jlow}
\DoxyCodeLine{470                iwrk1 = ihigt(1)}
\DoxyCodeLine{471                xpiv = invals(iwrk1) + real(nwrk) / real(nord+nwrk) * \&}
\DoxyCodeLine{472                                       (invals(ihigt(ifin))-\/invals(iwrk1))}
\DoxyCodeLine{473 \textcolor{comment}{!}}
\DoxyCodeLine{474 \textcolor{comment}{!  One takes values <= pivot to ILOWT}}
\DoxyCodeLine{475 \textcolor{comment}{!  Again, 2 parts, one where we take care of the remaining}}
\DoxyCodeLine{476 \textcolor{comment}{!  high values because we might still need them, and the}}
\DoxyCodeLine{477 \textcolor{comment}{!  other when we know that we will have more than enough}}
\DoxyCodeLine{478 \textcolor{comment}{!  low values in the end.}}
\DoxyCodeLine{479 \textcolor{comment}{!}}
\DoxyCodeLine{480                jhig = 0}
\DoxyCodeLine{481                lowloop3: \textcolor{keywordflow}{Do} icrs = 1, ifin}
\DoxyCodeLine{482                   \textcolor{keywordflow}{If} (invals(ihigt(icrs)) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{483                      \textcolor{keywordflow}{Do} ilow = 1, jlow}
\DoxyCodeLine{484                         \textcolor{keywordflow}{If} (invals(ihigt(icrs)) == invals(ilowt(ilow))) \&}
\DoxyCodeLine{485                             cycle lowloop3}
\DoxyCodeLine{486 \textcolor{keywordflow}{                     End Do}}
\DoxyCodeLine{487                      jlow = jlow + 1}
\DoxyCodeLine{488                      ilowt(jlow) = ihigt(icrs)}
\DoxyCodeLine{489                      \textcolor{keywordflow}{If} (jlow > nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{490                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{491                      jhig = jhig + 1}
\DoxyCodeLine{492                      ihigt(jhig) = ihigt(icrs)}
\DoxyCodeLine{493 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{494 \textcolor{keywordflow}{               End Do} lowloop3}
\DoxyCodeLine{495 \textcolor{comment}{!}}
\DoxyCodeLine{496                \textcolor{keywordflow}{Do} icrs = icrs + 1, ifin}
\DoxyCodeLine{497                   \textcolor{keywordflow}{If} (invals(ihigt(icrs)) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{498                      jlow = jlow + 1}
\DoxyCodeLine{499                      ilowt(jlow) = ihigt(icrs)}
\DoxyCodeLine{500 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{501 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{502 \textcolor{keywordflow}{           End Select}}
\DoxyCodeLine{503 \textcolor{comment}{!}}
\DoxyCodeLine{504 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{505 \textcolor{comment}{!}}
\DoxyCodeLine{506          \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{507 \textcolor{comment}{!}}
\DoxyCodeLine{508 \textcolor{comment}{!  Only 1 value is missing in low part}}
\DoxyCodeLine{509 \textcolor{comment}{!}}
\DoxyCodeLine{510             xmin = invals(ihigt(1))}
\DoxyCodeLine{511             ihig = 1}
\DoxyCodeLine{512             \textcolor{keywordflow}{Do} icrs = 2, jhig}
\DoxyCodeLine{513                \textcolor{keywordflow}{If} (invals(ihigt(icrs)) < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{514                   xmin = invals(ihigt(icrs))}
\DoxyCodeLine{515                   ihig = icrs}
\DoxyCodeLine{516 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{517 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{518 \textcolor{comment}{!}}
\DoxyCodeLine{519             jlow = jlow + 1}
\DoxyCodeLine{520             ilowt(jlow) = ihigt(ihig)}
\DoxyCodeLine{521             \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{522 \textcolor{comment}{!}}
\DoxyCodeLine{523 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{524 \textcolor{comment}{!}}
\DoxyCodeLine{525          \textcolor{keywordflow}{Case} (0)}
\DoxyCodeLine{526 \textcolor{comment}{!}}
\DoxyCodeLine{527 \textcolor{comment}{!  Low part is exactly what we want}}
\DoxyCodeLine{528 \textcolor{comment}{!}}
\DoxyCodeLine{529             \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{530 \textcolor{comment}{!}}
\DoxyCodeLine{531 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{532 \textcolor{comment}{!}}
\DoxyCodeLine{533          \textcolor{keywordflow}{Case} (-\/5:-\/1)}
\DoxyCodeLine{534 \textcolor{comment}{!}}
\DoxyCodeLine{535 \textcolor{comment}{!  Only few values too many in low part}}
\DoxyCodeLine{536 \textcolor{comment}{!}}
\DoxyCodeLine{537             irngt(1) = ilowt(1)}
\DoxyCodeLine{538             \textcolor{keywordflow}{Do} icrs = 2, nord}
\DoxyCodeLine{539                iwrk = ilowt(icrs)}
\DoxyCodeLine{540                xwrk = invals(iwrk)}
\DoxyCodeLine{541                \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{542                   \textcolor{keywordflow}{If} (xwrk < invals(irngt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{543                      irngt(idcr+1) = irngt(idcr)}
\DoxyCodeLine{544                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{545                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{546 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{547 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{548                irngt(idcr+1) = iwrk}
\DoxyCodeLine{549 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{550 \textcolor{comment}{!}}
\DoxyCodeLine{551             xwrk1 = invals(irngt(nord))}
\DoxyCodeLine{552             insert1: \textcolor{keywordflow}{Do} icrs = nord + 1, jlow}
\DoxyCodeLine{553                \textcolor{keywordflow}{If} (invals(ilowt(icrs)) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{554                   xwrk = invals(ilowt(icrs))}
\DoxyCodeLine{555                   \textcolor{keywordflow}{Do} ilow = 1, nord -\/ 1}
\DoxyCodeLine{556                      \textcolor{keywordflow}{If} (xwrk <= invals(irngt(ilow))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{557                         \textcolor{keywordflow}{If} (xwrk == invals(irngt(ilow))) cycle insert1}
\DoxyCodeLine{558                         \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{559 \textcolor{keywordflow}{                     End If}}
\DoxyCodeLine{560 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{561                   \textcolor{keywordflow}{Do} idcr = nord -\/ 1, ilow, -\/ 1}
\DoxyCodeLine{562                      irngt(idcr+1) = irngt(idcr)}
\DoxyCodeLine{563 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{564                   irngt(idcr+1) = ilowt(icrs)}
\DoxyCodeLine{565                   xwrk1 = invals(irngt(nord))}
\DoxyCodeLine{566 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{567 \textcolor{keywordflow}{            End Do} insert1}
\DoxyCodeLine{568 \textcolor{comment}{!}}
\DoxyCodeLine{569             \textcolor{keywordflow}{Return}}
\DoxyCodeLine{570 \textcolor{comment}{!}}
\DoxyCodeLine{571 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{572 \textcolor{comment}{!}}
\DoxyCodeLine{573          \textcolor{keywordflow}{Case} (:-\/6)}
\DoxyCodeLine{574 \textcolor{comment}{!}}
\DoxyCodeLine{575 \textcolor{comment}{! last case: too many values in low part}}
\DoxyCodeLine{576 \textcolor{comment}{!}}
\DoxyCodeLine{577             ideb = jdeb + 1}
\DoxyCodeLine{578             imil = min((jlow+ideb) / 2, nord)}
\DoxyCodeLine{579             ifin = min(jlow, nord+1)}
\DoxyCodeLine{580 \textcolor{comment}{!}}
\DoxyCodeLine{581 \textcolor{comment}{!  One chooses a pivot from 1st, last, and middle values}}
\DoxyCodeLine{582 \textcolor{comment}{!}}
\DoxyCodeLine{583             \textcolor{keywordflow}{If} (invals(ilowt(imil)) < invals(ilowt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{584                iwrk = ilowt(ideb)}
\DoxyCodeLine{585                ilowt(ideb) = ilowt(imil)}
\DoxyCodeLine{586                ilowt(imil) = iwrk}
\DoxyCodeLine{587 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{588             \textcolor{keywordflow}{If} (invals(ilowt(imil)) > invals(ilowt(ifin))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{589                iwrk = ilowt(ifin)}
\DoxyCodeLine{590                ilowt(ifin) = ilowt(imil)}
\DoxyCodeLine{591                ilowt(imil) = iwrk}
\DoxyCodeLine{592                \textcolor{keywordflow}{If} (invals(ilowt(imil)) < invals(ilowt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{593                   iwrk = ilowt(ideb)}
\DoxyCodeLine{594                   ilowt(ideb) = ilowt(imil)}
\DoxyCodeLine{595                   ilowt(imil) = iwrk}
\DoxyCodeLine{596 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{597 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{598             \textcolor{keywordflow}{If} (ifin <= 3) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{599 \textcolor{comment}{!}}
\DoxyCodeLine{600             xpiv = invals(ilowt(ideb)) + real(nord)/real(jlow+nord) * \&}
\DoxyCodeLine{601                                       (invals(ilowt(ifin))-\/invals(ilowt(1)))}
\DoxyCodeLine{602             \textcolor{keywordflow}{If} (jdeb > 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{603                \textcolor{keywordflow}{If} (xpiv <= xpiv0) \&}
\DoxyCodeLine{604                    xpiv = xpiv0 + real(2*nord-\/jdeb)/real(jlow+nord) * \&}
\DoxyCodeLine{605                                   (invals(ilowt(ifin))-\/xpiv0)}
\DoxyCodeLine{606             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{607                ideb = 1}
\DoxyCodeLine{608 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{609 \textcolor{comment}{!}}
\DoxyCodeLine{610 \textcolor{comment}{!  One takes values > XPIV to IHIGT}}
\DoxyCodeLine{611 \textcolor{comment}{!  However, we do not process the first values if we have been}}
\DoxyCodeLine{612 \textcolor{comment}{!  through the case when we did not have enough low values}}
\DoxyCodeLine{613 \textcolor{comment}{!}}
\DoxyCodeLine{614             jhig = 0}
\DoxyCodeLine{615             ifin = jlow}
\DoxyCodeLine{616             jlow = jdeb}
\DoxyCodeLine{617 \textcolor{comment}{!}}
\DoxyCodeLine{618             \textcolor{keywordflow}{If} (invals(ilowt(ifin)) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{619                icrs = jdeb}
\DoxyCodeLine{620               lowloop4: \textcolor{keywordflow}{Do}}
\DoxyCodeLine{621                  icrs = icrs + 1}
\DoxyCodeLine{622                   \textcolor{keywordflow}{If} (invals(ilowt(icrs)) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{623                      jhig = jhig + 1}
\DoxyCodeLine{624                      ihigt(jhig) = ilowt(icrs)}
\DoxyCodeLine{625                      \textcolor{keywordflow}{If} (icrs >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{626                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{627                      xwrk1 = invals(ilowt(icrs))}
\DoxyCodeLine{628                      \textcolor{keywordflow}{Do} ilow = ideb, jlow}
\DoxyCodeLine{629                         \textcolor{keywordflow}{If} (xwrk1 == invals(ilowt(ilow))) \&}
\DoxyCodeLine{630                             cycle lowloop4}
\DoxyCodeLine{631 \textcolor{keywordflow}{                     End Do}}
\DoxyCodeLine{632                      jlow = jlow + 1}
\DoxyCodeLine{633                      ilowt(jlow) = ilowt(icrs)}
\DoxyCodeLine{634                      \textcolor{keywordflow}{If} (jlow >= nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{635 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{636 \textcolor{keywordflow}{               End Do} lowloop4}
\DoxyCodeLine{637 \textcolor{comment}{!}}
\DoxyCodeLine{638                \textcolor{keywordflow}{If} (icrs < ifin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{639                   \textcolor{keywordflow}{Do}}
\DoxyCodeLine{640                      icrs = icrs + 1}
\DoxyCodeLine{641                      \textcolor{keywordflow}{If} (invals(ilowt(icrs)) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{642                         jlow = jlow + 1}
\DoxyCodeLine{643                         ilowt(jlow) = ilowt(icrs)}
\DoxyCodeLine{644                      \textcolor{keywordflow}{Else}}
\DoxyCodeLine{645                         \textcolor{keywordflow}{If} (icrs >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{646 \textcolor{keywordflow}{                     End If}}
\DoxyCodeLine{647 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{648 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{649            \textcolor{keywordflow}{Else}}
\DoxyCodeLine{650               lowloop5: \textcolor{keywordflow}{Do} icrs = ideb, ifin}
\DoxyCodeLine{651                   \textcolor{keywordflow}{If} (invals(ilowt(icrs)) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{652                      jhig = jhig + 1}
\DoxyCodeLine{653                      ihigt(jhig) = ilowt(icrs)}
\DoxyCodeLine{654                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{655                      xwrk1 = invals(ilowt(icrs))}
\DoxyCodeLine{656                      \textcolor{keywordflow}{Do} ilow = ideb, jlow}
\DoxyCodeLine{657                         \textcolor{keywordflow}{If} (xwrk1 == invals(ilowt(ilow))) \&}
\DoxyCodeLine{658                             cycle lowloop5}
\DoxyCodeLine{659 \textcolor{keywordflow}{                     End Do}}
\DoxyCodeLine{660                      jlow = jlow + 1}
\DoxyCodeLine{661                      ilowt(jlow) = ilowt(icrs)}
\DoxyCodeLine{662                      \textcolor{keywordflow}{If} (jlow >= nord) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{663 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{664 \textcolor{keywordflow}{               End Do} lowloop5}
\DoxyCodeLine{665 \textcolor{comment}{!}}
\DoxyCodeLine{666                \textcolor{keywordflow}{Do} icrs = icrs + 1, ifin}
\DoxyCodeLine{667                   \textcolor{keywordflow}{If} (invals(ilowt(icrs)) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{668                      jlow = jlow + 1}
\DoxyCodeLine{669                      ilowt(jlow) = ilowt(icrs)}
\DoxyCodeLine{670 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{671 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{672 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{673 \textcolor{comment}{!}}
\DoxyCodeLine{674 \textcolor{keywordflow}{         End Select}}
\DoxyCodeLine{675 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{676 \textcolor{comment}{!}}
\DoxyCodeLine{677 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{678 \textcolor{comment}{!}}
\DoxyCodeLine{679 \textcolor{comment}{!  Now, we only need to complete ranking of the 1:NORD set}}
\DoxyCodeLine{680 \textcolor{comment}{!  Assuming NORD is small, we use a simple insertion sort}}
\DoxyCodeLine{681 \textcolor{comment}{!}}
\DoxyCodeLine{682       irngt(1) = ilowt(1)}
\DoxyCodeLine{683       \textcolor{keywordflow}{Do} icrs = 2, nord}
\DoxyCodeLine{684          iwrk = ilowt(icrs)}
\DoxyCodeLine{685          xwrk = invals(iwrk)}
\DoxyCodeLine{686          \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{687             \textcolor{keywordflow}{If} (xwrk < invals(irngt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{688                irngt(idcr+1) = irngt(idcr)}
\DoxyCodeLine{689             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{690                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{691 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{692 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{693          irngt(idcr+1) = iwrk}
\DoxyCodeLine{694 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{695      \textcolor{keywordflow}{Return}}
\DoxyCodeLine{696 \textcolor{comment}{!}}
\DoxyCodeLine{697 \textcolor{comment}{!}}

\end{DoxyCode}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacem__orderpack____unipar_a192ff7cf342557a2f2c76667c999ce21}\label{namespacem__orderpack____unipar_a192ff7cf342557a2f2c76667c999ce21}} 
\index{m\_orderpack\_\_unipar@{m\_orderpack\_\_unipar}!f\_char@{f\_char}}
\index{f\_char@{f\_char}!m\_orderpack\_\_unipar@{m\_orderpack\_\_unipar}}
\doxysubsubsection{\texorpdfstring{f\_char}{f\_char}}
{\footnotesize\ttfamily integer, parameter m\+\_\+orderpack\+\_\+\+\_\+unipar\+::f\+\_\+char =selected\+\_\+char\+\_\+kind(\char`\"{}D\+E\+F\+A\+U\+LT\char`\"{})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{5 \textcolor{keywordtype}{integer},\textcolor{keywordtype}{parameter} :: f\_char=selected\_char\_kind(\textcolor{stringliteral}{"DEFAULT"})}

\end{DoxyCode}
