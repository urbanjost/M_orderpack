\hypertarget{namespacem__uniinv}{}\doxysection{m\+\_\+uniinv Module Reference}
\label{namespacem__uniinv}\index{m\_uniinv@{m\_uniinv}}
\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface \mbox{\hyperlink{interfacem__uniinv_1_1nearless}{nearless}}
\item 
interface \mbox{\hyperlink{interfacem__uniinv_1_1uniinv}{uniinv}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacem__uniinv_aa0a7596e11e337f9bb409e0bd496d4d3}{real64\+\_\+uniinv}} (X\+D\+O\+NT, I\+G\+O\+E\+ST)
\item 
real(kind=real64) function \mbox{\hyperlink{namespacem__uniinv_a869e1708aa9b20de9eed1b16d8184479}{real64\+\_\+nearless}} (X\+V\+AL)
\item 
subroutine \mbox{\hyperlink{namespacem__uniinv_a9199a88d435b2623cd72904069aa1401}{real32\+\_\+uniinv}} (X\+D\+O\+NT, I\+G\+O\+E\+ST)
\item 
real(kind=real32) function \mbox{\hyperlink{namespacem__uniinv_a897a2688266af18fc6b1f1cc134c3286}{real32\+\_\+nearless}} (X\+V\+AL)
\item 
subroutine \mbox{\hyperlink{namespacem__uniinv_a4d22f9758e3ab1ccf4d08ad0e72e1905}{int32\+\_\+uniinv}} (X\+D\+O\+NT, I\+G\+O\+E\+ST)
\item 
integer(kind=int32) function \mbox{\hyperlink{namespacem__uniinv_a4122a23d616699a990897245cdd1c54c}{int32\+\_\+nearless}} (X\+V\+AL)
\item 
subroutine \mbox{\hyperlink{namespacem__uniinv_ac68b6ac78d9370e2864921b8e70a2da8}{f\+\_\+char\+\_\+uniinv}} (X\+D\+O\+NT, I\+G\+O\+E\+ST)
\item 
character(kind=\mbox{\hyperlink{namespacem__uniinv_aae3df561c217bf871a83bafbc46f27ba}{f\+\_\+char}}, len=len(xval)) function \mbox{\hyperlink{namespacem__uniinv_af40df4c6f44a4e86ab7575ec1e2a3d48}{f\+\_\+char\+\_\+nearless}} (X\+V\+AL)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
integer, parameter \mbox{\hyperlink{namespacem__uniinv_aae3df561c217bf871a83bafbc46f27ba}{f\+\_\+char}} =selected\+\_\+char\+\_\+kind(\char`\"{}D\+E\+F\+A\+U\+LT\char`\"{})
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacem__uniinv_af40df4c6f44a4e86ab7575ec1e2a3d48}\label{namespacem__uniinv_af40df4c6f44a4e86ab7575ec1e2a3d48}} 
\index{m\_uniinv@{m\_uniinv}!f\_char\_nearless@{f\_char\_nearless}}
\index{f\_char\_nearless@{f\_char\_nearless}!m\_uniinv@{m\_uniinv}}
\doxysubsubsection{\texorpdfstring{f\_char\_nearless()}{f\_char\_nearless()}}
{\footnotesize\ttfamily character (kind=\mbox{\hyperlink{namespacem__uniinv_aae3df561c217bf871a83bafbc46f27ba}{f\+\_\+char}},len=len(xval)) function m\+\_\+uniinv\+::f\+\_\+char\+\_\+nearless (\begin{DoxyParamCaption}\item[{character (kind=\mbox{\hyperlink{namespacem__uniinv_aae3df561c217bf871a83bafbc46f27ba}{f\+\_\+char}},len=$\ast$), intent(in)}]{X\+V\+AL }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{1068 \textcolor{comment}{!! Nearest value less than given value}}
\DoxyCodeLine{1069 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1070       \textcolor{keywordtype}{character (kind=f\_char,len=*)}, \textcolor{keywordtype}{Intent (In)} :: XVAL}
\DoxyCodeLine{1071       \textcolor{keywordtype}{character (kind=f\_char,len=len(XVAL))} :: f\_char\_nl}
\DoxyCodeLine{1072 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1073       f\_char\_nl = xval}
\DoxyCodeLine{1074 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__uniinv_ac68b6ac78d9370e2864921b8e70a2da8}\label{namespacem__uniinv_ac68b6ac78d9370e2864921b8e70a2da8}} 
\index{m\_uniinv@{m\_uniinv}!f\_char\_uniinv@{f\_char\_uniinv}}
\index{f\_char\_uniinv@{f\_char\_uniinv}!m\_uniinv@{m\_uniinv}}
\doxysubsubsection{\texorpdfstring{f\_char\_uniinv()}{f\_char\_uniinv()}}
{\footnotesize\ttfamily subroutine m\+\_\+uniinv\+::f\+\_\+char\+\_\+uniinv (\begin{DoxyParamCaption}\item[{character (kind=\mbox{\hyperlink{namespacem__uniinv_aae3df561c217bf871a83bafbc46f27ba}{f\+\_\+char}},len=$\ast$), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, dimension (\+:), intent(out)}]{I\+G\+O\+E\+ST }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{832       \textcolor{keywordtype}{character (kind=f\_char,len=*)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDONT}
\DoxyCodeLine{833       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IGOEST}
\DoxyCodeLine{834 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{835       \textcolor{keywordtype}{character (kind=f\_char,len=len(XDONT))} :: XTST, XDONA, XDONB}
\DoxyCodeLine{836 \textcolor{comment}{!}}
\DoxyCodeLine{837 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{838       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IGOEST))} :: JWRKT, IRNGT}
\DoxyCodeLine{839       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2, NUNI}
\DoxyCodeLine{840       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{841 \textcolor{comment}{!}}
\DoxyCodeLine{842       nval = min(\textcolor{keyword}{SIZE}(xdont), \textcolor{keyword}{SIZE}(igoest))}
\DoxyCodeLine{843 \textcolor{comment}{!}}
\DoxyCodeLine{844       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{845       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{846          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{847       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{848          igoest(1) = 1}
\DoxyCodeLine{849          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{850 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{851          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{852 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{853 \textcolor{comment}{!}}
\DoxyCodeLine{854 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{855 \textcolor{comment}{!}}
\DoxyCodeLine{856       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{857          \textcolor{keywordflow}{If} (xdont(iind-\/1) < xdont(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{858             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{859             irngt(iind) = iind}
\DoxyCodeLine{860          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{861             irngt(iind-\/1) = iind}
\DoxyCodeLine{862             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{863 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{864 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{865       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{866          irngt(nval) = nval}
\DoxyCodeLine{867 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{868 \textcolor{comment}{!}}
\DoxyCodeLine{869 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{870 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{871 \textcolor{comment}{!}}
\DoxyCodeLine{872       lmtna = 2}
\DoxyCodeLine{873       lmtnc = 4}
\DoxyCodeLine{874 \textcolor{comment}{!}}
\DoxyCodeLine{875 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{876 \textcolor{comment}{!}}
\DoxyCodeLine{877       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{878          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{879 \textcolor{comment}{!}}
\DoxyCodeLine{880 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{881 \textcolor{comment}{!}}
\DoxyCodeLine{882          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{883             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{884                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{885 \textcolor{comment}{!}}
\DoxyCodeLine{886 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{887 \textcolor{comment}{!}}
\DoxyCodeLine{888                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{889 \textcolor{comment}{!}}
\DoxyCodeLine{890 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{891 \textcolor{comment}{!}}
\DoxyCodeLine{892                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{893                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{894                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{895                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{896 \textcolor{comment}{!}}
\DoxyCodeLine{897 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{898 \textcolor{comment}{!}}
\DoxyCodeLine{899                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{900                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{901                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{902                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{903                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{904 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{905                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{906 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{907 \textcolor{comment}{!}}
\DoxyCodeLine{908 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{909 \textcolor{comment}{!}}
\DoxyCodeLine{910             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{911 \textcolor{comment}{!}}
\DoxyCodeLine{912 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{913 \textcolor{comment}{!}}
\DoxyCodeLine{914             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{915                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{916                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{917                \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{918 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{919                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{920                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{921 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{922                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{923                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{924 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{925 \textcolor{comment}{!}}
\DoxyCodeLine{926 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{927 \textcolor{comment}{!}}
\DoxyCodeLine{928             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{929                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{930                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{931                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{932                \textcolor{keywordflow}{If} (xdont(irng1) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{933                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{934                   \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{935 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{936                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{937                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{938 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{939                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{940                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{941 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{942                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{943 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{944                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{945                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{946                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{947 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{948 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{949 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{950 \textcolor{comment}{!}}
\DoxyCodeLine{951 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{952 \textcolor{comment}{!}}
\DoxyCodeLine{953          lmtna = 4}
\DoxyCodeLine{954          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{955 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{956 \textcolor{comment}{!}}
\DoxyCodeLine{957 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{958 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{959 \textcolor{comment}{!}}
\DoxyCodeLine{960       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{961          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{962          iwrkf = 0}
\DoxyCodeLine{963          lmtnc = 2 * lmtnc}
\DoxyCodeLine{964 \textcolor{comment}{!}}
\DoxyCodeLine{965 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{966 \textcolor{comment}{!}}
\DoxyCodeLine{967          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{968             iwrk = iwrkf}
\DoxyCodeLine{969             iwrkd = iwrkf + 1}
\DoxyCodeLine{970             jinda = iwrkf + lmtna}
\DoxyCodeLine{971             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{972             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{973                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{974                iwrkf = nval}
\DoxyCodeLine{975 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{976             iinda = 1}
\DoxyCodeLine{977             iindb = jinda + 1}
\DoxyCodeLine{978 \textcolor{comment}{!}}
\DoxyCodeLine{979 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{980 \textcolor{comment}{!}}
\DoxyCodeLine{981 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{982 \textcolor{comment}{!}}
\DoxyCodeLine{983             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{984             xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{985             xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{986 \textcolor{comment}{!}}
\DoxyCodeLine{987             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{988                iwrk = iwrk + 1}
\DoxyCodeLine{989 \textcolor{comment}{!}}
\DoxyCodeLine{990 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{991 \textcolor{comment}{!}}
\DoxyCodeLine{992                \textcolor{keywordflow}{If} (xdona > xdonb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{993                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{994                   iindb = iindb + 1}
\DoxyCodeLine{995                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{996 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{997                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{998                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{999 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1000                   xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{1001                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1002                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{1003                   iinda = iinda + 1}
\DoxyCodeLine{1004                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{1005                   xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{1006 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1007 \textcolor{comment}{!}}
\DoxyCodeLine{1008 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1009 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1010 \textcolor{comment}{!}}
\DoxyCodeLine{1011 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{1012 \textcolor{comment}{!}}
\DoxyCodeLine{1013          lmtna = 2 * lmtna}
\DoxyCodeLine{1014 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{1015 \textcolor{comment}{!}}
\DoxyCodeLine{1016 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{1017 \textcolor{comment}{!}}
\DoxyCodeLine{1018       iinda = 1}
\DoxyCodeLine{1019       iindb = lmtna + 1}
\DoxyCodeLine{1020       nuni = 0}
\DoxyCodeLine{1021 \textcolor{comment}{!}}
\DoxyCodeLine{1022 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{1023 \textcolor{comment}{!}}
\DoxyCodeLine{1024       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{1025       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1026         xtst = nearless(min(xdont(jwrkt(1)), xdont(irngt(iindb))))}
\DoxyCodeLine{1027       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1028         xtst = nearless(xdont(jwrkt(1)))}
\DoxyCodeLine{1029 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{1030       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{1031 \textcolor{comment}{!}}
\DoxyCodeLine{1032 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{1033 \textcolor{comment}{!}}
\DoxyCodeLine{1034          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1035             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1036                \textcolor{keywordflow}{If} (xdont(jwrkt(iinda)) > xdont(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1037                   irng = irngt(iindb)}
\DoxyCodeLine{1038                   iindb = iindb + 1}
\DoxyCodeLine{1039                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1040                   irng = jwrkt(iinda)}
\DoxyCodeLine{1041                   iinda = iinda + 1}
\DoxyCodeLine{1042 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1043             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1044 \textcolor{comment}{!}}
\DoxyCodeLine{1045 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{1046 \textcolor{comment}{!}}
\DoxyCodeLine{1047                irng = jwrkt(iinda)}
\DoxyCodeLine{1048                iinda = iinda + 1}
\DoxyCodeLine{1049 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1050          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1051 \textcolor{comment}{!}}
\DoxyCodeLine{1052 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{1053 \textcolor{comment}{!}}
\DoxyCodeLine{1054             irng = irngt(iwrk)}
\DoxyCodeLine{1055 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1056          \textcolor{keywordflow}{If} (xdont(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1057             xtst = xdont(irng)}
\DoxyCodeLine{1058             nuni = nuni + 1}
\DoxyCodeLine{1059 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1060          igoest(irng) = nuni}
\DoxyCodeLine{1061 \textcolor{comment}{!}}
\DoxyCodeLine{1062 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{1063 \textcolor{comment}{!}}
\DoxyCodeLine{1064    igoest=igoest+1}
\DoxyCodeLine{1065 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__uniinv_a4122a23d616699a990897245cdd1c54c}\label{namespacem__uniinv_a4122a23d616699a990897245cdd1c54c}} 
\index{m\_uniinv@{m\_uniinv}!int32\_nearless@{int32\_nearless}}
\index{int32\_nearless@{int32\_nearless}!m\_uniinv@{m\_uniinv}}
\doxysubsubsection{\texorpdfstring{int32\_nearless()}{int32\_nearless()}}
{\footnotesize\ttfamily integer (kind=int32) function m\+\_\+uniinv\+::int32\+\_\+nearless (\begin{DoxyParamCaption}\item[{integer (kind=int32), intent(in)}]{X\+V\+AL }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{823 \textcolor{comment}{!! Nearest value less than given value}}
\DoxyCodeLine{824 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{825       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Intent (In)} :: XVAL}
\DoxyCodeLine{826       \textcolor{keywordtype}{Integer (kind=int32)} :: int32\_nl}
\DoxyCodeLine{827 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{828       int32\_nl = xval -\/1\_int32}
\DoxyCodeLine{829 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__uniinv_a4d22f9758e3ab1ccf4d08ad0e72e1905}\label{namespacem__uniinv_a4d22f9758e3ab1ccf4d08ad0e72e1905}} 
\index{m\_uniinv@{m\_uniinv}!int32\_uniinv@{int32\_uniinv}}
\index{int32\_uniinv@{int32\_uniinv}!m\_uniinv@{m\_uniinv}}
\doxysubsubsection{\texorpdfstring{int32\_uniinv()}{int32\_uniinv()}}
{\footnotesize\ttfamily subroutine m\+\_\+uniinv\+::int32\+\_\+uniinv (\begin{DoxyParamCaption}\item[{integer (kind=int32), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, dimension (\+:), intent(out)}]{I\+G\+O\+E\+ST }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{589       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDONT}
\DoxyCodeLine{590       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IGOEST}
\DoxyCodeLine{591 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{592       \textcolor{keywordtype}{Integer (kind=int32)} :: XTST, XDONA, XDONB}
\DoxyCodeLine{593 \textcolor{comment}{!}}
\DoxyCodeLine{594 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{595       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IGOEST))} :: JWRKT, IRNGT}
\DoxyCodeLine{596       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2, NUNI}
\DoxyCodeLine{597       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{598 \textcolor{comment}{!}}
\DoxyCodeLine{599       nval = min(\textcolor{keyword}{SIZE}(xdont), \textcolor{keyword}{SIZE}(igoest))}
\DoxyCodeLine{600 \textcolor{comment}{!}}
\DoxyCodeLine{601       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{602       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{603          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{604       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{605          igoest(1) = 1}
\DoxyCodeLine{606          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{607 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{608          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{609 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{610 \textcolor{comment}{!}}
\DoxyCodeLine{611 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{612 \textcolor{comment}{!}}
\DoxyCodeLine{613       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{614          \textcolor{keywordflow}{If} (xdont(iind-\/1) < xdont(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{615             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{616             irngt(iind) = iind}
\DoxyCodeLine{617          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{618             irngt(iind-\/1) = iind}
\DoxyCodeLine{619             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{620 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{621 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{622       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{623          irngt(nval) = nval}
\DoxyCodeLine{624 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{625 \textcolor{comment}{!}}
\DoxyCodeLine{626 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{627 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{628 \textcolor{comment}{!}}
\DoxyCodeLine{629       lmtna = 2}
\DoxyCodeLine{630       lmtnc = 4}
\DoxyCodeLine{631 \textcolor{comment}{!}}
\DoxyCodeLine{632 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{633 \textcolor{comment}{!}}
\DoxyCodeLine{634       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{635          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{636 \textcolor{comment}{!}}
\DoxyCodeLine{637 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{638 \textcolor{comment}{!}}
\DoxyCodeLine{639          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{640             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{641                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{642 \textcolor{comment}{!}}
\DoxyCodeLine{643 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{644 \textcolor{comment}{!}}
\DoxyCodeLine{645                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{646 \textcolor{comment}{!}}
\DoxyCodeLine{647 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{648 \textcolor{comment}{!}}
\DoxyCodeLine{649                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{650                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{651                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{652                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{653 \textcolor{comment}{!}}
\DoxyCodeLine{654 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{655 \textcolor{comment}{!}}
\DoxyCodeLine{656                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{657                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{658                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{659                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{660                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{661 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{662                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{663 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{664 \textcolor{comment}{!}}
\DoxyCodeLine{665 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{666 \textcolor{comment}{!}}
\DoxyCodeLine{667             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{668 \textcolor{comment}{!}}
\DoxyCodeLine{669 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{670 \textcolor{comment}{!}}
\DoxyCodeLine{671             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{672                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{673                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{674                \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{675 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{676                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{677                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{678 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{679                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{680                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{681 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{682 \textcolor{comment}{!}}
\DoxyCodeLine{683 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{684 \textcolor{comment}{!}}
\DoxyCodeLine{685             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{686                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{687                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{688                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{689                \textcolor{keywordflow}{If} (xdont(irng1) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{690                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{691                   \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{692 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{693                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{694                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{695 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{696                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{697                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{698 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{699                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{700 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{701                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{702                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{703                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{704 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{705 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{706 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{707 \textcolor{comment}{!}}
\DoxyCodeLine{708 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{709 \textcolor{comment}{!}}
\DoxyCodeLine{710          lmtna = 4}
\DoxyCodeLine{711          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{712 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{713 \textcolor{comment}{!}}
\DoxyCodeLine{714 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{715 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{716 \textcolor{comment}{!}}
\DoxyCodeLine{717       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{718          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{719          iwrkf = 0}
\DoxyCodeLine{720          lmtnc = 2 * lmtnc}
\DoxyCodeLine{721 \textcolor{comment}{!}}
\DoxyCodeLine{722 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{723 \textcolor{comment}{!}}
\DoxyCodeLine{724          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{725             iwrk = iwrkf}
\DoxyCodeLine{726             iwrkd = iwrkf + 1}
\DoxyCodeLine{727             jinda = iwrkf + lmtna}
\DoxyCodeLine{728             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{729             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{730                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{731                iwrkf = nval}
\DoxyCodeLine{732 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{733             iinda = 1}
\DoxyCodeLine{734             iindb = jinda + 1}
\DoxyCodeLine{735 \textcolor{comment}{!}}
\DoxyCodeLine{736 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{737 \textcolor{comment}{!}}
\DoxyCodeLine{738 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{739 \textcolor{comment}{!}}
\DoxyCodeLine{740             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{741             xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{742             xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{743 \textcolor{comment}{!}}
\DoxyCodeLine{744             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{745                iwrk = iwrk + 1}
\DoxyCodeLine{746 \textcolor{comment}{!}}
\DoxyCodeLine{747 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{748 \textcolor{comment}{!}}
\DoxyCodeLine{749                \textcolor{keywordflow}{If} (xdona > xdonb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{750                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{751                   iindb = iindb + 1}
\DoxyCodeLine{752                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{753 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{754                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{755                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{756 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{757                   xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{758                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{759                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{760                   iinda = iinda + 1}
\DoxyCodeLine{761                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{762                   xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{763 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{764 \textcolor{comment}{!}}
\DoxyCodeLine{765 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{766 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{767 \textcolor{comment}{!}}
\DoxyCodeLine{768 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{769 \textcolor{comment}{!}}
\DoxyCodeLine{770          lmtna = 2 * lmtna}
\DoxyCodeLine{771 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{772 \textcolor{comment}{!}}
\DoxyCodeLine{773 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{774 \textcolor{comment}{!}}
\DoxyCodeLine{775       iinda = 1}
\DoxyCodeLine{776       iindb = lmtna + 1}
\DoxyCodeLine{777       nuni = 0}
\DoxyCodeLine{778 \textcolor{comment}{!}}
\DoxyCodeLine{779 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{780 \textcolor{comment}{!}}
\DoxyCodeLine{781       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{782       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{783         xtst = nearless(min(xdont(jwrkt(1)), xdont(irngt(iindb))))}
\DoxyCodeLine{784       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{785         xtst = nearless(xdont(jwrkt(1)))}
\DoxyCodeLine{786 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{787       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{788 \textcolor{comment}{!}}
\DoxyCodeLine{789 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{790 \textcolor{comment}{!}}
\DoxyCodeLine{791          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{792             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{793                \textcolor{keywordflow}{If} (xdont(jwrkt(iinda)) > xdont(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{794                   irng = irngt(iindb)}
\DoxyCodeLine{795                   iindb = iindb + 1}
\DoxyCodeLine{796                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{797                   irng = jwrkt(iinda)}
\DoxyCodeLine{798                   iinda = iinda + 1}
\DoxyCodeLine{799 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{800             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{801 \textcolor{comment}{!}}
\DoxyCodeLine{802 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{803 \textcolor{comment}{!}}
\DoxyCodeLine{804                irng = jwrkt(iinda)}
\DoxyCodeLine{805                iinda = iinda + 1}
\DoxyCodeLine{806 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{807          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{808 \textcolor{comment}{!}}
\DoxyCodeLine{809 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{810 \textcolor{comment}{!}}
\DoxyCodeLine{811             irng = irngt(iwrk)}
\DoxyCodeLine{812 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{813          \textcolor{keywordflow}{If} (xdont(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{814             xtst = xdont(irng)}
\DoxyCodeLine{815             nuni = nuni + 1}
\DoxyCodeLine{816 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{817          igoest(irng) = nuni}
\DoxyCodeLine{818 \textcolor{comment}{!}}
\DoxyCodeLine{819 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{820 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__uniinv_a897a2688266af18fc6b1f1cc134c3286}\label{namespacem__uniinv_a897a2688266af18fc6b1f1cc134c3286}} 
\index{m\_uniinv@{m\_uniinv}!real32\_nearless@{real32\_nearless}}
\index{real32\_nearless@{real32\_nearless}!m\_uniinv@{m\_uniinv}}
\doxysubsubsection{\texorpdfstring{real32\_nearless()}{real32\_nearless()}}
{\footnotesize\ttfamily real (kind=real32) function m\+\_\+uniinv\+::real32\+\_\+nearless (\begin{DoxyParamCaption}\item[{real (kind=real32), intent(in)}]{X\+V\+AL }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{580 \textcolor{comment}{!! Nearest value less than given value}}
\DoxyCodeLine{581 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{582 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Intent (In)} :: xval}
\DoxyCodeLine{583 \textcolor{keywordtype}{      Real} (kind=real32) :: real32\_nl}
\DoxyCodeLine{584 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{585       real32\_nl = nearest(xval, -\/1.0\_real32)}
\DoxyCodeLine{586 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__uniinv_a9199a88d435b2623cd72904069aa1401}\label{namespacem__uniinv_a9199a88d435b2623cd72904069aa1401}} 
\index{m\_uniinv@{m\_uniinv}!real32\_uniinv@{real32\_uniinv}}
\index{real32\_uniinv@{real32\_uniinv}!m\_uniinv@{m\_uniinv}}
\doxysubsubsection{\texorpdfstring{real32\_uniinv()}{real32\_uniinv()}}
{\footnotesize\ttfamily subroutine m\+\_\+uniinv\+::real32\+\_\+uniinv (\begin{DoxyParamCaption}\item[{real (kind=real32), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, dimension (\+:), intent(out)}]{I\+G\+O\+E\+ST }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{346 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{347       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IGOEST}
\DoxyCodeLine{348 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{349 \textcolor{keywordtype}{      Real} (kind=real32) :: xtst, xdona, xdonb}
\DoxyCodeLine{350 \textcolor{comment}{!}}
\DoxyCodeLine{351 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{352       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IGOEST))} :: JWRKT, IRNGT}
\DoxyCodeLine{353       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2, NUNI}
\DoxyCodeLine{354       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{355 \textcolor{comment}{!}}
\DoxyCodeLine{356       nval = min(\textcolor{keyword}{SIZE}(xdont), \textcolor{keyword}{SIZE}(igoest))}
\DoxyCodeLine{357 \textcolor{comment}{!}}
\DoxyCodeLine{358       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{359       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{360          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{361       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{362          igoest(1) = 1}
\DoxyCodeLine{363          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{364 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{365          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{366 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{367 \textcolor{comment}{!}}
\DoxyCodeLine{368 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{369 \textcolor{comment}{!}}
\DoxyCodeLine{370       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{371          \textcolor{keywordflow}{If} (xdont(iind-\/1) < xdont(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{372             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{373             irngt(iind) = iind}
\DoxyCodeLine{374          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{375             irngt(iind-\/1) = iind}
\DoxyCodeLine{376             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{377 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{378 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{379       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{380          irngt(nval) = nval}
\DoxyCodeLine{381 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{382 \textcolor{comment}{!}}
\DoxyCodeLine{383 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{384 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{385 \textcolor{comment}{!}}
\DoxyCodeLine{386       lmtna = 2}
\DoxyCodeLine{387       lmtnc = 4}
\DoxyCodeLine{388 \textcolor{comment}{!}}
\DoxyCodeLine{389 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{390 \textcolor{comment}{!}}
\DoxyCodeLine{391       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{392          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{393 \textcolor{comment}{!}}
\DoxyCodeLine{394 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{395 \textcolor{comment}{!}}
\DoxyCodeLine{396          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{397             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{398                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{399 \textcolor{comment}{!}}
\DoxyCodeLine{400 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{401 \textcolor{comment}{!}}
\DoxyCodeLine{402                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{403 \textcolor{comment}{!}}
\DoxyCodeLine{404 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{405 \textcolor{comment}{!}}
\DoxyCodeLine{406                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{407                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{408                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{409                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{410 \textcolor{comment}{!}}
\DoxyCodeLine{411 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{412 \textcolor{comment}{!}}
\DoxyCodeLine{413                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{414                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{415                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{416                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{417                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{418 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{419                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{420 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{421 \textcolor{comment}{!}}
\DoxyCodeLine{422 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{423 \textcolor{comment}{!}}
\DoxyCodeLine{424             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{425 \textcolor{comment}{!}}
\DoxyCodeLine{426 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{427 \textcolor{comment}{!}}
\DoxyCodeLine{428             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{429                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{430                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{431                \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{432 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{433                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{434                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{435 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{436                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{437                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{438 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{439 \textcolor{comment}{!}}
\DoxyCodeLine{440 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{441 \textcolor{comment}{!}}
\DoxyCodeLine{442             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{443                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{444                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{445                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{446                \textcolor{keywordflow}{If} (xdont(irng1) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{447                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{448                   \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{449 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{450                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{451                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{452 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{453                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{454                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{455 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{456                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{457 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{458                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{459                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{460                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{461 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{462 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{463 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{464 \textcolor{comment}{!}}
\DoxyCodeLine{465 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{466 \textcolor{comment}{!}}
\DoxyCodeLine{467          lmtna = 4}
\DoxyCodeLine{468          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{469 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{470 \textcolor{comment}{!}}
\DoxyCodeLine{471 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{472 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{473 \textcolor{comment}{!}}
\DoxyCodeLine{474       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{475          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{476          iwrkf = 0}
\DoxyCodeLine{477          lmtnc = 2 * lmtnc}
\DoxyCodeLine{478 \textcolor{comment}{!}}
\DoxyCodeLine{479 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{480 \textcolor{comment}{!}}
\DoxyCodeLine{481          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{482             iwrk = iwrkf}
\DoxyCodeLine{483             iwrkd = iwrkf + 1}
\DoxyCodeLine{484             jinda = iwrkf + lmtna}
\DoxyCodeLine{485             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{486             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{487                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{488                iwrkf = nval}
\DoxyCodeLine{489 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{490             iinda = 1}
\DoxyCodeLine{491             iindb = jinda + 1}
\DoxyCodeLine{492 \textcolor{comment}{!}}
\DoxyCodeLine{493 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{494 \textcolor{comment}{!}}
\DoxyCodeLine{495 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{496 \textcolor{comment}{!}}
\DoxyCodeLine{497             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{498             xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{499             xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{500 \textcolor{comment}{!}}
\DoxyCodeLine{501             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{502                iwrk = iwrk + 1}
\DoxyCodeLine{503 \textcolor{comment}{!}}
\DoxyCodeLine{504 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{505 \textcolor{comment}{!}}
\DoxyCodeLine{506                \textcolor{keywordflow}{If} (xdona > xdonb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{507                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{508                   iindb = iindb + 1}
\DoxyCodeLine{509                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{510 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{511                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{512                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{513 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{514                   xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{515                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{516                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{517                   iinda = iinda + 1}
\DoxyCodeLine{518                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{519                   xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{520 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{521 \textcolor{comment}{!}}
\DoxyCodeLine{522 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{523 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{524 \textcolor{comment}{!}}
\DoxyCodeLine{525 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{526 \textcolor{comment}{!}}
\DoxyCodeLine{527          lmtna = 2 * lmtna}
\DoxyCodeLine{528 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{529 \textcolor{comment}{!}}
\DoxyCodeLine{530 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{531 \textcolor{comment}{!}}
\DoxyCodeLine{532       iinda = 1}
\DoxyCodeLine{533       iindb = lmtna + 1}
\DoxyCodeLine{534       nuni = 0}
\DoxyCodeLine{535 \textcolor{comment}{!}}
\DoxyCodeLine{536 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{537 \textcolor{comment}{!}}
\DoxyCodeLine{538       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{539       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{540         xtst = nearless(min(xdont(jwrkt(1)), xdont(irngt(iindb))))}
\DoxyCodeLine{541       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{542         xtst = nearless(xdont(jwrkt(1)))}
\DoxyCodeLine{543 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{544       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{545 \textcolor{comment}{!}}
\DoxyCodeLine{546 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{547 \textcolor{comment}{!}}
\DoxyCodeLine{548          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{549             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{550                \textcolor{keywordflow}{If} (xdont(jwrkt(iinda)) > xdont(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{551                   irng = irngt(iindb)}
\DoxyCodeLine{552                   iindb = iindb + 1}
\DoxyCodeLine{553                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{554                   irng = jwrkt(iinda)}
\DoxyCodeLine{555                   iinda = iinda + 1}
\DoxyCodeLine{556 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{557             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{558 \textcolor{comment}{!}}
\DoxyCodeLine{559 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{560 \textcolor{comment}{!}}
\DoxyCodeLine{561                irng = jwrkt(iinda)}
\DoxyCodeLine{562                iinda = iinda + 1}
\DoxyCodeLine{563 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{564          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{565 \textcolor{comment}{!}}
\DoxyCodeLine{566 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{567 \textcolor{comment}{!}}
\DoxyCodeLine{568             irng = irngt(iwrk)}
\DoxyCodeLine{569 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{570          \textcolor{keywordflow}{If} (xdont(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{571             xtst = xdont(irng)}
\DoxyCodeLine{572             nuni = nuni + 1}
\DoxyCodeLine{573 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{574          igoest(irng) = nuni}
\DoxyCodeLine{575 \textcolor{comment}{!}}
\DoxyCodeLine{576 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{577 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__uniinv_a869e1708aa9b20de9eed1b16d8184479}\label{namespacem__uniinv_a869e1708aa9b20de9eed1b16d8184479}} 
\index{m\_uniinv@{m\_uniinv}!real64\_nearless@{real64\_nearless}}
\index{real64\_nearless@{real64\_nearless}!m\_uniinv@{m\_uniinv}}
\doxysubsubsection{\texorpdfstring{real64\_nearless()}{real64\_nearless()}}
{\footnotesize\ttfamily real (kind=real64) function m\+\_\+uniinv\+::real64\+\_\+nearless (\begin{DoxyParamCaption}\item[{real (kind=real64), intent(in)}]{X\+V\+AL }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{337 \textcolor{comment}{!! Nearest value less than given value}}
\DoxyCodeLine{338 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{339 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Intent (In)} :: xval}
\DoxyCodeLine{340 \textcolor{keywordtype}{      Real} (kind=real64) :: real64\_nl}
\DoxyCodeLine{341 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{342       real64\_nl = nearest(xval, -\/1.0\_real64)}
\DoxyCodeLine{343 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__uniinv_aa0a7596e11e337f9bb409e0bd496d4d3}\label{namespacem__uniinv_aa0a7596e11e337f9bb409e0bd496d4d3}} 
\index{m\_uniinv@{m\_uniinv}!real64\_uniinv@{real64\_uniinv}}
\index{real64\_uniinv@{real64\_uniinv}!m\_uniinv@{m\_uniinv}}
\doxysubsubsection{\texorpdfstring{real64\_uniinv()}{real64\_uniinv()}}
{\footnotesize\ttfamily subroutine m\+\_\+uniinv\+::real64\+\_\+uniinv (\begin{DoxyParamCaption}\item[{real (kind=real64), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, dimension (\+:), intent(out)}]{I\+G\+O\+E\+ST }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\hypertarget{namespacem__uniinv_autotoc_md111}{}\doxysubsubsection{N\+A\+ME}\label{namespacem__uniinv_autotoc_md111}
uniinv(3f) -\/ \mbox{[}orderpack\+:\+R\+A\+NK\+:U\+N\+I\+Q\+UE\mbox{]} a Merge\+Sort inverse ranking of an array, with duplicate entries assigned the same rank.\hypertarget{namespacem__uniinv_autotoc_md112}{}\doxysubsubsection{S\+Y\+N\+O\+P\+S\+IS}\label{namespacem__uniinv_autotoc_md112}
\begin{DoxyVerb} Subroutine uniinv (XDONT, IGOEST)

   ${TYPE} (kind=${KIND}), Intent (In) :: XDONT(:)
   Integer, Intent (Out)               :: IGOEST(:)

Where ${TYPE}(kind=${KIND}) may be

   o Real(kind=real32)
   o Real(kind=real64)
   o Integer(kind=int32)
   o Character(kind=selected_char_kind("DEFAULT"),len=*)
\end{DoxyVerb}
\hypertarget{namespacem__uniinv_autotoc_md113}{}\doxysubsubsection{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}\label{namespacem__uniinv_autotoc_md113}
\begin{DoxyVerb}UNIINV(3f) is a merge-sort inverse ranking of an array, but with
duplicate entries assigned the same rank.

The routine is similar to pure merge-sort ranking, but on the last
pass, it sets indices in IGOEST to the rank of the value in the ordered
set with duplicates ignored.  For performance reasons, the first two
passes are taken out of the standard loop, and use dedicated coding.
\end{DoxyVerb}
\hypertarget{namespacem__uniinv_autotoc_md114}{}\doxysubsubsection{O\+P\+T\+I\+O\+NS}\label{namespacem__uniinv_autotoc_md114}
X\+D\+O\+NT array to rank I\+G\+O\+E\+ST returned rank array\hypertarget{namespacem__uniinv_autotoc_md115}{}\doxysubsubsection{E\+X\+A\+M\+P\+L\+ES}\label{namespacem__uniinv_autotoc_md115}
Sample program\+:

program demo\+\_\+uniinv ! rank input array ranking duplicates the same use M\+\_\+uniinv, only \+: uniinv implicit none character(len=$\ast$),parameter \+:: fmt=\textquotesingle{}(a,$\ast$(g3.\+3,1x))\textquotesingle{} integer,allocatable,dimension(\+:) \+:: xdont, igoest, distinct, count integer \+:: imx, i ! create an input array xdont=\mbox{[}11, 11, 22, 11, 33, 33, 22, 33, 33\mbox{]} ! make an index array of the same size if(allocated(igoest))deallocate(igoest) allocate(igoest(size(xdont))) print fmt, \textquotesingle{}Original\+: \textquotesingle{},xdont print fmt, \textquotesingle{}Number of indices to sort\+:\textquotesingle{},size(xdont) ! rank input array ranking duplicates the same call uniinv(xdont,igoest) print fmt, \textquotesingle{}Returned Indices\+: \textquotesingle{},igoest(\+:) ! ! interrogate the results ! imx=maxval(igoest) print fmt, \textquotesingle{}Number of unique indices \+:\textquotesingle{},imx ! squeeze it down to just I\+MX unique values count=\mbox{[}(0,i=1,imx)\mbox{]} ! count how many times a value occurs distinct=count ! array to set of unique values do i=1,size(xdont) distinct(igoest(i))=xdont(i) count(igoest(i))= count(igoest(i))+1 enddo print fmt, \textquotesingle{}Sorted unique values\+: \textquotesingle{},distinct print fmt, \textquotesingle{}count of occurrences\+: \textquotesingle{},count end program demo\+\_\+uniinv

Results\+:

Original\+: 11 11 22 11 33 33 22 33 33 Number of indices to sort\+: 9 Returned Indices\+: 1 1 2 1 3 3 2 3 3 Number of unique indices \+: 3 Sorted unique values\+: 11 22 33 count of occurrences\+: 3 2 4\hypertarget{namespacem__uniinv_autotoc_md116}{}\doxysubsubsection{A\+U\+T\+H\+OR}\label{namespacem__uniinv_autotoc_md116}
Michel Olagnon, 2000-\/2012

John Urban, 2022.\+04.\+16 o added man-\/page and reduced to a template using the prep(1) preprocessor.\hypertarget{namespacem__uniinv_autotoc_md117}{}\doxysubsubsection{L\+I\+C\+E\+N\+SE}\label{namespacem__uniinv_autotoc_md117}
C\+C0-\/1.\+0 
\begin{DoxyCode}{0}
\DoxyCodeLine{103 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{104       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IGOEST}
\DoxyCodeLine{105 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{106 \textcolor{keywordtype}{      Real} (kind=real64) :: xtst, xdona, xdonb}
\DoxyCodeLine{107 \textcolor{comment}{!}}
\DoxyCodeLine{108 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{109       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IGOEST))} :: JWRKT, IRNGT}
\DoxyCodeLine{110       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2, NUNI}
\DoxyCodeLine{111       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{112 \textcolor{comment}{!}}
\DoxyCodeLine{113       nval = min(\textcolor{keyword}{SIZE}(xdont), \textcolor{keyword}{SIZE}(igoest))}
\DoxyCodeLine{114 \textcolor{comment}{!}}
\DoxyCodeLine{115       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{116       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{117          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{118       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{119          igoest(1) = 1}
\DoxyCodeLine{120          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{121 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{122          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{123 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{124 \textcolor{comment}{!}}
\DoxyCodeLine{125 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{126 \textcolor{comment}{!}}
\DoxyCodeLine{127       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{128          \textcolor{keywordflow}{If} (xdont(iind-\/1) < xdont(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{129             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{130             irngt(iind) = iind}
\DoxyCodeLine{131          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{132             irngt(iind-\/1) = iind}
\DoxyCodeLine{133             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{134 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{135 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{136       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{137          irngt(nval) = nval}
\DoxyCodeLine{138 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{139 \textcolor{comment}{!}}
\DoxyCodeLine{140 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{141 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{142 \textcolor{comment}{!}}
\DoxyCodeLine{143       lmtna = 2}
\DoxyCodeLine{144       lmtnc = 4}
\DoxyCodeLine{145 \textcolor{comment}{!}}
\DoxyCodeLine{146 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{147 \textcolor{comment}{!}}
\DoxyCodeLine{148       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{149          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{150 \textcolor{comment}{!}}
\DoxyCodeLine{151 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{152 \textcolor{comment}{!}}
\DoxyCodeLine{153          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{154             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{155                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{156 \textcolor{comment}{!}}
\DoxyCodeLine{157 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{158 \textcolor{comment}{!}}
\DoxyCodeLine{159                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{160 \textcolor{comment}{!}}
\DoxyCodeLine{161 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{162 \textcolor{comment}{!}}
\DoxyCodeLine{163                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{164                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{165                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{166                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{167 \textcolor{comment}{!}}
\DoxyCodeLine{168 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{169 \textcolor{comment}{!}}
\DoxyCodeLine{170                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{171                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{172                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{173                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{174                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{175 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{176                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{177 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{178 \textcolor{comment}{!}}
\DoxyCodeLine{179 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{180 \textcolor{comment}{!}}
\DoxyCodeLine{181             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{182 \textcolor{comment}{!}}
\DoxyCodeLine{183 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{184 \textcolor{comment}{!}}
\DoxyCodeLine{185             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{186                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{187                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{188                \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{189 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{190                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{191                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{192 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{193                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{194                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{195 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{196 \textcolor{comment}{!}}
\DoxyCodeLine{197 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{198 \textcolor{comment}{!}}
\DoxyCodeLine{199             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{200                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{201                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{202                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{203                \textcolor{keywordflow}{If} (xdont(irng1) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{204                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{205                   \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{206 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{207                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{208                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{209 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{210                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{211                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{212 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{213                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{214 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{215                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{216                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{217                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{218 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{219 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{220 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{221 \textcolor{comment}{!}}
\DoxyCodeLine{222 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{223 \textcolor{comment}{!}}
\DoxyCodeLine{224          lmtna = 4}
\DoxyCodeLine{225          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{226 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{227 \textcolor{comment}{!}}
\DoxyCodeLine{228 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{229 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{230 \textcolor{comment}{!}}
\DoxyCodeLine{231       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{232          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{233          iwrkf = 0}
\DoxyCodeLine{234          lmtnc = 2 * lmtnc}
\DoxyCodeLine{235 \textcolor{comment}{!}}
\DoxyCodeLine{236 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{237 \textcolor{comment}{!}}
\DoxyCodeLine{238          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{239             iwrk = iwrkf}
\DoxyCodeLine{240             iwrkd = iwrkf + 1}
\DoxyCodeLine{241             jinda = iwrkf + lmtna}
\DoxyCodeLine{242             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{243             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{244                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{245                iwrkf = nval}
\DoxyCodeLine{246 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{247             iinda = 1}
\DoxyCodeLine{248             iindb = jinda + 1}
\DoxyCodeLine{249 \textcolor{comment}{!}}
\DoxyCodeLine{250 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{251 \textcolor{comment}{!}}
\DoxyCodeLine{252 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{253 \textcolor{comment}{!}}
\DoxyCodeLine{254             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{255             xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{256             xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{257 \textcolor{comment}{!}}
\DoxyCodeLine{258             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{259                iwrk = iwrk + 1}
\DoxyCodeLine{260 \textcolor{comment}{!}}
\DoxyCodeLine{261 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{262 \textcolor{comment}{!}}
\DoxyCodeLine{263                \textcolor{keywordflow}{If} (xdona > xdonb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{264                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{265                   iindb = iindb + 1}
\DoxyCodeLine{266                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{267 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{268                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{269                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{270 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{271                   xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{272                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{273                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{274                   iinda = iinda + 1}
\DoxyCodeLine{275                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{276                   xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{277 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{278 \textcolor{comment}{!}}
\DoxyCodeLine{279 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{280 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{281 \textcolor{comment}{!}}
\DoxyCodeLine{282 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{283 \textcolor{comment}{!}}
\DoxyCodeLine{284          lmtna = 2 * lmtna}
\DoxyCodeLine{285 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{286 \textcolor{comment}{!}}
\DoxyCodeLine{287 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{288 \textcolor{comment}{!}}
\DoxyCodeLine{289       iinda = 1}
\DoxyCodeLine{290       iindb = lmtna + 1}
\DoxyCodeLine{291       nuni = 0}
\DoxyCodeLine{292 \textcolor{comment}{!}}
\DoxyCodeLine{293 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{294 \textcolor{comment}{!}}
\DoxyCodeLine{295       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{296       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{297         xtst = nearless(min(xdont(jwrkt(1)), xdont(irngt(iindb))))}
\DoxyCodeLine{298       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{299         xtst = nearless(xdont(jwrkt(1)))}
\DoxyCodeLine{300 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{301       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{302 \textcolor{comment}{!}}
\DoxyCodeLine{303 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{304 \textcolor{comment}{!}}
\DoxyCodeLine{305          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{306             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{307                \textcolor{keywordflow}{If} (xdont(jwrkt(iinda)) > xdont(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{308                   irng = irngt(iindb)}
\DoxyCodeLine{309                   iindb = iindb + 1}
\DoxyCodeLine{310                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{311                   irng = jwrkt(iinda)}
\DoxyCodeLine{312                   iinda = iinda + 1}
\DoxyCodeLine{313 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{314             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{315 \textcolor{comment}{!}}
\DoxyCodeLine{316 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{317 \textcolor{comment}{!}}
\DoxyCodeLine{318                irng = jwrkt(iinda)}
\DoxyCodeLine{319                iinda = iinda + 1}
\DoxyCodeLine{320 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{321          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{322 \textcolor{comment}{!}}
\DoxyCodeLine{323 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{324 \textcolor{comment}{!}}
\DoxyCodeLine{325             irng = irngt(iwrk)}
\DoxyCodeLine{326 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{327          \textcolor{keywordflow}{If} (xdont(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{328             xtst = xdont(irng)}
\DoxyCodeLine{329             nuni = nuni + 1}
\DoxyCodeLine{330 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{331          igoest(irng) = nuni}
\DoxyCodeLine{332 \textcolor{comment}{!}}
\DoxyCodeLine{333 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{334 \textcolor{comment}{!}}

\end{DoxyCode}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacem__uniinv_aae3df561c217bf871a83bafbc46f27ba}\label{namespacem__uniinv_aae3df561c217bf871a83bafbc46f27ba}} 
\index{m\_uniinv@{m\_uniinv}!f\_char@{f\_char}}
\index{f\_char@{f\_char}!m\_uniinv@{m\_uniinv}}
\doxysubsubsection{\texorpdfstring{f\_char}{f\_char}}
{\footnotesize\ttfamily integer, parameter m\+\_\+uniinv\+::f\+\_\+char =selected\+\_\+char\+\_\+kind(\char`\"{}D\+E\+F\+A\+U\+LT\char`\"{})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{5 \textcolor{keywordtype}{integer},\textcolor{keywordtype}{parameter} :: f\_char=selected\_char\_kind(\textcolor{stringliteral}{"DEFAULT"})}

\end{DoxyCode}
