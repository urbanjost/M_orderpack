\hypertarget{namespacem__uniinv}{}\doxysection{m\+\_\+uniinv Module Reference}
\label{namespacem__uniinv}\index{m\_uniinv@{m\_uniinv}}
\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface \mbox{\hyperlink{interfacem__uniinv_1_1nearless}{nearless}}
\item 
interface \mbox{\hyperlink{interfacem__uniinv_1_1uniinv}{uniinv}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacem__uniinv_aa0a7596e11e337f9bb409e0bd496d4d3}{real64\+\_\+uniinv}} (X\+D\+O\+NT, I\+G\+O\+E\+ST)
\item 
real(kind=real64) function \mbox{\hyperlink{namespacem__uniinv_a869e1708aa9b20de9eed1b16d8184479}{real64\+\_\+nearless}} (X\+V\+AL)
\item 
subroutine \mbox{\hyperlink{namespacem__uniinv_a9199a88d435b2623cd72904069aa1401}{real32\+\_\+uniinv}} (X\+D\+O\+NT, I\+G\+O\+E\+ST)
\item 
real(kind=real32) function \mbox{\hyperlink{namespacem__uniinv_a897a2688266af18fc6b1f1cc134c3286}{real32\+\_\+nearless}} (X\+V\+AL)
\item 
subroutine \mbox{\hyperlink{namespacem__uniinv_a4d22f9758e3ab1ccf4d08ad0e72e1905}{int32\+\_\+uniinv}} (X\+D\+O\+NT, I\+G\+O\+E\+ST)
\item 
integer(kind=int32) function \mbox{\hyperlink{namespacem__uniinv_a4122a23d616699a990897245cdd1c54c}{int32\+\_\+nearless}} (X\+V\+AL)
\item 
subroutine \mbox{\hyperlink{namespacem__uniinv_ac68b6ac78d9370e2864921b8e70a2da8}{f\+\_\+char\+\_\+uniinv}} (X\+D\+O\+NT, I\+G\+O\+E\+ST)
\item 
character(kind=\mbox{\hyperlink{namespacem__uniinv_aae3df561c217bf871a83bafbc46f27ba}{f\+\_\+char}}, len=len(xval)) function \mbox{\hyperlink{namespacem__uniinv_af40df4c6f44a4e86ab7575ec1e2a3d48}{f\+\_\+char\+\_\+nearless}} (X\+V\+AL)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
integer, parameter \mbox{\hyperlink{namespacem__uniinv_aae3df561c217bf871a83bafbc46f27ba}{f\+\_\+char}} =selected\+\_\+char\+\_\+kind(\char`\"{}D\+E\+F\+A\+U\+LT\char`\"{})
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacem__uniinv_af40df4c6f44a4e86ab7575ec1e2a3d48}\label{namespacem__uniinv_af40df4c6f44a4e86ab7575ec1e2a3d48}} 
\index{m\_uniinv@{m\_uniinv}!f\_char\_nearless@{f\_char\_nearless}}
\index{f\_char\_nearless@{f\_char\_nearless}!m\_uniinv@{m\_uniinv}}
\doxysubsubsection{\texorpdfstring{f\_char\_nearless()}{f\_char\_nearless()}}
{\footnotesize\ttfamily character (kind=\mbox{\hyperlink{namespacem__uniinv_aae3df561c217bf871a83bafbc46f27ba}{f\+\_\+char}},len=len(xval)) function m\+\_\+uniinv\+::f\+\_\+char\+\_\+nearless (\begin{DoxyParamCaption}\item[{character (kind=\mbox{\hyperlink{namespacem__uniinv_aae3df561c217bf871a83bafbc46f27ba}{f\+\_\+char}},len=$\ast$), intent(in)}]{X\+V\+AL }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{1084 \textcolor{comment}{!! Nearest value less than given value}}
\DoxyCodeLine{1085 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1086       \textcolor{keywordtype}{character (kind=f\_char,len=*)}, \textcolor{keywordtype}{Intent (In)} :: XVAL}
\DoxyCodeLine{1087       \textcolor{keywordtype}{character (kind=f\_char,len=len(XVAL))} :: f\_char\_nl}
\DoxyCodeLine{1088 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1089       f\_char\_nl = xval}
\DoxyCodeLine{1090 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__uniinv_ac68b6ac78d9370e2864921b8e70a2da8}\label{namespacem__uniinv_ac68b6ac78d9370e2864921b8e70a2da8}} 
\index{m\_uniinv@{m\_uniinv}!f\_char\_uniinv@{f\_char\_uniinv}}
\index{f\_char\_uniinv@{f\_char\_uniinv}!m\_uniinv@{m\_uniinv}}
\doxysubsubsection{\texorpdfstring{f\_char\_uniinv()}{f\_char\_uniinv()}}
{\footnotesize\ttfamily subroutine m\+\_\+uniinv\+::f\+\_\+char\+\_\+uniinv (\begin{DoxyParamCaption}\item[{character (kind=\mbox{\hyperlink{namespacem__uniinv_aae3df561c217bf871a83bafbc46f27ba}{f\+\_\+char}},len=$\ast$), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, dimension (\+:), intent(out)}]{I\+G\+O\+E\+ST }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{844       \textcolor{keywordtype}{character (kind=f\_char,len=*)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDONT}
\DoxyCodeLine{845       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IGOEST}
\DoxyCodeLine{846 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{847       \textcolor{keywordtype}{character (kind=f\_char,len=len(XDONT))} :: XTST, XDONA, XDONB}
\DoxyCodeLine{848 \textcolor{comment}{!}}
\DoxyCodeLine{849 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{850       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IGOEST))} :: JWRKT, IRNGT}
\DoxyCodeLine{851       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2, NUNI}
\DoxyCodeLine{852       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{853 \textcolor{comment}{!}}
\DoxyCodeLine{854       nval = min(\textcolor{keyword}{SIZE}(xdont), \textcolor{keyword}{SIZE}(igoest))}
\DoxyCodeLine{855 \textcolor{comment}{!}}
\DoxyCodeLine{856       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{857       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{858          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{859       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{860          igoest(1) = 1}
\DoxyCodeLine{861          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{862 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{863          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{864 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{865 \textcolor{comment}{!}}
\DoxyCodeLine{866 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{867 \textcolor{comment}{!}}
\DoxyCodeLine{868       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{869          \textcolor{keywordflow}{If} (xdont(iind-\/1) < xdont(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{870             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{871             irngt(iind) = iind}
\DoxyCodeLine{872          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{873             irngt(iind-\/1) = iind}
\DoxyCodeLine{874             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{875 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{876 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{877       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{878          irngt(nval) = nval}
\DoxyCodeLine{879 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{880 \textcolor{comment}{!}}
\DoxyCodeLine{881 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{882 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{883 \textcolor{comment}{!}}
\DoxyCodeLine{884       lmtna = 2}
\DoxyCodeLine{885       lmtnc = 4}
\DoxyCodeLine{886 \textcolor{comment}{!}}
\DoxyCodeLine{887 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{888 \textcolor{comment}{!}}
\DoxyCodeLine{889       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{890          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{891 \textcolor{comment}{!}}
\DoxyCodeLine{892 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{893 \textcolor{comment}{!}}
\DoxyCodeLine{894          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{895             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{896                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{897 \textcolor{comment}{!}}
\DoxyCodeLine{898 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{899 \textcolor{comment}{!}}
\DoxyCodeLine{900                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{901 \textcolor{comment}{!}}
\DoxyCodeLine{902 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{903 \textcolor{comment}{!}}
\DoxyCodeLine{904                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{905                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{906                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{907                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{908 \textcolor{comment}{!}}
\DoxyCodeLine{909 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{910 \textcolor{comment}{!}}
\DoxyCodeLine{911                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{912                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{913                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{914                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{915                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{916 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{917                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{918 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{919 \textcolor{comment}{!}}
\DoxyCodeLine{920 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{921 \textcolor{comment}{!}}
\DoxyCodeLine{922             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{923 \textcolor{comment}{!}}
\DoxyCodeLine{924 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{925 \textcolor{comment}{!}}
\DoxyCodeLine{926             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{927                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{928                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{929                \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{930 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{931                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{932                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{933 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{934                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{935                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{936 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{937 \textcolor{comment}{!}}
\DoxyCodeLine{938 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{939 \textcolor{comment}{!}}
\DoxyCodeLine{940             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{941                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{942                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{943                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{944                \textcolor{keywordflow}{If} (xdont(irng1) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{945                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{946                   \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{947 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{948                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{949                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{950 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{951                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{952                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{953 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{954                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{955 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{956                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{957                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{958                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{959 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{960 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{961 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{962 \textcolor{comment}{!}}
\DoxyCodeLine{963 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{964 \textcolor{comment}{!}}
\DoxyCodeLine{965          lmtna = 4}
\DoxyCodeLine{966          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{967 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{968 \textcolor{comment}{!}}
\DoxyCodeLine{969 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{970 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{971 \textcolor{comment}{!}}
\DoxyCodeLine{972       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{973          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{974          iwrkf = 0}
\DoxyCodeLine{975          lmtnc = 2 * lmtnc}
\DoxyCodeLine{976 \textcolor{comment}{!}}
\DoxyCodeLine{977 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{978 \textcolor{comment}{!}}
\DoxyCodeLine{979          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{980             iwrk = iwrkf}
\DoxyCodeLine{981             iwrkd = iwrkf + 1}
\DoxyCodeLine{982             jinda = iwrkf + lmtna}
\DoxyCodeLine{983             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{984             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{985                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{986                iwrkf = nval}
\DoxyCodeLine{987 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{988             iinda = 1}
\DoxyCodeLine{989             iindb = jinda + 1}
\DoxyCodeLine{990 \textcolor{comment}{!}}
\DoxyCodeLine{991 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{992 \textcolor{comment}{!}}
\DoxyCodeLine{993 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{994 \textcolor{comment}{!}}
\DoxyCodeLine{995             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{996             xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{997             xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{998 \textcolor{comment}{!}}
\DoxyCodeLine{999             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{1000                iwrk = iwrk + 1}
\DoxyCodeLine{1001 \textcolor{comment}{!}}
\DoxyCodeLine{1002 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{1003 \textcolor{comment}{!}}
\DoxyCodeLine{1004                \textcolor{keywordflow}{If} (xdona > xdonb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1005                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{1006                   iindb = iindb + 1}
\DoxyCodeLine{1007                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1008 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{1009                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{1010                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1011 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1012                   xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{1013                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1014                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{1015                   iinda = iinda + 1}
\DoxyCodeLine{1016                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{1017                   xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{1018 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1019 \textcolor{comment}{!}}
\DoxyCodeLine{1020 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1021 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1022 \textcolor{comment}{!}}
\DoxyCodeLine{1023 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{1024 \textcolor{comment}{!}}
\DoxyCodeLine{1025          lmtna = 2 * lmtna}
\DoxyCodeLine{1026 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{1027 \textcolor{comment}{!}}
\DoxyCodeLine{1028 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{1029 \textcolor{comment}{!}}
\DoxyCodeLine{1030       iinda = 1}
\DoxyCodeLine{1031       iindb = lmtna + 1}
\DoxyCodeLine{1032       nuni = 0}
\DoxyCodeLine{1033 \textcolor{comment}{!}}
\DoxyCodeLine{1034 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{1035 \textcolor{comment}{!}}
\DoxyCodeLine{1036       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{1037       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1038         \textcolor{keywordflow}{If} (xdont(jwrkt(1)) < xdont(irngt(iindb)) ) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1039            xtst = nearless(xdont(jwrkt(1)))}
\DoxyCodeLine{1040         \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1041            xtst = nearless(xdont(irngt(iindb)))}
\DoxyCodeLine{1042 \textcolor{keywordflow}{        Endif}}
\DoxyCodeLine{1043       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1044         xtst = nearless(xdont(jwrkt(1)))}
\DoxyCodeLine{1045 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{1046       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{1047 \textcolor{comment}{!}}
\DoxyCodeLine{1048 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{1049 \textcolor{comment}{!}}
\DoxyCodeLine{1050          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1051             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1052                \textcolor{keywordflow}{If} (xdont(jwrkt(iinda)) > xdont(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1053                   irng = irngt(iindb)}
\DoxyCodeLine{1054                   iindb = iindb + 1}
\DoxyCodeLine{1055                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1056                   irng = jwrkt(iinda)}
\DoxyCodeLine{1057                   iinda = iinda + 1}
\DoxyCodeLine{1058 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1059             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1060 \textcolor{comment}{!}}
\DoxyCodeLine{1061 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{1062 \textcolor{comment}{!}}
\DoxyCodeLine{1063                irng = jwrkt(iinda)}
\DoxyCodeLine{1064                iinda = iinda + 1}
\DoxyCodeLine{1065 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1066          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1067 \textcolor{comment}{!}}
\DoxyCodeLine{1068 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{1069 \textcolor{comment}{!}}
\DoxyCodeLine{1070             irng = irngt(iwrk)}
\DoxyCodeLine{1071 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1072          \textcolor{keywordflow}{If} (xdont(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1073             xtst = xdont(irng)}
\DoxyCodeLine{1074             nuni = nuni + 1}
\DoxyCodeLine{1075 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1076          igoest(irng) = nuni}
\DoxyCodeLine{1077 \textcolor{comment}{!}}
\DoxyCodeLine{1078 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{1079 \textcolor{comment}{!}}
\DoxyCodeLine{1080    igoest=igoest+1}
\DoxyCodeLine{1081 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__uniinv_a4122a23d616699a990897245cdd1c54c}\label{namespacem__uniinv_a4122a23d616699a990897245cdd1c54c}} 
\index{m\_uniinv@{m\_uniinv}!int32\_nearless@{int32\_nearless}}
\index{int32\_nearless@{int32\_nearless}!m\_uniinv@{m\_uniinv}}
\doxysubsubsection{\texorpdfstring{int32\_nearless()}{int32\_nearless()}}
{\footnotesize\ttfamily integer (kind=int32) function m\+\_\+uniinv\+::int32\+\_\+nearless (\begin{DoxyParamCaption}\item[{integer (kind=int32), intent(in)}]{X\+V\+AL }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{835 \textcolor{comment}{!! Nearest value less than given value}}
\DoxyCodeLine{836 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{837       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Intent (In)} :: XVAL}
\DoxyCodeLine{838       \textcolor{keywordtype}{Integer (kind=int32)} :: int32\_nl}
\DoxyCodeLine{839 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{840       int32\_nl = xval -\/1\_int32}
\DoxyCodeLine{841 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__uniinv_a4d22f9758e3ab1ccf4d08ad0e72e1905}\label{namespacem__uniinv_a4d22f9758e3ab1ccf4d08ad0e72e1905}} 
\index{m\_uniinv@{m\_uniinv}!int32\_uniinv@{int32\_uniinv}}
\index{int32\_uniinv@{int32\_uniinv}!m\_uniinv@{m\_uniinv}}
\doxysubsubsection{\texorpdfstring{int32\_uniinv()}{int32\_uniinv()}}
{\footnotesize\ttfamily subroutine m\+\_\+uniinv\+::int32\+\_\+uniinv (\begin{DoxyParamCaption}\item[{integer (kind=int32), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, dimension (\+:), intent(out)}]{I\+G\+O\+E\+ST }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{597       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDONT}
\DoxyCodeLine{598       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IGOEST}
\DoxyCodeLine{599 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{600       \textcolor{keywordtype}{Integer (kind=int32)} :: XTST, XDONA, XDONB}
\DoxyCodeLine{601 \textcolor{comment}{!}}
\DoxyCodeLine{602 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{603       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IGOEST))} :: JWRKT, IRNGT}
\DoxyCodeLine{604       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2, NUNI}
\DoxyCodeLine{605       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{606 \textcolor{comment}{!}}
\DoxyCodeLine{607       nval = min(\textcolor{keyword}{SIZE}(xdont), \textcolor{keyword}{SIZE}(igoest))}
\DoxyCodeLine{608 \textcolor{comment}{!}}
\DoxyCodeLine{609       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{610       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{611          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{612       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{613          igoest(1) = 1}
\DoxyCodeLine{614          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{615 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{616          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{617 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{618 \textcolor{comment}{!}}
\DoxyCodeLine{619 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{620 \textcolor{comment}{!}}
\DoxyCodeLine{621       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{622          \textcolor{keywordflow}{If} (xdont(iind-\/1) < xdont(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{623             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{624             irngt(iind) = iind}
\DoxyCodeLine{625          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{626             irngt(iind-\/1) = iind}
\DoxyCodeLine{627             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{628 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{629 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{630       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{631          irngt(nval) = nval}
\DoxyCodeLine{632 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{633 \textcolor{comment}{!}}
\DoxyCodeLine{634 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{635 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{636 \textcolor{comment}{!}}
\DoxyCodeLine{637       lmtna = 2}
\DoxyCodeLine{638       lmtnc = 4}
\DoxyCodeLine{639 \textcolor{comment}{!}}
\DoxyCodeLine{640 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{641 \textcolor{comment}{!}}
\DoxyCodeLine{642       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{643          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{644 \textcolor{comment}{!}}
\DoxyCodeLine{645 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{646 \textcolor{comment}{!}}
\DoxyCodeLine{647          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{648             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{649                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{650 \textcolor{comment}{!}}
\DoxyCodeLine{651 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{652 \textcolor{comment}{!}}
\DoxyCodeLine{653                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{654 \textcolor{comment}{!}}
\DoxyCodeLine{655 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{656 \textcolor{comment}{!}}
\DoxyCodeLine{657                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{658                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{659                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{660                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{661 \textcolor{comment}{!}}
\DoxyCodeLine{662 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{663 \textcolor{comment}{!}}
\DoxyCodeLine{664                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{665                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{666                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{667                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{668                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{669 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{670                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{671 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{672 \textcolor{comment}{!}}
\DoxyCodeLine{673 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{674 \textcolor{comment}{!}}
\DoxyCodeLine{675             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{676 \textcolor{comment}{!}}
\DoxyCodeLine{677 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{678 \textcolor{comment}{!}}
\DoxyCodeLine{679             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{680                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{681                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{682                \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{683 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{684                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{685                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{686 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{687                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{688                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{689 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{690 \textcolor{comment}{!}}
\DoxyCodeLine{691 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{692 \textcolor{comment}{!}}
\DoxyCodeLine{693             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{694                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{695                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{696                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{697                \textcolor{keywordflow}{If} (xdont(irng1) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{698                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{699                   \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{700 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{701                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{702                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{703 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{704                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{705                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{706 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{707                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{708 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{709                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{710                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{711                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{712 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{713 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{714 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{715 \textcolor{comment}{!}}
\DoxyCodeLine{716 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{717 \textcolor{comment}{!}}
\DoxyCodeLine{718          lmtna = 4}
\DoxyCodeLine{719          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{720 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{721 \textcolor{comment}{!}}
\DoxyCodeLine{722 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{723 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{724 \textcolor{comment}{!}}
\DoxyCodeLine{725       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{726          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{727          iwrkf = 0}
\DoxyCodeLine{728          lmtnc = 2 * lmtnc}
\DoxyCodeLine{729 \textcolor{comment}{!}}
\DoxyCodeLine{730 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{731 \textcolor{comment}{!}}
\DoxyCodeLine{732          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{733             iwrk = iwrkf}
\DoxyCodeLine{734             iwrkd = iwrkf + 1}
\DoxyCodeLine{735             jinda = iwrkf + lmtna}
\DoxyCodeLine{736             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{737             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{738                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{739                iwrkf = nval}
\DoxyCodeLine{740 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{741             iinda = 1}
\DoxyCodeLine{742             iindb = jinda + 1}
\DoxyCodeLine{743 \textcolor{comment}{!}}
\DoxyCodeLine{744 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{745 \textcolor{comment}{!}}
\DoxyCodeLine{746 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{747 \textcolor{comment}{!}}
\DoxyCodeLine{748             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{749             xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{750             xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{751 \textcolor{comment}{!}}
\DoxyCodeLine{752             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{753                iwrk = iwrk + 1}
\DoxyCodeLine{754 \textcolor{comment}{!}}
\DoxyCodeLine{755 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{756 \textcolor{comment}{!}}
\DoxyCodeLine{757                \textcolor{keywordflow}{If} (xdona > xdonb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{758                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{759                   iindb = iindb + 1}
\DoxyCodeLine{760                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{761 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{762                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{763                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{764 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{765                   xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{766                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{767                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{768                   iinda = iinda + 1}
\DoxyCodeLine{769                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{770                   xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{771 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{772 \textcolor{comment}{!}}
\DoxyCodeLine{773 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{774 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{775 \textcolor{comment}{!}}
\DoxyCodeLine{776 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{777 \textcolor{comment}{!}}
\DoxyCodeLine{778          lmtna = 2 * lmtna}
\DoxyCodeLine{779 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{780 \textcolor{comment}{!}}
\DoxyCodeLine{781 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{782 \textcolor{comment}{!}}
\DoxyCodeLine{783       iinda = 1}
\DoxyCodeLine{784       iindb = lmtna + 1}
\DoxyCodeLine{785       nuni = 0}
\DoxyCodeLine{786 \textcolor{comment}{!}}
\DoxyCodeLine{787 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{788 \textcolor{comment}{!}}
\DoxyCodeLine{789       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{790       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{791         \textcolor{keywordflow}{If} (xdont(jwrkt(1)) < xdont(irngt(iindb)) ) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{792            xtst = nearless(xdont(jwrkt(1)))}
\DoxyCodeLine{793         \textcolor{keywordflow}{Else}}
\DoxyCodeLine{794            xtst = nearless(xdont(irngt(iindb)))}
\DoxyCodeLine{795 \textcolor{keywordflow}{        Endif}}
\DoxyCodeLine{796       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{797         xtst = nearless(xdont(jwrkt(1)))}
\DoxyCodeLine{798 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{799       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{800 \textcolor{comment}{!}}
\DoxyCodeLine{801 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{802 \textcolor{comment}{!}}
\DoxyCodeLine{803          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{804             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{805                \textcolor{keywordflow}{If} (xdont(jwrkt(iinda)) > xdont(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{806                   irng = irngt(iindb)}
\DoxyCodeLine{807                   iindb = iindb + 1}
\DoxyCodeLine{808                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{809                   irng = jwrkt(iinda)}
\DoxyCodeLine{810                   iinda = iinda + 1}
\DoxyCodeLine{811 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{812             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{813 \textcolor{comment}{!}}
\DoxyCodeLine{814 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{815 \textcolor{comment}{!}}
\DoxyCodeLine{816                irng = jwrkt(iinda)}
\DoxyCodeLine{817                iinda = iinda + 1}
\DoxyCodeLine{818 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{819          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{820 \textcolor{comment}{!}}
\DoxyCodeLine{821 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{822 \textcolor{comment}{!}}
\DoxyCodeLine{823             irng = irngt(iwrk)}
\DoxyCodeLine{824 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{825          \textcolor{keywordflow}{If} (xdont(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{826             xtst = xdont(irng)}
\DoxyCodeLine{827             nuni = nuni + 1}
\DoxyCodeLine{828 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{829          igoest(irng) = nuni}
\DoxyCodeLine{830 \textcolor{comment}{!}}
\DoxyCodeLine{831 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{832 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__uniinv_a897a2688266af18fc6b1f1cc134c3286}\label{namespacem__uniinv_a897a2688266af18fc6b1f1cc134c3286}} 
\index{m\_uniinv@{m\_uniinv}!real32\_nearless@{real32\_nearless}}
\index{real32\_nearless@{real32\_nearless}!m\_uniinv@{m\_uniinv}}
\doxysubsubsection{\texorpdfstring{real32\_nearless()}{real32\_nearless()}}
{\footnotesize\ttfamily real (kind=real32) function m\+\_\+uniinv\+::real32\+\_\+nearless (\begin{DoxyParamCaption}\item[{real (kind=real32), intent(in)}]{X\+V\+AL }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{588 \textcolor{comment}{!! Nearest value less than given value}}
\DoxyCodeLine{589 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{590 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Intent (In)} :: xval}
\DoxyCodeLine{591 \textcolor{keywordtype}{      Real} (kind=real32) :: real32\_nl}
\DoxyCodeLine{592 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{593       real32\_nl = nearest(xval, -\/1.0\_real32)}
\DoxyCodeLine{594 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__uniinv_a9199a88d435b2623cd72904069aa1401}\label{namespacem__uniinv_a9199a88d435b2623cd72904069aa1401}} 
\index{m\_uniinv@{m\_uniinv}!real32\_uniinv@{real32\_uniinv}}
\index{real32\_uniinv@{real32\_uniinv}!m\_uniinv@{m\_uniinv}}
\doxysubsubsection{\texorpdfstring{real32\_uniinv()}{real32\_uniinv()}}
{\footnotesize\ttfamily subroutine m\+\_\+uniinv\+::real32\+\_\+uniinv (\begin{DoxyParamCaption}\item[{real (kind=real32), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, dimension (\+:), intent(out)}]{I\+G\+O\+E\+ST }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{350 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{351       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IGOEST}
\DoxyCodeLine{352 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{353 \textcolor{keywordtype}{      Real} (kind=real32) :: xtst, xdona, xdonb}
\DoxyCodeLine{354 \textcolor{comment}{!}}
\DoxyCodeLine{355 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{356       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IGOEST))} :: JWRKT, IRNGT}
\DoxyCodeLine{357       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2, NUNI}
\DoxyCodeLine{358       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{359 \textcolor{comment}{!}}
\DoxyCodeLine{360       nval = min(\textcolor{keyword}{SIZE}(xdont), \textcolor{keyword}{SIZE}(igoest))}
\DoxyCodeLine{361 \textcolor{comment}{!}}
\DoxyCodeLine{362       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{363       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{364          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{365       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{366          igoest(1) = 1}
\DoxyCodeLine{367          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{368 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{369          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{370 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{371 \textcolor{comment}{!}}
\DoxyCodeLine{372 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{373 \textcolor{comment}{!}}
\DoxyCodeLine{374       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{375          \textcolor{keywordflow}{If} (xdont(iind-\/1) < xdont(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{376             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{377             irngt(iind) = iind}
\DoxyCodeLine{378          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{379             irngt(iind-\/1) = iind}
\DoxyCodeLine{380             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{381 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{382 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{383       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{384          irngt(nval) = nval}
\DoxyCodeLine{385 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{386 \textcolor{comment}{!}}
\DoxyCodeLine{387 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{388 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{389 \textcolor{comment}{!}}
\DoxyCodeLine{390       lmtna = 2}
\DoxyCodeLine{391       lmtnc = 4}
\DoxyCodeLine{392 \textcolor{comment}{!}}
\DoxyCodeLine{393 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{394 \textcolor{comment}{!}}
\DoxyCodeLine{395       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{396          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{397 \textcolor{comment}{!}}
\DoxyCodeLine{398 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{399 \textcolor{comment}{!}}
\DoxyCodeLine{400          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{401             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{402                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{403 \textcolor{comment}{!}}
\DoxyCodeLine{404 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{405 \textcolor{comment}{!}}
\DoxyCodeLine{406                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{407 \textcolor{comment}{!}}
\DoxyCodeLine{408 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{409 \textcolor{comment}{!}}
\DoxyCodeLine{410                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{411                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{412                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{413                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{414 \textcolor{comment}{!}}
\DoxyCodeLine{415 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{416 \textcolor{comment}{!}}
\DoxyCodeLine{417                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{418                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{419                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{420                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{421                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{422 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{423                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{424 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{425 \textcolor{comment}{!}}
\DoxyCodeLine{426 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{427 \textcolor{comment}{!}}
\DoxyCodeLine{428             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{429 \textcolor{comment}{!}}
\DoxyCodeLine{430 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{431 \textcolor{comment}{!}}
\DoxyCodeLine{432             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{433                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{434                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{435                \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{436 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{437                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{438                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{439 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{440                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{441                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{442 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{443 \textcolor{comment}{!}}
\DoxyCodeLine{444 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{445 \textcolor{comment}{!}}
\DoxyCodeLine{446             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{447                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{448                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{449                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{450                \textcolor{keywordflow}{If} (xdont(irng1) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{451                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{452                   \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{453 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{454                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{455                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{456 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{457                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{458                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{459 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{460                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{461 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{462                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{463                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{464                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{465 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{466 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{467 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{468 \textcolor{comment}{!}}
\DoxyCodeLine{469 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{470 \textcolor{comment}{!}}
\DoxyCodeLine{471          lmtna = 4}
\DoxyCodeLine{472          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{473 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{474 \textcolor{comment}{!}}
\DoxyCodeLine{475 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{476 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{477 \textcolor{comment}{!}}
\DoxyCodeLine{478       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{479          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{480          iwrkf = 0}
\DoxyCodeLine{481          lmtnc = 2 * lmtnc}
\DoxyCodeLine{482 \textcolor{comment}{!}}
\DoxyCodeLine{483 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{484 \textcolor{comment}{!}}
\DoxyCodeLine{485          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{486             iwrk = iwrkf}
\DoxyCodeLine{487             iwrkd = iwrkf + 1}
\DoxyCodeLine{488             jinda = iwrkf + lmtna}
\DoxyCodeLine{489             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{490             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{491                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{492                iwrkf = nval}
\DoxyCodeLine{493 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{494             iinda = 1}
\DoxyCodeLine{495             iindb = jinda + 1}
\DoxyCodeLine{496 \textcolor{comment}{!}}
\DoxyCodeLine{497 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{498 \textcolor{comment}{!}}
\DoxyCodeLine{499 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{500 \textcolor{comment}{!}}
\DoxyCodeLine{501             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{502             xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{503             xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{504 \textcolor{comment}{!}}
\DoxyCodeLine{505             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{506                iwrk = iwrk + 1}
\DoxyCodeLine{507 \textcolor{comment}{!}}
\DoxyCodeLine{508 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{509 \textcolor{comment}{!}}
\DoxyCodeLine{510                \textcolor{keywordflow}{If} (xdona > xdonb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{511                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{512                   iindb = iindb + 1}
\DoxyCodeLine{513                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{514 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{515                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{516                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{517 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{518                   xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{519                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{520                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{521                   iinda = iinda + 1}
\DoxyCodeLine{522                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{523                   xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{524 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{525 \textcolor{comment}{!}}
\DoxyCodeLine{526 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{527 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{528 \textcolor{comment}{!}}
\DoxyCodeLine{529 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{530 \textcolor{comment}{!}}
\DoxyCodeLine{531          lmtna = 2 * lmtna}
\DoxyCodeLine{532 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{533 \textcolor{comment}{!}}
\DoxyCodeLine{534 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{535 \textcolor{comment}{!}}
\DoxyCodeLine{536       iinda = 1}
\DoxyCodeLine{537       iindb = lmtna + 1}
\DoxyCodeLine{538       nuni = 0}
\DoxyCodeLine{539 \textcolor{comment}{!}}
\DoxyCodeLine{540 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{541 \textcolor{comment}{!}}
\DoxyCodeLine{542       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{543       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{544         \textcolor{keywordflow}{If} (xdont(jwrkt(1)) < xdont(irngt(iindb)) ) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{545            xtst = nearless(xdont(jwrkt(1)))}
\DoxyCodeLine{546         \textcolor{keywordflow}{Else}}
\DoxyCodeLine{547            xtst = nearless(xdont(irngt(iindb)))}
\DoxyCodeLine{548 \textcolor{keywordflow}{        Endif}}
\DoxyCodeLine{549       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{550         xtst = nearless(xdont(jwrkt(1)))}
\DoxyCodeLine{551 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{552       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{553 \textcolor{comment}{!}}
\DoxyCodeLine{554 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{555 \textcolor{comment}{!}}
\DoxyCodeLine{556          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{557             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{558                \textcolor{keywordflow}{If} (xdont(jwrkt(iinda)) > xdont(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{559                   irng = irngt(iindb)}
\DoxyCodeLine{560                   iindb = iindb + 1}
\DoxyCodeLine{561                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{562                   irng = jwrkt(iinda)}
\DoxyCodeLine{563                   iinda = iinda + 1}
\DoxyCodeLine{564 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{565             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{566 \textcolor{comment}{!}}
\DoxyCodeLine{567 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{568 \textcolor{comment}{!}}
\DoxyCodeLine{569                irng = jwrkt(iinda)}
\DoxyCodeLine{570                iinda = iinda + 1}
\DoxyCodeLine{571 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{572          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{573 \textcolor{comment}{!}}
\DoxyCodeLine{574 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{575 \textcolor{comment}{!}}
\DoxyCodeLine{576             irng = irngt(iwrk)}
\DoxyCodeLine{577 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{578          \textcolor{keywordflow}{If} (xdont(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{579             xtst = xdont(irng)}
\DoxyCodeLine{580             nuni = nuni + 1}
\DoxyCodeLine{581 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{582          igoest(irng) = nuni}
\DoxyCodeLine{583 \textcolor{comment}{!}}
\DoxyCodeLine{584 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{585 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__uniinv_a869e1708aa9b20de9eed1b16d8184479}\label{namespacem__uniinv_a869e1708aa9b20de9eed1b16d8184479}} 
\index{m\_uniinv@{m\_uniinv}!real64\_nearless@{real64\_nearless}}
\index{real64\_nearless@{real64\_nearless}!m\_uniinv@{m\_uniinv}}
\doxysubsubsection{\texorpdfstring{real64\_nearless()}{real64\_nearless()}}
{\footnotesize\ttfamily real (kind=real64) function m\+\_\+uniinv\+::real64\+\_\+nearless (\begin{DoxyParamCaption}\item[{real (kind=real64), intent(in)}]{X\+V\+AL }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{341 \textcolor{comment}{!! Nearest value less than given value}}
\DoxyCodeLine{342 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{343 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Intent (In)} :: xval}
\DoxyCodeLine{344 \textcolor{keywordtype}{      Real} (kind=real64) :: real64\_nl}
\DoxyCodeLine{345 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{346       real64\_nl = nearest(xval, -\/1.0\_real64)}
\DoxyCodeLine{347 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__uniinv_aa0a7596e11e337f9bb409e0bd496d4d3}\label{namespacem__uniinv_aa0a7596e11e337f9bb409e0bd496d4d3}} 
\index{m\_uniinv@{m\_uniinv}!real64\_uniinv@{real64\_uniinv}}
\index{real64\_uniinv@{real64\_uniinv}!m\_uniinv@{m\_uniinv}}
\doxysubsubsection{\texorpdfstring{real64\_uniinv()}{real64\_uniinv()}}
{\footnotesize\ttfamily subroutine m\+\_\+uniinv\+::real64\+\_\+uniinv (\begin{DoxyParamCaption}\item[{real (kind=real64), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, dimension (\+:), intent(out)}]{I\+G\+O\+E\+ST }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\hypertarget{namespacem__uniinv_autotoc_md111}{}\doxysubsubsection{N\+A\+ME}\label{namespacem__uniinv_autotoc_md111}
uniinv(3f) -\/ \mbox{[}orderpack\+:\+R\+A\+NK\+:U\+N\+I\+Q\+UE\mbox{]} ranks an array, with duplicate entries assigned the same rank(\+Merge\+Sort)\hypertarget{namespacem__uniinv_autotoc_md112}{}\doxysubsubsection{S\+Y\+N\+O\+P\+S\+IS}\label{namespacem__uniinv_autotoc_md112}
\begin{DoxyVerb} Subroutine uniinv (XDONT, IGOEST)

   ${TYPE} (kind=${KIND}), Intent (In) :: XDONT(:)
   Integer, Intent (Out)               :: IGOEST(:)

Where ${TYPE}(kind=${KIND}) may be

   o Real(kind=real32)
   o Real(kind=real64)
   o Integer(kind=int32)
   o Character(kind=selected_char_kind("DEFAULT"),len=*)
\end{DoxyVerb}
\hypertarget{namespacem__uniinv_autotoc_md113}{}\doxysubsubsection{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}\label{namespacem__uniinv_autotoc_md113}
\begin{DoxyVerb}UNIINV(3f) is a merge-sort inverse ranking of an array, but with
duplicate entries assigned the same rank.

The routine is similar to pure merge-sort ranking, but on the last
pass, it sets indices in IGOEST to the rank of the value in the ordered
set with duplicates ignored. For performance reasons, the first two
passes are taken out of the standard loop, and use dedicated coding.
\end{DoxyVerb}
\hypertarget{namespacem__uniinv_autotoc_md114}{}\doxysubsubsection{O\+P\+T\+I\+O\+NS}\label{namespacem__uniinv_autotoc_md114}
X\+D\+O\+NT array to rank I\+G\+O\+E\+ST returned rank array\hypertarget{namespacem__uniinv_autotoc_md115}{}\doxysubsubsection{E\+X\+A\+M\+P\+L\+ES}\label{namespacem__uniinv_autotoc_md115}
Sample program\+:

program demo\+\_\+uniinv ! rank input array ranking duplicates the same use M\+\_\+uniinv, only \+: uniinv implicit none character(len=$\ast$),parameter \+:: fmt=\textquotesingle{}(a,$\ast$(g3.\+3,1x))\textquotesingle{} integer,allocatable,dimension(\+:) \+:: xdont, igoest, distinct, count integer \+:: imx, i ! create an input array xdont=\mbox{[}11, 11, 22, 11, 33, 33, 22, 33, 33\mbox{]} ! make an index array of the same size if(allocated(igoest))deallocate(igoest) allocate(igoest(size(xdont))) print fmt, \textquotesingle{}Original\+: \textquotesingle{},xdont print fmt, \textquotesingle{}Number of indices to sort\+:\textquotesingle{},size(xdont) ! rank input array ranking duplicates the same call uniinv(xdont,igoest) print fmt, \textquotesingle{}Returned Indices\+: \textquotesingle{},igoest(\+:) ! ! interrogate the results ! imx=maxval(igoest) print fmt, \textquotesingle{}Number of unique indices \+:\textquotesingle{},imx ! squeeze it down to just I\+MX unique values count=\mbox{[}(0,i=1,imx)\mbox{]} ! count how many times a value occurs distinct=count ! array to set of unique values do i=1,size(xdont) distinct(igoest(i))=xdont(i) count(igoest(i))= count(igoest(i))+1 enddo print fmt, \textquotesingle{}Sorted unique values\+: \textquotesingle{},distinct print fmt, \textquotesingle{}count of occurrences\+: \textquotesingle{},count end program demo\+\_\+uniinv

Results\+:

Original\+: 11 11 22 11 33 33 22 33 33 Number of indices to sort\+: 9 Returned Indices\+: 1 1 2 1 3 3 2 3 3 Number of unique indices \+: 3 Sorted unique values\+: 11 22 33 count of occurrences\+: 3 2 4\hypertarget{namespacem__uniinv_autotoc_md116}{}\doxysubsubsection{A\+U\+T\+H\+OR}\label{namespacem__uniinv_autotoc_md116}
Michel Olagnon, 2000-\/2012

John Urban, 2022.\+04.\+16 o added man-\/page and reduced to a template using the prep(1) preprocessor.\hypertarget{namespacem__uniinv_autotoc_md117}{}\doxysubsubsection{L\+I\+C\+E\+N\+SE}\label{namespacem__uniinv_autotoc_md117}
C\+C0-\/1.\+0 
\begin{DoxyCode}{0}
\DoxyCodeLine{103 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{104       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IGOEST}
\DoxyCodeLine{105 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{106 \textcolor{keywordtype}{      Real} (kind=real64) :: xtst, xdona, xdonb}
\DoxyCodeLine{107 \textcolor{comment}{!}}
\DoxyCodeLine{108 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{109       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IGOEST))} :: JWRKT, IRNGT}
\DoxyCodeLine{110       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2, NUNI}
\DoxyCodeLine{111       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{112 \textcolor{comment}{!}}
\DoxyCodeLine{113       nval = min(\textcolor{keyword}{SIZE}(xdont), \textcolor{keyword}{SIZE}(igoest))}
\DoxyCodeLine{114 \textcolor{comment}{!}}
\DoxyCodeLine{115       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{116       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{117          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{118       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{119          igoest(1) = 1}
\DoxyCodeLine{120          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{121 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{122          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{123 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{124 \textcolor{comment}{!}}
\DoxyCodeLine{125 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{126 \textcolor{comment}{!}}
\DoxyCodeLine{127       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{128          \textcolor{keywordflow}{If} (xdont(iind-\/1) < xdont(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{129             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{130             irngt(iind) = iind}
\DoxyCodeLine{131          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{132             irngt(iind-\/1) = iind}
\DoxyCodeLine{133             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{134 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{135 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{136       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{137          irngt(nval) = nval}
\DoxyCodeLine{138 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{139 \textcolor{comment}{!}}
\DoxyCodeLine{140 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{141 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{142 \textcolor{comment}{!}}
\DoxyCodeLine{143       lmtna = 2}
\DoxyCodeLine{144       lmtnc = 4}
\DoxyCodeLine{145 \textcolor{comment}{!}}
\DoxyCodeLine{146 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{147 \textcolor{comment}{!}}
\DoxyCodeLine{148       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{149          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{150 \textcolor{comment}{!}}
\DoxyCodeLine{151 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{152 \textcolor{comment}{!}}
\DoxyCodeLine{153          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{154             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{155                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{156 \textcolor{comment}{!}}
\DoxyCodeLine{157 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{158 \textcolor{comment}{!}}
\DoxyCodeLine{159                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{160 \textcolor{comment}{!}}
\DoxyCodeLine{161 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{162 \textcolor{comment}{!}}
\DoxyCodeLine{163                \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{164                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{165                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{166                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{167 \textcolor{comment}{!}}
\DoxyCodeLine{168 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{169 \textcolor{comment}{!}}
\DoxyCodeLine{170                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{171                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{172                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{173                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{174                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{175 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{176                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{177 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{178 \textcolor{comment}{!}}
\DoxyCodeLine{179 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{180 \textcolor{comment}{!}}
\DoxyCodeLine{181             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+2)) <= xdont(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{182 \textcolor{comment}{!}}
\DoxyCodeLine{183 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{184 \textcolor{comment}{!}}
\DoxyCodeLine{185             \textcolor{keywordflow}{If} (xdont(irngt(iwrkd+1)) <= xdont(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{186                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{187                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{188                \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{189 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{190                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{191                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{192 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{193                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{194                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{195 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{196 \textcolor{comment}{!}}
\DoxyCodeLine{197 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{198 \textcolor{comment}{!}}
\DoxyCodeLine{199             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{200                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{201                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{202                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{203                \textcolor{keywordflow}{If} (xdont(irng1) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{204                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{205                   \textcolor{keywordflow}{If} (xdont(irng2) <= xdont(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{206 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{207                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{208                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{209 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{210                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{211                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{212 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{213                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{214 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{215                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{216                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{217                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{218 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{219 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{220 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{221 \textcolor{comment}{!}}
\DoxyCodeLine{222 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{223 \textcolor{comment}{!}}
\DoxyCodeLine{224          lmtna = 4}
\DoxyCodeLine{225          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{226 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{227 \textcolor{comment}{!}}
\DoxyCodeLine{228 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{229 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{230 \textcolor{comment}{!}}
\DoxyCodeLine{231       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{232          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{233          iwrkf = 0}
\DoxyCodeLine{234          lmtnc = 2 * lmtnc}
\DoxyCodeLine{235 \textcolor{comment}{!}}
\DoxyCodeLine{236 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{237 \textcolor{comment}{!}}
\DoxyCodeLine{238          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{239             iwrk = iwrkf}
\DoxyCodeLine{240             iwrkd = iwrkf + 1}
\DoxyCodeLine{241             jinda = iwrkf + lmtna}
\DoxyCodeLine{242             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{243             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{244                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{245                iwrkf = nval}
\DoxyCodeLine{246 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{247             iinda = 1}
\DoxyCodeLine{248             iindb = jinda + 1}
\DoxyCodeLine{249 \textcolor{comment}{!}}
\DoxyCodeLine{250 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{251 \textcolor{comment}{!}}
\DoxyCodeLine{252 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{253 \textcolor{comment}{!}}
\DoxyCodeLine{254             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{255             xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{256             xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{257 \textcolor{comment}{!}}
\DoxyCodeLine{258             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{259                iwrk = iwrk + 1}
\DoxyCodeLine{260 \textcolor{comment}{!}}
\DoxyCodeLine{261 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{262 \textcolor{comment}{!}}
\DoxyCodeLine{263                \textcolor{keywordflow}{If} (xdona > xdonb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{264                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{265                   iindb = iindb + 1}
\DoxyCodeLine{266                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{267 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{268                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{269                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{270 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{271                   xdonb = xdont(irngt(iindb))}
\DoxyCodeLine{272                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{273                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{274                   iinda = iinda + 1}
\DoxyCodeLine{275                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{276                   xdona = xdont(jwrkt(iinda))}
\DoxyCodeLine{277 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{278 \textcolor{comment}{!}}
\DoxyCodeLine{279 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{280 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{281 \textcolor{comment}{!}}
\DoxyCodeLine{282 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{283 \textcolor{comment}{!}}
\DoxyCodeLine{284          lmtna = 2 * lmtna}
\DoxyCodeLine{285 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{286 \textcolor{comment}{!}}
\DoxyCodeLine{287 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{288 \textcolor{comment}{!}}
\DoxyCodeLine{289       iinda = 1}
\DoxyCodeLine{290       iindb = lmtna + 1}
\DoxyCodeLine{291       nuni = 0}
\DoxyCodeLine{292 \textcolor{comment}{!}}
\DoxyCodeLine{293 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{294 \textcolor{comment}{!}}
\DoxyCodeLine{295       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{296       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{297         \textcolor{keywordflow}{If} (xdont(jwrkt(1)) < xdont(irngt(iindb)) ) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{298            xtst = nearless(xdont(jwrkt(1)))}
\DoxyCodeLine{299         \textcolor{keywordflow}{Else}}
\DoxyCodeLine{300            xtst = nearless(xdont(irngt(iindb)))}
\DoxyCodeLine{301 \textcolor{keywordflow}{        Endif}}
\DoxyCodeLine{302       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{303         xtst = nearless(xdont(jwrkt(1)))}
\DoxyCodeLine{304 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{305       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{306 \textcolor{comment}{!}}
\DoxyCodeLine{307 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{308 \textcolor{comment}{!}}
\DoxyCodeLine{309          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{310             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{311                \textcolor{keywordflow}{If} (xdont(jwrkt(iinda)) > xdont(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{312                   irng = irngt(iindb)}
\DoxyCodeLine{313                   iindb = iindb + 1}
\DoxyCodeLine{314                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{315                   irng = jwrkt(iinda)}
\DoxyCodeLine{316                   iinda = iinda + 1}
\DoxyCodeLine{317 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{318             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{319 \textcolor{comment}{!}}
\DoxyCodeLine{320 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{321 \textcolor{comment}{!}}
\DoxyCodeLine{322                irng = jwrkt(iinda)}
\DoxyCodeLine{323                iinda = iinda + 1}
\DoxyCodeLine{324 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{325          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{326 \textcolor{comment}{!}}
\DoxyCodeLine{327 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{328 \textcolor{comment}{!}}
\DoxyCodeLine{329             irng = irngt(iwrk)}
\DoxyCodeLine{330 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{331          \textcolor{keywordflow}{If} (xdont(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{332             xtst = xdont(irng)}
\DoxyCodeLine{333             nuni = nuni + 1}
\DoxyCodeLine{334 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{335          igoest(irng) = nuni}
\DoxyCodeLine{336 \textcolor{comment}{!}}
\DoxyCodeLine{337 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{338 \textcolor{comment}{!}}

\end{DoxyCode}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacem__uniinv_aae3df561c217bf871a83bafbc46f27ba}\label{namespacem__uniinv_aae3df561c217bf871a83bafbc46f27ba}} 
\index{m\_uniinv@{m\_uniinv}!f\_char@{f\_char}}
\index{f\_char@{f\_char}!m\_uniinv@{m\_uniinv}}
\doxysubsubsection{\texorpdfstring{f\_char}{f\_char}}
{\footnotesize\ttfamily integer, parameter m\+\_\+uniinv\+::f\+\_\+char =selected\+\_\+char\+\_\+kind(\char`\"{}D\+E\+F\+A\+U\+LT\char`\"{})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{5 \textcolor{keywordtype}{integer},\textcolor{keywordtype}{parameter} :: f\_char=selected\_char\_kind(\textcolor{stringliteral}{"DEFAULT"})}

\end{DoxyCode}
