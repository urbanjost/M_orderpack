\hypertarget{namespacem__refpar}{}\doxysection{m\+\_\+refpar Module Reference}
\label{namespacem__refpar}\index{m\_refpar@{m\_refpar}}
\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface \mbox{\hyperlink{interfacem__refpar_1_1refpar}{refpar}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, private \mbox{\hyperlink{namespacem__refpar_a09f3f60cd039abaeff4d5d94d091e900}{d\+\_\+refpar}} (X\+D\+O\+NT, I\+R\+N\+GT, N\+O\+RD)
\item 
subroutine, private \mbox{\hyperlink{namespacem__refpar_a47195dab7466d976d4bf041298ca79e2}{r\+\_\+refpar}} (X\+D\+O\+NT, I\+R\+N\+GT, N\+O\+RD)
\item 
subroutine, private \mbox{\hyperlink{namespacem__refpar_a316403aa82b5b566a1efa18ea82c7a3a}{i\+\_\+refpar}} (X\+D\+O\+NT, I\+R\+N\+GT, N\+O\+RD)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
integer, parameter, private \mbox{\hyperlink{namespacem__refpar_aa4f066586bdbf5e6bbf03cedc6c5692f}{kdp}} = selected\+\_\+real\+\_\+kind(15)
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacem__refpar_a09f3f60cd039abaeff4d5d94d091e900}\label{namespacem__refpar_a09f3f60cd039abaeff4d5d94d091e900}} 
\index{m\_refpar@{m\_refpar}!d\_refpar@{d\_refpar}}
\index{d\_refpar@{d\_refpar}!m\_refpar@{m\_refpar}}
\doxysubsubsection{\texorpdfstring{d\_refpar()}{d\_refpar()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+refpar\+::d\+\_\+refpar (\begin{DoxyParamCaption}\item[{real (kind=\mbox{\hyperlink{namespacem__refpar_aa4f066586bdbf5e6bbf03cedc6c5692f}{kdp}}), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, dimension (\+:), intent(out)}]{I\+R\+N\+GT,  }\item[{integer, intent(in)}]{N\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{14 \textcolor{comment}{!! Ranks partially XDONT by IRNGT, up to order NORD}}
\DoxyCodeLine{15 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{16 \textcolor{comment}{!! This routine uses a pivoting strategy such as the one of}}
\DoxyCodeLine{17 \textcolor{comment}{!! finding the median based on the quicksort algorithm. It uses}}
\DoxyCodeLine{18 \textcolor{comment}{!! a temporary array, where it stores the partially ranked indices}}
\DoxyCodeLine{19 \textcolor{comment}{!! of the values. It iterates until it can bring the number of}}
\DoxyCodeLine{20 \textcolor{comment}{!! values lower than the pivot to exactly NORD, and then uses an}}
\DoxyCodeLine{21 \textcolor{comment}{!! insertion sort to rank this set, since it is supposedly small.}}
\DoxyCodeLine{22 \textcolor{comment}{!! Michel Olagnon -\/ Feb. 2000}}
\DoxyCodeLine{23 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{24 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{25 \textcolor{keywordtype}{      Real} (kind=kdp), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{26       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IRNGT}
\DoxyCodeLine{27       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (In)} :: NORD}
\DoxyCodeLine{28 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{29 \textcolor{keywordtype}{      Real} (kind=kdp) :: xpiv, xwrk}
\DoxyCodeLine{30 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{31 \textcolor{comment}{!}}
\DoxyCodeLine{32       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(XDONT))} :: IWRKT}
\DoxyCodeLine{33       \textcolor{keywordtype}{Integer} :: NDON, ICRS, IDEB, IDCR, IFIN, IMIL, IWRK}
\DoxyCodeLine{34 \textcolor{comment}{!}}
\DoxyCodeLine{35       ndon = \textcolor{keyword}{SIZE} (xdont)}
\DoxyCodeLine{36 \textcolor{comment}{!}}
\DoxyCodeLine{37       \textcolor{keywordflow}{Do} icrs = 1, ndon}
\DoxyCodeLine{38          iwrkt(icrs) = icrs}
\DoxyCodeLine{39 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{40       ideb = 1}
\DoxyCodeLine{41       ifin = ndon}
\DoxyCodeLine{42       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{43          \textcolor{keywordflow}{If} (ideb >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{44          imil = (ideb+ifin) / 2}
\DoxyCodeLine{45 \textcolor{comment}{!}}
\DoxyCodeLine{46 \textcolor{comment}{!  One chooses a pivot, median of 1st, last, and middle values}}
\DoxyCodeLine{47 \textcolor{comment}{!}}
\DoxyCodeLine{48          \textcolor{keywordflow}{If} (xdont(iwrkt(imil)) < xdont(iwrkt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{49             iwrk = iwrkt(ideb)}
\DoxyCodeLine{50             iwrkt(ideb) = iwrkt(imil)}
\DoxyCodeLine{51             iwrkt(imil) = iwrk}
\DoxyCodeLine{52 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{53          \textcolor{keywordflow}{If} (xdont(iwrkt(imil)) > xdont(iwrkt(ifin))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{54             iwrk = iwrkt(ifin)}
\DoxyCodeLine{55             iwrkt(ifin) = iwrkt(imil)}
\DoxyCodeLine{56             iwrkt(imil) = iwrk}
\DoxyCodeLine{57             \textcolor{keywordflow}{If} (xdont(iwrkt(imil)) < xdont(iwrkt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{58                iwrk = iwrkt(ideb)}
\DoxyCodeLine{59                iwrkt(ideb) = iwrkt(imil)}
\DoxyCodeLine{60                iwrkt(imil) = iwrk}
\DoxyCodeLine{61 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{62 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{63          \textcolor{keywordflow}{If} ((ifin-\/ideb) < 3) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{64          xpiv = xdont(iwrkt(imil))}
\DoxyCodeLine{65 \textcolor{comment}{!}}
\DoxyCodeLine{66 \textcolor{comment}{!  One exchanges values to put those > pivot in the end and}}
\DoxyCodeLine{67 \textcolor{comment}{!  those <= pivot at the beginning}}
\DoxyCodeLine{68 \textcolor{comment}{!}}
\DoxyCodeLine{69          icrs = ideb}
\DoxyCodeLine{70          idcr = ifin}
\DoxyCodeLine{71          ech2: \textcolor{keywordflow}{Do}}
\DoxyCodeLine{72             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{73                icrs = icrs + 1}
\DoxyCodeLine{74                \textcolor{keywordflow}{If} (icrs >= idcr) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{75 \textcolor{comment}{!}}
\DoxyCodeLine{76 \textcolor{comment}{!  the first  >  pivot is IWRKT(IDCR)}}
\DoxyCodeLine{77 \textcolor{comment}{!  the last   <= pivot is IWRKT(ICRS-\/1)}}
\DoxyCodeLine{78 \textcolor{comment}{!  Note: If one arrives here on the first iteration, then}}
\DoxyCodeLine{79 \textcolor{comment}{!        the pivot is the maximum of the set, the last value is equal}}
\DoxyCodeLine{80 \textcolor{comment}{!        to it, and one can reduce by one the size of the set to process,}}
\DoxyCodeLine{81 \textcolor{comment}{!        as if XDONT (IWRKT(IFIN)) > XPIV}}
\DoxyCodeLine{82 \textcolor{comment}{!}}
\DoxyCodeLine{83                   \textcolor{keywordflow}{Exit} ech2}
\DoxyCodeLine{84 \textcolor{comment}{!}}
\DoxyCodeLine{85 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{86                \textcolor{keywordflow}{If} (xdont(iwrkt(icrs)) > xpiv) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{87 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{88             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{89                \textcolor{keywordflow}{If} (xdont(iwrkt(idcr)) <= xpiv) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{90                idcr = idcr -\/ 1}
\DoxyCodeLine{91                \textcolor{keywordflow}{If} (icrs >= idcr) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{92 \textcolor{comment}{!}}
\DoxyCodeLine{93 \textcolor{comment}{!  The last value < pivot is always IWRKT(ICRS-\/1)}}
\DoxyCodeLine{94 \textcolor{comment}{!}}
\DoxyCodeLine{95                   \textcolor{keywordflow}{Exit} ech2}
\DoxyCodeLine{96 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{97 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{98 \textcolor{comment}{!}}
\DoxyCodeLine{99             iwrk = iwrkt(idcr)}
\DoxyCodeLine{100             iwrkt(idcr) = iwrkt(icrs)}
\DoxyCodeLine{101             iwrkt(icrs) = iwrk}
\DoxyCodeLine{102 \textcolor{keywordflow}{         End Do} ech2}
\DoxyCodeLine{103 \textcolor{comment}{!}}
\DoxyCodeLine{104 \textcolor{comment}{!  One restricts further processing to find the fractile value}}
\DoxyCodeLine{105 \textcolor{comment}{!}}
\DoxyCodeLine{106          \textcolor{keywordflow}{If} (icrs <= nord) ideb = icrs}
\DoxyCodeLine{107          \textcolor{keywordflow}{If} (icrs > nord) ifin = icrs -\/ 1}
\DoxyCodeLine{108 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{109 \textcolor{comment}{!}}
\DoxyCodeLine{110 \textcolor{comment}{!  Now, we only need to complete ranking of the 1:NORD set}}
\DoxyCodeLine{111 \textcolor{comment}{!  Assuming NORD is small, we use a simple insertion sort}}
\DoxyCodeLine{112 \textcolor{comment}{!}}
\DoxyCodeLine{113       \textcolor{keywordflow}{Do} icrs = 2, nord}
\DoxyCodeLine{114          iwrk = iwrkt(icrs)}
\DoxyCodeLine{115          xwrk = xdont(iwrk)}
\DoxyCodeLine{116          \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{117             \textcolor{keywordflow}{If} (xwrk <= xdont(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{118                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{119             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{120                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{121 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{122 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{123          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{124 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{125       irngt(1:nord) = iwrkt(1:nord)}
\DoxyCodeLine{126       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{127 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__refpar_a316403aa82b5b566a1efa18ea82c7a3a}\label{namespacem__refpar_a316403aa82b5b566a1efa18ea82c7a3a}} 
\index{m\_refpar@{m\_refpar}!i\_refpar@{i\_refpar}}
\index{i\_refpar@{i\_refpar}!m\_refpar@{m\_refpar}}
\doxysubsubsection{\texorpdfstring{i\_refpar()}{i\_refpar()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+refpar\+::i\+\_\+refpar (\begin{DoxyParamCaption}\item[{integer, dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, dimension (\+:), intent(out)}]{I\+R\+N\+GT,  }\item[{integer, intent(in)}]{N\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{247 \textcolor{comment}{!! Ranks partially XDONT by IRNGT, up to order NORD}}
\DoxyCodeLine{248 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{249 \textcolor{comment}{!! This routine uses a pivoting strategy such as the one of}}
\DoxyCodeLine{250 \textcolor{comment}{!! finding the median based on the quicksort algorithm. It uses}}
\DoxyCodeLine{251 \textcolor{comment}{!! a temporary array, where it stores the partially ranked indices}}
\DoxyCodeLine{252 \textcolor{comment}{!! of the values. It iterates until it can bring the number of}}
\DoxyCodeLine{253 \textcolor{comment}{!! values lower than the pivot to exactly NORD, and then uses an}}
\DoxyCodeLine{254 \textcolor{comment}{!! insertion sort to rank this set, since it is supposedly small.}}
\DoxyCodeLine{255 \textcolor{comment}{!! Michel Olagnon -\/ Feb. 2000}}
\DoxyCodeLine{256 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{257 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{258       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)}  :: XDONT}
\DoxyCodeLine{259       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IRNGT}
\DoxyCodeLine{260       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (In)} :: NORD}
\DoxyCodeLine{261 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{262       \textcolor{keywordtype}{Integer} :: XPIV, XWRK}
\DoxyCodeLine{263 \textcolor{comment}{!}}
\DoxyCodeLine{264       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(XDONT))} :: IWRKT}
\DoxyCodeLine{265       \textcolor{keywordtype}{Integer} :: NDON, ICRS, IDEB, IDCR, IFIN, IMIL, IWRK}
\DoxyCodeLine{266 \textcolor{comment}{!}}
\DoxyCodeLine{267       ndon = \textcolor{keyword}{SIZE} (xdont)}
\DoxyCodeLine{268 \textcolor{comment}{!}}
\DoxyCodeLine{269       \textcolor{keywordflow}{Do} icrs = 1, ndon}
\DoxyCodeLine{270          iwrkt(icrs) = icrs}
\DoxyCodeLine{271 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{272       ideb = 1}
\DoxyCodeLine{273       ifin = ndon}
\DoxyCodeLine{274       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{275          \textcolor{keywordflow}{If} (ideb >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{276          imil = (ideb+ifin) / 2}
\DoxyCodeLine{277 \textcolor{comment}{!}}
\DoxyCodeLine{278 \textcolor{comment}{!  One chooses a pivot, median of 1st, last, and middle values}}
\DoxyCodeLine{279 \textcolor{comment}{!}}
\DoxyCodeLine{280          \textcolor{keywordflow}{If} (xdont(iwrkt(imil)) < xdont(iwrkt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{281             iwrk = iwrkt(ideb)}
\DoxyCodeLine{282             iwrkt(ideb) = iwrkt(imil)}
\DoxyCodeLine{283             iwrkt(imil) = iwrk}
\DoxyCodeLine{284 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{285          \textcolor{keywordflow}{If} (xdont(iwrkt(imil)) > xdont(iwrkt(ifin))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{286             iwrk = iwrkt(ifin)}
\DoxyCodeLine{287             iwrkt(ifin) = iwrkt(imil)}
\DoxyCodeLine{288             iwrkt(imil) = iwrk}
\DoxyCodeLine{289             \textcolor{keywordflow}{If} (xdont(iwrkt(imil)) < xdont(iwrkt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{290                iwrk = iwrkt(ideb)}
\DoxyCodeLine{291                iwrkt(ideb) = iwrkt(imil)}
\DoxyCodeLine{292                iwrkt(imil) = iwrk}
\DoxyCodeLine{293 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{294 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{295          \textcolor{keywordflow}{If} ((ifin-\/ideb) < 3) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{296          xpiv = xdont(iwrkt(imil))}
\DoxyCodeLine{297 \textcolor{comment}{!}}
\DoxyCodeLine{298 \textcolor{comment}{!  One exchanges values to put those > pivot in the end and}}
\DoxyCodeLine{299 \textcolor{comment}{!  those <= pivot at the beginning}}
\DoxyCodeLine{300 \textcolor{comment}{!}}
\DoxyCodeLine{301          icrs = ideb}
\DoxyCodeLine{302          idcr = ifin}
\DoxyCodeLine{303          ech2: \textcolor{keywordflow}{Do}}
\DoxyCodeLine{304             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{305                icrs = icrs + 1}
\DoxyCodeLine{306                \textcolor{keywordflow}{If} (icrs >= idcr) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{307 \textcolor{comment}{!}}
\DoxyCodeLine{308 \textcolor{comment}{!  the first  >  pivot is IWRKT(IDCR)}}
\DoxyCodeLine{309 \textcolor{comment}{!  the last   <= pivot is IWRKT(ICRS-\/1)}}
\DoxyCodeLine{310 \textcolor{comment}{!  Note: If one arrives here on the first iteration, then}}
\DoxyCodeLine{311 \textcolor{comment}{!        the pivot is the maximum of the set, the last value is equal}}
\DoxyCodeLine{312 \textcolor{comment}{!        to it, and one can reduce by one the size of the set to process,}}
\DoxyCodeLine{313 \textcolor{comment}{!        as if XDONT (IWRKT(IFIN)) > XPIV}}
\DoxyCodeLine{314 \textcolor{comment}{!}}
\DoxyCodeLine{315                   \textcolor{keywordflow}{Exit} ech2}
\DoxyCodeLine{316 \textcolor{comment}{!}}
\DoxyCodeLine{317 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{318                \textcolor{keywordflow}{If} (xdont(iwrkt(icrs)) > xpiv) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{319 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{320             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{321                \textcolor{keywordflow}{If} (xdont(iwrkt(idcr)) <= xpiv) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{322                idcr = idcr -\/ 1}
\DoxyCodeLine{323                \textcolor{keywordflow}{If} (icrs >= idcr) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{324 \textcolor{comment}{!}}
\DoxyCodeLine{325 \textcolor{comment}{!  The last value < pivot is always IWRKT(ICRS-\/1)}}
\DoxyCodeLine{326 \textcolor{comment}{!}}
\DoxyCodeLine{327                   \textcolor{keywordflow}{Exit} ech2}
\DoxyCodeLine{328 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{329 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{330 \textcolor{comment}{!}}
\DoxyCodeLine{331             iwrk = iwrkt(idcr)}
\DoxyCodeLine{332             iwrkt(idcr) = iwrkt(icrs)}
\DoxyCodeLine{333             iwrkt(icrs) = iwrk}
\DoxyCodeLine{334 \textcolor{keywordflow}{         End Do} ech2}
\DoxyCodeLine{335 \textcolor{comment}{!}}
\DoxyCodeLine{336 \textcolor{comment}{!  One restricts further processing to find the fractile value}}
\DoxyCodeLine{337 \textcolor{comment}{!}}
\DoxyCodeLine{338          \textcolor{keywordflow}{If} (icrs <= nord) ideb = icrs}
\DoxyCodeLine{339          \textcolor{keywordflow}{If} (icrs > nord) ifin = icrs -\/ 1}
\DoxyCodeLine{340 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{341 \textcolor{comment}{!}}
\DoxyCodeLine{342 \textcolor{comment}{!  Now, we only need to complete ranking of the 1:NORD set}}
\DoxyCodeLine{343 \textcolor{comment}{!  Assuming NORD is small, we use a simple insertion sort}}
\DoxyCodeLine{344 \textcolor{comment}{!}}
\DoxyCodeLine{345       \textcolor{keywordflow}{Do} icrs = 2, nord}
\DoxyCodeLine{346          iwrk = iwrkt(icrs)}
\DoxyCodeLine{347          xwrk = xdont(iwrk)}
\DoxyCodeLine{348          \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{349             \textcolor{keywordflow}{If} (xwrk <= xdont(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{350                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{351             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{352                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{353 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{354 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{355          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{356 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{357       irngt(1:nord) = iwrkt(1:nord)}
\DoxyCodeLine{358       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{359 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__refpar_a47195dab7466d976d4bf041298ca79e2}\label{namespacem__refpar_a47195dab7466d976d4bf041298ca79e2}} 
\index{m\_refpar@{m\_refpar}!r\_refpar@{r\_refpar}}
\index{r\_refpar@{r\_refpar}!m\_refpar@{m\_refpar}}
\doxysubsubsection{\texorpdfstring{r\_refpar()}{r\_refpar()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+refpar\+::r\+\_\+refpar (\begin{DoxyParamCaption}\item[{real, dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, dimension (\+:), intent(out)}]{I\+R\+N\+GT,  }\item[{integer, intent(in)}]{N\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{131 \textcolor{comment}{!! Ranks partially XDONT by IRNGT, up to order NORD}}
\DoxyCodeLine{132 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{133 \textcolor{comment}{!! This routine uses a pivoting strategy such as the one of}}
\DoxyCodeLine{134 \textcolor{comment}{!! finding the median based on the quicksort algorithm. It uses}}
\DoxyCodeLine{135 \textcolor{comment}{!! a temporary array, where it stores the partially ranked indices}}
\DoxyCodeLine{136 \textcolor{comment}{!! of the values. It iterates until it can bring the number of}}
\DoxyCodeLine{137 \textcolor{comment}{!! values lower than the pivot to exactly NORD, and then uses an}}
\DoxyCodeLine{138 \textcolor{comment}{!! insertion sort to rank this set, since it is supposedly small.}}
\DoxyCodeLine{139 \textcolor{comment}{!! Michel Olagnon -\/ Feb. 2000}}
\DoxyCodeLine{140 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{141 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{142 \textcolor{keywordtype}{      Real}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDONT}
\DoxyCodeLine{143       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IRNGT}
\DoxyCodeLine{144       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (In)} :: NORD}
\DoxyCodeLine{145 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{146 \textcolor{keywordtype}{      Real} :: XPIV, XWRK}
\DoxyCodeLine{147 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{148 \textcolor{comment}{!}}
\DoxyCodeLine{149       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(XDONT))} :: IWRKT}
\DoxyCodeLine{150       \textcolor{keywordtype}{Integer} :: NDON, ICRS, IDEB, IDCR, IFIN, IMIL, IWRK}
\DoxyCodeLine{151 \textcolor{comment}{!}}
\DoxyCodeLine{152       ndon = \textcolor{keyword}{SIZE} (xdont)}
\DoxyCodeLine{153 \textcolor{comment}{!}}
\DoxyCodeLine{154       \textcolor{keywordflow}{Do} icrs = 1, ndon}
\DoxyCodeLine{155          iwrkt(icrs) = icrs}
\DoxyCodeLine{156 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{157       ideb = 1}
\DoxyCodeLine{158       ifin = ndon}
\DoxyCodeLine{159       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{160          \textcolor{keywordflow}{If} (ideb >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{161          imil = (ideb+ifin) / 2}
\DoxyCodeLine{162 \textcolor{comment}{!}}
\DoxyCodeLine{163 \textcolor{comment}{!  One chooses a pivot, median of 1st, last, and middle values}}
\DoxyCodeLine{164 \textcolor{comment}{!}}
\DoxyCodeLine{165          \textcolor{keywordflow}{If} (xdont(iwrkt(imil)) < xdont(iwrkt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{166             iwrk = iwrkt(ideb)}
\DoxyCodeLine{167             iwrkt(ideb) = iwrkt(imil)}
\DoxyCodeLine{168             iwrkt(imil) = iwrk}
\DoxyCodeLine{169 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{170          \textcolor{keywordflow}{If} (xdont(iwrkt(imil)) > xdont(iwrkt(ifin))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{171             iwrk = iwrkt(ifin)}
\DoxyCodeLine{172             iwrkt(ifin) = iwrkt(imil)}
\DoxyCodeLine{173             iwrkt(imil) = iwrk}
\DoxyCodeLine{174             \textcolor{keywordflow}{If} (xdont(iwrkt(imil)) < xdont(iwrkt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{175                iwrk = iwrkt(ideb)}
\DoxyCodeLine{176                iwrkt(ideb) = iwrkt(imil)}
\DoxyCodeLine{177                iwrkt(imil) = iwrk}
\DoxyCodeLine{178 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{179 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{180          \textcolor{keywordflow}{If} ((ifin-\/ideb) < 3) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{181          xpiv = xdont(iwrkt(imil))}
\DoxyCodeLine{182 \textcolor{comment}{!}}
\DoxyCodeLine{183 \textcolor{comment}{!  One exchanges values to put those > pivot in the end and}}
\DoxyCodeLine{184 \textcolor{comment}{!  those <= pivot at the beginning}}
\DoxyCodeLine{185 \textcolor{comment}{!}}
\DoxyCodeLine{186          icrs = ideb}
\DoxyCodeLine{187          idcr = ifin}
\DoxyCodeLine{188          ech2: \textcolor{keywordflow}{Do}}
\DoxyCodeLine{189             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{190                icrs = icrs + 1}
\DoxyCodeLine{191                \textcolor{keywordflow}{If} (icrs >= idcr) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{192 \textcolor{comment}{!}}
\DoxyCodeLine{193 \textcolor{comment}{!  the first  >  pivot is IWRKT(IDCR)}}
\DoxyCodeLine{194 \textcolor{comment}{!  the last   <= pivot is IWRKT(ICRS-\/1)}}
\DoxyCodeLine{195 \textcolor{comment}{!  Note: If one arrives here on the first iteration, then}}
\DoxyCodeLine{196 \textcolor{comment}{!        the pivot is the maximum of the set, the last value is equal}}
\DoxyCodeLine{197 \textcolor{comment}{!        to it, and one can reduce by one the size of the set to process,}}
\DoxyCodeLine{198 \textcolor{comment}{!        as if XDONT (IWRKT(IFIN)) > XPIV}}
\DoxyCodeLine{199 \textcolor{comment}{!}}
\DoxyCodeLine{200                   \textcolor{keywordflow}{Exit} ech2}
\DoxyCodeLine{201 \textcolor{comment}{!}}
\DoxyCodeLine{202 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{203                \textcolor{keywordflow}{If} (xdont(iwrkt(icrs)) > xpiv) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{204 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{205             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{206                \textcolor{keywordflow}{If} (xdont(iwrkt(idcr)) <= xpiv) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{207                idcr = idcr -\/ 1}
\DoxyCodeLine{208                \textcolor{keywordflow}{If} (icrs >= idcr) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{209 \textcolor{comment}{!}}
\DoxyCodeLine{210 \textcolor{comment}{!  The last value < pivot is always IWRKT(ICRS-\/1)}}
\DoxyCodeLine{211 \textcolor{comment}{!}}
\DoxyCodeLine{212                   \textcolor{keywordflow}{Exit} ech2}
\DoxyCodeLine{213 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{214 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{215 \textcolor{comment}{!}}
\DoxyCodeLine{216             iwrk = iwrkt(idcr)}
\DoxyCodeLine{217             iwrkt(idcr) = iwrkt(icrs)}
\DoxyCodeLine{218             iwrkt(icrs) = iwrk}
\DoxyCodeLine{219 \textcolor{keywordflow}{         End Do} ech2}
\DoxyCodeLine{220 \textcolor{comment}{!}}
\DoxyCodeLine{221 \textcolor{comment}{!  One restricts further processing to find the fractile value}}
\DoxyCodeLine{222 \textcolor{comment}{!}}
\DoxyCodeLine{223          \textcolor{keywordflow}{If} (icrs <= nord) ideb = icrs}
\DoxyCodeLine{224          \textcolor{keywordflow}{If} (icrs > nord) ifin = icrs -\/ 1}
\DoxyCodeLine{225 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{226 \textcolor{comment}{!}}
\DoxyCodeLine{227 \textcolor{comment}{!  Now, we only need to complete ranking of the 1:NORD set}}
\DoxyCodeLine{228 \textcolor{comment}{!  Assuming NORD is small, we use a simple insertion sort}}
\DoxyCodeLine{229 \textcolor{comment}{!}}
\DoxyCodeLine{230       \textcolor{keywordflow}{Do} icrs = 2, nord}
\DoxyCodeLine{231          iwrk = iwrkt(icrs)}
\DoxyCodeLine{232          xwrk = xdont(iwrk)}
\DoxyCodeLine{233          \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{234             \textcolor{keywordflow}{If} (xwrk <= xdont(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{235                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{236             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{237                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{238 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{239 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{240          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{241 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{242       irngt(1:nord) = iwrkt(1:nord)}
\DoxyCodeLine{243       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{244 \textcolor{comment}{!}}

\end{DoxyCode}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacem__refpar_aa4f066586bdbf5e6bbf03cedc6c5692f}\label{namespacem__refpar_aa4f066586bdbf5e6bbf03cedc6c5692f}} 
\index{m\_refpar@{m\_refpar}!kdp@{kdp}}
\index{kdp@{kdp}!m\_refpar@{m\_refpar}}
\doxysubsubsection{\texorpdfstring{kdp}{kdp}}
{\footnotesize\ttfamily integer, parameter, private m\+\_\+refpar\+::kdp = selected\+\_\+real\+\_\+kind(15)\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{4 \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Parameter} :: kdp = selected\_real\_kind(15)}

\end{DoxyCode}
