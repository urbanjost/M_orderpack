\hypertarget{interfacem__refpar_1_1refpar}{}\doxysection{m\+\_\+refpar\+::refpar Interface Reference}
\label{interfacem__refpar_1_1refpar}\index{m\_refpar::refpar@{m\_refpar::refpar}}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{interfacem__refpar_1_1refpar_a7a2d5d0ffa7d3a57df431c07236f4ae6}{real64\+\_\+refpar}} (X\+D\+O\+NT, I\+R\+N\+GT, N\+O\+RD)
\item 
subroutine \mbox{\hyperlink{interfacem__refpar_1_1refpar_aaf99407671aca1eba007b178dc4b2469}{real32\+\_\+refpar}} (X\+D\+O\+NT, I\+R\+N\+GT, N\+O\+RD)
\item 
subroutine \mbox{\hyperlink{interfacem__refpar_1_1refpar_ad85e2add12c4cda2adb86b4b1efaa23b}{int32\+\_\+refpar}} (X\+D\+O\+NT, I\+R\+N\+GT, N\+O\+RD)
\end{DoxyCompactItemize}


\doxysubsection{Member Function/\+Subroutine Documentation}
\mbox{\Hypertarget{interfacem__refpar_1_1refpar_ad85e2add12c4cda2adb86b4b1efaa23b}\label{interfacem__refpar_1_1refpar_ad85e2add12c4cda2adb86b4b1efaa23b}} 
\index{m\_refpar::refpar@{m\_refpar::refpar}!int32\_refpar@{int32\_refpar}}
\index{int32\_refpar@{int32\_refpar}!m\_refpar::refpar@{m\_refpar::refpar}}
\doxysubsubsection{\texorpdfstring{int32\_refpar()}{int32\_refpar()}}
{\footnotesize\ttfamily subroutine m\+\_\+refpar\+::refpar\+::int32\+\_\+refpar (\begin{DoxyParamCaption}\item[{integer (kind=int32), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, dimension (\+:), intent(out)}]{I\+R\+N\+GT,  }\item[{integer, intent(in)}]{N\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{279       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDONT}
\DoxyCodeLine{280       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IRNGT}
\DoxyCodeLine{281       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (In)} :: NORD}
\DoxyCodeLine{282 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{283       \textcolor{keywordtype}{Integer (kind=int32)} :: XPIV, XWRK}
\DoxyCodeLine{284 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{285 \textcolor{comment}{!}}
\DoxyCodeLine{286       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(XDONT))} :: IWRKT}
\DoxyCodeLine{287       \textcolor{keywordtype}{Integer} :: NDON, ICRS, IDEB, IDCR, IFIN, IMIL, IWRK}
\DoxyCodeLine{288 \textcolor{comment}{!}}
\DoxyCodeLine{289       ndon = \textcolor{keyword}{SIZE} (xdont)}
\DoxyCodeLine{290 \textcolor{comment}{!}}
\DoxyCodeLine{291       \textcolor{keywordflow}{Do} icrs = 1, ndon}
\DoxyCodeLine{292          iwrkt(icrs) = icrs}
\DoxyCodeLine{293 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{294       ideb = 1}
\DoxyCodeLine{295       ifin = ndon}
\DoxyCodeLine{296       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{297          \textcolor{keywordflow}{If} (ideb >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{298          imil = (ideb+ifin) / 2}
\DoxyCodeLine{299 \textcolor{comment}{!}}
\DoxyCodeLine{300 \textcolor{comment}{!  One chooses a pivot, median of 1st, last, and middle values}}
\DoxyCodeLine{301 \textcolor{comment}{!}}
\DoxyCodeLine{302          \textcolor{keywordflow}{If} (xdont(iwrkt(imil)) < xdont(iwrkt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{303             iwrk = iwrkt(ideb)}
\DoxyCodeLine{304             iwrkt(ideb) = iwrkt(imil)}
\DoxyCodeLine{305             iwrkt(imil) = iwrk}
\DoxyCodeLine{306 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{307          \textcolor{keywordflow}{If} (xdont(iwrkt(imil)) > xdont(iwrkt(ifin))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{308             iwrk = iwrkt(ifin)}
\DoxyCodeLine{309             iwrkt(ifin) = iwrkt(imil)}
\DoxyCodeLine{310             iwrkt(imil) = iwrk}
\DoxyCodeLine{311             \textcolor{keywordflow}{If} (xdont(iwrkt(imil)) < xdont(iwrkt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{312                iwrk = iwrkt(ideb)}
\DoxyCodeLine{313                iwrkt(ideb) = iwrkt(imil)}
\DoxyCodeLine{314                iwrkt(imil) = iwrk}
\DoxyCodeLine{315 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{316 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{317          \textcolor{keywordflow}{If} ((ifin-\/ideb) < 3) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{318          xpiv = xdont(iwrkt(imil))}
\DoxyCodeLine{319 \textcolor{comment}{!}}
\DoxyCodeLine{320 \textcolor{comment}{!  One exchanges values to put those > pivot in the end and}}
\DoxyCodeLine{321 \textcolor{comment}{!  those <= pivot at the beginning}}
\DoxyCodeLine{322 \textcolor{comment}{!}}
\DoxyCodeLine{323          icrs = ideb}
\DoxyCodeLine{324          idcr = ifin}
\DoxyCodeLine{325          ech2: \textcolor{keywordflow}{Do}}
\DoxyCodeLine{326             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{327                icrs = icrs + 1}
\DoxyCodeLine{328                \textcolor{keywordflow}{If} (icrs >= idcr) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{329 \textcolor{comment}{!}}
\DoxyCodeLine{330 \textcolor{comment}{!  the first  >  pivot is IWRKT(IDCR)}}
\DoxyCodeLine{331 \textcolor{comment}{!  the last   <= pivot is IWRKT(ICRS-\/1)}}
\DoxyCodeLine{332 \textcolor{comment}{!  Note: If one arrives here on the first iteration, then}}
\DoxyCodeLine{333 \textcolor{comment}{!        the pivot is the maximum of the set, the last value is equal}}
\DoxyCodeLine{334 \textcolor{comment}{!        to it, and one can reduce by one the size of the set to process,}}
\DoxyCodeLine{335 \textcolor{comment}{!        as if XDONT (IWRKT(IFIN)) > XPIV}}
\DoxyCodeLine{336 \textcolor{comment}{!}}
\DoxyCodeLine{337                   \textcolor{keywordflow}{Exit} ech2}
\DoxyCodeLine{338 \textcolor{comment}{!}}
\DoxyCodeLine{339 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{340                \textcolor{keywordflow}{If} (xdont(iwrkt(icrs)) > xpiv) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{341 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{342             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{343                \textcolor{keywordflow}{If} (xdont(iwrkt(idcr)) <= xpiv) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{344                idcr = idcr -\/ 1}
\DoxyCodeLine{345                \textcolor{keywordflow}{If} (icrs >= idcr) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{346 \textcolor{comment}{!}}
\DoxyCodeLine{347 \textcolor{comment}{!  The last value < pivot is always IWRKT(ICRS-\/1)}}
\DoxyCodeLine{348 \textcolor{comment}{!}}
\DoxyCodeLine{349                   \textcolor{keywordflow}{Exit} ech2}
\DoxyCodeLine{350 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{351 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{352 \textcolor{comment}{!}}
\DoxyCodeLine{353             iwrk = iwrkt(idcr)}
\DoxyCodeLine{354             iwrkt(idcr) = iwrkt(icrs)}
\DoxyCodeLine{355             iwrkt(icrs) = iwrk}
\DoxyCodeLine{356 \textcolor{keywordflow}{         End Do} ech2}
\DoxyCodeLine{357 \textcolor{comment}{!}}
\DoxyCodeLine{358 \textcolor{comment}{!  One restricts further processing to find the fractile value}}
\DoxyCodeLine{359 \textcolor{comment}{!}}
\DoxyCodeLine{360          \textcolor{keywordflow}{If} (icrs <= nord) ideb = icrs}
\DoxyCodeLine{361          \textcolor{keywordflow}{If} (icrs > nord) ifin = icrs -\/ 1}
\DoxyCodeLine{362 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{363 \textcolor{comment}{!}}
\DoxyCodeLine{364 \textcolor{comment}{!  Now, we only need to complete ranking of the 1:NORD set}}
\DoxyCodeLine{365 \textcolor{comment}{!  Assuming NORD is small, we use a simple insertion sort}}
\DoxyCodeLine{366 \textcolor{comment}{!}}
\DoxyCodeLine{367       \textcolor{keywordflow}{Do} icrs = 2, nord}
\DoxyCodeLine{368          iwrk = iwrkt(icrs)}
\DoxyCodeLine{369          xwrk = xdont(iwrk)}
\DoxyCodeLine{370          \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{371             \textcolor{keywordflow}{If} (xwrk <= xdont(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{372                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{373             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{374                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{375 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{376 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{377          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{378 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{379       irngt(1:nord) = iwrkt(1:nord)}
\DoxyCodeLine{380       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{381 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{interfacem__refpar_1_1refpar_aaf99407671aca1eba007b178dc4b2469}\label{interfacem__refpar_1_1refpar_aaf99407671aca1eba007b178dc4b2469}} 
\index{m\_refpar::refpar@{m\_refpar::refpar}!real32\_refpar@{real32\_refpar}}
\index{real32\_refpar@{real32\_refpar}!m\_refpar::refpar@{m\_refpar::refpar}}
\doxysubsubsection{\texorpdfstring{real32\_refpar()}{real32\_refpar()}}
{\footnotesize\ttfamily subroutine m\+\_\+refpar\+::refpar\+::real32\+\_\+refpar (\begin{DoxyParamCaption}\item[{real (kind=real32), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, dimension (\+:), intent(out)}]{I\+R\+N\+GT,  }\item[{integer, intent(in)}]{N\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{173 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{174       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IRNGT}
\DoxyCodeLine{175       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (In)} :: NORD}
\DoxyCodeLine{176 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{177 \textcolor{keywordtype}{      Real} (kind=real32) :: xpiv, xwrk}
\DoxyCodeLine{178 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{179 \textcolor{comment}{!}}
\DoxyCodeLine{180       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(XDONT))} :: IWRKT}
\DoxyCodeLine{181       \textcolor{keywordtype}{Integer} :: NDON, ICRS, IDEB, IDCR, IFIN, IMIL, IWRK}
\DoxyCodeLine{182 \textcolor{comment}{!}}
\DoxyCodeLine{183       ndon = \textcolor{keyword}{SIZE} (xdont)}
\DoxyCodeLine{184 \textcolor{comment}{!}}
\DoxyCodeLine{185       \textcolor{keywordflow}{Do} icrs = 1, ndon}
\DoxyCodeLine{186          iwrkt(icrs) = icrs}
\DoxyCodeLine{187 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{188       ideb = 1}
\DoxyCodeLine{189       ifin = ndon}
\DoxyCodeLine{190       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{191          \textcolor{keywordflow}{If} (ideb >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{192          imil = (ideb+ifin) / 2}
\DoxyCodeLine{193 \textcolor{comment}{!}}
\DoxyCodeLine{194 \textcolor{comment}{!  One chooses a pivot, median of 1st, last, and middle values}}
\DoxyCodeLine{195 \textcolor{comment}{!}}
\DoxyCodeLine{196          \textcolor{keywordflow}{If} (xdont(iwrkt(imil)) < xdont(iwrkt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{197             iwrk = iwrkt(ideb)}
\DoxyCodeLine{198             iwrkt(ideb) = iwrkt(imil)}
\DoxyCodeLine{199             iwrkt(imil) = iwrk}
\DoxyCodeLine{200 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{201          \textcolor{keywordflow}{If} (xdont(iwrkt(imil)) > xdont(iwrkt(ifin))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{202             iwrk = iwrkt(ifin)}
\DoxyCodeLine{203             iwrkt(ifin) = iwrkt(imil)}
\DoxyCodeLine{204             iwrkt(imil) = iwrk}
\DoxyCodeLine{205             \textcolor{keywordflow}{If} (xdont(iwrkt(imil)) < xdont(iwrkt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{206                iwrk = iwrkt(ideb)}
\DoxyCodeLine{207                iwrkt(ideb) = iwrkt(imil)}
\DoxyCodeLine{208                iwrkt(imil) = iwrk}
\DoxyCodeLine{209 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{210 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{211          \textcolor{keywordflow}{If} ((ifin-\/ideb) < 3) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{212          xpiv = xdont(iwrkt(imil))}
\DoxyCodeLine{213 \textcolor{comment}{!}}
\DoxyCodeLine{214 \textcolor{comment}{!  One exchanges values to put those > pivot in the end and}}
\DoxyCodeLine{215 \textcolor{comment}{!  those <= pivot at the beginning}}
\DoxyCodeLine{216 \textcolor{comment}{!}}
\DoxyCodeLine{217          icrs = ideb}
\DoxyCodeLine{218          idcr = ifin}
\DoxyCodeLine{219          ech2: \textcolor{keywordflow}{Do}}
\DoxyCodeLine{220             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{221                icrs = icrs + 1}
\DoxyCodeLine{222                \textcolor{keywordflow}{If} (icrs >= idcr) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{223 \textcolor{comment}{!}}
\DoxyCodeLine{224 \textcolor{comment}{!  the first  >  pivot is IWRKT(IDCR)}}
\DoxyCodeLine{225 \textcolor{comment}{!  the last   <= pivot is IWRKT(ICRS-\/1)}}
\DoxyCodeLine{226 \textcolor{comment}{!  Note: If one arrives here on the first iteration, then}}
\DoxyCodeLine{227 \textcolor{comment}{!        the pivot is the maximum of the set, the last value is equal}}
\DoxyCodeLine{228 \textcolor{comment}{!        to it, and one can reduce by one the size of the set to process,}}
\DoxyCodeLine{229 \textcolor{comment}{!        as if XDONT (IWRKT(IFIN)) > XPIV}}
\DoxyCodeLine{230 \textcolor{comment}{!}}
\DoxyCodeLine{231                   \textcolor{keywordflow}{Exit} ech2}
\DoxyCodeLine{232 \textcolor{comment}{!}}
\DoxyCodeLine{233 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{234                \textcolor{keywordflow}{If} (xdont(iwrkt(icrs)) > xpiv) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{235 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{236             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{237                \textcolor{keywordflow}{If} (xdont(iwrkt(idcr)) <= xpiv) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{238                idcr = idcr -\/ 1}
\DoxyCodeLine{239                \textcolor{keywordflow}{If} (icrs >= idcr) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{240 \textcolor{comment}{!}}
\DoxyCodeLine{241 \textcolor{comment}{!  The last value < pivot is always IWRKT(ICRS-\/1)}}
\DoxyCodeLine{242 \textcolor{comment}{!}}
\DoxyCodeLine{243                   \textcolor{keywordflow}{Exit} ech2}
\DoxyCodeLine{244 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{245 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{246 \textcolor{comment}{!}}
\DoxyCodeLine{247             iwrk = iwrkt(idcr)}
\DoxyCodeLine{248             iwrkt(idcr) = iwrkt(icrs)}
\DoxyCodeLine{249             iwrkt(icrs) = iwrk}
\DoxyCodeLine{250 \textcolor{keywordflow}{         End Do} ech2}
\DoxyCodeLine{251 \textcolor{comment}{!}}
\DoxyCodeLine{252 \textcolor{comment}{!  One restricts further processing to find the fractile value}}
\DoxyCodeLine{253 \textcolor{comment}{!}}
\DoxyCodeLine{254          \textcolor{keywordflow}{If} (icrs <= nord) ideb = icrs}
\DoxyCodeLine{255          \textcolor{keywordflow}{If} (icrs > nord) ifin = icrs -\/ 1}
\DoxyCodeLine{256 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{257 \textcolor{comment}{!}}
\DoxyCodeLine{258 \textcolor{comment}{!  Now, we only need to complete ranking of the 1:NORD set}}
\DoxyCodeLine{259 \textcolor{comment}{!  Assuming NORD is small, we use a simple insertion sort}}
\DoxyCodeLine{260 \textcolor{comment}{!}}
\DoxyCodeLine{261       \textcolor{keywordflow}{Do} icrs = 2, nord}
\DoxyCodeLine{262          iwrk = iwrkt(icrs)}
\DoxyCodeLine{263          xwrk = xdont(iwrk)}
\DoxyCodeLine{264          \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{265             \textcolor{keywordflow}{If} (xwrk <= xdont(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{266                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{267             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{268                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{269 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{270 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{271          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{272 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{273       irngt(1:nord) = iwrkt(1:nord)}
\DoxyCodeLine{274       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{275 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{interfacem__refpar_1_1refpar_a7a2d5d0ffa7d3a57df431c07236f4ae6}\label{interfacem__refpar_1_1refpar_a7a2d5d0ffa7d3a57df431c07236f4ae6}} 
\index{m\_refpar::refpar@{m\_refpar::refpar}!real64\_refpar@{real64\_refpar}}
\index{real64\_refpar@{real64\_refpar}!m\_refpar::refpar@{m\_refpar::refpar}}
\doxysubsubsection{\texorpdfstring{real64\_refpar()}{real64\_refpar()}}
{\footnotesize\ttfamily subroutine m\+\_\+refpar\+::refpar\+::real64\+\_\+refpar (\begin{DoxyParamCaption}\item[{real (kind=real64), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, dimension (\+:), intent(out)}]{I\+R\+N\+GT,  }\item[{integer, intent(in)}]{N\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\hypertarget{namespacem__refpar_autotoc_md81}{}\doxysubsubsection{N\+A\+ME}\label{namespacem__refpar_autotoc_md81}
refpar(3f) -\/ \mbox{[}orderpack\+:P\+A\+R\+T\+I\+A\+L\+\_\+\+R\+A\+NK\mbox{]} partially ranks any array up to specified number of elements (L\+I\+C\+E\+N\+SE\+:C\+C0-\/1.\+0)\hypertarget{namespacem__refpar_autotoc_md82}{}\doxysubsubsection{S\+Y\+N\+O\+P\+S\+IS}\label{namespacem__refpar_autotoc_md82}
\begin{DoxyVerb} Subroutine ${KIND}_refpar (XDONT, IRNGT, NORD)

   ${TYPE} (kind=${KIND}), Dimension (:), Intent (In) :: XDONT
   Integer, Dimension (:), Intent (Out) :: IRNGT
   Integer, Intent (In) :: NORD

Where ${TYPE}(kind=${KIND}) may be

   o Real(kind=real32)
   o Real(kind=real64)
   o Integer(kind=int32)
\end{DoxyVerb}
\hypertarget{namespacem__refpar_autotoc_md83}{}\doxysubsubsection{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}\label{namespacem__refpar_autotoc_md83}
Ranks partially X\+D\+O\+NT by I\+R\+N\+GT, up to order N\+O\+RD

This routine uses a pivoting strategy such as the one used in finding the median based on the quicksort algorithm. It uses a temporary array, where it stores the partially ranked indices of the values. It iterates until it can bring the number of values lower than the pivot to exactly N\+O\+RD, and then uses an insertion sort to rank this set, since it is supposedly small.\hypertarget{namespacem__refpar_autotoc_md84}{}\doxysubsubsection{O\+P\+T\+I\+O\+NS}\label{namespacem__refpar_autotoc_md84}
X\+D\+O\+NT array to partially rank I\+R\+N\+GT array to hold indices of ranked elements N\+O\+RD number of elements to rank\hypertarget{namespacem__refpar_autotoc_md85}{}\doxysubsubsection{E\+X\+A\+M\+P\+L\+ES}\label{namespacem__refpar_autotoc_md85}
Sample program\+:

program demo\+\_\+refpar use M\+\_\+refpar, only \+: refpar implicit none !x!call refpar(yyyyyy) end program demo\+\_\+refpar

Results\+:\hypertarget{namespacem__refpar_autotoc_md86}{}\doxysubsubsection{A\+U\+T\+H\+OR}\label{namespacem__refpar_autotoc_md86}
Michel Olagnon -\/ Feb. 2000

John Urban, 2022.\+04.\+16 o added man-\/page and reduced to a template using the prep(1) preprocessor.\hypertarget{namespacem__refpar_autotoc_md87}{}\doxysubsubsection{L\+I\+C\+E\+N\+SE}\label{namespacem__refpar_autotoc_md87}
C\+C0-\/1.\+0 
\begin{DoxyCode}{0}
\DoxyCodeLine{67 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{68       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IRNGT}
\DoxyCodeLine{69       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (In)} :: NORD}
\DoxyCodeLine{70 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{71 \textcolor{keywordtype}{      Real} (kind=real64) :: xpiv, xwrk}
\DoxyCodeLine{72 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{73 \textcolor{comment}{!}}
\DoxyCodeLine{74       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(XDONT))} :: IWRKT}
\DoxyCodeLine{75       \textcolor{keywordtype}{Integer} :: NDON, ICRS, IDEB, IDCR, IFIN, IMIL, IWRK}
\DoxyCodeLine{76 \textcolor{comment}{!}}
\DoxyCodeLine{77       ndon = \textcolor{keyword}{SIZE} (xdont)}
\DoxyCodeLine{78 \textcolor{comment}{!}}
\DoxyCodeLine{79       \textcolor{keywordflow}{Do} icrs = 1, ndon}
\DoxyCodeLine{80          iwrkt(icrs) = icrs}
\DoxyCodeLine{81 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{82       ideb = 1}
\DoxyCodeLine{83       ifin = ndon}
\DoxyCodeLine{84       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{85          \textcolor{keywordflow}{If} (ideb >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{86          imil = (ideb+ifin) / 2}
\DoxyCodeLine{87 \textcolor{comment}{!}}
\DoxyCodeLine{88 \textcolor{comment}{!  One chooses a pivot, median of 1st, last, and middle values}}
\DoxyCodeLine{89 \textcolor{comment}{!}}
\DoxyCodeLine{90          \textcolor{keywordflow}{If} (xdont(iwrkt(imil)) < xdont(iwrkt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{91             iwrk = iwrkt(ideb)}
\DoxyCodeLine{92             iwrkt(ideb) = iwrkt(imil)}
\DoxyCodeLine{93             iwrkt(imil) = iwrk}
\DoxyCodeLine{94 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{95          \textcolor{keywordflow}{If} (xdont(iwrkt(imil)) > xdont(iwrkt(ifin))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{96             iwrk = iwrkt(ifin)}
\DoxyCodeLine{97             iwrkt(ifin) = iwrkt(imil)}
\DoxyCodeLine{98             iwrkt(imil) = iwrk}
\DoxyCodeLine{99             \textcolor{keywordflow}{If} (xdont(iwrkt(imil)) < xdont(iwrkt(ideb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{100                iwrk = iwrkt(ideb)}
\DoxyCodeLine{101                iwrkt(ideb) = iwrkt(imil)}
\DoxyCodeLine{102                iwrkt(imil) = iwrk}
\DoxyCodeLine{103 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{104 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{105          \textcolor{keywordflow}{If} ((ifin-\/ideb) < 3) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{106          xpiv = xdont(iwrkt(imil))}
\DoxyCodeLine{107 \textcolor{comment}{!}}
\DoxyCodeLine{108 \textcolor{comment}{!  One exchanges values to put those > pivot in the end and}}
\DoxyCodeLine{109 \textcolor{comment}{!  those <= pivot at the beginning}}
\DoxyCodeLine{110 \textcolor{comment}{!}}
\DoxyCodeLine{111          icrs = ideb}
\DoxyCodeLine{112          idcr = ifin}
\DoxyCodeLine{113          ech2: \textcolor{keywordflow}{Do}}
\DoxyCodeLine{114             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{115                icrs = icrs + 1}
\DoxyCodeLine{116                \textcolor{keywordflow}{If} (icrs >= idcr) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{117 \textcolor{comment}{!}}
\DoxyCodeLine{118 \textcolor{comment}{!  the first  >  pivot is IWRKT(IDCR)}}
\DoxyCodeLine{119 \textcolor{comment}{!  the last   <= pivot is IWRKT(ICRS-\/1)}}
\DoxyCodeLine{120 \textcolor{comment}{!  Note: If one arrives here on the first iteration, then}}
\DoxyCodeLine{121 \textcolor{comment}{!        the pivot is the maximum of the set, the last value is equal}}
\DoxyCodeLine{122 \textcolor{comment}{!        to it, and one can reduce by one the size of the set to process,}}
\DoxyCodeLine{123 \textcolor{comment}{!        as if XDONT (IWRKT(IFIN)) > XPIV}}
\DoxyCodeLine{124 \textcolor{comment}{!}}
\DoxyCodeLine{125                   \textcolor{keywordflow}{Exit} ech2}
\DoxyCodeLine{126 \textcolor{comment}{!}}
\DoxyCodeLine{127 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{128                \textcolor{keywordflow}{If} (xdont(iwrkt(icrs)) > xpiv) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{129 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{130             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{131                \textcolor{keywordflow}{If} (xdont(iwrkt(idcr)) <= xpiv) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{132                idcr = idcr -\/ 1}
\DoxyCodeLine{133                \textcolor{keywordflow}{If} (icrs >= idcr) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{134 \textcolor{comment}{!}}
\DoxyCodeLine{135 \textcolor{comment}{!  The last value < pivot is always IWRKT(ICRS-\/1)}}
\DoxyCodeLine{136 \textcolor{comment}{!}}
\DoxyCodeLine{137                   \textcolor{keywordflow}{Exit} ech2}
\DoxyCodeLine{138 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{139 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{140 \textcolor{comment}{!}}
\DoxyCodeLine{141             iwrk = iwrkt(idcr)}
\DoxyCodeLine{142             iwrkt(idcr) = iwrkt(icrs)}
\DoxyCodeLine{143             iwrkt(icrs) = iwrk}
\DoxyCodeLine{144 \textcolor{keywordflow}{         End Do} ech2}
\DoxyCodeLine{145 \textcolor{comment}{!}}
\DoxyCodeLine{146 \textcolor{comment}{!  One restricts further processing to find the fractile value}}
\DoxyCodeLine{147 \textcolor{comment}{!}}
\DoxyCodeLine{148          \textcolor{keywordflow}{If} (icrs <= nord) ideb = icrs}
\DoxyCodeLine{149          \textcolor{keywordflow}{If} (icrs > nord) ifin = icrs -\/ 1}
\DoxyCodeLine{150 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{151 \textcolor{comment}{!}}
\DoxyCodeLine{152 \textcolor{comment}{!  Now, we only need to complete ranking of the 1:NORD set}}
\DoxyCodeLine{153 \textcolor{comment}{!  Assuming NORD is small, we use a simple insertion sort}}
\DoxyCodeLine{154 \textcolor{comment}{!}}
\DoxyCodeLine{155       \textcolor{keywordflow}{Do} icrs = 2, nord}
\DoxyCodeLine{156          iwrk = iwrkt(icrs)}
\DoxyCodeLine{157          xwrk = xdont(iwrk)}
\DoxyCodeLine{158          \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{159             \textcolor{keywordflow}{If} (xwrk <= xdont(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{160                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{161             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{162                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{163 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{164 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{165          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{166 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{167       irngt(1:nord) = iwrkt(1:nord)}
\DoxyCodeLine{168       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{169 \textcolor{comment}{!}}

\end{DoxyCode}


The documentation for this interface was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/home/urbanjs/venus/\+V600/github/orderpack/src/\mbox{\hyperlink{M__refpar_8f90}{M\+\_\+refpar.\+f90}}\end{DoxyCompactItemize}
