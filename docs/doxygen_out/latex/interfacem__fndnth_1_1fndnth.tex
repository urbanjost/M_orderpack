\hypertarget{interfacem__fndnth_1_1fndnth}{}\doxysection{m\+\_\+fndnth\+::fndnth Interface Reference}
\label{interfacem__fndnth_1_1fndnth}\index{m\_fndnth::fndnth@{m\_fndnth::fndnth}}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
real(kind=real64) function \mbox{\hyperlink{interfacem__fndnth_1_1fndnth_ac4449c422c18ed759ec93b72537dd077}{real64\+\_\+fndnth}} (X\+D\+O\+NT, N\+O\+RD)
\item 
real(kind=real32) function \mbox{\hyperlink{interfacem__fndnth_1_1fndnth_a4783cb5e86bf3d1899c58b326de882b3}{real32\+\_\+fndnth}} (X\+D\+O\+NT, N\+O\+RD)
\item 
integer(kind=int32) function \mbox{\hyperlink{interfacem__fndnth_1_1fndnth_a50cead5a1b79d5c0f0c75a1551aabcd1}{int32\+\_\+fndnth}} (X\+D\+O\+NT, N\+O\+RD)
\end{DoxyCompactItemize}


\doxysubsection{Member Function/\+Subroutine Documentation}
\mbox{\Hypertarget{interfacem__fndnth_1_1fndnth_a50cead5a1b79d5c0f0c75a1551aabcd1}\label{interfacem__fndnth_1_1fndnth_a50cead5a1b79d5c0f0c75a1551aabcd1}} 
\index{m\_fndnth::fndnth@{m\_fndnth::fndnth}!int32\_fndnth@{int32\_fndnth}}
\index{int32\_fndnth@{int32\_fndnth}!m\_fndnth::fndnth@{m\_fndnth::fndnth}}
\doxysubsubsection{\texorpdfstring{int32\_fndnth()}{int32\_fndnth()}}
{\footnotesize\ttfamily integer (kind=int32) function m\+\_\+fndnth\+::fndnth\+::int32\+\_\+fndnth (\begin{DoxyParamCaption}\item[{integer (kind=int32), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, intent(in)}]{N\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{191 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{192       \textcolor{keywordtype}{Integer (Kind=int32)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDONT}
\DoxyCodeLine{193       \textcolor{keywordtype}{Integer (Kind=int32)} :: FNDNTH}
\DoxyCodeLine{194       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (In)} :: NORD}
\DoxyCodeLine{195 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{196       \textcolor{keywordtype}{Integer (Kind=int32)}, \textcolor{keywordtype}{Dimension (NORD)} :: XWRKT}
\DoxyCodeLine{197       \textcolor{keywordtype}{Integer (Kind=int32)} :: XWRK, XWRK1}
\DoxyCodeLine{198 \textcolor{comment}{!}}
\DoxyCodeLine{199       \textcolor{keywordtype}{Integer} :: ICRS, IDCR, ILOW, NDON}
\DoxyCodeLine{200 \textcolor{comment}{!}}
\DoxyCodeLine{201       xwrkt(1) = xdont(1)}
\DoxyCodeLine{202       \textcolor{keywordflow}{Do} icrs = 2, nord}
\DoxyCodeLine{203          xwrk = xdont(icrs)}
\DoxyCodeLine{204          \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{205             \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{206             xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{207 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{208          xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{209 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{210 \textcolor{comment}{!}}
\DoxyCodeLine{211       ndon = \textcolor{keyword}{SIZE} (xdont)}
\DoxyCodeLine{212       xwrk1 = xwrkt(nord)}
\DoxyCodeLine{213       ilow = 2*nord -\/ ndon}
\DoxyCodeLine{214       \textcolor{keywordflow}{Do} icrs = nord + 1, ndon}
\DoxyCodeLine{215          \textcolor{keywordflow}{If} (xdont(icrs) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{216             xwrk = xdont(icrs)}
\DoxyCodeLine{217             \textcolor{keywordflow}{Do} idcr = nord -\/ 1, max(1, ilow) , -\/ 1}
\DoxyCodeLine{218                \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{219                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{220 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{221             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{222             xwrk1 = xwrkt(nord)}
\DoxyCodeLine{223 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{224          ilow = ilow + 1}
\DoxyCodeLine{225 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{226       fndnth = xwrk1}
\DoxyCodeLine{227 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{interfacem__fndnth_1_1fndnth_a4783cb5e86bf3d1899c58b326de882b3}\label{interfacem__fndnth_1_1fndnth_a4783cb5e86bf3d1899c58b326de882b3}} 
\index{m\_fndnth::fndnth@{m\_fndnth::fndnth}!real32\_fndnth@{real32\_fndnth}}
\index{real32\_fndnth@{real32\_fndnth}!m\_fndnth::fndnth@{m\_fndnth::fndnth}}
\doxysubsubsection{\texorpdfstring{real32\_fndnth()}{real32\_fndnth()}}
{\footnotesize\ttfamily real (kind=real32) function m\+\_\+fndnth\+::fndnth\+::real32\+\_\+fndnth (\begin{DoxyParamCaption}\item[{real (kind=real32), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, intent(in)}]{N\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{152 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{153 \textcolor{keywordtype}{      Real} (Kind=real32), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{154 \textcolor{keywordtype}{      Real} (Kind=real32) :: fndnth}
\DoxyCodeLine{155       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (In)} :: NORD}
\DoxyCodeLine{156 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{157 \textcolor{keywordtype}{      Real} (Kind=real32), \textcolor{keywordtype}{Dimension (NORD)} :: xwrkt}
\DoxyCodeLine{158 \textcolor{keywordtype}{      Real} (Kind=real32) :: xwrk, xwrk1}
\DoxyCodeLine{159 \textcolor{comment}{!}}
\DoxyCodeLine{160       \textcolor{keywordtype}{Integer} :: ICRS, IDCR, ILOW, NDON}
\DoxyCodeLine{161 \textcolor{comment}{!}}
\DoxyCodeLine{162       xwrkt(1) = xdont(1)}
\DoxyCodeLine{163       \textcolor{keywordflow}{Do} icrs = 2, nord}
\DoxyCodeLine{164          xwrk = xdont(icrs)}
\DoxyCodeLine{165          \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{166             \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{167             xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{168 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{169          xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{170 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{171 \textcolor{comment}{!}}
\DoxyCodeLine{172       ndon = \textcolor{keyword}{SIZE} (xdont)}
\DoxyCodeLine{173       xwrk1 = xwrkt(nord)}
\DoxyCodeLine{174       ilow = 2*nord -\/ ndon}
\DoxyCodeLine{175       \textcolor{keywordflow}{Do} icrs = nord + 1, ndon}
\DoxyCodeLine{176          \textcolor{keywordflow}{If} (xdont(icrs) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{177             xwrk = xdont(icrs)}
\DoxyCodeLine{178             \textcolor{keywordflow}{Do} idcr = nord -\/ 1, max(1, ilow) , -\/ 1}
\DoxyCodeLine{179                \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{180                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{181 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{182             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{183             xwrk1 = xwrkt(nord)}
\DoxyCodeLine{184 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{185          ilow = ilow + 1}
\DoxyCodeLine{186 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{187       fndnth = xwrk1}
\DoxyCodeLine{188 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{interfacem__fndnth_1_1fndnth_ac4449c422c18ed759ec93b72537dd077}\label{interfacem__fndnth_1_1fndnth_ac4449c422c18ed759ec93b72537dd077}} 
\index{m\_fndnth::fndnth@{m\_fndnth::fndnth}!real64\_fndnth@{real64\_fndnth}}
\index{real64\_fndnth@{real64\_fndnth}!m\_fndnth::fndnth@{m\_fndnth::fndnth}}
\doxysubsubsection{\texorpdfstring{real64\_fndnth()}{real64\_fndnth()}}
{\footnotesize\ttfamily real (kind=real64) function m\+\_\+fndnth\+::fndnth\+::real64\+\_\+fndnth (\begin{DoxyParamCaption}\item[{real (kind=real64), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, intent(in)}]{N\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\hypertarget{namespacem__fndnth_autotoc_md7}{}\doxysubsubsection{N\+A\+ME}\label{namespacem__fndnth_autotoc_md7}
fndnth(3f) -\/ \mbox{[}orderpack\+:F\+R\+A\+C\+T\+I\+LE\mbox{]} Return Nth lowest ordered V\+A\+L\+UE of array, i.\+e. return fractile of order N/\+S\+I\+ZE(array) (Insert\+Sort-\/like)\hypertarget{namespacem__fndnth_autotoc_md8}{}\doxysubsubsection{S\+Y\+N\+O\+P\+S\+IS}\label{namespacem__fndnth_autotoc_md8}
\begin{DoxyVerb} Function fndnth (XDONT, NORD) Result (FNDNTH)

  ${TYPE} (Kind=${KIND}), Dimension (:), Intent (In) :: XDONT
  Integer, Intent (In) :: NORD
  ${TYPE} (Kind=${KIND}) :: FNDNTH

Where ${TYPE}(kind=${KIND}) may be

o Real(kind=real32)
o Real(kind=real64)
o Integer(kind=int32)
\end{DoxyVerb}
\hypertarget{namespacem__fndnth_autotoc_md9}{}\doxysubsubsection{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}\label{namespacem__fndnth_autotoc_md9}
F\+N\+D\+N\+T\+H(3) returns the N\+O\+R\+Dth lowest value of X\+D\+O\+N\+T(), i.\+e. the fractile of order N\+O\+R\+D/\+S\+I\+ZE(X\+D\+O\+NT).

This subroutine uses an insertion sort, limiting insertion to the first N\+O\+RD values. An insertion sort is very fast when N\+O\+RD is very small (2-\/5). Additionally, internally it requires only a work array of size N\+O\+RD (and type of X\+D\+O\+NT),

But worst case behavior can happen fairly probably (e.\+g., initially inverse sorted). Therefore, in many cases, the refined Quick\+Sort method is faster.

so F\+N\+D\+N\+T\+H() should be used when N\+O\+RD is small and X\+D\+O\+NT is likely to be a random array, otherwise consider using I\+N\+D\+N\+T\+H(3) or V\+A\+L\+N\+T\+H(3).\hypertarget{namespacem__fndnth_autotoc_md10}{}\doxysubsubsection{O\+P\+T\+I\+O\+NS}\label{namespacem__fndnth_autotoc_md10}
X\+D\+O\+NT input array of values N\+O\+RD specify Nth value of sorted X\+D\+O\+NT array to return, from 1 to size(\+X\+D\+O\+N\+T). \hypertarget{namespacem__fndnth_autotoc_md11}{}\doxysubsubsection{R\+E\+T\+U\+R\+NS}\label{namespacem__fndnth_autotoc_md11}
F\+N\+D\+N\+TH returned value\hypertarget{namespacem__fndnth_autotoc_md12}{}\doxysubsubsection{E\+X\+A\+M\+P\+L\+ES}\label{namespacem__fndnth_autotoc_md12}
Sample program\+:

program demo\+\_\+fndnth ! return Nth ordered value of an array use M\+\_\+fndnth, only \+: fndnth use M\+\_\+valmed, only \+: valmed implicit none character(len=$\ast$),parameter \+:: list= \textquotesingle{}($\ast$(g0\+:,\char`\"{}, \char`\"{}))\textquotesingle{},sp=\textquotesingle{}($\ast$(g0,1x))\textquotesingle{} integer,allocatable \+:: iarr(\+:) integer \+:: i iarr=\mbox{[}80,70,30,40,-\/50,60,20,10\mbox{]} print sp, \textquotesingle{}O\+R\+I\+G\+I\+N\+AL\+:\textquotesingle{},iarr ! can return the same values as intrinsics minval() and maxval() print sp, \textquotesingle{}minval\textquotesingle{},fndnth(iarr,1), minval(iarr) print sp, \textquotesingle{}maxval\textquotesingle{},fndnth(iarr,size(iarr)), maxval(iarr) ! but more generally it can return the Nth lowest value. print sp, \textquotesingle{}median\textquotesingle{},fndnth(iarr,(size(iarr+1))/2), valmed(iarr) ! so only Nth ordered value can be found print sp,\textquotesingle{}nord=\textquotesingle{},3, \textquotesingle{} fractile=\textquotesingle{},fndnth(iarr,3) ! sorting the hard way print sp, \textquotesingle{}O\+R\+I\+G\+I\+N\+AL\+:\textquotesingle{},iarr do i=1,size(iarr) write($\ast$,list)i,fndnth(iarr,i) enddo print $\ast$ end program demo\+\_\+fndnth

Results\+:

O\+R\+I\+G\+I\+N\+AL\+: 80 70 30 40 -\/50 60 20 10 minval -\/50 -\/50 maxval 80 80 median 30 30 nord= 3 fractile= 20 O\+R\+I\+G\+I\+N\+AL\+: 80 70 30 40 -\/50 60 20 10 1, -\/50 2, 10 3, 20 4, 30 5, 40 6, 60 7, 70 8, 80\hypertarget{namespacem__fndnth_autotoc_md13}{}\doxysubsubsection{S\+E\+E A\+L\+SO}\label{namespacem__fndnth_autotoc_md13}
\begin{DoxyVerb}indnth(3), valnth(3)
\end{DoxyVerb}
\hypertarget{namespacem__fndnth_autotoc_md14}{}\doxysubsubsection{A\+U\+T\+H\+OR}\label{namespacem__fndnth_autotoc_md14}
Michel Olagnon -\/ Aug. 2000

John Urban, 2022.\+04.\+16 o added man-\/page and reduced to a template using the prep(1) preprocessor.\hypertarget{namespacem__fndnth_autotoc_md15}{}\doxysubsubsection{L\+I\+C\+E\+N\+SE}\label{namespacem__fndnth_autotoc_md15}
C\+C0-\/1.\+0 
\begin{DoxyCode}{0}
\DoxyCodeLine{113 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{114 \textcolor{keywordtype}{      Real} (Kind=real64), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{115 \textcolor{keywordtype}{      Real} (Kind=real64) :: fndnth}
\DoxyCodeLine{116       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (In)} :: NORD}
\DoxyCodeLine{117 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{118 \textcolor{keywordtype}{      Real} (Kind=real64), \textcolor{keywordtype}{Dimension (NORD)} :: xwrkt}
\DoxyCodeLine{119 \textcolor{keywordtype}{      Real} (Kind=real64) :: xwrk, xwrk1}
\DoxyCodeLine{120 \textcolor{comment}{!}}
\DoxyCodeLine{121       \textcolor{keywordtype}{Integer} :: ICRS, IDCR, ILOW, NDON}
\DoxyCodeLine{122 \textcolor{comment}{!}}
\DoxyCodeLine{123       xwrkt(1) = xdont(1)}
\DoxyCodeLine{124       \textcolor{keywordflow}{Do} icrs = 2, nord}
\DoxyCodeLine{125          xwrk = xdont(icrs)}
\DoxyCodeLine{126          \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{127             \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{128             xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{129 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{130          xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{131 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{132 \textcolor{comment}{!}}
\DoxyCodeLine{133       ndon = \textcolor{keyword}{SIZE} (xdont)}
\DoxyCodeLine{134       xwrk1 = xwrkt(nord)}
\DoxyCodeLine{135       ilow = 2*nord -\/ ndon}
\DoxyCodeLine{136       \textcolor{keywordflow}{Do} icrs = nord + 1, ndon}
\DoxyCodeLine{137          \textcolor{keywordflow}{If} (xdont(icrs) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{138             xwrk = xdont(icrs)}
\DoxyCodeLine{139             \textcolor{keywordflow}{Do} idcr = nord -\/ 1, max(1, ilow) , -\/ 1}
\DoxyCodeLine{140                \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{141                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{142 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{143             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{144             xwrk1 = xwrkt(nord)}
\DoxyCodeLine{145 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{146          ilow = ilow + 1}
\DoxyCodeLine{147 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{148       fndnth = xwrk1}
\DoxyCodeLine{149 \textcolor{comment}{!}}

\end{DoxyCode}


The documentation for this interface was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/home/urbanjs/venus/\+V600/github/orderpack/src/\mbox{\hyperlink{M__fndnth_8f90}{M\+\_\+fndnth.\+f90}}\end{DoxyCompactItemize}
