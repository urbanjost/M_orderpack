\hypertarget{namespacem__ctrper}{}\doxysection{m\+\_\+ctrper Module Reference}
\label{namespacem__ctrper}\index{m\_ctrper@{m\_ctrper}}
\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface \mbox{\hyperlink{interfacem__ctrper_1_1ctrper}{ctrper}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, private \mbox{\hyperlink{namespacem__ctrper_a18c973de9dc34464ce69cd3a03428b3a}{real64\+\_\+ctrper}} (X\+D\+O\+NT, P\+C\+LS)
\item 
subroutine, private \mbox{\hyperlink{namespacem__ctrper_a9c552c42eed06299e94f7b1365b679bc}{real32\+\_\+ctrper}} (X\+D\+O\+NT, P\+C\+LS)
\item 
subroutine, private \mbox{\hyperlink{namespacem__ctrper_a43f8d1b4420bd2b501cf716b8de5339b}{int32\+\_\+ctrper}} (X\+D\+O\+NT, P\+C\+LS)
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacem__ctrper_a43f8d1b4420bd2b501cf716b8de5339b}\label{namespacem__ctrper_a43f8d1b4420bd2b501cf716b8de5339b}} 
\index{m\_ctrper@{m\_ctrper}!int32\_ctrper@{int32\_ctrper}}
\index{int32\_ctrper@{int32\_ctrper}!m\_ctrper@{m\_ctrper}}
\doxysubsubsection{\texorpdfstring{int32\_ctrper()}{int32\_ctrper()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+ctrper\+::int32\+\_\+ctrper (\begin{DoxyParamCaption}\item[{integer (kind=int32), dimension (\+:), intent(inout)}]{X\+D\+O\+NT,  }\item[{real, intent(in)}]{P\+C\+LS }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{163 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{164       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (InOut)} :: XDONT}
\DoxyCodeLine{165 \textcolor{keywordtype}{      Real}, \textcolor{keywordtype}{Intent (In)} :: PCLS}
\DoxyCodeLine{166 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{167 \textcolor{comment}{!}}
\DoxyCodeLine{168 \textcolor{keywordtype}{      Real}, \textcolor{keywordtype}{Dimension (Size(XDONT))} :: XINDT}
\DoxyCodeLine{169       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (Size(XDONT))} :: JWRKT}
\DoxyCodeLine{170 \textcolor{keywordtype}{      Real} :: PWRK}
\DoxyCodeLine{171       \textcolor{keywordtype}{Integer} :: I}
\DoxyCodeLine{172 \textcolor{comment}{!}}
\DoxyCodeLine{173       \textcolor{keyword}{Call }random\_number (xindt(:))}
\DoxyCodeLine{174       pwrk = min(max(0.0, pcls), 1.0)}
\DoxyCodeLine{175       xindt = real(\textcolor{keyword}{Size}(xdont)) * xindt}
\DoxyCodeLine{176       xindt = pwrk*xindt + (1.0-\/pwrk)*[ (real(i), i=1,\textcolor{keyword}{size}(xdont)) ]}
\DoxyCodeLine{177       \textcolor{keyword}{Call }mrgrnk (xindt, jwrkt)}
\DoxyCodeLine{178       xdont = xdont(jwrkt)}
\DoxyCodeLine{179 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__ctrper_a9c552c42eed06299e94f7b1365b679bc}\label{namespacem__ctrper_a9c552c42eed06299e94f7b1365b679bc}} 
\index{m\_ctrper@{m\_ctrper}!real32\_ctrper@{real32\_ctrper}}
\index{real32\_ctrper@{real32\_ctrper}!m\_ctrper@{m\_ctrper}}
\doxysubsubsection{\texorpdfstring{real32\_ctrper()}{real32\_ctrper()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+ctrper\+::real32\+\_\+ctrper (\begin{DoxyParamCaption}\item[{real (kind=real32), dimension (\+:), intent(inout)}]{X\+D\+O\+NT,  }\item[{real, intent(in)}]{P\+C\+LS }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{144 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{145 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (InOut)} :: xdont}
\DoxyCodeLine{146 \textcolor{keywordtype}{      Real}, \textcolor{keywordtype}{Intent (In)} :: PCLS}
\DoxyCodeLine{147 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{148 \textcolor{comment}{!}}
\DoxyCodeLine{149 \textcolor{keywordtype}{      Real}, \textcolor{keywordtype}{Dimension (Size(XDONT))} :: XINDT}
\DoxyCodeLine{150       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (Size(XDONT))} :: JWRKT}
\DoxyCodeLine{151 \textcolor{keywordtype}{      Real} :: PWRK}
\DoxyCodeLine{152       \textcolor{keywordtype}{Integer} :: I}
\DoxyCodeLine{153 \textcolor{comment}{!}}
\DoxyCodeLine{154       \textcolor{keyword}{Call }random\_number (xindt(:))}
\DoxyCodeLine{155       pwrk = min(max(0.0, pcls), 1.0)}
\DoxyCodeLine{156       xindt = real(\textcolor{keyword}{Size}(xdont)) * xindt}
\DoxyCodeLine{157       xindt = pwrk*xindt + (1.0-\/pwrk)*[ (real(i), i=1,\textcolor{keyword}{size}(xdont)) ]}
\DoxyCodeLine{158       \textcolor{keyword}{Call }mrgrnk (xindt, jwrkt)}
\DoxyCodeLine{159       xdont = xdont(jwrkt)}
\DoxyCodeLine{160 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__ctrper_a18c973de9dc34464ce69cd3a03428b3a}\label{namespacem__ctrper_a18c973de9dc34464ce69cd3a03428b3a}} 
\index{m\_ctrper@{m\_ctrper}!real64\_ctrper@{real64\_ctrper}}
\index{real64\_ctrper@{real64\_ctrper}!m\_ctrper@{m\_ctrper}}
\doxysubsubsection{\texorpdfstring{real64\_ctrper()}{real64\_ctrper()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+ctrper\+::real64\+\_\+ctrper (\begin{DoxyParamCaption}\item[{real (kind=real64), dimension (\+:), intent(inout)}]{X\+D\+O\+NT,  }\item[{real, intent(in)}]{P\+C\+LS }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\hypertarget{namespacem__ctrper_autotoc_md0}{}\doxysubsubsection{N\+A\+ME}\label{namespacem__ctrper_autotoc_md0}
ctrper(3f) -\/ \mbox{[}orderpack\+:P\+E\+R\+M\+U\+T\+A\+T\+I\+ON\mbox{]} generate a random permutation of an array leaving elements close to initial locations\hypertarget{namespacem__ctrper_autotoc_md1}{}\doxysubsubsection{S\+Y\+N\+O\+P\+S\+IS}\label{namespacem__ctrper_autotoc_md1}
\begin{DoxyVerb} Subroutine ctrper (XDONT, PCLS)

  ${TYPE} (kind=${KIND}), Intent (InOut) :: XDONT(:)
  Real, Intent (In) :: PCLS

Where ${TYPE}(kind=${KIND}) may be

   o Real(kind=real32)
   o Real(kind=real64)
   o Integer(kind=int32)
\end{DoxyVerb}
\hypertarget{namespacem__ctrper_autotoc_md2}{}\doxysubsubsection{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}\label{namespacem__ctrper_autotoc_md2}
Permute array X\+D\+O\+NT randomly, but leaving elements close to their initial locations (nearbyness is controlled by P\+C\+LS).

The routine creates a real array of the indices of X\+D\+O\+N\+T() perturbed by random values that are based on the size of P\+C\+LS. The new array is then ranked and the resulting index is used to permute the input array.

The relative proportion of initial order and random order is defined as 1-\/P\+C\+LS / P\+C\+LS, thus when P\+C\+LS = 0, there is no change in the order whereas the new order is fully random when P\+C\+LS = 1.

Note this differs from adding random noise to the values. The original values remain unchanged, their order is just perturbed.\hypertarget{namespacem__ctrper_autotoc_md3}{}\doxysubsubsection{O\+P\+T\+I\+O\+NS}\label{namespacem__ctrper_autotoc_md3}
X\+D\+O\+NT Array of values to perturb. P\+C\+LS Proportion of closeness, constrained to the range 0.\+0(no change) to 1.\+0(fully random).\hypertarget{namespacem__ctrper_autotoc_md4}{}\doxysubsubsection{E\+X\+A\+M\+P\+L\+ES}\label{namespacem__ctrper_autotoc_md4}
Sample program\+:

program demo\+\_\+ctrper use M\+\_\+ctrper, only \+: ctrper implicit none integer,allocatable \+:: xdont(\+:) integer,allocatable \+:: xout(\+:,\+:) real \+:: pcls integer \+:: isz, i, j isz=200 if(allocated(xout))deallocate(xout) allocate(xout(3,isz))

xdont=\mbox{[}(i,i=1,isz)\mbox{]}$\ast$10 call ctrper(xdont,0.\+0) xout(1,\+:)=xdont

xdont=\mbox{[}(i,i=1,isz)\mbox{]}$\ast$10 call ctrper(xdont,0.\+1) xout(2,\+:)=xdont

xdont=\mbox{[}(i,i=1,isz)\mbox{]}$\ast$10 call ctrper(xdont,1.\+0) xout(3,\+:)=xdont

write($\ast$,\textquotesingle{}(a)\textquotesingle{})\textquotesingle{}count unchanged perturbed random\textquotesingle{} do i=1,size(xdont) write($\ast$,\textquotesingle{}($\ast$(i8,1x))\textquotesingle{})i,xout(\+:,i) enddo

end program demo\+\_\+ctrper

Results\+:

$>$ count unchanged perturbed random $>$ 1 10 30 1930 $>$ 2 20 20 1430 $>$ 3 30 120 320 $>$ 4 40 110 670 $>$ 5 50 90 750 $>$ 6 60 60 790 $>$ 7 70 130 1850 $>$ 8 80 50 390 $>$ 9 90 150 1470 $>$ 10 100 80 710 $>$ 11 110 70 820 $>$ 12 120 10 680 $>$ . . . . $>$ . . . . $>$ . . . . $>$ . . . . $>$ 190 1900 1860 1210 $>$ 191 1910 1890 580 $>$ 192 1920 1840 600 $>$ 193 1930 1870 1640 $>$ 194 1940 1920 290 $>$ 195 1950 2000 1180 $>$ 196 1960 1910 340 $>$ 197 1970 1990 1540 $>$ 198 1980 1940 990 $>$ 199 1990 1950 470 $>$ 200 2000 1980 200\hypertarget{namespacem__ctrper_autotoc_md5}{}\doxysubsubsection{A\+U\+T\+H\+OR}\label{namespacem__ctrper_autotoc_md5}
Michel Olagnon, 2000-\/2012

John Urban, 2022.\+04.\+16 o added man-\/page and reduced to a template using the prep(1) preprocessor.\hypertarget{namespacem__ctrper_autotoc_md6}{}\doxysubsubsection{L\+I\+C\+E\+N\+SE}\label{namespacem__ctrper_autotoc_md6}
C\+C0-\/1.\+0 
\begin{DoxyCode}{0}
\DoxyCodeLine{125 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{126 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (InOut)} :: xdont}
\DoxyCodeLine{127 \textcolor{keywordtype}{      Real}, \textcolor{keywordtype}{Intent (In)} :: PCLS}
\DoxyCodeLine{128 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{129 \textcolor{comment}{!}}
\DoxyCodeLine{130 \textcolor{keywordtype}{      Real}, \textcolor{keywordtype}{Dimension (Size(XDONT))} :: XINDT}
\DoxyCodeLine{131       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (Size(XDONT))} :: JWRKT}
\DoxyCodeLine{132 \textcolor{keywordtype}{      Real} :: PWRK}
\DoxyCodeLine{133       \textcolor{keywordtype}{Integer} :: I}
\DoxyCodeLine{134 \textcolor{comment}{!}}
\DoxyCodeLine{135       \textcolor{keyword}{Call }random\_number (xindt(:))}
\DoxyCodeLine{136       pwrk = min(max(0.0, pcls), 1.0)}
\DoxyCodeLine{137       xindt = real(\textcolor{keyword}{Size}(xdont)) * xindt}
\DoxyCodeLine{138       xindt = pwrk*xindt + (1.0-\/pwrk)*[ (real(i), i=1,\textcolor{keyword}{size}(xdont)) ]}
\DoxyCodeLine{139       \textcolor{keyword}{Call }mrgrnk (xindt, jwrkt)}
\DoxyCodeLine{140       xdont = xdont(jwrkt)}
\DoxyCodeLine{141 \textcolor{comment}{!}}

\end{DoxyCode}
