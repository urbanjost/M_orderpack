\hypertarget{namespacem__ctrper}{}\doxysection{m\+\_\+ctrper Module Reference}
\label{namespacem__ctrper}\index{m\_ctrper@{m\_ctrper}}
\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface \mbox{\hyperlink{interfacem__ctrper_1_1ctrper}{ctrper}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacem__ctrper_a736174988fde2e5624c0b5a611c58f94}{real64\+\_\+ctrper}} (I\+N\+O\+U\+T\+V\+A\+LS, C\+L\+O\+S\+E\+N\+E\+SS)
\item 
subroutine \mbox{\hyperlink{namespacem__ctrper_a576addce3587cce9931176623788acc0}{real32\+\_\+ctrper}} (I\+N\+O\+U\+T\+V\+A\+LS, C\+L\+O\+S\+E\+N\+E\+SS)
\item 
subroutine \mbox{\hyperlink{namespacem__ctrper_a2ff20d42be1fe1774dae8bd9f276fb0f}{int32\+\_\+ctrper}} (I\+N\+O\+U\+T\+V\+A\+LS, C\+L\+O\+S\+E\+N\+E\+SS)
\item 
subroutine \mbox{\hyperlink{namespacem__ctrper_aa77d67b83a578cb271d7af99b462c688}{f\+\_\+char\+\_\+ctrper}} (I\+N\+O\+U\+T\+V\+A\+LS, C\+L\+O\+S\+E\+N\+E\+SS)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
integer, parameter \mbox{\hyperlink{namespacem__ctrper_a2549d1e9c7e73b3c0bcc27afe267ecef}{f\+\_\+char}} =selected\+\_\+char\+\_\+kind(\char`\"{}D\+E\+F\+A\+U\+LT\char`\"{})
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacem__ctrper_aa77d67b83a578cb271d7af99b462c688}\label{namespacem__ctrper_aa77d67b83a578cb271d7af99b462c688}} 
\index{m\_ctrper@{m\_ctrper}!f\_char\_ctrper@{f\_char\_ctrper}}
\index{f\_char\_ctrper@{f\_char\_ctrper}!m\_ctrper@{m\_ctrper}}
\doxysubsubsection{\texorpdfstring{f\_char\_ctrper()}{f\_char\_ctrper()}}
{\footnotesize\ttfamily subroutine m\+\_\+ctrper\+::f\+\_\+char\+\_\+ctrper (\begin{DoxyParamCaption}\item[{character (kind=\mbox{\hyperlink{namespacem__ctrper_a2549d1e9c7e73b3c0bcc27afe267ecef}{f\+\_\+char}},len=$\ast$), dimension (\+:), intent(inout)}]{I\+N\+O\+U\+T\+V\+A\+LS,  }\item[{real, intent(in)}]{C\+L\+O\+S\+E\+N\+E\+SS }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{193 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{194       \textcolor{keywordtype}{character (kind=f\_char,len=*)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (InOut)} :: INOUTVALS}
\DoxyCodeLine{195 \textcolor{keywordtype}{      Real}, \textcolor{keywordtype}{Intent (In)} :: CLOSENESS}
\DoxyCodeLine{196 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{197 \textcolor{comment}{!}}
\DoxyCodeLine{198 \textcolor{keywordtype}{      Real}, \textcolor{keywordtype}{Dimension (Size(INOUTVALS))} :: XINDT}
\DoxyCodeLine{199       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (Size(INOUTVALS))} :: JWRKT}
\DoxyCodeLine{200 \textcolor{keywordtype}{      Real} :: PWRK}
\DoxyCodeLine{201       \textcolor{keywordtype}{Integer} :: I}
\DoxyCodeLine{202 \textcolor{comment}{!}}
\DoxyCodeLine{203       \textcolor{keyword}{Call }random\_number (xindt(:))}
\DoxyCodeLine{204       pwrk = min(max(0.0, closeness), 1.0)}
\DoxyCodeLine{205       xindt = real(\textcolor{keyword}{Size}(inoutvals)) * xindt}
\DoxyCodeLine{206       xindt = pwrk*xindt + (1.0-\/pwrk)*[ (real(i), i=1,\textcolor{keyword}{size}(inoutvals)) ]}
\DoxyCodeLine{207       \textcolor{keyword}{Call }mrgrnk (xindt, jwrkt)}
\DoxyCodeLine{208       inoutvals = inoutvals(jwrkt)}
\DoxyCodeLine{209 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__ctrper_a2ff20d42be1fe1774dae8bd9f276fb0f}\label{namespacem__ctrper_a2ff20d42be1fe1774dae8bd9f276fb0f}} 
\index{m\_ctrper@{m\_ctrper}!int32\_ctrper@{int32\_ctrper}}
\index{int32\_ctrper@{int32\_ctrper}!m\_ctrper@{m\_ctrper}}
\doxysubsubsection{\texorpdfstring{int32\_ctrper()}{int32\_ctrper()}}
{\footnotesize\ttfamily subroutine m\+\_\+ctrper\+::int32\+\_\+ctrper (\begin{DoxyParamCaption}\item[{integer (kind=int32), dimension (\+:), intent(inout)}]{I\+N\+O\+U\+T\+V\+A\+LS,  }\item[{real, intent(in)}]{C\+L\+O\+S\+E\+N\+E\+SS }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{174 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{175       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (InOut)} :: INOUTVALS}
\DoxyCodeLine{176 \textcolor{keywordtype}{      Real}, \textcolor{keywordtype}{Intent (In)} :: CLOSENESS}
\DoxyCodeLine{177 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{178 \textcolor{comment}{!}}
\DoxyCodeLine{179 \textcolor{keywordtype}{      Real}, \textcolor{keywordtype}{Dimension (Size(INOUTVALS))} :: XINDT}
\DoxyCodeLine{180       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (Size(INOUTVALS))} :: JWRKT}
\DoxyCodeLine{181 \textcolor{keywordtype}{      Real} :: PWRK}
\DoxyCodeLine{182       \textcolor{keywordtype}{Integer} :: I}
\DoxyCodeLine{183 \textcolor{comment}{!}}
\DoxyCodeLine{184       \textcolor{keyword}{Call }random\_number (xindt(:))}
\DoxyCodeLine{185       pwrk = min(max(0.0, closeness), 1.0)}
\DoxyCodeLine{186       xindt = real(\textcolor{keyword}{Size}(inoutvals)) * xindt}
\DoxyCodeLine{187       xindt = pwrk*xindt + (1.0-\/pwrk)*[ (real(i), i=1,\textcolor{keyword}{size}(inoutvals)) ]}
\DoxyCodeLine{188       \textcolor{keyword}{Call }mrgrnk (xindt, jwrkt)}
\DoxyCodeLine{189       inoutvals = inoutvals(jwrkt)}
\DoxyCodeLine{190 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__ctrper_a576addce3587cce9931176623788acc0}\label{namespacem__ctrper_a576addce3587cce9931176623788acc0}} 
\index{m\_ctrper@{m\_ctrper}!real32\_ctrper@{real32\_ctrper}}
\index{real32\_ctrper@{real32\_ctrper}!m\_ctrper@{m\_ctrper}}
\doxysubsubsection{\texorpdfstring{real32\_ctrper()}{real32\_ctrper()}}
{\footnotesize\ttfamily subroutine m\+\_\+ctrper\+::real32\+\_\+ctrper (\begin{DoxyParamCaption}\item[{real (kind=real32), dimension (\+:), intent(inout)}]{I\+N\+O\+U\+T\+V\+A\+LS,  }\item[{real, intent(in)}]{C\+L\+O\+S\+E\+N\+E\+SS }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{155 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{156 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (InOut)} :: inoutvals}
\DoxyCodeLine{157 \textcolor{keywordtype}{      Real}, \textcolor{keywordtype}{Intent (In)} :: CLOSENESS}
\DoxyCodeLine{158 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{159 \textcolor{comment}{!}}
\DoxyCodeLine{160 \textcolor{keywordtype}{      Real}, \textcolor{keywordtype}{Dimension (Size(INOUTVALS))} :: XINDT}
\DoxyCodeLine{161       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (Size(INOUTVALS))} :: JWRKT}
\DoxyCodeLine{162 \textcolor{keywordtype}{      Real} :: PWRK}
\DoxyCodeLine{163       \textcolor{keywordtype}{Integer} :: I}
\DoxyCodeLine{164 \textcolor{comment}{!}}
\DoxyCodeLine{165       \textcolor{keyword}{Call }random\_number (xindt(:))}
\DoxyCodeLine{166       pwrk = min(max(0.0, closeness), 1.0)}
\DoxyCodeLine{167       xindt = real(\textcolor{keyword}{Size}(inoutvals)) * xindt}
\DoxyCodeLine{168       xindt = pwrk*xindt + (1.0-\/pwrk)*[ (real(i), i=1,\textcolor{keyword}{size}(inoutvals)) ]}
\DoxyCodeLine{169       \textcolor{keyword}{Call }mrgrnk (xindt, jwrkt)}
\DoxyCodeLine{170       inoutvals = inoutvals(jwrkt)}
\DoxyCodeLine{171 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__ctrper_a736174988fde2e5624c0b5a611c58f94}\label{namespacem__ctrper_a736174988fde2e5624c0b5a611c58f94}} 
\index{m\_ctrper@{m\_ctrper}!real64\_ctrper@{real64\_ctrper}}
\index{real64\_ctrper@{real64\_ctrper}!m\_ctrper@{m\_ctrper}}
\doxysubsubsection{\texorpdfstring{real64\_ctrper()}{real64\_ctrper()}}
{\footnotesize\ttfamily subroutine m\+\_\+ctrper\+::real64\+\_\+ctrper (\begin{DoxyParamCaption}\item[{real (kind=real64), dimension (\+:), intent(inout)}]{I\+N\+O\+U\+T\+V\+A\+LS,  }\item[{real, intent(in)}]{C\+L\+O\+S\+E\+N\+E\+SS }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\hypertarget{namespacem__ctrper_autotoc_md0}{}\doxysubsubsection{N\+A\+ME}\label{namespacem__ctrper_autotoc_md0}
perturb(3f) -\/ \mbox{[}orderpack\+:P\+E\+R\+M\+U\+T\+A\+T\+I\+ON\mbox{]} generate a random permutation of an array leaving elements close to initial locations\hypertarget{namespacem__ctrper_autotoc_md1}{}\doxysubsubsection{S\+Y\+N\+O\+P\+S\+IS}\label{namespacem__ctrper_autotoc_md1}
\begin{DoxyVerb} Subroutine Perturb (INOUTVALS, CLOSENESS)

  ${TYPE} (kind=${KIND}), Intent (InOut) :: INOUTVALS(:)
  Real, Intent (In)                      :: CLOSENESS

Where ${TYPE}(kind=${KIND}) may be

   o Real(kind=real32)
   o Real(kind=real64)
   o Integer(kind=int32)
   o Character(kind=selected_char_kind("DEFAULT"),len=*)
\end{DoxyVerb}
\hypertarget{namespacem__ctrper_autotoc_md2}{}\doxysubsubsection{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}\label{namespacem__ctrper_autotoc_md2}
Shuffle the array I\+N\+O\+U\+T\+V\+A\+LS randomly, leaving elements close to their initial locations.

Nearbyness is controlled by C\+L\+O\+S\+E\+N\+E\+SS. The relative proportion of initial order and random order is defined as 1-\/C\+L\+O\+S\+E\+N\+E\+SS / C\+L\+O\+S\+E\+N\+E\+SS, thus when C\+L\+O\+S\+E\+N\+E\+SS = 0, there is no change in the order whereas the new order is fully random when C\+L\+O\+S\+E\+N\+E\+SS = 1.

Note this differs from adding random noise to the values. The original values remain unchanged, their order is just perturbed.

Internally, the routine creates a real array of the indices of I\+N\+O\+U\+T\+V\+A\+L\+S() perturbed by random values that are based on the size of C\+L\+O\+S\+E\+N\+E\+SS. The new array is then ranked using M\+R\+G\+R\+N\+K(3f) and the resulting index is used to permute the input array.\hypertarget{namespacem__ctrper_autotoc_md3}{}\doxysubsubsection{O\+P\+T\+I\+O\+NS}\label{namespacem__ctrper_autotoc_md3}
I\+N\+O\+U\+T\+V\+A\+LS Array of values to perturb. C\+L\+O\+S\+E\+N\+E\+SS Proportion of closeness, constrained to the range 0.\+0(no change) to 1.\+0(fully random).\hypertarget{namespacem__ctrper_autotoc_md4}{}\doxysubsubsection{E\+X\+A\+M\+P\+L\+ES}\label{namespacem__ctrper_autotoc_md4}
Sample program\+:

program demo\+\_\+perturb ! generate a random perturbation of an array use M\+\_\+orderpack, only \+: perturb implicit none character(len=$\ast$),parameter \+:: g=\textquotesingle{}($\ast$(g0,1x))\textquotesingle{} character(len=$\ast$),parameter \+:: list= \textquotesingle{}($\ast$(g0\+:,\char`\"{}, \char`\"{}))\textquotesingle{} integer,allocatable \+:: xout(\+:,\+:) integer \+:: isz, i, j isz=200 ! randomly perturb location of values ! ! make an array with three initially identical rows of ! values perturbed by different amounts if(allocated(xout))deallocate(xout) allocate(xout(3,isz)) xout(1,\+:)=\mbox{[}(i,i=isz,1,-\/1)\mbox{]}$\ast$10 xout(2,\+:)=xout(1,\+:) xout(3,\+:)=xout(1,\+:) ! perturb each row a different amount call perturb(xout(1,\+:),0.\+0) call perturb(xout(2,\+:),0.\+1) call perturb(xout(3,\+:),1.\+0) ! show values write($\ast$,\textquotesingle{}(a)\textquotesingle{})\textquotesingle{}count unchanged perturbed random\textquotesingle{} do i=1,size(xout,dim=2) write($\ast$,\textquotesingle{}($\ast$(i8,1x))\textquotesingle{})i,xout(\+:,i) enddo char\+: block character(len=\+:),allocatable \+:: cdont(\+:) cdont=\mbox{[}character(len=20) \+:: \textquotesingle{}a\textquotesingle{}, \textquotesingle{}be\textquotesingle{}, \textquotesingle{}car\textquotesingle{}, \textquotesingle{}dam\textquotesingle{},\textquotesingle{}fan\textquotesingle{},\textquotesingle{}gas\textquotesingle{},\textquotesingle{}egg\textquotesingle{}\mbox{]} isz=size(cdont) write($\ast$,g)\textquotesingle{}Original.................\+:\textquotesingle{},(trim(cdont(i)),i=1,isz) call perturb(cdont,1.\+0) write($\ast$,g)\textquotesingle{}Perturbed ...............\+:\textquotesingle{},(trim(cdont(i)),i=1,isz) write($\ast$,g) endblock char

end program demo\+\_\+perturb

Results\+:

count unchanged perturbed random 1 2000 1980 80 2 1990 1990 580 3 1980 1890 1690 4 1970 1900 1340 5 1960 1920 1260 6 1950 1950 1220 7 1940 1880 160 8 1930 1960 1620 9 1920 1860 540 10 1910 1930 1300 11 1900 1940 1190 . . . . . . . . . . . . . . . . 189 120 80 1200 190 110 150 800 191 100 120 1430 192 90 170 1410 193 80 140 370 194 70 90 1720 195 60 10 830 196 50 100 1670 197 40 20 470 198 30 70 1020 199 20 60 1540 200 10 30 1810 Original.................\+: a be car dam fan gas egg Perturbed ...............\+: a be gas dam fan car egg\hypertarget{namespacem__ctrper_autotoc_md5}{}\doxysubsubsection{A\+U\+T\+H\+OR}\label{namespacem__ctrper_autotoc_md5}
Michel Olagnon, 2000-\/2012 \hypertarget{namespacem__ctrper_autotoc_md6}{}\doxysubsubsection{M\+A\+I\+N\+T\+A\+I\+N\+ER}\label{namespacem__ctrper_autotoc_md6}
John Urban, 2022.\+04.\+16 \hypertarget{namespacem__ctrper_autotoc_md7}{}\doxysubsubsection{L\+I\+C\+E\+N\+SE}\label{namespacem__ctrper_autotoc_md7}
C\+C0-\/1.\+0 
\begin{DoxyCode}{0}
\DoxyCodeLine{136 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{137 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (InOut)} :: inoutvals}
\DoxyCodeLine{138 \textcolor{keywordtype}{      Real}, \textcolor{keywordtype}{Intent (In)} :: CLOSENESS}
\DoxyCodeLine{139 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{140 \textcolor{comment}{!}}
\DoxyCodeLine{141 \textcolor{keywordtype}{      Real}, \textcolor{keywordtype}{Dimension (Size(INOUTVALS))} :: XINDT}
\DoxyCodeLine{142       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (Size(INOUTVALS))} :: JWRKT}
\DoxyCodeLine{143 \textcolor{keywordtype}{      Real} :: PWRK}
\DoxyCodeLine{144       \textcolor{keywordtype}{Integer} :: I}
\DoxyCodeLine{145 \textcolor{comment}{!}}
\DoxyCodeLine{146       \textcolor{keyword}{Call }random\_number (xindt(:))}
\DoxyCodeLine{147       pwrk = min(max(0.0, closeness), 1.0)}
\DoxyCodeLine{148       xindt = real(\textcolor{keyword}{Size}(inoutvals)) * xindt}
\DoxyCodeLine{149       xindt = pwrk*xindt + (1.0-\/pwrk)*[ (real(i), i=1,\textcolor{keyword}{size}(inoutvals)) ]}
\DoxyCodeLine{150       \textcolor{keyword}{Call }mrgrnk (xindt, jwrkt)}
\DoxyCodeLine{151       inoutvals = inoutvals(jwrkt)}
\DoxyCodeLine{152 \textcolor{comment}{!}}

\end{DoxyCode}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacem__ctrper_a2549d1e9c7e73b3c0bcc27afe267ecef}\label{namespacem__ctrper_a2549d1e9c7e73b3c0bcc27afe267ecef}} 
\index{m\_ctrper@{m\_ctrper}!f\_char@{f\_char}}
\index{f\_char@{f\_char}!m\_ctrper@{m\_ctrper}}
\doxysubsubsection{\texorpdfstring{f\_char}{f\_char}}
{\footnotesize\ttfamily integer, parameter m\+\_\+ctrper\+::f\+\_\+char =selected\+\_\+char\+\_\+kind(\char`\"{}D\+E\+F\+A\+U\+LT\char`\"{})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{6 \textcolor{keywordtype}{integer},\textcolor{keywordtype}{parameter} :: f\_char=selected\_char\_kind(\textcolor{stringliteral}{"DEFAULT"})}

\end{DoxyCode}
