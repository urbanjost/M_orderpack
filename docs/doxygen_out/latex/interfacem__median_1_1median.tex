\hypertarget{interfacem__median_1_1median}{}\doxysection{m\+\_\+median\+::median Interface Reference}
\label{interfacem__median_1_1median}\index{m\_median::median@{m\_median::median}}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
real(kind=real64) function \mbox{\hyperlink{interfacem__median_1_1median_ac6db8c53318d03fb6b7d73040c63bbe3}{real64\+\_\+median}} (X\+D\+O\+NT)
\item 
real(kind=real32) function \mbox{\hyperlink{interfacem__median_1_1median_a74fe3a78f8691b7d6d020e2618b3ce28}{real32\+\_\+median}} (X\+D\+O\+NT)
\item 
integer(kind=int32) function \mbox{\hyperlink{interfacem__median_1_1median_a3a0939725772f2c747174176b06e06d8}{int32\+\_\+median}} (X\+D\+O\+NT)
\end{DoxyCompactItemize}


\doxysubsection{Member Function/\+Subroutine Documentation}
\mbox{\Hypertarget{interfacem__median_1_1median_a3a0939725772f2c747174176b06e06d8}\label{interfacem__median_1_1median_a3a0939725772f2c747174176b06e06d8}} 
\index{m\_median::median@{m\_median::median}!int32\_median@{int32\_median}}
\index{int32\_median@{int32\_median}!m\_median::median@{m\_median::median}}
\doxysubsubsection{\texorpdfstring{int32\_median()}{int32\_median()}}
{\footnotesize\ttfamily integer (kind=int32) function m\+\_\+median\+::median\+::int32\+\_\+median (\begin{DoxyParamCaption}\item[{integer (kind=int32), dimension (\+:), intent(in)}]{X\+D\+O\+NT }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{1051       \textcolor{keywordtype}{Integer (Kind=int32)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDONT}
\DoxyCodeLine{1052       \textcolor{keywordtype}{Integer (Kind=int32)} :: median}
\DoxyCodeLine{1053 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1054       \textcolor{keywordtype}{Integer (Kind=int32)}, \textcolor{keywordtype}{Dimension (SIZE(XDONT))} :: XLOWT, XHIGT}
\DoxyCodeLine{1055       \textcolor{keywordtype}{Integer (Kind=int32)} :: XPIV, XPIV0, XWRK, XWRK1, XWRK2, XWRK3, XMIN\textcolor{comment}{, XMAX}}
\DoxyCodeLine{1056 \textcolor{comment}{!!}}
\DoxyCodeLine{1057       \textcolor{keywordtype}{Logical} :: IFODD}
\DoxyCodeLine{1058       \textcolor{keywordtype}{Integer} :: NDON, JHIG, JLOW, IHIG, NORD}
\DoxyCodeLine{1059       \textcolor{keywordtype}{Integer} :: IMIL, IFIN, ICRS, IDCR, ILOW}
\DoxyCodeLine{1060       \textcolor{keywordtype}{Integer} :: JLM2, JLM1, JHM2, JHM1, INTH}
\DoxyCodeLine{1061 \textcolor{comment}{!}}
\DoxyCodeLine{1062       ndon = \textcolor{keyword}{SIZE} (xdont)}
\DoxyCodeLine{1063       inth = ndon/2 + 1}
\DoxyCodeLine{1064       ifodd = (2*inth == ndon + 1)}
\DoxyCodeLine{1065 \textcolor{comment}{!}}
\DoxyCodeLine{1066 \textcolor{comment}{!    First loop is used to fill-\/in XLOWT, XHIGT at the same time}}
\DoxyCodeLine{1067 \textcolor{comment}{!}}
\DoxyCodeLine{1068       \textcolor{keywordflow}{If} (ndon < 3) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1069          \textcolor{keywordflow}{If} (ndon > 0) median = 0.5 * (xdont(1) + xdont(ndon))}
\DoxyCodeLine{1070          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1071 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1072 \textcolor{comment}{!}}
\DoxyCodeLine{1073 \textcolor{comment}{!  One chooses a pivot, best estimate possible to put fractile near}}
\DoxyCodeLine{1074 \textcolor{comment}{!  mid-\/point of the set of low values.}}
\DoxyCodeLine{1075 \textcolor{comment}{!}}
\DoxyCodeLine{1076       \textcolor{keywordflow}{If} (xdont(2) < xdont(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1077          xlowt(1) = xdont(2)}
\DoxyCodeLine{1078          xhigt(1) = xdont(1)}
\DoxyCodeLine{1079       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1080          xlowt(1) = xdont(1)}
\DoxyCodeLine{1081          xhigt(1) = xdont(2)}
\DoxyCodeLine{1082 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1083 \textcolor{comment}{!}}
\DoxyCodeLine{1084 \textcolor{comment}{!}}
\DoxyCodeLine{1085       \textcolor{keywordflow}{If} (xdont(3) < xhigt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1086          xhigt(2) = xhigt(1)}
\DoxyCodeLine{1087          \textcolor{keywordflow}{If} (xdont(3) < xlowt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1088             xhigt(1) = xlowt(1)}
\DoxyCodeLine{1089             xlowt(1) = xdont(3)}
\DoxyCodeLine{1090          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1091             xhigt(1) = xdont(3)}
\DoxyCodeLine{1092 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1093       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1094          xhigt(2) = xdont(3)}
\DoxyCodeLine{1095 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1096 \textcolor{comment}{!}}
\DoxyCodeLine{1097       \textcolor{keywordflow}{If} (ndon < 4) \textcolor{keywordflow}{Then} \textcolor{comment}{! 3 values}}
\DoxyCodeLine{1098          median = xhigt(1)}
\DoxyCodeLine{1099          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1100 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1101 \textcolor{comment}{!}}
\DoxyCodeLine{1102       \textcolor{keywordflow}{If} (xdont(ndon) < xhigt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1103          xhigt(3) = xhigt(2)}
\DoxyCodeLine{1104          xhigt(2) = xhigt(1)}
\DoxyCodeLine{1105          \textcolor{keywordflow}{If} (xdont(ndon) < xlowt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1106             xhigt(1) = xlowt(1)}
\DoxyCodeLine{1107             xlowt(1) = xdont(ndon)}
\DoxyCodeLine{1108          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1109             xhigt(1) = xdont(ndon)}
\DoxyCodeLine{1110 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1111       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1112          \textcolor{keywordflow}{If} (xdont(ndon) < xhigt(2)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1113             xhigt(3) = xhigt(2)}
\DoxyCodeLine{1114             xhigt(2) = xdont(ndon)}
\DoxyCodeLine{1115          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1116             xhigt(3) = xdont(ndon)}
\DoxyCodeLine{1117 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1118 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1119 \textcolor{comment}{!}}
\DoxyCodeLine{1120       \textcolor{keywordflow}{If} (ndon < 5) \textcolor{keywordflow}{Then} \textcolor{comment}{! 4 values}}
\DoxyCodeLine{1121          median = 0.5*(xhigt(1) + xhigt(2))}
\DoxyCodeLine{1122          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1123 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1124 \textcolor{comment}{!}}
\DoxyCodeLine{1125       jlow = 1}
\DoxyCodeLine{1126       jhig = 3}
\DoxyCodeLine{1127       xpiv = xlowt(1) + 2.0 * (xhigt(3)-\/xlowt(1)) / 3.0}
\DoxyCodeLine{1128       \textcolor{keywordflow}{If} (xpiv >= xhigt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1129          xpiv = xlowt(1) + 2.0 * (xhigt(2)-\/xlowt(1)) / 3.0}
\DoxyCodeLine{1130          \textcolor{keywordflow}{If} (xpiv >= xhigt(1)) xpiv = xlowt(1) + 2.0 * (xhigt(1)-\/xlowt(1\textcolor{comment}{)) / 3.0}}
\DoxyCodeLine{1131 \textcolor{comment}{}\textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1132       xpiv0 = xpiv}
\DoxyCodeLine{1133 \textcolor{comment}{!}}
\DoxyCodeLine{1134 \textcolor{comment}{!  One puts values > pivot in the end and those <= pivot}}
\DoxyCodeLine{1135 \textcolor{comment}{!  at the beginning. This is split in 2 cases, so that}}
\DoxyCodeLine{1136 \textcolor{comment}{!  we can skip the loop test a number of times.}}
\DoxyCodeLine{1137 \textcolor{comment}{!  As we are also filling in the work arrays at the same time}}
\DoxyCodeLine{1138 \textcolor{comment}{!  we stop filling in the XHIGT array as soon as we have more}}
\DoxyCodeLine{1139 \textcolor{comment}{!  than enough values in XLOWT.}}
\DoxyCodeLine{1140 \textcolor{comment}{!}}
\DoxyCodeLine{1141 \textcolor{comment}{!}}
\DoxyCodeLine{1142       \textcolor{keywordflow}{If} (xdont(ndon) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1143          icrs = 3}
\DoxyCodeLine{1144          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{1145             icrs = icrs + 1}
\DoxyCodeLine{1146             \textcolor{keywordflow}{If} (xdont(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1147                \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1148                jhig = jhig + 1}
\DoxyCodeLine{1149                xhigt(jhig) = xdont(icrs)}
\DoxyCodeLine{1150             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1151                jlow = jlow + 1}
\DoxyCodeLine{1152                xlowt(jlow) = xdont(icrs)}
\DoxyCodeLine{1153                \textcolor{keywordflow}{If} (jlow >= inth) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1154 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1155 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1156 \textcolor{comment}{!}}
\DoxyCodeLine{1157 \textcolor{comment}{!  One restricts further processing because it is no use}}
\DoxyCodeLine{1158 \textcolor{comment}{!  to store more high values}}
\DoxyCodeLine{1159 \textcolor{comment}{!}}
\DoxyCodeLine{1160          \textcolor{keywordflow}{If} (icrs < ndon-\/1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1161             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{1162                icrs = icrs + 1}
\DoxyCodeLine{1163                \textcolor{keywordflow}{If} (xdont(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1164                   jlow = jlow + 1}
\DoxyCodeLine{1165                   xlowt(jlow) = xdont(icrs)}
\DoxyCodeLine{1166                \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1167                   \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1168 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1169 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1170 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1171 \textcolor{comment}{!}}
\DoxyCodeLine{1172 \textcolor{comment}{!}}
\DoxyCodeLine{1173       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1174 \textcolor{comment}{!}}
\DoxyCodeLine{1175 \textcolor{comment}{!  Same as above, but this is not as easy to optimize, so the}}
\DoxyCodeLine{1176 \textcolor{comment}{!  DO-\/loop is kept}}
\DoxyCodeLine{1177 \textcolor{comment}{!}}
\DoxyCodeLine{1178          \textcolor{keywordflow}{Do} icrs = 4, ndon -\/ 1}
\DoxyCodeLine{1179             \textcolor{keywordflow}{If} (xdont(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1180                jhig = jhig + 1}
\DoxyCodeLine{1181                xhigt(jhig) = xdont(icrs)}
\DoxyCodeLine{1182             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1183                jlow = jlow + 1}
\DoxyCodeLine{1184                xlowt(jlow) = xdont(icrs)}
\DoxyCodeLine{1185                \textcolor{keywordflow}{If} (jlow >= inth) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1186 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1187 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1188 \textcolor{comment}{!}}
\DoxyCodeLine{1189          \textcolor{keywordflow}{If} (icrs < ndon-\/1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1190             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{1191                icrs = icrs + 1}
\DoxyCodeLine{1192                \textcolor{keywordflow}{If} (xdont(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1193                   \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1194                   jlow = jlow + 1}
\DoxyCodeLine{1195                   xlowt(jlow) = xdont(icrs)}
\DoxyCodeLine{1196 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1197 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1198 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1199 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1200 \textcolor{comment}{!}}
\DoxyCodeLine{1201       jlm2 = 0}
\DoxyCodeLine{1202       jlm1 = 0}
\DoxyCodeLine{1203       jhm2 = 0}
\DoxyCodeLine{1204       jhm1 = 0}
\DoxyCodeLine{1205       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{1206          \textcolor{keywordflow}{If} (jlm2 == jlow .And. jhm2 == jhig) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1207 \textcolor{comment}{!}}
\DoxyCodeLine{1208 \textcolor{comment}{!   We are oscillating. Perturbate by bringing JLOW closer by one}}
\DoxyCodeLine{1209 \textcolor{comment}{!   to INTH}}
\DoxyCodeLine{1210 \textcolor{comment}{!}}
\DoxyCodeLine{1211              \textcolor{keywordflow}{If} (inth > jlow) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1212                 xmin = xhigt(1)}
\DoxyCodeLine{1213                 ihig = 1}
\DoxyCodeLine{1214                 \textcolor{keywordflow}{Do} icrs = 2, jhig}
\DoxyCodeLine{1215                    \textcolor{keywordflow}{If} (xhigt(icrs) < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1216                       xmin = xhigt(icrs)}
\DoxyCodeLine{1217                       ihig = icrs}
\DoxyCodeLine{1218 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{1219 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{1220 \textcolor{comment}{!}}
\DoxyCodeLine{1221                 jlow = jlow + 1}
\DoxyCodeLine{1222                 xlowt(jlow) = xhigt(ihig)}
\DoxyCodeLine{1223                 xhigt(ihig) = xhigt(jhig)}
\DoxyCodeLine{1224                 jhig = jhig -\/ 1}
\DoxyCodeLine{1225              \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1226 }
\DoxyCodeLine{1227                 xmax = xlowt(jlow)}
\DoxyCodeLine{1228                 jlow = jlow -\/ 1}
\DoxyCodeLine{1229                 \textcolor{keywordflow}{Do} icrs = 1, jlow}
\DoxyCodeLine{1230                    \textcolor{keywordflow}{If} (xlowt(icrs) > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1231                       xwrk = xmax}
\DoxyCodeLine{1232                       xmax = xlowt(icrs)}
\DoxyCodeLine{1233                       xlowt(icrs) = xwrk}
\DoxyCodeLine{1234 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{1235 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{1236 \textcolor{keywordflow}{             End If}}
\DoxyCodeLine{1237 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1238          jlm2 = jlm1}
\DoxyCodeLine{1239          jlm1 = jlow}
\DoxyCodeLine{1240          jhm2 = jhm1}
\DoxyCodeLine{1241          jhm1 = jhig}
\DoxyCodeLine{1242 \textcolor{comment}{!}}
\DoxyCodeLine{1243 \textcolor{comment}{!   We try to bring the number of values in the low values set}}
\DoxyCodeLine{1244 \textcolor{comment}{!   closer to INTH.}}
\DoxyCodeLine{1245 \textcolor{comment}{!}}
\DoxyCodeLine{1246          \textcolor{keywordflow}{Select Case} (inth-\/jlow)}
\DoxyCodeLine{1247          \textcolor{keywordflow}{Case} (2:)}
\DoxyCodeLine{1248 \textcolor{comment}{!}}
\DoxyCodeLine{1249 \textcolor{comment}{!   Not enough values in low part, at least 2 are missing}}
\DoxyCodeLine{1250 \textcolor{comment}{!}}
\DoxyCodeLine{1251             inth = inth -\/ jlow}
\DoxyCodeLine{1252             jlow = 0}
\DoxyCodeLine{1253             \textcolor{keywordflow}{Select Case} (jhig)}
\DoxyCodeLine{1254 \textcolor{comment}{!!!!!           CASE DEFAULT}}
\DoxyCodeLine{1255 \textcolor{comment}{!!!!!              write (unit=*,fmt=*) "Assertion failed"}}
\DoxyCodeLine{1256 \textcolor{comment}{!!!!!              STOP}}
\DoxyCodeLine{1257 \textcolor{comment}{!}}
\DoxyCodeLine{1258 \textcolor{comment}{!   We make a special case when we have so few values in}}
\DoxyCodeLine{1259 \textcolor{comment}{!   the high values set that it is bad performance to choose a pivot}}
\DoxyCodeLine{1260 \textcolor{comment}{!   and apply the general algorithm.}}
\DoxyCodeLine{1261 \textcolor{comment}{!}}
\DoxyCodeLine{1262             \textcolor{keywordflow}{Case} (2)}
\DoxyCodeLine{1263                \textcolor{keywordflow}{If} (xhigt(1) <= xhigt(2)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1264                   jlow = jlow + 1}
\DoxyCodeLine{1265                   xlowt(jlow) = xhigt(1)}
\DoxyCodeLine{1266                   jlow = jlow + 1}
\DoxyCodeLine{1267                   xlowt(jlow) = xhigt(2)}
\DoxyCodeLine{1268                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1269                   jlow = jlow + 1}
\DoxyCodeLine{1270                   xlowt(jlow) = xhigt(2)}
\DoxyCodeLine{1271                   jlow = jlow + 1}
\DoxyCodeLine{1272                   xlowt(jlow) = xhigt(1)}
\DoxyCodeLine{1273 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1274                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1275 \textcolor{comment}{!}}
\DoxyCodeLine{1276             \textcolor{keywordflow}{Case} (3)}
\DoxyCodeLine{1277 \textcolor{comment}{!}}
\DoxyCodeLine{1278 \textcolor{comment}{!}}
\DoxyCodeLine{1279                xwrk1 = xhigt(1)}
\DoxyCodeLine{1280                xwrk2 = xhigt(2)}
\DoxyCodeLine{1281                xwrk3 = xhigt(3)}
\DoxyCodeLine{1282                \textcolor{keywordflow}{If} (xwrk2 < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1283                   xhigt(1) = xwrk2}
\DoxyCodeLine{1284                   xhigt(2) = xwrk1}
\DoxyCodeLine{1285                   xwrk2 = xwrk1}
\DoxyCodeLine{1286 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1287                \textcolor{keywordflow}{If} (xwrk2 > xwrk3) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1288                   xhigt(3) = xwrk2}
\DoxyCodeLine{1289                   xhigt(2) = xwrk3}
\DoxyCodeLine{1290                   xwrk2 = xwrk3}
\DoxyCodeLine{1291                   \textcolor{keywordflow}{If} (xwrk2 < xhigt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1292                      xhigt(2) = xhigt(1)}
\DoxyCodeLine{1293                      xhigt(1) = xwrk2}
\DoxyCodeLine{1294 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1295 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1296                jhig = 0}
\DoxyCodeLine{1297                \textcolor{keywordflow}{Do} icrs = jlow + 1, inth}
\DoxyCodeLine{1298                   jhig = jhig + 1}
\DoxyCodeLine{1299                   xlowt(icrs) = xhigt(jhig)}
\DoxyCodeLine{1300 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1301                jlow = inth}
\DoxyCodeLine{1302                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1303 \textcolor{comment}{!}}
\DoxyCodeLine{1304             \textcolor{keywordflow}{Case} (4:)}
\DoxyCodeLine{1305 \textcolor{comment}{!}}
\DoxyCodeLine{1306 \textcolor{comment}{!}}
\DoxyCodeLine{1307                xpiv0 = xpiv}
\DoxyCodeLine{1308                ifin = jhig}
\DoxyCodeLine{1309 \textcolor{comment}{!}}
\DoxyCodeLine{1310 \textcolor{comment}{!  One chooses a pivot from the 2 first values and the last one.}}
\DoxyCodeLine{1311 \textcolor{comment}{!  This should ensure sufficient renewal between iterations to}}
\DoxyCodeLine{1312 \textcolor{comment}{!  avoid worst case behavior effects.}}
\DoxyCodeLine{1313 \textcolor{comment}{!}}
\DoxyCodeLine{1314                xwrk1 = xhigt(1)}
\DoxyCodeLine{1315                xwrk2 = xhigt(2)}
\DoxyCodeLine{1316                xwrk3 = xhigt(ifin)}
\DoxyCodeLine{1317                \textcolor{keywordflow}{If} (xwrk2 < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1318                   xhigt(1) = xwrk2}
\DoxyCodeLine{1319                   xhigt(2) = xwrk1}
\DoxyCodeLine{1320                   xwrk2 = xwrk1}
\DoxyCodeLine{1321 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1322                \textcolor{keywordflow}{If} (xwrk2 > xwrk3) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1323                   xhigt(ifin) = xwrk2}
\DoxyCodeLine{1324                   xhigt(2) = xwrk3}
\DoxyCodeLine{1325                   xwrk2 = xwrk3}
\DoxyCodeLine{1326                   \textcolor{keywordflow}{If} (xwrk2 < xhigt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1327                      xhigt(2) = xhigt(1)}
\DoxyCodeLine{1328                      xhigt(1) = xwrk2}
\DoxyCodeLine{1329 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1330 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1331 \textcolor{comment}{!}}
\DoxyCodeLine{1332                xwrk1 = xhigt(1)}
\DoxyCodeLine{1333                jlow = jlow + 1}
\DoxyCodeLine{1334                xlowt(jlow) = xwrk1}
\DoxyCodeLine{1335                xpiv = xwrk1 + 0.5 * (xhigt(ifin)-\/xwrk1)}
\DoxyCodeLine{1336 \textcolor{comment}{!}}
\DoxyCodeLine{1337 \textcolor{comment}{!  One takes values <= pivot to XLOWT}}
\DoxyCodeLine{1338 \textcolor{comment}{!  Again, 2 parts, one where we take care of the remaining}}
\DoxyCodeLine{1339 \textcolor{comment}{!  high values because we might still need them, and the}}
\DoxyCodeLine{1340 \textcolor{comment}{!  other when we know that we will have more than enough}}
\DoxyCodeLine{1341 \textcolor{comment}{!  low values in the end.}}
\DoxyCodeLine{1342 \textcolor{comment}{!}}
\DoxyCodeLine{1343                jhig = 0}
\DoxyCodeLine{1344                \textcolor{keywordflow}{Do} icrs = 2, ifin}
\DoxyCodeLine{1345                   \textcolor{keywordflow}{If} (xhigt(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1346                      jlow = jlow + 1}
\DoxyCodeLine{1347                      xlowt(jlow) = xhigt(icrs)}
\DoxyCodeLine{1348                      \textcolor{keywordflow}{If} (jlow >= inth) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1349                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1350                      jhig = jhig + 1}
\DoxyCodeLine{1351                      xhigt(jhig) = xhigt(icrs)}
\DoxyCodeLine{1352 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1353 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1354 \textcolor{comment}{!}}
\DoxyCodeLine{1355                \textcolor{keywordflow}{Do} icrs = icrs + 1, ifin}
\DoxyCodeLine{1356                   \textcolor{keywordflow}{If} (xhigt(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1357                      jlow = jlow + 1}
\DoxyCodeLine{1358                      xlowt(jlow) = xhigt(icrs)}
\DoxyCodeLine{1359 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1360 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1361 \textcolor{keywordflow}{            End Select}}
\DoxyCodeLine{1362 \textcolor{comment}{!}}
\DoxyCodeLine{1363 \textcolor{comment}{!}}
\DoxyCodeLine{1364          \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{1365 \textcolor{comment}{!}}
\DoxyCodeLine{1366 \textcolor{comment}{!  Only 1 value is missing in low part}}
\DoxyCodeLine{1367 \textcolor{comment}{!}}
\DoxyCodeLine{1368             xmin = xhigt(1)}
\DoxyCodeLine{1369             \textcolor{keywordflow}{Do} icrs = 2, jhig}
\DoxyCodeLine{1370                \textcolor{keywordflow}{If} (xhigt(icrs) < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1371                   xmin = xhigt(icrs)}
\DoxyCodeLine{1372 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1373 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1374 \textcolor{comment}{!}}
\DoxyCodeLine{1375             jlow = jlow + 1}
\DoxyCodeLine{1376             xlowt(jlow) = xmin}
\DoxyCodeLine{1377             \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1378 \textcolor{comment}{!}}
\DoxyCodeLine{1379 \textcolor{comment}{!}}
\DoxyCodeLine{1380          \textcolor{keywordflow}{Case} (0)}
\DoxyCodeLine{1381 \textcolor{comment}{!}}
\DoxyCodeLine{1382 \textcolor{comment}{!  Low part is exactly what we want}}
\DoxyCodeLine{1383 \textcolor{comment}{!}}
\DoxyCodeLine{1384             \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1385 \textcolor{comment}{!}}
\DoxyCodeLine{1386 \textcolor{comment}{!}}
\DoxyCodeLine{1387          \textcolor{keywordflow}{Case} (-\/5:-\/1)}
\DoxyCodeLine{1388 \textcolor{comment}{!}}
\DoxyCodeLine{1389 \textcolor{comment}{!  Only few values too many in low part}}
\DoxyCodeLine{1390 \textcolor{comment}{!}}
\DoxyCodeLine{1391             \textcolor{keywordflow}{IF} (ifodd) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{1392               jhig = jlow -\/ inth + 1}
\DoxyCodeLine{1393             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1394               jhig = jlow -\/ inth + 2}
\DoxyCodeLine{1395 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{1396             xhigt(1) = xlowt(1)}
\DoxyCodeLine{1397             \textcolor{keywordflow}{Do} icrs = 2, jhig}
\DoxyCodeLine{1398                xwrk = xlowt(icrs)}
\DoxyCodeLine{1399                \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1400                   \textcolor{keywordflow}{If} (xwrk < xhigt(idcr)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1401                      xhigt(idcr+1) = xhigt(idcr)}
\DoxyCodeLine{1402                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1403                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1404 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1405 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1406                xhigt(idcr+1) = xwrk}
\DoxyCodeLine{1407 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1408 \textcolor{comment}{!}}
\DoxyCodeLine{1409             \textcolor{keywordflow}{Do} icrs = jhig + 1, jlow}
\DoxyCodeLine{1410                \textcolor{keywordflow}{If} (xlowt(icrs) > xhigt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1411                   xwrk = xlowt(icrs)}
\DoxyCodeLine{1412                   \textcolor{keywordflow}{Do} idcr = 2, jhig}
\DoxyCodeLine{1413                      \textcolor{keywordflow}{If} (xwrk >= xhigt(idcr)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1414                         xhigt(idcr-\/1) = xhigt(idcr)}
\DoxyCodeLine{1415                      \textcolor{keywordflow}{else}}
\DoxyCodeLine{1416                         \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1417 \textcolor{keywordflow}{                     endif}}
\DoxyCodeLine{1418 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{1419                   xhigt(idcr-\/1) = xwrk}
\DoxyCodeLine{1420 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1421 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1422 \textcolor{comment}{!}}
\DoxyCodeLine{1423             \textcolor{keywordflow}{IF} (ifodd) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{1424               median = xhigt(1)}
\DoxyCodeLine{1425             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1426               median = 0.5*(xhigt(1)+xhigt(2))}
\DoxyCodeLine{1427 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{1428             \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1429 \textcolor{comment}{!}}
\DoxyCodeLine{1430 \textcolor{comment}{!}}
\DoxyCodeLine{1431          \textcolor{keywordflow}{Case} (:-\/6)}
\DoxyCodeLine{1432 \textcolor{comment}{!}}
\DoxyCodeLine{1433 \textcolor{comment}{! last case: too many values in low part}}
\DoxyCodeLine{1434 \textcolor{comment}{!}}
\DoxyCodeLine{1435 }
\DoxyCodeLine{1436             imil = (jlow+1) / 2}
\DoxyCodeLine{1437             ifin = jlow}
\DoxyCodeLine{1438 \textcolor{comment}{!}}
\DoxyCodeLine{1439 \textcolor{comment}{!  One chooses a pivot from 1st, last, and middle values}}
\DoxyCodeLine{1440 \textcolor{comment}{!}}
\DoxyCodeLine{1441             \textcolor{keywordflow}{If} (xlowt(imil) < xlowt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1442                xwrk = xlowt(1)}
\DoxyCodeLine{1443                xlowt(1) = xlowt(imil)}
\DoxyCodeLine{1444                xlowt(imil) = xwrk}
\DoxyCodeLine{1445 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1446             \textcolor{keywordflow}{If} (xlowt(imil) > xlowt(ifin)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1447                xwrk = xlowt(ifin)}
\DoxyCodeLine{1448                xlowt(ifin) = xlowt(imil)}
\DoxyCodeLine{1449                xlowt(imil) = xwrk}
\DoxyCodeLine{1450                \textcolor{keywordflow}{If} (xlowt(imil) < xlowt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1451                   xwrk = xlowt(1)}
\DoxyCodeLine{1452                   xlowt(1) = xlowt(imil)}
\DoxyCodeLine{1453                   xlowt(imil) = xwrk}
\DoxyCodeLine{1454 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1455 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1456             \textcolor{keywordflow}{If} (ifin <= 3) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1457 \textcolor{comment}{!}}
\DoxyCodeLine{1458             xpiv = xlowt(1) + real(inth)/real(jlow+inth) * \&}
\DoxyCodeLine{1459                               (xlowt(ifin)-\/xlowt(1))}
\DoxyCodeLine{1460 }
\DoxyCodeLine{1461 \textcolor{comment}{!}}
\DoxyCodeLine{1462 \textcolor{comment}{!  One takes values > XPIV to XHIGT}}
\DoxyCodeLine{1463 \textcolor{comment}{!}}
\DoxyCodeLine{1464             jhig = 0}
\DoxyCodeLine{1465             jlow = 0}
\DoxyCodeLine{1466 \textcolor{comment}{!}}
\DoxyCodeLine{1467             \textcolor{keywordflow}{If} (xlowt(ifin) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1468                icrs = 0}
\DoxyCodeLine{1469                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{1470                   icrs = icrs + 1}
\DoxyCodeLine{1471                   \textcolor{keywordflow}{If} (xlowt(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1472                      jhig = jhig + 1}
\DoxyCodeLine{1473                      xhigt(jhig) = xlowt(icrs)}
\DoxyCodeLine{1474                      \textcolor{keywordflow}{If} (icrs >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1475                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1476                      jlow = jlow + 1}
\DoxyCodeLine{1477                      xlowt(jlow) = xlowt(icrs)}
\DoxyCodeLine{1478                      \textcolor{keywordflow}{If} (jlow >= inth) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1479 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1480 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1481 \textcolor{comment}{!}}
\DoxyCodeLine{1482                \textcolor{keywordflow}{If} (icrs < ifin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1483                   \textcolor{keywordflow}{Do}}
\DoxyCodeLine{1484                      icrs = icrs + 1}
\DoxyCodeLine{1485                      \textcolor{keywordflow}{If} (xlowt(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1486                         jlow = jlow + 1}
\DoxyCodeLine{1487                         xlowt(jlow) = xlowt(icrs)}
\DoxyCodeLine{1488                      \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1489                         \textcolor{keywordflow}{If} (icrs >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1490 \textcolor{keywordflow}{                     End If}}
\DoxyCodeLine{1491 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{1492 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1493             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1494                \textcolor{keywordflow}{Do} icrs = 1, ifin}
\DoxyCodeLine{1495                   \textcolor{keywordflow}{If} (xlowt(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1496                      jhig = jhig + 1}
\DoxyCodeLine{1497                      xhigt(jhig) = xlowt(icrs)}
\DoxyCodeLine{1498                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1499                      jlow = jlow + 1}
\DoxyCodeLine{1500                      xlowt(jlow) = xlowt(icrs)}
\DoxyCodeLine{1501                      \textcolor{keywordflow}{If} (jlow >= inth) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1502 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1503 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1504 \textcolor{comment}{!}}
\DoxyCodeLine{1505                \textcolor{keywordflow}{Do} icrs = icrs + 1, ifin}
\DoxyCodeLine{1506                   \textcolor{keywordflow}{If} (xlowt(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1507                      jlow = jlow + 1}
\DoxyCodeLine{1508                      xlowt(jlow) = xlowt(icrs)}
\DoxyCodeLine{1509 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1510 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1511 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1512 \textcolor{comment}{!}}
\DoxyCodeLine{1513 \textcolor{keywordflow}{         End Select}}
\DoxyCodeLine{1514 \textcolor{comment}{!}}
\DoxyCodeLine{1515 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{1516 \textcolor{comment}{!}}
\DoxyCodeLine{1517 \textcolor{comment}{!  Now, we only need to find maximum of the 1:INTH set}}
\DoxyCodeLine{1518 \textcolor{comment}{!}}
\DoxyCodeLine{1519       \textcolor{keywordflow}{if} (ifodd) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1520         median = maxval(xlowt(1:inth))}
\DoxyCodeLine{1521       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1522         xwrk = max(xlowt(1), xlowt(2))}
\DoxyCodeLine{1523         xwrk1 = min(xlowt(1), xlowt(2))}
\DoxyCodeLine{1524         \textcolor{keywordflow}{DO} icrs = 3, inth}
\DoxyCodeLine{1525           \textcolor{keywordflow}{IF} (xlowt(icrs) > xwrk1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{1526             \textcolor{keywordflow}{IF} (xlowt(icrs) > xwrk) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{1527               xwrk1 = xwrk}
\DoxyCodeLine{1528               xwrk  = xlowt(icrs)}
\DoxyCodeLine{1529             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1530               xwrk1 = xlowt(icrs)}
\DoxyCodeLine{1531 \textcolor{keywordflow}{            ENDIF}}
\DoxyCodeLine{1532 \textcolor{keywordflow}{          ENDIF}}
\DoxyCodeLine{1533 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{1534         median = 0.5*(xwrk+xwrk1)}
\DoxyCodeLine{1535 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{1536       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1537 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{interfacem__median_1_1median_a74fe3a78f8691b7d6d020e2618b3ce28}\label{interfacem__median_1_1median_a74fe3a78f8691b7d6d020e2618b3ce28}} 
\index{m\_median::median@{m\_median::median}!real32\_median@{real32\_median}}
\index{real32\_median@{real32\_median}!m\_median::median@{m\_median::median}}
\doxysubsubsection{\texorpdfstring{real32\_median()}{real32\_median()}}
{\footnotesize\ttfamily real (kind=real32) function m\+\_\+median\+::median\+::real32\+\_\+median (\begin{DoxyParamCaption}\item[{real (kind=real32), dimension (\+:), intent(in)}]{X\+D\+O\+NT }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{562 \textcolor{keywordtype}{      Real} (Kind=real32), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{563 \textcolor{keywordtype}{      Real} (Kind=real32) :: median}
\DoxyCodeLine{564 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{565 \textcolor{keywordtype}{      Real} (Kind=real32), \textcolor{keywordtype}{Dimension (SIZE(XDONT))} :: xlowt, xhigt}
\DoxyCodeLine{566 \textcolor{keywordtype}{      Real} (Kind=real32) :: xpiv, xpiv0, xwrk, xwrk1, xwrk2, xwrk3, xmin\textcolor{comment}{, xmax}}
\DoxyCodeLine{567 \textcolor{comment}{}\textcolor{comment}{!!}}
\DoxyCodeLine{568       \textcolor{keywordtype}{Logical} :: IFODD}
\DoxyCodeLine{569       \textcolor{keywordtype}{Integer} :: NDON, JHIG, JLOW, IHIG, NORD}
\DoxyCodeLine{570       \textcolor{keywordtype}{Integer} :: IMIL, IFIN, ICRS, IDCR, ILOW}
\DoxyCodeLine{571       \textcolor{keywordtype}{Integer} :: JLM2, JLM1, JHM2, JHM1, INTH}
\DoxyCodeLine{572 \textcolor{comment}{!}}
\DoxyCodeLine{573       ndon = \textcolor{keyword}{SIZE} (xdont)}
\DoxyCodeLine{574       inth = ndon/2 + 1}
\DoxyCodeLine{575       ifodd = (2*inth == ndon + 1)}
\DoxyCodeLine{576 \textcolor{comment}{!}}
\DoxyCodeLine{577 \textcolor{comment}{!    First loop is used to fill-\/in XLOWT, XHIGT at the same time}}
\DoxyCodeLine{578 \textcolor{comment}{!}}
\DoxyCodeLine{579       \textcolor{keywordflow}{If} (ndon < 3) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{580          \textcolor{keywordflow}{If} (ndon > 0) median = 0.5 * (xdont(1) + xdont(ndon))}
\DoxyCodeLine{581          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{582 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{583 \textcolor{comment}{!}}
\DoxyCodeLine{584 \textcolor{comment}{!  One chooses a pivot, best estimate possible to put fractile near}}
\DoxyCodeLine{585 \textcolor{comment}{!  mid-\/point of the set of low values.}}
\DoxyCodeLine{586 \textcolor{comment}{!}}
\DoxyCodeLine{587       \textcolor{keywordflow}{If} (xdont(2) < xdont(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{588          xlowt(1) = xdont(2)}
\DoxyCodeLine{589          xhigt(1) = xdont(1)}
\DoxyCodeLine{590       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{591          xlowt(1) = xdont(1)}
\DoxyCodeLine{592          xhigt(1) = xdont(2)}
\DoxyCodeLine{593 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{594 \textcolor{comment}{!}}
\DoxyCodeLine{595 \textcolor{comment}{!}}
\DoxyCodeLine{596       \textcolor{keywordflow}{If} (xdont(3) < xhigt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{597          xhigt(2) = xhigt(1)}
\DoxyCodeLine{598          \textcolor{keywordflow}{If} (xdont(3) < xlowt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{599             xhigt(1) = xlowt(1)}
\DoxyCodeLine{600             xlowt(1) = xdont(3)}
\DoxyCodeLine{601          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{602             xhigt(1) = xdont(3)}
\DoxyCodeLine{603 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{604       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{605          xhigt(2) = xdont(3)}
\DoxyCodeLine{606 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{607 \textcolor{comment}{!}}
\DoxyCodeLine{608       \textcolor{keywordflow}{If} (ndon < 4) \textcolor{keywordflow}{Then} \textcolor{comment}{! 3 values}}
\DoxyCodeLine{609          median = xhigt(1)}
\DoxyCodeLine{610          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{611 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{612 \textcolor{comment}{!}}
\DoxyCodeLine{613       \textcolor{keywordflow}{If} (xdont(ndon) < xhigt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{614          xhigt(3) = xhigt(2)}
\DoxyCodeLine{615          xhigt(2) = xhigt(1)}
\DoxyCodeLine{616          \textcolor{keywordflow}{If} (xdont(ndon) < xlowt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{617             xhigt(1) = xlowt(1)}
\DoxyCodeLine{618             xlowt(1) = xdont(ndon)}
\DoxyCodeLine{619          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{620             xhigt(1) = xdont(ndon)}
\DoxyCodeLine{621 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{622       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{623          \textcolor{keywordflow}{If} (xdont(ndon) < xhigt(2)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{624             xhigt(3) = xhigt(2)}
\DoxyCodeLine{625             xhigt(2) = xdont(ndon)}
\DoxyCodeLine{626          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{627             xhigt(3) = xdont(ndon)}
\DoxyCodeLine{628 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{629 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{630 \textcolor{comment}{!}}
\DoxyCodeLine{631       \textcolor{keywordflow}{If} (ndon < 5) \textcolor{keywordflow}{Then} \textcolor{comment}{! 4 values}}
\DoxyCodeLine{632          median = 0.5*(xhigt(1) + xhigt(2))}
\DoxyCodeLine{633          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{634 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{635 \textcolor{comment}{!}}
\DoxyCodeLine{636       jlow = 1}
\DoxyCodeLine{637       jhig = 3}
\DoxyCodeLine{638       xpiv = xlowt(1) + 2.0 * (xhigt(3)-\/xlowt(1)) / 3.0}
\DoxyCodeLine{639       \textcolor{keywordflow}{If} (xpiv >= xhigt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{640          xpiv = xlowt(1) + 2.0 * (xhigt(2)-\/xlowt(1)) / 3.0}
\DoxyCodeLine{641          \textcolor{keywordflow}{If} (xpiv >= xhigt(1)) xpiv = xlowt(1) + 2.0 * (xhigt(1)-\/xlowt(1\textcolor{comment}{)) / 3.0}}
\DoxyCodeLine{642 \textcolor{comment}{}\textcolor{keywordflow}{      End If}}
\DoxyCodeLine{643       xpiv0 = xpiv}
\DoxyCodeLine{644 \textcolor{comment}{!}}
\DoxyCodeLine{645 \textcolor{comment}{!  One puts values > pivot in the end and those <= pivot}}
\DoxyCodeLine{646 \textcolor{comment}{!  at the beginning. This is split in 2 cases, so that}}
\DoxyCodeLine{647 \textcolor{comment}{!  we can skip the loop test a number of times.}}
\DoxyCodeLine{648 \textcolor{comment}{!  As we are also filling in the work arrays at the same time}}
\DoxyCodeLine{649 \textcolor{comment}{!  we stop filling in the XHIGT array as soon as we have more}}
\DoxyCodeLine{650 \textcolor{comment}{!  than enough values in XLOWT.}}
\DoxyCodeLine{651 \textcolor{comment}{!}}
\DoxyCodeLine{652 \textcolor{comment}{!}}
\DoxyCodeLine{653       \textcolor{keywordflow}{If} (xdont(ndon) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{654          icrs = 3}
\DoxyCodeLine{655          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{656             icrs = icrs + 1}
\DoxyCodeLine{657             \textcolor{keywordflow}{If} (xdont(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{658                \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{659                jhig = jhig + 1}
\DoxyCodeLine{660                xhigt(jhig) = xdont(icrs)}
\DoxyCodeLine{661             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{662                jlow = jlow + 1}
\DoxyCodeLine{663                xlowt(jlow) = xdont(icrs)}
\DoxyCodeLine{664                \textcolor{keywordflow}{If} (jlow >= inth) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{665 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{666 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{667 \textcolor{comment}{!}}
\DoxyCodeLine{668 \textcolor{comment}{!  One restricts further processing because it is no use}}
\DoxyCodeLine{669 \textcolor{comment}{!  to store more high values}}
\DoxyCodeLine{670 \textcolor{comment}{!}}
\DoxyCodeLine{671          \textcolor{keywordflow}{If} (icrs < ndon-\/1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{672             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{673                icrs = icrs + 1}
\DoxyCodeLine{674                \textcolor{keywordflow}{If} (xdont(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{675                   jlow = jlow + 1}
\DoxyCodeLine{676                   xlowt(jlow) = xdont(icrs)}
\DoxyCodeLine{677                \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{678                   \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{679 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{680 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{681 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{682 \textcolor{comment}{!}}
\DoxyCodeLine{683 \textcolor{comment}{!}}
\DoxyCodeLine{684       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{685 \textcolor{comment}{!}}
\DoxyCodeLine{686 \textcolor{comment}{!  Same as above, but this is not as easy to optimize, so the}}
\DoxyCodeLine{687 \textcolor{comment}{!  DO-\/loop is kept}}
\DoxyCodeLine{688 \textcolor{comment}{!}}
\DoxyCodeLine{689          \textcolor{keywordflow}{Do} icrs = 4, ndon -\/ 1}
\DoxyCodeLine{690             \textcolor{keywordflow}{If} (xdont(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{691                jhig = jhig + 1}
\DoxyCodeLine{692                xhigt(jhig) = xdont(icrs)}
\DoxyCodeLine{693             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{694                jlow = jlow + 1}
\DoxyCodeLine{695                xlowt(jlow) = xdont(icrs)}
\DoxyCodeLine{696                \textcolor{keywordflow}{If} (jlow >= inth) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{697 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{698 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{699 \textcolor{comment}{!}}
\DoxyCodeLine{700          \textcolor{keywordflow}{If} (icrs < ndon-\/1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{701             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{702                icrs = icrs + 1}
\DoxyCodeLine{703                \textcolor{keywordflow}{If} (xdont(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{704                   \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{705                   jlow = jlow + 1}
\DoxyCodeLine{706                   xlowt(jlow) = xdont(icrs)}
\DoxyCodeLine{707 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{708 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{709 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{710 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{711 \textcolor{comment}{!}}
\DoxyCodeLine{712       jlm2 = 0}
\DoxyCodeLine{713       jlm1 = 0}
\DoxyCodeLine{714       jhm2 = 0}
\DoxyCodeLine{715       jhm1 = 0}
\DoxyCodeLine{716       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{717          \textcolor{keywordflow}{If} (jlm2 == jlow .And. jhm2 == jhig) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{718 \textcolor{comment}{!}}
\DoxyCodeLine{719 \textcolor{comment}{!   We are oscillating. Perturbate by bringing JLOW closer by one}}
\DoxyCodeLine{720 \textcolor{comment}{!   to INTH}}
\DoxyCodeLine{721 \textcolor{comment}{!}}
\DoxyCodeLine{722              \textcolor{keywordflow}{If} (inth > jlow) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{723                 xmin = xhigt(1)}
\DoxyCodeLine{724                 ihig = 1}
\DoxyCodeLine{725                 \textcolor{keywordflow}{Do} icrs = 2, jhig}
\DoxyCodeLine{726                    \textcolor{keywordflow}{If} (xhigt(icrs) < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{727                       xmin = xhigt(icrs)}
\DoxyCodeLine{728                       ihig = icrs}
\DoxyCodeLine{729 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{730 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{731 \textcolor{comment}{!}}
\DoxyCodeLine{732                 jlow = jlow + 1}
\DoxyCodeLine{733                 xlowt(jlow) = xhigt(ihig)}
\DoxyCodeLine{734                 xhigt(ihig) = xhigt(jhig)}
\DoxyCodeLine{735                 jhig = jhig -\/ 1}
\DoxyCodeLine{736              \textcolor{keywordflow}{Else}}
\DoxyCodeLine{737 }
\DoxyCodeLine{738                 xmax = xlowt(jlow)}
\DoxyCodeLine{739                 jlow = jlow -\/ 1}
\DoxyCodeLine{740                 \textcolor{keywordflow}{Do} icrs = 1, jlow}
\DoxyCodeLine{741                    \textcolor{keywordflow}{If} (xlowt(icrs) > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{742                       xwrk = xmax}
\DoxyCodeLine{743                       xmax = xlowt(icrs)}
\DoxyCodeLine{744                       xlowt(icrs) = xwrk}
\DoxyCodeLine{745 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{746 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{747 \textcolor{keywordflow}{             End If}}
\DoxyCodeLine{748 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{749          jlm2 = jlm1}
\DoxyCodeLine{750          jlm1 = jlow}
\DoxyCodeLine{751          jhm2 = jhm1}
\DoxyCodeLine{752          jhm1 = jhig}
\DoxyCodeLine{753 \textcolor{comment}{!}}
\DoxyCodeLine{754 \textcolor{comment}{!   We try to bring the number of values in the low values set}}
\DoxyCodeLine{755 \textcolor{comment}{!   closer to INTH.}}
\DoxyCodeLine{756 \textcolor{comment}{!}}
\DoxyCodeLine{757          \textcolor{keywordflow}{Select Case} (inth-\/jlow)}
\DoxyCodeLine{758          \textcolor{keywordflow}{Case} (2:)}
\DoxyCodeLine{759 \textcolor{comment}{!}}
\DoxyCodeLine{760 \textcolor{comment}{!   Not enough values in low part, at least 2 are missing}}
\DoxyCodeLine{761 \textcolor{comment}{!}}
\DoxyCodeLine{762             inth = inth -\/ jlow}
\DoxyCodeLine{763             jlow = 0}
\DoxyCodeLine{764             \textcolor{keywordflow}{Select Case} (jhig)}
\DoxyCodeLine{765 \textcolor{comment}{!!!!!           CASE DEFAULT}}
\DoxyCodeLine{766 \textcolor{comment}{!!!!!              write (unit=*,fmt=*) "Assertion failed"}}
\DoxyCodeLine{767 \textcolor{comment}{!!!!!              STOP}}
\DoxyCodeLine{768 \textcolor{comment}{!}}
\DoxyCodeLine{769 \textcolor{comment}{!   We make a special case when we have so few values in}}
\DoxyCodeLine{770 \textcolor{comment}{!   the high values set that it is bad performance to choose a pivot}}
\DoxyCodeLine{771 \textcolor{comment}{!   and apply the general algorithm.}}
\DoxyCodeLine{772 \textcolor{comment}{!}}
\DoxyCodeLine{773             \textcolor{keywordflow}{Case} (2)}
\DoxyCodeLine{774                \textcolor{keywordflow}{If} (xhigt(1) <= xhigt(2)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{775                   jlow = jlow + 1}
\DoxyCodeLine{776                   xlowt(jlow) = xhigt(1)}
\DoxyCodeLine{777                   jlow = jlow + 1}
\DoxyCodeLine{778                   xlowt(jlow) = xhigt(2)}
\DoxyCodeLine{779                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{780                   jlow = jlow + 1}
\DoxyCodeLine{781                   xlowt(jlow) = xhigt(2)}
\DoxyCodeLine{782                   jlow = jlow + 1}
\DoxyCodeLine{783                   xlowt(jlow) = xhigt(1)}
\DoxyCodeLine{784 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{785                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{786 \textcolor{comment}{!}}
\DoxyCodeLine{787             \textcolor{keywordflow}{Case} (3)}
\DoxyCodeLine{788 \textcolor{comment}{!}}
\DoxyCodeLine{789 \textcolor{comment}{!}}
\DoxyCodeLine{790                xwrk1 = xhigt(1)}
\DoxyCodeLine{791                xwrk2 = xhigt(2)}
\DoxyCodeLine{792                xwrk3 = xhigt(3)}
\DoxyCodeLine{793                \textcolor{keywordflow}{If} (xwrk2 < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{794                   xhigt(1) = xwrk2}
\DoxyCodeLine{795                   xhigt(2) = xwrk1}
\DoxyCodeLine{796                   xwrk2 = xwrk1}
\DoxyCodeLine{797 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{798                \textcolor{keywordflow}{If} (xwrk2 > xwrk3) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{799                   xhigt(3) = xwrk2}
\DoxyCodeLine{800                   xhigt(2) = xwrk3}
\DoxyCodeLine{801                   xwrk2 = xwrk3}
\DoxyCodeLine{802                   \textcolor{keywordflow}{If} (xwrk2 < xhigt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{803                      xhigt(2) = xhigt(1)}
\DoxyCodeLine{804                      xhigt(1) = xwrk2}
\DoxyCodeLine{805 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{806 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{807                jhig = 0}
\DoxyCodeLine{808                \textcolor{keywordflow}{Do} icrs = jlow + 1, inth}
\DoxyCodeLine{809                   jhig = jhig + 1}
\DoxyCodeLine{810                   xlowt(icrs) = xhigt(jhig)}
\DoxyCodeLine{811 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{812                jlow = inth}
\DoxyCodeLine{813                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{814 \textcolor{comment}{!}}
\DoxyCodeLine{815             \textcolor{keywordflow}{Case} (4:)}
\DoxyCodeLine{816 \textcolor{comment}{!}}
\DoxyCodeLine{817 \textcolor{comment}{!}}
\DoxyCodeLine{818                xpiv0 = xpiv}
\DoxyCodeLine{819                ifin = jhig}
\DoxyCodeLine{820 \textcolor{comment}{!}}
\DoxyCodeLine{821 \textcolor{comment}{!  One chooses a pivot from the 2 first values and the last one.}}
\DoxyCodeLine{822 \textcolor{comment}{!  This should ensure sufficient renewal between iterations to}}
\DoxyCodeLine{823 \textcolor{comment}{!  avoid worst case behavior effects.}}
\DoxyCodeLine{824 \textcolor{comment}{!}}
\DoxyCodeLine{825                xwrk1 = xhigt(1)}
\DoxyCodeLine{826                xwrk2 = xhigt(2)}
\DoxyCodeLine{827                xwrk3 = xhigt(ifin)}
\DoxyCodeLine{828                \textcolor{keywordflow}{If} (xwrk2 < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{829                   xhigt(1) = xwrk2}
\DoxyCodeLine{830                   xhigt(2) = xwrk1}
\DoxyCodeLine{831                   xwrk2 = xwrk1}
\DoxyCodeLine{832 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{833                \textcolor{keywordflow}{If} (xwrk2 > xwrk3) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{834                   xhigt(ifin) = xwrk2}
\DoxyCodeLine{835                   xhigt(2) = xwrk3}
\DoxyCodeLine{836                   xwrk2 = xwrk3}
\DoxyCodeLine{837                   \textcolor{keywordflow}{If} (xwrk2 < xhigt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{838                      xhigt(2) = xhigt(1)}
\DoxyCodeLine{839                      xhigt(1) = xwrk2}
\DoxyCodeLine{840 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{841 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{842 \textcolor{comment}{!}}
\DoxyCodeLine{843                xwrk1 = xhigt(1)}
\DoxyCodeLine{844                jlow = jlow + 1}
\DoxyCodeLine{845                xlowt(jlow) = xwrk1}
\DoxyCodeLine{846                xpiv = xwrk1 + 0.5 * (xhigt(ifin)-\/xwrk1)}
\DoxyCodeLine{847 \textcolor{comment}{!}}
\DoxyCodeLine{848 \textcolor{comment}{!  One takes values <= pivot to XLOWT}}
\DoxyCodeLine{849 \textcolor{comment}{!  Again, 2 parts, one where we take care of the remaining}}
\DoxyCodeLine{850 \textcolor{comment}{!  high values because we might still need them, and the}}
\DoxyCodeLine{851 \textcolor{comment}{!  other when we know that we will have more than enough}}
\DoxyCodeLine{852 \textcolor{comment}{!  low values in the end.}}
\DoxyCodeLine{853 \textcolor{comment}{!}}
\DoxyCodeLine{854                jhig = 0}
\DoxyCodeLine{855                \textcolor{keywordflow}{Do} icrs = 2, ifin}
\DoxyCodeLine{856                   \textcolor{keywordflow}{If} (xhigt(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{857                      jlow = jlow + 1}
\DoxyCodeLine{858                      xlowt(jlow) = xhigt(icrs)}
\DoxyCodeLine{859                      \textcolor{keywordflow}{If} (jlow >= inth) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{860                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{861                      jhig = jhig + 1}
\DoxyCodeLine{862                      xhigt(jhig) = xhigt(icrs)}
\DoxyCodeLine{863 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{864 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{865 \textcolor{comment}{!}}
\DoxyCodeLine{866                \textcolor{keywordflow}{Do} icrs = icrs + 1, ifin}
\DoxyCodeLine{867                   \textcolor{keywordflow}{If} (xhigt(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{868                      jlow = jlow + 1}
\DoxyCodeLine{869                      xlowt(jlow) = xhigt(icrs)}
\DoxyCodeLine{870 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{871 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{872 \textcolor{keywordflow}{            End Select}}
\DoxyCodeLine{873 \textcolor{comment}{!}}
\DoxyCodeLine{874 \textcolor{comment}{!}}
\DoxyCodeLine{875          \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{876 \textcolor{comment}{!}}
\DoxyCodeLine{877 \textcolor{comment}{!  Only 1 value is missing in low part}}
\DoxyCodeLine{878 \textcolor{comment}{!}}
\DoxyCodeLine{879             xmin = xhigt(1)}
\DoxyCodeLine{880             \textcolor{keywordflow}{Do} icrs = 2, jhig}
\DoxyCodeLine{881                \textcolor{keywordflow}{If} (xhigt(icrs) < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{882                   xmin = xhigt(icrs)}
\DoxyCodeLine{883 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{884 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{885 \textcolor{comment}{!}}
\DoxyCodeLine{886             jlow = jlow + 1}
\DoxyCodeLine{887             xlowt(jlow) = xmin}
\DoxyCodeLine{888             \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{889 \textcolor{comment}{!}}
\DoxyCodeLine{890 \textcolor{comment}{!}}
\DoxyCodeLine{891          \textcolor{keywordflow}{Case} (0)}
\DoxyCodeLine{892 \textcolor{comment}{!}}
\DoxyCodeLine{893 \textcolor{comment}{!  Low part is exactly what we want}}
\DoxyCodeLine{894 \textcolor{comment}{!}}
\DoxyCodeLine{895             \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{896 \textcolor{comment}{!}}
\DoxyCodeLine{897 \textcolor{comment}{!}}
\DoxyCodeLine{898          \textcolor{keywordflow}{Case} (-\/5:-\/1)}
\DoxyCodeLine{899 \textcolor{comment}{!}}
\DoxyCodeLine{900 \textcolor{comment}{!  Only few values too many in low part}}
\DoxyCodeLine{901 \textcolor{comment}{!}}
\DoxyCodeLine{902             \textcolor{keywordflow}{IF} (ifodd) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{903               jhig = jlow -\/ inth + 1}
\DoxyCodeLine{904             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{905               jhig = jlow -\/ inth + 2}
\DoxyCodeLine{906 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{907             xhigt(1) = xlowt(1)}
\DoxyCodeLine{908             \textcolor{keywordflow}{Do} icrs = 2, jhig}
\DoxyCodeLine{909                xwrk = xlowt(icrs)}
\DoxyCodeLine{910                \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{911                   \textcolor{keywordflow}{If} (xwrk < xhigt(idcr)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{912                      xhigt(idcr+1) = xhigt(idcr)}
\DoxyCodeLine{913                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{914                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{915 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{916 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{917                xhigt(idcr+1) = xwrk}
\DoxyCodeLine{918 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{919 \textcolor{comment}{!}}
\DoxyCodeLine{920             \textcolor{keywordflow}{Do} icrs = jhig + 1, jlow}
\DoxyCodeLine{921                \textcolor{keywordflow}{If} (xlowt(icrs) > xhigt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{922                   xwrk = xlowt(icrs)}
\DoxyCodeLine{923                   \textcolor{keywordflow}{Do} idcr = 2, jhig}
\DoxyCodeLine{924                      \textcolor{keywordflow}{If} (xwrk >= xhigt(idcr)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{925                         xhigt(idcr-\/1) = xhigt(idcr)}
\DoxyCodeLine{926                      \textcolor{keywordflow}{else}}
\DoxyCodeLine{927                         \textcolor{keywordflow}{exit}}
\DoxyCodeLine{928 \textcolor{keywordflow}{                     endif}}
\DoxyCodeLine{929 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{930                   xhigt(idcr-\/1) = xwrk}
\DoxyCodeLine{931 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{932 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{933 \textcolor{comment}{!}}
\DoxyCodeLine{934             \textcolor{keywordflow}{IF} (ifodd) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{935               median = xhigt(1)}
\DoxyCodeLine{936             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{937               median = 0.5*(xhigt(1)+xhigt(2))}
\DoxyCodeLine{938 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{939             \textcolor{keywordflow}{Return}}
\DoxyCodeLine{940 \textcolor{comment}{!}}
\DoxyCodeLine{941 \textcolor{comment}{!}}
\DoxyCodeLine{942          \textcolor{keywordflow}{Case} (:-\/6)}
\DoxyCodeLine{943 \textcolor{comment}{!}}
\DoxyCodeLine{944 \textcolor{comment}{! last case: too many values in low part}}
\DoxyCodeLine{945 \textcolor{comment}{!}}
\DoxyCodeLine{946 }
\DoxyCodeLine{947             imil = (jlow+1) / 2}
\DoxyCodeLine{948             ifin = jlow}
\DoxyCodeLine{949 \textcolor{comment}{!}}
\DoxyCodeLine{950 \textcolor{comment}{!  One chooses a pivot from 1st, last, and middle values}}
\DoxyCodeLine{951 \textcolor{comment}{!}}
\DoxyCodeLine{952             \textcolor{keywordflow}{If} (xlowt(imil) < xlowt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{953                xwrk = xlowt(1)}
\DoxyCodeLine{954                xlowt(1) = xlowt(imil)}
\DoxyCodeLine{955                xlowt(imil) = xwrk}
\DoxyCodeLine{956 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{957             \textcolor{keywordflow}{If} (xlowt(imil) > xlowt(ifin)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{958                xwrk = xlowt(ifin)}
\DoxyCodeLine{959                xlowt(ifin) = xlowt(imil)}
\DoxyCodeLine{960                xlowt(imil) = xwrk}
\DoxyCodeLine{961                \textcolor{keywordflow}{If} (xlowt(imil) < xlowt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{962                   xwrk = xlowt(1)}
\DoxyCodeLine{963                   xlowt(1) = xlowt(imil)}
\DoxyCodeLine{964                   xlowt(imil) = xwrk}
\DoxyCodeLine{965 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{966 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{967             \textcolor{keywordflow}{If} (ifin <= 3) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{968 \textcolor{comment}{!}}
\DoxyCodeLine{969             xpiv = xlowt(1) + real(inth)/real(jlow+inth) * \&}
\DoxyCodeLine{970                               (xlowt(ifin)-\/xlowt(1))}
\DoxyCodeLine{971 }
\DoxyCodeLine{972 \textcolor{comment}{!}}
\DoxyCodeLine{973 \textcolor{comment}{!  One takes values > XPIV to XHIGT}}
\DoxyCodeLine{974 \textcolor{comment}{!}}
\DoxyCodeLine{975             jhig = 0}
\DoxyCodeLine{976             jlow = 0}
\DoxyCodeLine{977 \textcolor{comment}{!}}
\DoxyCodeLine{978             \textcolor{keywordflow}{If} (xlowt(ifin) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{979                icrs = 0}
\DoxyCodeLine{980                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{981                   icrs = icrs + 1}
\DoxyCodeLine{982                   \textcolor{keywordflow}{If} (xlowt(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{983                      jhig = jhig + 1}
\DoxyCodeLine{984                      xhigt(jhig) = xlowt(icrs)}
\DoxyCodeLine{985                      \textcolor{keywordflow}{If} (icrs >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{986                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{987                      jlow = jlow + 1}
\DoxyCodeLine{988                      xlowt(jlow) = xlowt(icrs)}
\DoxyCodeLine{989                      \textcolor{keywordflow}{If} (jlow >= inth) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{990 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{991 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{992 \textcolor{comment}{!}}
\DoxyCodeLine{993                \textcolor{keywordflow}{If} (icrs < ifin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{994                   \textcolor{keywordflow}{Do}}
\DoxyCodeLine{995                      icrs = icrs + 1}
\DoxyCodeLine{996                      \textcolor{keywordflow}{If} (xlowt(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{997                         jlow = jlow + 1}
\DoxyCodeLine{998                         xlowt(jlow) = xlowt(icrs)}
\DoxyCodeLine{999                      \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1000                         \textcolor{keywordflow}{If} (icrs >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1001 \textcolor{keywordflow}{                     End If}}
\DoxyCodeLine{1002 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{1003 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1004             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1005                \textcolor{keywordflow}{Do} icrs = 1, ifin}
\DoxyCodeLine{1006                   \textcolor{keywordflow}{If} (xlowt(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1007                      jhig = jhig + 1}
\DoxyCodeLine{1008                      xhigt(jhig) = xlowt(icrs)}
\DoxyCodeLine{1009                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1010                      jlow = jlow + 1}
\DoxyCodeLine{1011                      xlowt(jlow) = xlowt(icrs)}
\DoxyCodeLine{1012                      \textcolor{keywordflow}{If} (jlow >= inth) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1013 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1014 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1015 \textcolor{comment}{!}}
\DoxyCodeLine{1016                \textcolor{keywordflow}{Do} icrs = icrs + 1, ifin}
\DoxyCodeLine{1017                   \textcolor{keywordflow}{If} (xlowt(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1018                      jlow = jlow + 1}
\DoxyCodeLine{1019                      xlowt(jlow) = xlowt(icrs)}
\DoxyCodeLine{1020 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1021 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1022 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1023 \textcolor{comment}{!}}
\DoxyCodeLine{1024 \textcolor{keywordflow}{         End Select}}
\DoxyCodeLine{1025 \textcolor{comment}{!}}
\DoxyCodeLine{1026 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{1027 \textcolor{comment}{!}}
\DoxyCodeLine{1028 \textcolor{comment}{!  Now, we only need to find maximum of the 1:INTH set}}
\DoxyCodeLine{1029 \textcolor{comment}{!}}
\DoxyCodeLine{1030       \textcolor{keywordflow}{if} (ifodd) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1031         median = maxval(xlowt(1:inth))}
\DoxyCodeLine{1032       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1033         xwrk = max(xlowt(1), xlowt(2))}
\DoxyCodeLine{1034         xwrk1 = min(xlowt(1), xlowt(2))}
\DoxyCodeLine{1035         \textcolor{keywordflow}{DO} icrs = 3, inth}
\DoxyCodeLine{1036           \textcolor{keywordflow}{IF} (xlowt(icrs) > xwrk1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{1037             \textcolor{keywordflow}{IF} (xlowt(icrs) > xwrk) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{1038               xwrk1 = xwrk}
\DoxyCodeLine{1039               xwrk  = xlowt(icrs)}
\DoxyCodeLine{1040             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1041               xwrk1 = xlowt(icrs)}
\DoxyCodeLine{1042 \textcolor{keywordflow}{            ENDIF}}
\DoxyCodeLine{1043 \textcolor{keywordflow}{          ENDIF}}
\DoxyCodeLine{1044 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{1045         median = 0.5*(xwrk+xwrk1)}
\DoxyCodeLine{1046 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{1047       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1048 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{interfacem__median_1_1median_ac6db8c53318d03fb6b7d73040c63bbe3}\label{interfacem__median_1_1median_ac6db8c53318d03fb6b7d73040c63bbe3}} 
\index{m\_median::median@{m\_median::median}!real64\_median@{real64\_median}}
\index{real64\_median@{real64\_median}!m\_median::median@{m\_median::median}}
\doxysubsubsection{\texorpdfstring{real64\_median()}{real64\_median()}}
{\footnotesize\ttfamily real (kind=real64) function m\+\_\+median\+::median\+::real64\+\_\+median (\begin{DoxyParamCaption}\item[{real (kind=real64), dimension (\+:), intent(in)}]{X\+D\+O\+NT }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\hypertarget{namespacem__median_autotoc_md45}{}\doxysubsubsection{N\+A\+ME}\label{namespacem__median_autotoc_md45}
median(3f) -\/ \mbox{[}orderpack\+:M\+E\+D\+I\+AN\mbox{]} Return median value of array. If even number of data, average of the two \char`\"{}medians\char`\"{}. (L\+I\+C\+E\+N\+SE\+:C\+C0-\/1.\+0)\hypertarget{namespacem__median_autotoc_md46}{}\doxysubsubsection{S\+Y\+N\+O\+P\+S\+IS}\label{namespacem__median_autotoc_md46}
\begin{DoxyVerb} Function ${KIND}_median (XDONT) Result (median)

  ${TYPE} (Kind=${KIND}), Dimension (:), Intent (In) :: XDONT
  ${TYPE} (Kind=${KIND}) :: median

Where ${TYPE}(kind=${KIND}) may be

   o Real(kind=real32)
   o Real(kind=real64)
   o Integer(kind=int32)
\end{DoxyVerb}
\hypertarget{namespacem__median_autotoc_md47}{}\doxysubsubsection{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}\label{namespacem__median_autotoc_md47}
Return median value of X\+D\+O\+NT. If even number of data, average of the two \char`\"{}medians\char`\"{}.

This routine uses a pivoting strategy such as the one of finding the median based on the quicksort algorithm, but we skew the pivot choice to try to bring it to N\+O\+RD as fast as possible. It uses 2 temporary arrays, where it stores the indices of the values smaller than the pivot (I\+L\+O\+WT), and the indices of values larger than the pivot that we might still need later on (I\+H\+I\+GT). It iterates until it can bring the number of values in I\+L\+O\+WT to exactly N\+O\+RD, and then finds the maximum of this set.\hypertarget{namespacem__median_autotoc_md48}{}\doxysubsubsection{O\+P\+T\+I\+O\+NS}\label{namespacem__median_autotoc_md48}
X\+D\+O\+NT array to determine the median value of.\hypertarget{namespacem__median_autotoc_md49}{}\doxysubsubsection{R\+E\+T\+U\+R\+NS}\label{namespacem__median_autotoc_md49}
M\+E\+D\+I\+AN median value. If X\+D\+O\+NT contains an even number of elements the value is the average of the two \char`\"{}medians\char`\"{}.\hypertarget{namespacem__median_autotoc_md50}{}\doxysubsubsection{E\+X\+A\+M\+P\+L\+ES}\label{namespacem__median_autotoc_md50}
Sample program\+:

program demo\+\_\+median use M\+\_\+median, only \+: median implicit none !x!call median(yyyyyy) end program demo\+\_\+median

Results\+:\hypertarget{namespacem__median_autotoc_md51}{}\doxysubsubsection{A\+U\+T\+H\+OR}\label{namespacem__median_autotoc_md51}
Michel Olagnon -\/ Aug. 2000

John Urban, 2022.\+04.\+16 o added man-\/page and reduced to a template using the prep(1) preprocessor.\hypertarget{namespacem__median_autotoc_md52}{}\doxysubsubsection{L\+I\+C\+E\+N\+SE}\label{namespacem__median_autotoc_md52}
C\+C0-\/1.\+0 
\begin{DoxyCode}{0}
\DoxyCodeLine{73 \textcolor{keywordtype}{      Real} (Kind=real64), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{74 \textcolor{keywordtype}{      Real} (Kind=real64) :: median}
\DoxyCodeLine{75 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{76 \textcolor{keywordtype}{      Real} (Kind=real64), \textcolor{keywordtype}{Dimension (SIZE(XDONT))} :: xlowt, xhigt}
\DoxyCodeLine{77 \textcolor{keywordtype}{      Real} (Kind=real64) :: xpiv, xpiv0, xwrk, xwrk1, xwrk2, xwrk3, xmin\textcolor{comment}{, xmax}}
\DoxyCodeLine{78 \textcolor{comment}{}\textcolor{comment}{!!}}
\DoxyCodeLine{79       \textcolor{keywordtype}{Logical} :: IFODD}
\DoxyCodeLine{80       \textcolor{keywordtype}{Integer} :: NDON, JHIG, JLOW, IHIG, NORD}
\DoxyCodeLine{81       \textcolor{keywordtype}{Integer} :: IMIL, IFIN, ICRS, IDCR, ILOW}
\DoxyCodeLine{82       \textcolor{keywordtype}{Integer} :: JLM2, JLM1, JHM2, JHM1, INTH}
\DoxyCodeLine{83 \textcolor{comment}{!}}
\DoxyCodeLine{84       ndon = \textcolor{keyword}{SIZE} (xdont)}
\DoxyCodeLine{85       inth = ndon/2 + 1}
\DoxyCodeLine{86       ifodd = (2*inth == ndon + 1)}
\DoxyCodeLine{87 \textcolor{comment}{!}}
\DoxyCodeLine{88 \textcolor{comment}{!    First loop is used to fill-\/in XLOWT, XHIGT at the same time}}
\DoxyCodeLine{89 \textcolor{comment}{!}}
\DoxyCodeLine{90       \textcolor{keywordflow}{If} (ndon < 3) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{91          \textcolor{keywordflow}{If} (ndon > 0) median = 0.5 * (xdont(1) + xdont(ndon))}
\DoxyCodeLine{92          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{93 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{94 \textcolor{comment}{!}}
\DoxyCodeLine{95 \textcolor{comment}{!  One chooses a pivot, best estimate possible to put fractile near}}
\DoxyCodeLine{96 \textcolor{comment}{!  mid-\/point of the set of low values.}}
\DoxyCodeLine{97 \textcolor{comment}{!}}
\DoxyCodeLine{98       \textcolor{keywordflow}{If} (xdont(2) < xdont(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{99          xlowt(1) = xdont(2)}
\DoxyCodeLine{100          xhigt(1) = xdont(1)}
\DoxyCodeLine{101       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{102          xlowt(1) = xdont(1)}
\DoxyCodeLine{103          xhigt(1) = xdont(2)}
\DoxyCodeLine{104 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{105 \textcolor{comment}{!}}
\DoxyCodeLine{106 \textcolor{comment}{!}}
\DoxyCodeLine{107       \textcolor{keywordflow}{If} (xdont(3) < xhigt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{108          xhigt(2) = xhigt(1)}
\DoxyCodeLine{109          \textcolor{keywordflow}{If} (xdont(3) < xlowt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{110             xhigt(1) = xlowt(1)}
\DoxyCodeLine{111             xlowt(1) = xdont(3)}
\DoxyCodeLine{112          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{113             xhigt(1) = xdont(3)}
\DoxyCodeLine{114 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{115       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{116          xhigt(2) = xdont(3)}
\DoxyCodeLine{117 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{118 \textcolor{comment}{!}}
\DoxyCodeLine{119       \textcolor{keywordflow}{If} (ndon < 4) \textcolor{keywordflow}{Then} \textcolor{comment}{! 3 values}}
\DoxyCodeLine{120          median = xhigt(1)}
\DoxyCodeLine{121          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{122 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{123 \textcolor{comment}{!}}
\DoxyCodeLine{124       \textcolor{keywordflow}{If} (xdont(ndon) < xhigt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{125          xhigt(3) = xhigt(2)}
\DoxyCodeLine{126          xhigt(2) = xhigt(1)}
\DoxyCodeLine{127          \textcolor{keywordflow}{If} (xdont(ndon) < xlowt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{128             xhigt(1) = xlowt(1)}
\DoxyCodeLine{129             xlowt(1) = xdont(ndon)}
\DoxyCodeLine{130          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{131             xhigt(1) = xdont(ndon)}
\DoxyCodeLine{132 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{133       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{134          \textcolor{keywordflow}{If} (xdont(ndon) < xhigt(2)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{135             xhigt(3) = xhigt(2)}
\DoxyCodeLine{136             xhigt(2) = xdont(ndon)}
\DoxyCodeLine{137          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{138             xhigt(3) = xdont(ndon)}
\DoxyCodeLine{139 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{140 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{141 \textcolor{comment}{!}}
\DoxyCodeLine{142       \textcolor{keywordflow}{If} (ndon < 5) \textcolor{keywordflow}{Then} \textcolor{comment}{! 4 values}}
\DoxyCodeLine{143          median = 0.5*(xhigt(1) + xhigt(2))}
\DoxyCodeLine{144          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{145 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{146 \textcolor{comment}{!}}
\DoxyCodeLine{147       jlow = 1}
\DoxyCodeLine{148       jhig = 3}
\DoxyCodeLine{149       xpiv = xlowt(1) + 2.0 * (xhigt(3)-\/xlowt(1)) / 3.0}
\DoxyCodeLine{150       \textcolor{keywordflow}{If} (xpiv >= xhigt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{151          xpiv = xlowt(1) + 2.0 * (xhigt(2)-\/xlowt(1)) / 3.0}
\DoxyCodeLine{152          \textcolor{keywordflow}{If} (xpiv >= xhigt(1)) xpiv = xlowt(1) + 2.0 * (xhigt(1)-\/xlowt(1\textcolor{comment}{)) / 3.0}}
\DoxyCodeLine{153 \textcolor{comment}{}\textcolor{keywordflow}{      End If}}
\DoxyCodeLine{154       xpiv0 = xpiv}
\DoxyCodeLine{155 \textcolor{comment}{!}}
\DoxyCodeLine{156 \textcolor{comment}{!  One puts values > pivot in the end and those <= pivot}}
\DoxyCodeLine{157 \textcolor{comment}{!  at the beginning. This is split in 2 cases, so that}}
\DoxyCodeLine{158 \textcolor{comment}{!  we can skip the loop test a number of times.}}
\DoxyCodeLine{159 \textcolor{comment}{!  As we are also filling in the work arrays at the same time}}
\DoxyCodeLine{160 \textcolor{comment}{!  we stop filling in the XHIGT array as soon as we have more}}
\DoxyCodeLine{161 \textcolor{comment}{!  than enough values in XLOWT.}}
\DoxyCodeLine{162 \textcolor{comment}{!}}
\DoxyCodeLine{163 \textcolor{comment}{!}}
\DoxyCodeLine{164       \textcolor{keywordflow}{If} (xdont(ndon) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{165          icrs = 3}
\DoxyCodeLine{166          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{167             icrs = icrs + 1}
\DoxyCodeLine{168             \textcolor{keywordflow}{If} (xdont(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{169                \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{170                jhig = jhig + 1}
\DoxyCodeLine{171                xhigt(jhig) = xdont(icrs)}
\DoxyCodeLine{172             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{173                jlow = jlow + 1}
\DoxyCodeLine{174                xlowt(jlow) = xdont(icrs)}
\DoxyCodeLine{175                \textcolor{keywordflow}{If} (jlow >= inth) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{176 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{177 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{178 \textcolor{comment}{!}}
\DoxyCodeLine{179 \textcolor{comment}{!  One restricts further processing because it is no use}}
\DoxyCodeLine{180 \textcolor{comment}{!  to store more high values}}
\DoxyCodeLine{181 \textcolor{comment}{!}}
\DoxyCodeLine{182          \textcolor{keywordflow}{If} (icrs < ndon-\/1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{183             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{184                icrs = icrs + 1}
\DoxyCodeLine{185                \textcolor{keywordflow}{If} (xdont(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{186                   jlow = jlow + 1}
\DoxyCodeLine{187                   xlowt(jlow) = xdont(icrs)}
\DoxyCodeLine{188                \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{189                   \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{190 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{191 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{192 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{193 \textcolor{comment}{!}}
\DoxyCodeLine{194 \textcolor{comment}{!}}
\DoxyCodeLine{195       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{196 \textcolor{comment}{!}}
\DoxyCodeLine{197 \textcolor{comment}{!  Same as above, but this is not as easy to optimize, so the}}
\DoxyCodeLine{198 \textcolor{comment}{!  DO-\/loop is kept}}
\DoxyCodeLine{199 \textcolor{comment}{!}}
\DoxyCodeLine{200          \textcolor{keywordflow}{Do} icrs = 4, ndon -\/ 1}
\DoxyCodeLine{201             \textcolor{keywordflow}{If} (xdont(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{202                jhig = jhig + 1}
\DoxyCodeLine{203                xhigt(jhig) = xdont(icrs)}
\DoxyCodeLine{204             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{205                jlow = jlow + 1}
\DoxyCodeLine{206                xlowt(jlow) = xdont(icrs)}
\DoxyCodeLine{207                \textcolor{keywordflow}{If} (jlow >= inth) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{208 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{209 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{210 \textcolor{comment}{!}}
\DoxyCodeLine{211          \textcolor{keywordflow}{If} (icrs < ndon-\/1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{212             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{213                icrs = icrs + 1}
\DoxyCodeLine{214                \textcolor{keywordflow}{If} (xdont(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{215                   \textcolor{keywordflow}{If} (icrs >= ndon) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{216                   jlow = jlow + 1}
\DoxyCodeLine{217                   xlowt(jlow) = xdont(icrs)}
\DoxyCodeLine{218 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{219 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{220 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{221 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{222 \textcolor{comment}{!}}
\DoxyCodeLine{223       jlm2 = 0}
\DoxyCodeLine{224       jlm1 = 0}
\DoxyCodeLine{225       jhm2 = 0}
\DoxyCodeLine{226       jhm1 = 0}
\DoxyCodeLine{227       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{228          \textcolor{keywordflow}{If} (jlm2 == jlow .And. jhm2 == jhig) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{229 \textcolor{comment}{!}}
\DoxyCodeLine{230 \textcolor{comment}{!   We are oscillating. Perturbate by bringing JLOW closer by one}}
\DoxyCodeLine{231 \textcolor{comment}{!   to INTH}}
\DoxyCodeLine{232 \textcolor{comment}{!}}
\DoxyCodeLine{233              \textcolor{keywordflow}{If} (inth > jlow) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{234                 xmin = xhigt(1)}
\DoxyCodeLine{235                 ihig = 1}
\DoxyCodeLine{236                 \textcolor{keywordflow}{Do} icrs = 2, jhig}
\DoxyCodeLine{237                    \textcolor{keywordflow}{If} (xhigt(icrs) < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{238                       xmin = xhigt(icrs)}
\DoxyCodeLine{239                       ihig = icrs}
\DoxyCodeLine{240 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{241 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{242 \textcolor{comment}{!}}
\DoxyCodeLine{243                 jlow = jlow + 1}
\DoxyCodeLine{244                 xlowt(jlow) = xhigt(ihig)}
\DoxyCodeLine{245                 xhigt(ihig) = xhigt(jhig)}
\DoxyCodeLine{246                 jhig = jhig -\/ 1}
\DoxyCodeLine{247              \textcolor{keywordflow}{Else}}
\DoxyCodeLine{248 }
\DoxyCodeLine{249                 xmax = xlowt(jlow)}
\DoxyCodeLine{250                 jlow = jlow -\/ 1}
\DoxyCodeLine{251                 \textcolor{keywordflow}{Do} icrs = 1, jlow}
\DoxyCodeLine{252                    \textcolor{keywordflow}{If} (xlowt(icrs) > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{253                       xwrk = xmax}
\DoxyCodeLine{254                       xmax = xlowt(icrs)}
\DoxyCodeLine{255                       xlowt(icrs) = xwrk}
\DoxyCodeLine{256 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{257 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{258 \textcolor{keywordflow}{             End If}}
\DoxyCodeLine{259 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{260          jlm2 = jlm1}
\DoxyCodeLine{261          jlm1 = jlow}
\DoxyCodeLine{262          jhm2 = jhm1}
\DoxyCodeLine{263          jhm1 = jhig}
\DoxyCodeLine{264 \textcolor{comment}{!}}
\DoxyCodeLine{265 \textcolor{comment}{!   We try to bring the number of values in the low values set}}
\DoxyCodeLine{266 \textcolor{comment}{!   closer to INTH.}}
\DoxyCodeLine{267 \textcolor{comment}{!}}
\DoxyCodeLine{268          \textcolor{keywordflow}{Select Case} (inth-\/jlow)}
\DoxyCodeLine{269          \textcolor{keywordflow}{Case} (2:)}
\DoxyCodeLine{270 \textcolor{comment}{!}}
\DoxyCodeLine{271 \textcolor{comment}{!   Not enough values in low part, at least 2 are missing}}
\DoxyCodeLine{272 \textcolor{comment}{!}}
\DoxyCodeLine{273             inth = inth -\/ jlow}
\DoxyCodeLine{274             jlow = 0}
\DoxyCodeLine{275             \textcolor{keywordflow}{Select Case} (jhig)}
\DoxyCodeLine{276 \textcolor{comment}{!!!!!           CASE DEFAULT}}
\DoxyCodeLine{277 \textcolor{comment}{!!!!!              write (unit=*,fmt=*) "Assertion failed"}}
\DoxyCodeLine{278 \textcolor{comment}{!!!!!              STOP}}
\DoxyCodeLine{279 \textcolor{comment}{!}}
\DoxyCodeLine{280 \textcolor{comment}{!   We make a special case when we have so few values in}}
\DoxyCodeLine{281 \textcolor{comment}{!   the high values set that it is bad performance to choose a pivot}}
\DoxyCodeLine{282 \textcolor{comment}{!   and apply the general algorithm.}}
\DoxyCodeLine{283 \textcolor{comment}{!}}
\DoxyCodeLine{284             \textcolor{keywordflow}{Case} (2)}
\DoxyCodeLine{285                \textcolor{keywordflow}{If} (xhigt(1) <= xhigt(2)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{286                   jlow = jlow + 1}
\DoxyCodeLine{287                   xlowt(jlow) = xhigt(1)}
\DoxyCodeLine{288                   jlow = jlow + 1}
\DoxyCodeLine{289                   xlowt(jlow) = xhigt(2)}
\DoxyCodeLine{290                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{291                   jlow = jlow + 1}
\DoxyCodeLine{292                   xlowt(jlow) = xhigt(2)}
\DoxyCodeLine{293                   jlow = jlow + 1}
\DoxyCodeLine{294                   xlowt(jlow) = xhigt(1)}
\DoxyCodeLine{295 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{296                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{297 \textcolor{comment}{!}}
\DoxyCodeLine{298             \textcolor{keywordflow}{Case} (3)}
\DoxyCodeLine{299 \textcolor{comment}{!}}
\DoxyCodeLine{300 \textcolor{comment}{!}}
\DoxyCodeLine{301                xwrk1 = xhigt(1)}
\DoxyCodeLine{302                xwrk2 = xhigt(2)}
\DoxyCodeLine{303                xwrk3 = xhigt(3)}
\DoxyCodeLine{304                \textcolor{keywordflow}{If} (xwrk2 < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{305                   xhigt(1) = xwrk2}
\DoxyCodeLine{306                   xhigt(2) = xwrk1}
\DoxyCodeLine{307                   xwrk2 = xwrk1}
\DoxyCodeLine{308 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{309                \textcolor{keywordflow}{If} (xwrk2 > xwrk3) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{310                   xhigt(3) = xwrk2}
\DoxyCodeLine{311                   xhigt(2) = xwrk3}
\DoxyCodeLine{312                   xwrk2 = xwrk3}
\DoxyCodeLine{313                   \textcolor{keywordflow}{If} (xwrk2 < xhigt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{314                      xhigt(2) = xhigt(1)}
\DoxyCodeLine{315                      xhigt(1) = xwrk2}
\DoxyCodeLine{316 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{317 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{318                jhig = 0}
\DoxyCodeLine{319                \textcolor{keywordflow}{Do} icrs = jlow + 1, inth}
\DoxyCodeLine{320                   jhig = jhig + 1}
\DoxyCodeLine{321                   xlowt(icrs) = xhigt(jhig)}
\DoxyCodeLine{322 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{323                jlow = inth}
\DoxyCodeLine{324                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{325 \textcolor{comment}{!}}
\DoxyCodeLine{326             \textcolor{keywordflow}{Case} (4:)}
\DoxyCodeLine{327 \textcolor{comment}{!}}
\DoxyCodeLine{328 \textcolor{comment}{!}}
\DoxyCodeLine{329                xpiv0 = xpiv}
\DoxyCodeLine{330                ifin = jhig}
\DoxyCodeLine{331 \textcolor{comment}{!}}
\DoxyCodeLine{332 \textcolor{comment}{!  One chooses a pivot from the 2 first values and the last one.}}
\DoxyCodeLine{333 \textcolor{comment}{!  This should ensure sufficient renewal between iterations to}}
\DoxyCodeLine{334 \textcolor{comment}{!  avoid worst case behavior effects.}}
\DoxyCodeLine{335 \textcolor{comment}{!}}
\DoxyCodeLine{336                xwrk1 = xhigt(1)}
\DoxyCodeLine{337                xwrk2 = xhigt(2)}
\DoxyCodeLine{338                xwrk3 = xhigt(ifin)}
\DoxyCodeLine{339                \textcolor{keywordflow}{If} (xwrk2 < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{340                   xhigt(1) = xwrk2}
\DoxyCodeLine{341                   xhigt(2) = xwrk1}
\DoxyCodeLine{342                   xwrk2 = xwrk1}
\DoxyCodeLine{343 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{344                \textcolor{keywordflow}{If} (xwrk2 > xwrk3) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{345                   xhigt(ifin) = xwrk2}
\DoxyCodeLine{346                   xhigt(2) = xwrk3}
\DoxyCodeLine{347                   xwrk2 = xwrk3}
\DoxyCodeLine{348                   \textcolor{keywordflow}{If} (xwrk2 < xhigt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{349                      xhigt(2) = xhigt(1)}
\DoxyCodeLine{350                      xhigt(1) = xwrk2}
\DoxyCodeLine{351 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{352 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{353 \textcolor{comment}{!}}
\DoxyCodeLine{354                xwrk1 = xhigt(1)}
\DoxyCodeLine{355                jlow = jlow + 1}
\DoxyCodeLine{356                xlowt(jlow) = xwrk1}
\DoxyCodeLine{357                xpiv = xwrk1 + 0.5 * (xhigt(ifin)-\/xwrk1)}
\DoxyCodeLine{358 \textcolor{comment}{!}}
\DoxyCodeLine{359 \textcolor{comment}{!  One takes values <= pivot to XLOWT}}
\DoxyCodeLine{360 \textcolor{comment}{!  Again, 2 parts, one where we take care of the remaining}}
\DoxyCodeLine{361 \textcolor{comment}{!  high values because we might still need them, and the}}
\DoxyCodeLine{362 \textcolor{comment}{!  other when we know that we will have more than enough}}
\DoxyCodeLine{363 \textcolor{comment}{!  low values in the end.}}
\DoxyCodeLine{364 \textcolor{comment}{!}}
\DoxyCodeLine{365                jhig = 0}
\DoxyCodeLine{366                \textcolor{keywordflow}{Do} icrs = 2, ifin}
\DoxyCodeLine{367                   \textcolor{keywordflow}{If} (xhigt(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{368                      jlow = jlow + 1}
\DoxyCodeLine{369                      xlowt(jlow) = xhigt(icrs)}
\DoxyCodeLine{370                      \textcolor{keywordflow}{If} (jlow >= inth) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{371                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{372                      jhig = jhig + 1}
\DoxyCodeLine{373                      xhigt(jhig) = xhigt(icrs)}
\DoxyCodeLine{374 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{375 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{376 \textcolor{comment}{!}}
\DoxyCodeLine{377                \textcolor{keywordflow}{Do} icrs = icrs + 1, ifin}
\DoxyCodeLine{378                   \textcolor{keywordflow}{If} (xhigt(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{379                      jlow = jlow + 1}
\DoxyCodeLine{380                      xlowt(jlow) = xhigt(icrs)}
\DoxyCodeLine{381 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{382 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{383 \textcolor{keywordflow}{            End Select}}
\DoxyCodeLine{384 \textcolor{comment}{!}}
\DoxyCodeLine{385 \textcolor{comment}{!}}
\DoxyCodeLine{386          \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{387 \textcolor{comment}{!}}
\DoxyCodeLine{388 \textcolor{comment}{!  Only 1 value is missing in low part}}
\DoxyCodeLine{389 \textcolor{comment}{!}}
\DoxyCodeLine{390             xmin = xhigt(1)}
\DoxyCodeLine{391             \textcolor{keywordflow}{Do} icrs = 2, jhig}
\DoxyCodeLine{392                \textcolor{keywordflow}{If} (xhigt(icrs) < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{393                   xmin = xhigt(icrs)}
\DoxyCodeLine{394 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{395 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{396 \textcolor{comment}{!}}
\DoxyCodeLine{397             jlow = jlow + 1}
\DoxyCodeLine{398             xlowt(jlow) = xmin}
\DoxyCodeLine{399             \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{400 \textcolor{comment}{!}}
\DoxyCodeLine{401 \textcolor{comment}{!}}
\DoxyCodeLine{402          \textcolor{keywordflow}{Case} (0)}
\DoxyCodeLine{403 \textcolor{comment}{!}}
\DoxyCodeLine{404 \textcolor{comment}{!  Low part is exactly what we want}}
\DoxyCodeLine{405 \textcolor{comment}{!}}
\DoxyCodeLine{406             \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{407 \textcolor{comment}{!}}
\DoxyCodeLine{408 \textcolor{comment}{!}}
\DoxyCodeLine{409          \textcolor{keywordflow}{Case} (-\/5:-\/1)}
\DoxyCodeLine{410 \textcolor{comment}{!}}
\DoxyCodeLine{411 \textcolor{comment}{!  Only few values too many in low part}}
\DoxyCodeLine{412 \textcolor{comment}{!}}
\DoxyCodeLine{413             \textcolor{keywordflow}{IF} (ifodd) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{414               jhig = jlow -\/ inth + 1}
\DoxyCodeLine{415             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{416               jhig = jlow -\/ inth + 2}
\DoxyCodeLine{417 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{418             xhigt(1) = xlowt(1)}
\DoxyCodeLine{419             \textcolor{keywordflow}{Do} icrs = 2, jhig}
\DoxyCodeLine{420                xwrk = xlowt(icrs)}
\DoxyCodeLine{421                \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{422                   \textcolor{keywordflow}{If} (xwrk < xhigt(idcr)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{423                      xhigt(idcr+1) = xhigt(idcr)}
\DoxyCodeLine{424                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{425                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{426 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{427 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{428                xhigt(idcr+1) = xwrk}
\DoxyCodeLine{429 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{430 \textcolor{comment}{!}}
\DoxyCodeLine{431             \textcolor{keywordflow}{Do} icrs = jhig + 1, jlow}
\DoxyCodeLine{432                \textcolor{keywordflow}{If} (xlowt(icrs) > xhigt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{433                   xwrk = xlowt(icrs)}
\DoxyCodeLine{434                   \textcolor{keywordflow}{Do} idcr = 2, jhig}
\DoxyCodeLine{435                      \textcolor{keywordflow}{If} (xwrk >= xhigt(idcr)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{436                         xhigt(idcr-\/1) = xhigt(idcr)}
\DoxyCodeLine{437                      \textcolor{keywordflow}{else}}
\DoxyCodeLine{438                         \textcolor{keywordflow}{exit}}
\DoxyCodeLine{439 \textcolor{keywordflow}{                     endif}}
\DoxyCodeLine{440 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{441                   xhigt(idcr-\/1) = xwrk}
\DoxyCodeLine{442 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{443 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{444 \textcolor{comment}{!}}
\DoxyCodeLine{445             \textcolor{keywordflow}{IF} (ifodd) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{446               median = xhigt(1)}
\DoxyCodeLine{447             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{448               median = 0.5*(xhigt(1)+xhigt(2))}
\DoxyCodeLine{449 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{450             \textcolor{keywordflow}{Return}}
\DoxyCodeLine{451 \textcolor{comment}{!}}
\DoxyCodeLine{452 \textcolor{comment}{!}}
\DoxyCodeLine{453          \textcolor{keywordflow}{Case} (:-\/6)}
\DoxyCodeLine{454 \textcolor{comment}{!}}
\DoxyCodeLine{455 \textcolor{comment}{! last case: too many values in low part}}
\DoxyCodeLine{456 \textcolor{comment}{!}}
\DoxyCodeLine{457 }
\DoxyCodeLine{458             imil = (jlow+1) / 2}
\DoxyCodeLine{459             ifin = jlow}
\DoxyCodeLine{460 \textcolor{comment}{!}}
\DoxyCodeLine{461 \textcolor{comment}{!  One chooses a pivot from 1st, last, and middle values}}
\DoxyCodeLine{462 \textcolor{comment}{!}}
\DoxyCodeLine{463             \textcolor{keywordflow}{If} (xlowt(imil) < xlowt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{464                xwrk = xlowt(1)}
\DoxyCodeLine{465                xlowt(1) = xlowt(imil)}
\DoxyCodeLine{466                xlowt(imil) = xwrk}
\DoxyCodeLine{467 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{468             \textcolor{keywordflow}{If} (xlowt(imil) > xlowt(ifin)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{469                xwrk = xlowt(ifin)}
\DoxyCodeLine{470                xlowt(ifin) = xlowt(imil)}
\DoxyCodeLine{471                xlowt(imil) = xwrk}
\DoxyCodeLine{472                \textcolor{keywordflow}{If} (xlowt(imil) < xlowt(1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{473                   xwrk = xlowt(1)}
\DoxyCodeLine{474                   xlowt(1) = xlowt(imil)}
\DoxyCodeLine{475                   xlowt(imil) = xwrk}
\DoxyCodeLine{476 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{477 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{478             \textcolor{keywordflow}{If} (ifin <= 3) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{479 \textcolor{comment}{!}}
\DoxyCodeLine{480             xpiv = xlowt(1) + real(inth)/real(jlow+inth) * \&}
\DoxyCodeLine{481                               (xlowt(ifin)-\/xlowt(1))}
\DoxyCodeLine{482 }
\DoxyCodeLine{483 \textcolor{comment}{!}}
\DoxyCodeLine{484 \textcolor{comment}{!  One takes values > XPIV to XHIGT}}
\DoxyCodeLine{485 \textcolor{comment}{!}}
\DoxyCodeLine{486             jhig = 0}
\DoxyCodeLine{487             jlow = 0}
\DoxyCodeLine{488 \textcolor{comment}{!}}
\DoxyCodeLine{489             \textcolor{keywordflow}{If} (xlowt(ifin) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{490                icrs = 0}
\DoxyCodeLine{491                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{492                   icrs = icrs + 1}
\DoxyCodeLine{493                   \textcolor{keywordflow}{If} (xlowt(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{494                      jhig = jhig + 1}
\DoxyCodeLine{495                      xhigt(jhig) = xlowt(icrs)}
\DoxyCodeLine{496                      \textcolor{keywordflow}{If} (icrs >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{497                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{498                      jlow = jlow + 1}
\DoxyCodeLine{499                      xlowt(jlow) = xlowt(icrs)}
\DoxyCodeLine{500                      \textcolor{keywordflow}{If} (jlow >= inth) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{501 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{502 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{503 \textcolor{comment}{!}}
\DoxyCodeLine{504                \textcolor{keywordflow}{If} (icrs < ifin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{505                   \textcolor{keywordflow}{Do}}
\DoxyCodeLine{506                      icrs = icrs + 1}
\DoxyCodeLine{507                      \textcolor{keywordflow}{If} (xlowt(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{508                         jlow = jlow + 1}
\DoxyCodeLine{509                         xlowt(jlow) = xlowt(icrs)}
\DoxyCodeLine{510                      \textcolor{keywordflow}{Else}}
\DoxyCodeLine{511                         \textcolor{keywordflow}{If} (icrs >= ifin) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{512 \textcolor{keywordflow}{                     End If}}
\DoxyCodeLine{513 \textcolor{keywordflow}{                  End Do}}
\DoxyCodeLine{514 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{515             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{516                \textcolor{keywordflow}{Do} icrs = 1, ifin}
\DoxyCodeLine{517                   \textcolor{keywordflow}{If} (xlowt(icrs) > xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{518                      jhig = jhig + 1}
\DoxyCodeLine{519                      xhigt(jhig) = xlowt(icrs)}
\DoxyCodeLine{520                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{521                      jlow = jlow + 1}
\DoxyCodeLine{522                      xlowt(jlow) = xlowt(icrs)}
\DoxyCodeLine{523                      \textcolor{keywordflow}{If} (jlow >= inth) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{524 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{525 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{526 \textcolor{comment}{!}}
\DoxyCodeLine{527                \textcolor{keywordflow}{Do} icrs = icrs + 1, ifin}
\DoxyCodeLine{528                   \textcolor{keywordflow}{If} (xlowt(icrs) <= xpiv) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{529                      jlow = jlow + 1}
\DoxyCodeLine{530                      xlowt(jlow) = xlowt(icrs)}
\DoxyCodeLine{531 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{532 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{533 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{534 \textcolor{comment}{!}}
\DoxyCodeLine{535 \textcolor{keywordflow}{         End Select}}
\DoxyCodeLine{536 \textcolor{comment}{!}}
\DoxyCodeLine{537 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{538 \textcolor{comment}{!}}
\DoxyCodeLine{539 \textcolor{comment}{!  Now, we only need to find maximum of the 1:INTH set}}
\DoxyCodeLine{540 \textcolor{comment}{!}}
\DoxyCodeLine{541       \textcolor{keywordflow}{if} (ifodd) \textcolor{keywordflow}{then}}
\DoxyCodeLine{542         median = maxval(xlowt(1:inth))}
\DoxyCodeLine{543       \textcolor{keywordflow}{else}}
\DoxyCodeLine{544         xwrk = max(xlowt(1), xlowt(2))}
\DoxyCodeLine{545         xwrk1 = min(xlowt(1), xlowt(2))}
\DoxyCodeLine{546         \textcolor{keywordflow}{DO} icrs = 3, inth}
\DoxyCodeLine{547           \textcolor{keywordflow}{IF} (xlowt(icrs) > xwrk1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{548             \textcolor{keywordflow}{IF} (xlowt(icrs) > xwrk) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{549               xwrk1 = xwrk}
\DoxyCodeLine{550               xwrk  = xlowt(icrs)}
\DoxyCodeLine{551             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{552               xwrk1 = xlowt(icrs)}
\DoxyCodeLine{553 \textcolor{keywordflow}{            ENDIF}}
\DoxyCodeLine{554 \textcolor{keywordflow}{          ENDIF}}
\DoxyCodeLine{555 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{556         median = 0.5*(xwrk+xwrk1)}
\DoxyCodeLine{557 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{558       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{559 \textcolor{comment}{!}}

\end{DoxyCode}


The documentation for this interface was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/home/urbanjs/venus/\+V600/github/orderpack/src/\mbox{\hyperlink{M__median_8f90}{M\+\_\+median.\+f90}}\end{DoxyCompactItemize}
