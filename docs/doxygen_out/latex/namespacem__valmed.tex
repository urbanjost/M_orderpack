\hypertarget{namespacem__valmed}{}\doxysection{m\+\_\+valmed Module Reference}
\label{namespacem__valmed}\index{m\_valmed@{m\_valmed}}
\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface \mbox{\hyperlink{interfacem__valmed_1_1valmed}{valmed}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
recursive real(kind=real64) function \mbox{\hyperlink{namespacem__valmed_a79bfc922a940113afbb31745215b7ddb}{real64\+\_\+valmed}} (X\+D\+O\+NT)
\item 
recursive real(kind=real32) function \mbox{\hyperlink{namespacem__valmed_a7463e0fe7ec96792d258c7ae4d6d3229}{real32\+\_\+valmed}} (X\+D\+O\+NT)
\item 
recursive integer(kind=int32) function \mbox{\hyperlink{namespacem__valmed_ac442d00d7888d58a5407a64d8fb2d77a}{int32\+\_\+valmed}} (X\+D\+O\+NT)
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacem__valmed_ac442d00d7888d58a5407a64d8fb2d77a}\label{namespacem__valmed_ac442d00d7888d58a5407a64d8fb2d77a}} 
\index{m\_valmed@{m\_valmed}!int32\_valmed@{int32\_valmed}}
\index{int32\_valmed@{int32\_valmed}!m\_valmed@{m\_valmed}}
\doxysubsubsection{\texorpdfstring{int32\_valmed()}{int32\_valmed()}}
{\footnotesize\ttfamily recursive integer (kind=int32) function m\+\_\+valmed\+::int32\+\_\+valmed (\begin{DoxyParamCaption}\item[{integer (kind=int32), dimension (\+:), intent(in)}]{X\+D\+O\+NT }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{727 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{728       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDONT}
\DoxyCodeLine{729       \textcolor{keywordtype}{Integer (kind=int32)} :: res\_med}
\DoxyCodeLine{730 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{731       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Parameter} :: XHUGE = huge (xdont)}
\DoxyCodeLine{732       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Dimension (SIZE(XDONT)+6)} :: XWRKT}
\DoxyCodeLine{733       \textcolor{keywordtype}{Integer (kind=int32)} :: XWRK, XWRK1, XMED7}
\DoxyCodeLine{734 \textcolor{comment}{!}}
\DoxyCodeLine{735       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension ((SIZE(XDONT)+6)/7)} :: ISTRT, IENDT, IMEDT}
\DoxyCodeLine{736       \textcolor{keywordtype}{Integer} :: NDON, NTRI, NMED, NORD, NEQU, NLEQ, IMED, IDON, IDON1}
\DoxyCodeLine{737       \textcolor{keywordtype}{Integer} :: IDEB, IWRK, IDCR, ICRS, ICRS1, ICRS2, IMED1}
\DoxyCodeLine{738 \textcolor{comment}{!}}
\DoxyCodeLine{739       ndon = \textcolor{keyword}{SIZE} (xdont)}
\DoxyCodeLine{740       nmed = (ndon+1) / 2}
\DoxyCodeLine{741 \textcolor{comment}{!      write(unit=*,fmt=*) NMED, NDON}}
\DoxyCodeLine{742 \textcolor{comment}{!}}
\DoxyCodeLine{743 \textcolor{comment}{!  If the number of values is small, then use insertion sort}}
\DoxyCodeLine{744 \textcolor{comment}{!}}
\DoxyCodeLine{745       \textcolor{keywordflow}{If} (ndon < 35) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{746 \textcolor{comment}{!}}
\DoxyCodeLine{747 \textcolor{comment}{!  Bring minimum to first location to save test in decreasing loop}}
\DoxyCodeLine{748 \textcolor{comment}{!}}
\DoxyCodeLine{749          idcr = ndon}
\DoxyCodeLine{750          \textcolor{keywordflow}{If} (xdont(1) < xdont(ndon)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{751             xwrk = xdont(1)}
\DoxyCodeLine{752             xwrkt(idcr) = xdont(idcr)}
\DoxyCodeLine{753          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{754             xwrk = xdont(idcr)}
\DoxyCodeLine{755             xwrkt(idcr) = xdont(1)}
\DoxyCodeLine{756 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{757          \textcolor{keywordflow}{Do} iwrk = 1, ndon -\/ 2}
\DoxyCodeLine{758             idcr = idcr -\/ 1}
\DoxyCodeLine{759             xwrk1 = xdont(idcr)}
\DoxyCodeLine{760             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{761                 xwrkt(idcr) = xwrk}
\DoxyCodeLine{762                 xwrk = xwrk1}
\DoxyCodeLine{763             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{764                 xwrkt(idcr) = xwrk1}
\DoxyCodeLine{765 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{766 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{767          xwrkt(1) = xwrk}
\DoxyCodeLine{768 \textcolor{comment}{!}}
\DoxyCodeLine{769 \textcolor{comment}{! Sort the first half, until we have NMED sorted values}}
\DoxyCodeLine{770 \textcolor{comment}{!}}
\DoxyCodeLine{771          \textcolor{keywordflow}{Do} icrs = 3, nmed}
\DoxyCodeLine{772             xwrk = xwrkt(icrs)}
\DoxyCodeLine{773                idcr = icrs -\/ 1}
\DoxyCodeLine{774                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{775                   \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{776                   xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{777                   idcr = idcr -\/ 1}
\DoxyCodeLine{778 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{779             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{780 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{781 \textcolor{comment}{!}}
\DoxyCodeLine{782 \textcolor{comment}{!  Insert any value less than the current median in the first half}}
\DoxyCodeLine{783 \textcolor{comment}{!}}
\DoxyCodeLine{784          \textcolor{keywordflow}{Do} icrs = nmed+1, ndon}
\DoxyCodeLine{785             xwrk = xwrkt(icrs)}
\DoxyCodeLine{786             \textcolor{keywordflow}{If} (xwrk < xwrkt(nmed)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{787                idcr = nmed -\/ 1}
\DoxyCodeLine{788                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{789                   \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{790                   xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{791                   idcr = idcr -\/ 1}
\DoxyCodeLine{792 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{793                xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{794 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{795 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{796          res\_med = xwrkt(nmed)}
\DoxyCodeLine{797          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{798 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{799 \textcolor{comment}{!}}
\DoxyCodeLine{800 \textcolor{comment}{!  Make sorted subsets of 7 elements}}
\DoxyCodeLine{801 \textcolor{comment}{!  This is done by a variant of insertion sort where a first}}
\DoxyCodeLine{802 \textcolor{comment}{!  pass is used to bring the smallest element to the first position}}
\DoxyCodeLine{803 \textcolor{comment}{!  decreasing disorder at the same time, so that we may remove}}
\DoxyCodeLine{804 \textcolor{comment}{!  remove the loop test in the insertion loop.}}
\DoxyCodeLine{805 \textcolor{comment}{!}}
\DoxyCodeLine{806       \textcolor{keywordflow}{DO} ideb = 1, ndon-\/6, 7}
\DoxyCodeLine{807          idcr = ideb + 6}
\DoxyCodeLine{808          \textcolor{keywordflow}{If} (xdont(ideb) < xdont(idcr)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{809             xwrk = xdont(ideb)}
\DoxyCodeLine{810             xwrkt(idcr) = xdont(idcr)}
\DoxyCodeLine{811          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{812             xwrk = xdont(idcr)}
\DoxyCodeLine{813             xwrkt(idcr) = xdont(ideb)}
\DoxyCodeLine{814 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{815          \textcolor{keywordflow}{Do} iwrk = 1, 5}
\DoxyCodeLine{816             idcr = idcr -\/ 1}
\DoxyCodeLine{817             xwrk1 = xdont(idcr)}
\DoxyCodeLine{818             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{819                 xwrkt(idcr) = xwrk}
\DoxyCodeLine{820                 xwrk = xwrk1}
\DoxyCodeLine{821             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{822                 xwrkt(idcr) = xwrk1}
\DoxyCodeLine{823 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{824 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{825          xwrkt(ideb) = xwrk}
\DoxyCodeLine{826          \textcolor{keywordflow}{Do} icrs = ideb+2, ideb+6}
\DoxyCodeLine{827             xwrk = xwrkt(icrs)}
\DoxyCodeLine{828             \textcolor{keywordflow}{If} (xwrk < xwrkt(icrs-\/1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{829                xwrkt(icrs) = xwrkt(icrs-\/1)}
\DoxyCodeLine{830                idcr = icrs -\/ 1}
\DoxyCodeLine{831                xwrk1 = xwrkt(idcr-\/1)}
\DoxyCodeLine{832                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{833                   \textcolor{keywordflow}{If} (xwrk >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{834                   xwrkt(idcr) = xwrk1}
\DoxyCodeLine{835                   idcr = idcr -\/ 1}
\DoxyCodeLine{836                   xwrk1 = xwrkt(idcr-\/1)}
\DoxyCodeLine{837 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{838                xwrkt(idcr) = xwrk}
\DoxyCodeLine{839 \textcolor{keywordflow}{            EndIf}}
\DoxyCodeLine{840 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{841 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{842 \textcolor{comment}{!}}
\DoxyCodeLine{843 \textcolor{comment}{!  Add-\/up alternatively + and -\/ HUGE values to make the number of data}}
\DoxyCodeLine{844 \textcolor{comment}{!  an exact multiple of 7.}}
\DoxyCodeLine{845 \textcolor{comment}{!}}
\DoxyCodeLine{846       ideb = 7 * (ndon/7)}
\DoxyCodeLine{847       ntri = ndon}
\DoxyCodeLine{848       \textcolor{keywordflow}{If} (ideb < ndon) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{849 \textcolor{comment}{!}}
\DoxyCodeLine{850          xwrk1 = xhuge}
\DoxyCodeLine{851          \textcolor{keywordflow}{Do} icrs = ideb+1, ideb+7}
\DoxyCodeLine{852             \textcolor{keywordflow}{If} (icrs <= ndon) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{853                xwrkt(icrs) = xdont(icrs)}
\DoxyCodeLine{854             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{855                \textcolor{keywordflow}{If} (xwrk1 /= xhuge) nmed = nmed + 1}
\DoxyCodeLine{856                xwrkt(icrs) = xwrk1}
\DoxyCodeLine{857                xwrk1 = -\/ xwrk1}
\DoxyCodeLine{858 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{859 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{860 \textcolor{comment}{!}}
\DoxyCodeLine{861          \textcolor{keywordflow}{Do} icrs = ideb+2, ideb+7}
\DoxyCodeLine{862             xwrk = xwrkt(icrs)}
\DoxyCodeLine{863             \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, ideb+1, -\/ 1}
\DoxyCodeLine{864                \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{865                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{866 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{867             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{868 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{869 \textcolor{comment}{!}}
\DoxyCodeLine{870          ntri = ideb+7}
\DoxyCodeLine{871 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{872 \textcolor{comment}{!}}
\DoxyCodeLine{873 \textcolor{comment}{!  Make the set of the indices of median values of each sorted subset}}
\DoxyCodeLine{874 \textcolor{comment}{!}}
\DoxyCodeLine{875          idon1 = 0}
\DoxyCodeLine{876          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{877             idon1 = idon1 + 1}
\DoxyCodeLine{878             imedt(idon1) = idon + 3}
\DoxyCodeLine{879 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{880 \textcolor{comment}{!}}
\DoxyCodeLine{881 \textcolor{comment}{!  Find XMED7, the median of the medians}}
\DoxyCodeLine{882 \textcolor{comment}{!}}
\DoxyCodeLine{883          xmed7 = int32\_valmed(xwrkt(imedt))}
\DoxyCodeLine{884 \textcolor{comment}{!}}
\DoxyCodeLine{885 \textcolor{comment}{!  Count how many values are not higher than (and how many equal to) XMED7}}
\DoxyCodeLine{886 \textcolor{comment}{!  This number is at least 4 * 1/2 * (N/7) : 4 values in each of the}}
\DoxyCodeLine{887 \textcolor{comment}{!  subsets where the median is lower than the median of medians. For similar}}
\DoxyCodeLine{888 \textcolor{comment}{!  reasons, we also have at least 2N/7 values not lower than XMED7. At the}}
\DoxyCodeLine{889 \textcolor{comment}{!  same time, we find in each subset the index of the last value < XMED7,}}
\DoxyCodeLine{890 \textcolor{comment}{!  and that of the first > XMED7. These indices will be used to restrict the}}
\DoxyCodeLine{891 \textcolor{comment}{!  search for the median as the Kth element in the subset (> or <) where}}
\DoxyCodeLine{892 \textcolor{comment}{!  we know it to be.}}
\DoxyCodeLine{893 \textcolor{comment}{!}}
\DoxyCodeLine{894          idon1 = 1}
\DoxyCodeLine{895          nleq = 0}
\DoxyCodeLine{896          nequ = 0}
\DoxyCodeLine{897          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{898             imed = idon+3}
\DoxyCodeLine{899             \textcolor{keywordflow}{If} (xwrkt(imed) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{900                   imed = imed -\/ 2}
\DoxyCodeLine{901                   \textcolor{keywordflow}{If} (xwrkt(imed) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{902                      imed = imed -\/ 1}
\DoxyCodeLine{903                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xwrkt(imed) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{904                      imed = imed + 1}
\DoxyCodeLine{905 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{906             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xwrkt(imed) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{907                   imed = imed + 2}
\DoxyCodeLine{908                   \textcolor{keywordflow}{If} (xwrkt(imed) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{909                      imed = imed -\/ 1}
\DoxyCodeLine{910                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xwrkt(imed) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{911                      imed = imed + 1}
\DoxyCodeLine{912 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{913 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{914             \textcolor{keywordflow}{If} (xwrkt(imed) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{915                nleq = nleq + imed -\/ idon}
\DoxyCodeLine{916                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{917                istrt(idon1) = imed}
\DoxyCodeLine{918             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xwrkt(imed) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{919                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{920                iendt(idon1) = imed}
\DoxyCodeLine{921                istrt(idon1) = imed + 1}
\DoxyCodeLine{922             \textcolor{keywordflow}{Else}                    \textcolor{comment}{!       If (XWRKT (IMED) == XMED7)}}
\DoxyCodeLine{923                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{924                nequ = nequ + 1}
\DoxyCodeLine{925                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{926                \textcolor{keywordflow}{Do} imed1 = imed -\/ 1, idon, -\/1}
\DoxyCodeLine{927                   \textcolor{keywordflow}{If} (xwrkt(imed1) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{928                      nequ = nequ + 1}
\DoxyCodeLine{929                      iendt(idon1) = imed1 -\/ 1}
\DoxyCodeLine{930                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{931                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{932 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{933 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{934                istrt(idon1) = imed + 1}
\DoxyCodeLine{935                \textcolor{keywordflow}{Do} imed1 = imed + 1, idon + 6}
\DoxyCodeLine{936                   \textcolor{keywordflow}{If} (xwrkt(imed1) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{937                      nequ = nequ + 1}
\DoxyCodeLine{938                      nleq = nleq + 1}
\DoxyCodeLine{939                      istrt(idon1) = imed1 + 1}
\DoxyCodeLine{940                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{941                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{942 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{943 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{944 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{945             idon1 = idon1 + 1}
\DoxyCodeLine{946 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{947 \textcolor{comment}{!}}
\DoxyCodeLine{948 \textcolor{comment}{!  Carry out a partial insertion sort to find the Kth smallest of the}}
\DoxyCodeLine{949 \textcolor{comment}{!  large values, or the Kth largest of the small values, according to}}
\DoxyCodeLine{950 \textcolor{comment}{!  what is needed.}}
\DoxyCodeLine{951 \textcolor{comment}{!}}
\DoxyCodeLine{952         \textcolor{keywordflow}{If} (nleq -\/ nequ + 1 <= nmed) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{953             \textcolor{keywordflow}{If} (nleq < nmed) \textcolor{keywordflow}{Then}   \textcolor{comment}{!      Not enough low values}}
\DoxyCodeLine{954                 xwrk1 = xhuge}
\DoxyCodeLine{955                 nord = nmed -\/ nleq}
\DoxyCodeLine{956                 idon1 = 0}
\DoxyCodeLine{957                 icrs1 = 1}
\DoxyCodeLine{958                 icrs2 = 0}
\DoxyCodeLine{959                 idcr = 0}
\DoxyCodeLine{960                \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{961                    idon1 = idon1 + 1}
\DoxyCodeLine{962                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{963                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{964                          \textcolor{keywordflow}{If} (xwrkt(icrs) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{965                             xwrk = xwrkt(icrs)}
\DoxyCodeLine{966                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{967                                \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{968                                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{969 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{970                             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{971                             xwrk1 = xwrkt(icrs1)}
\DoxyCodeLine{972                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{973                            \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{974                               xwrkt(icrs1) = xwrkt(icrs)}
\DoxyCodeLine{975                               xwrk1 = xwrkt(icrs1)}
\DoxyCodeLine{976 \textcolor{keywordflow}{                           Endif}}
\DoxyCodeLine{977 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{978                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{979                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{980 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{981                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{982                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{983                          \textcolor{keywordflow}{If} (xwrkt(icrs) >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{984                          xwrk = xwrkt(icrs)}
\DoxyCodeLine{985                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{986                                \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{987                                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{988 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{989                          xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{990                          xwrk1 = xwrkt(icrs1)}
\DoxyCodeLine{991 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{992 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{993 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{994                 res\_med = xwrk1}
\DoxyCodeLine{995                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{996             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{997                 res\_med = xmed7}
\DoxyCodeLine{998                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{999 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1000          \textcolor{keywordflow}{Else}                       \textcolor{comment}{!      If (NLEQ > NMED)}}
\DoxyCodeLine{1001 \textcolor{comment}{!                                          Not enough high values}}
\DoxyCodeLine{1002                 xwrk1 = -\/xhuge}
\DoxyCodeLine{1003                 nord = nleq -\/ nequ -\/ nmed + 1}
\DoxyCodeLine{1004                 idon1 = 0}
\DoxyCodeLine{1005                 icrs1 = 1}
\DoxyCodeLine{1006                 icrs2 = 0}
\DoxyCodeLine{1007                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1008                    idon1 = idon1 + 1}
\DoxyCodeLine{1009                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1010 \textcolor{comment}{!}}
\DoxyCodeLine{1011                       \textcolor{keywordflow}{Do} icrs = idon, iendt(idon1)}
\DoxyCodeLine{1012                          \textcolor{keywordflow}{If} (xwrkt(icrs) > xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1013                             xwrk = xwrkt(icrs)}
\DoxyCodeLine{1014                             idcr = icrs1 -\/ 1}
\DoxyCodeLine{1015                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1016                                \textcolor{keywordflow}{If} (xwrk <= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1017                                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{1018 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{1019                             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{1020                             xwrk1 = xwrkt(icrs1)}
\DoxyCodeLine{1021                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1022                             \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1023                                xwrkt(icrs1) = xwrkt(icrs)}
\DoxyCodeLine{1024                                xwrk1 = xwrkt(icrs1)}
\DoxyCodeLine{1025 \textcolor{keywordflow}{                            End If}}
\DoxyCodeLine{1026 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{1027                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{1028                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{1029 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1030                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1031                       \textcolor{keywordflow}{Do} icrs = iendt(idon1), idon, -\/1}
\DoxyCodeLine{1032                          \textcolor{keywordflow}{If} (xwrkt(icrs) > xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1033                             xwrk = xwrkt(icrs)}
\DoxyCodeLine{1034                             idcr = icrs1 -\/ 1}
\DoxyCodeLine{1035                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1036                                \textcolor{keywordflow}{If} (xwrk <= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1037                                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{1038 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{1039                             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{1040                             xwrk1 = xwrkt(icrs1)}
\DoxyCodeLine{1041                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1042                             \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1043 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{1044 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1045 \textcolor{keywordflow}{                   Endif}}
\DoxyCodeLine{1046 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{1047 \textcolor{comment}{!}}
\DoxyCodeLine{1048                 res\_med = xwrk1}
\DoxyCodeLine{1049                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1050 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1051 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__valmed_a7463e0fe7ec96792d258c7ae4d6d3229}\label{namespacem__valmed_a7463e0fe7ec96792d258c7ae4d6d3229}} 
\index{m\_valmed@{m\_valmed}!real32\_valmed@{real32\_valmed}}
\index{real32\_valmed@{real32\_valmed}!m\_valmed@{m\_valmed}}
\doxysubsubsection{\texorpdfstring{real32\_valmed()}{real32\_valmed()}}
{\footnotesize\ttfamily recursive real (kind=real32) function m\+\_\+valmed\+::real32\+\_\+valmed (\begin{DoxyParamCaption}\item[{real (kind=real32), dimension (\+:), intent(in)}]{X\+D\+O\+NT }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{400 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{401 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{402 \textcolor{keywordtype}{      Real} (kind=real32) :: res\_med}
\DoxyCodeLine{403 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{404 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Parameter} :: xhuge = huge(xdont)}
\DoxyCodeLine{405 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Dimension (SIZE(XDONT)+6)} :: xwrkt}
\DoxyCodeLine{406 \textcolor{keywordtype}{      Real} (kind=real32) :: xwrk, xwrk1, xmed7}
\DoxyCodeLine{407 \textcolor{comment}{!}}
\DoxyCodeLine{408       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension ((SIZE(XDONT)+6)/7)} :: ISTRT, IENDT, IMEDT}
\DoxyCodeLine{409       \textcolor{keywordtype}{Integer} :: NDON, NTRI, NMED, NORD, NEQU, NLEQ, IMED, IDON, IDON1}
\DoxyCodeLine{410       \textcolor{keywordtype}{Integer} :: IDEB, IWRK, IDCR, ICRS, ICRS1, ICRS2, IMED1}
\DoxyCodeLine{411 \textcolor{comment}{!}}
\DoxyCodeLine{412       ndon = \textcolor{keyword}{SIZE} (xdont)}
\DoxyCodeLine{413       nmed = (ndon+1) / 2}
\DoxyCodeLine{414 \textcolor{comment}{!      write(unit=*,fmt=*) NMED, NDON}}
\DoxyCodeLine{415 \textcolor{comment}{!}}
\DoxyCodeLine{416 \textcolor{comment}{!  If the number of values is small, then use insertion sort}}
\DoxyCodeLine{417 \textcolor{comment}{!}}
\DoxyCodeLine{418       \textcolor{keywordflow}{If} (ndon < 35) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{419 \textcolor{comment}{!}}
\DoxyCodeLine{420 \textcolor{comment}{!  Bring minimum to first location to save test in decreasing loop}}
\DoxyCodeLine{421 \textcolor{comment}{!}}
\DoxyCodeLine{422          idcr = ndon}
\DoxyCodeLine{423          \textcolor{keywordflow}{If} (xdont(1) < xdont(ndon)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{424             xwrk = xdont(1)}
\DoxyCodeLine{425             xwrkt(idcr) = xdont(idcr)}
\DoxyCodeLine{426          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{427             xwrk = xdont(idcr)}
\DoxyCodeLine{428             xwrkt(idcr) = xdont(1)}
\DoxyCodeLine{429 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{430          \textcolor{keywordflow}{Do} iwrk = 1, ndon -\/ 2}
\DoxyCodeLine{431             idcr = idcr -\/ 1}
\DoxyCodeLine{432             xwrk1 = xdont(idcr)}
\DoxyCodeLine{433             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{434                 xwrkt(idcr) = xwrk}
\DoxyCodeLine{435                 xwrk = xwrk1}
\DoxyCodeLine{436             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{437                 xwrkt(idcr) = xwrk1}
\DoxyCodeLine{438 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{439 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{440          xwrkt(1) = xwrk}
\DoxyCodeLine{441 \textcolor{comment}{!}}
\DoxyCodeLine{442 \textcolor{comment}{! Sort the first half, until we have NMED sorted values}}
\DoxyCodeLine{443 \textcolor{comment}{!}}
\DoxyCodeLine{444          \textcolor{keywordflow}{Do} icrs = 3, nmed}
\DoxyCodeLine{445             xwrk = xwrkt(icrs)}
\DoxyCodeLine{446                idcr = icrs -\/ 1}
\DoxyCodeLine{447                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{448                   \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{449                   xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{450                   idcr = idcr -\/ 1}
\DoxyCodeLine{451 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{452             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{453 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{454 \textcolor{comment}{!}}
\DoxyCodeLine{455 \textcolor{comment}{!  Insert any value less than the current median in the first half}}
\DoxyCodeLine{456 \textcolor{comment}{!}}
\DoxyCodeLine{457          \textcolor{keywordflow}{Do} icrs = nmed+1, ndon}
\DoxyCodeLine{458             xwrk = xwrkt(icrs)}
\DoxyCodeLine{459             \textcolor{keywordflow}{If} (xwrk < xwrkt(nmed)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{460                idcr = nmed -\/ 1}
\DoxyCodeLine{461                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{462                   \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{463                   xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{464                   idcr = idcr -\/ 1}
\DoxyCodeLine{465 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{466                xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{467 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{468 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{469          res\_med = xwrkt(nmed)}
\DoxyCodeLine{470          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{471 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{472 \textcolor{comment}{!}}
\DoxyCodeLine{473 \textcolor{comment}{!  Make sorted subsets of 7 elements}}
\DoxyCodeLine{474 \textcolor{comment}{!  This is done by a variant of insertion sort where a first}}
\DoxyCodeLine{475 \textcolor{comment}{!  pass is used to bring the smallest element to the first position}}
\DoxyCodeLine{476 \textcolor{comment}{!  decreasing disorder at the same time, so that we may remove}}
\DoxyCodeLine{477 \textcolor{comment}{!  remove the loop test in the insertion loop.}}
\DoxyCodeLine{478 \textcolor{comment}{!}}
\DoxyCodeLine{479       \textcolor{keywordflow}{DO} ideb = 1, ndon-\/6, 7}
\DoxyCodeLine{480          idcr = ideb + 6}
\DoxyCodeLine{481          \textcolor{keywordflow}{If} (xdont(ideb) < xdont(idcr)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{482             xwrk = xdont(ideb)}
\DoxyCodeLine{483             xwrkt(idcr) = xdont(idcr)}
\DoxyCodeLine{484          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{485             xwrk = xdont(idcr)}
\DoxyCodeLine{486             xwrkt(idcr) = xdont(ideb)}
\DoxyCodeLine{487 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{488          \textcolor{keywordflow}{Do} iwrk = 1, 5}
\DoxyCodeLine{489             idcr = idcr -\/ 1}
\DoxyCodeLine{490             xwrk1 = xdont(idcr)}
\DoxyCodeLine{491             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{492                 xwrkt(idcr) = xwrk}
\DoxyCodeLine{493                 xwrk = xwrk1}
\DoxyCodeLine{494             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{495                 xwrkt(idcr) = xwrk1}
\DoxyCodeLine{496 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{497 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{498          xwrkt(ideb) = xwrk}
\DoxyCodeLine{499          \textcolor{keywordflow}{Do} icrs = ideb+2, ideb+6}
\DoxyCodeLine{500             xwrk = xwrkt(icrs)}
\DoxyCodeLine{501             \textcolor{keywordflow}{If} (xwrk < xwrkt(icrs-\/1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{502                xwrkt(icrs) = xwrkt(icrs-\/1)}
\DoxyCodeLine{503                idcr = icrs -\/ 1}
\DoxyCodeLine{504                xwrk1 = xwrkt(idcr-\/1)}
\DoxyCodeLine{505                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{506                   \textcolor{keywordflow}{If} (xwrk >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{507                   xwrkt(idcr) = xwrk1}
\DoxyCodeLine{508                   idcr = idcr -\/ 1}
\DoxyCodeLine{509                   xwrk1 = xwrkt(idcr-\/1)}
\DoxyCodeLine{510 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{511                xwrkt(idcr) = xwrk}
\DoxyCodeLine{512 \textcolor{keywordflow}{            EndIf}}
\DoxyCodeLine{513 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{514 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{515 \textcolor{comment}{!}}
\DoxyCodeLine{516 \textcolor{comment}{!  Add-\/up alternatively + and -\/ HUGE values to make the number of data}}
\DoxyCodeLine{517 \textcolor{comment}{!  an exact multiple of 7.}}
\DoxyCodeLine{518 \textcolor{comment}{!}}
\DoxyCodeLine{519       ideb = 7 * (ndon/7)}
\DoxyCodeLine{520       ntri = ndon}
\DoxyCodeLine{521       \textcolor{keywordflow}{If} (ideb < ndon) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{522 \textcolor{comment}{!}}
\DoxyCodeLine{523          xwrk1 = xhuge}
\DoxyCodeLine{524          \textcolor{keywordflow}{Do} icrs = ideb+1, ideb+7}
\DoxyCodeLine{525             \textcolor{keywordflow}{If} (icrs <= ndon) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{526                xwrkt(icrs) = xdont(icrs)}
\DoxyCodeLine{527             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{528                \textcolor{keywordflow}{If} (xwrk1 /= xhuge) nmed = nmed + 1}
\DoxyCodeLine{529                xwrkt(icrs) = xwrk1}
\DoxyCodeLine{530                xwrk1 = -\/ xwrk1}
\DoxyCodeLine{531 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{532 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{533 \textcolor{comment}{!}}
\DoxyCodeLine{534          \textcolor{keywordflow}{Do} icrs = ideb+2, ideb+7}
\DoxyCodeLine{535             xwrk = xwrkt(icrs)}
\DoxyCodeLine{536             \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, ideb+1, -\/ 1}
\DoxyCodeLine{537                \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{538                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{539 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{540             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{541 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{542 \textcolor{comment}{!}}
\DoxyCodeLine{543          ntri = ideb+7}
\DoxyCodeLine{544 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{545 \textcolor{comment}{!}}
\DoxyCodeLine{546 \textcolor{comment}{!  Make the set of the indices of median values of each sorted subset}}
\DoxyCodeLine{547 \textcolor{comment}{!}}
\DoxyCodeLine{548          idon1 = 0}
\DoxyCodeLine{549          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{550             idon1 = idon1 + 1}
\DoxyCodeLine{551             imedt(idon1) = idon + 3}
\DoxyCodeLine{552 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{553 \textcolor{comment}{!}}
\DoxyCodeLine{554 \textcolor{comment}{!  Find XMED7, the median of the medians}}
\DoxyCodeLine{555 \textcolor{comment}{!}}
\DoxyCodeLine{556          xmed7 = real32\_valmed(xwrkt(imedt))}
\DoxyCodeLine{557 \textcolor{comment}{!}}
\DoxyCodeLine{558 \textcolor{comment}{!  Count how many values are not higher than (and how many equal to) XMED7}}
\DoxyCodeLine{559 \textcolor{comment}{!  This number is at least 4 * 1/2 * (N/7) : 4 values in each of the}}
\DoxyCodeLine{560 \textcolor{comment}{!  subsets where the median is lower than the median of medians. For similar}}
\DoxyCodeLine{561 \textcolor{comment}{!  reasons, we also have at least 2N/7 values not lower than XMED7. At the}}
\DoxyCodeLine{562 \textcolor{comment}{!  same time, we find in each subset the index of the last value < XMED7,}}
\DoxyCodeLine{563 \textcolor{comment}{!  and that of the first > XMED7. These indices will be used to restrict the}}
\DoxyCodeLine{564 \textcolor{comment}{!  search for the median as the Kth element in the subset (> or <) where}}
\DoxyCodeLine{565 \textcolor{comment}{!  we know it to be.}}
\DoxyCodeLine{566 \textcolor{comment}{!}}
\DoxyCodeLine{567          idon1 = 1}
\DoxyCodeLine{568          nleq = 0}
\DoxyCodeLine{569          nequ = 0}
\DoxyCodeLine{570          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{571             imed = idon+3}
\DoxyCodeLine{572             \textcolor{keywordflow}{If} (xwrkt(imed) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{573                   imed = imed -\/ 2}
\DoxyCodeLine{574                   \textcolor{keywordflow}{If} (xwrkt(imed) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{575                      imed = imed -\/ 1}
\DoxyCodeLine{576                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xwrkt(imed) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{577                      imed = imed + 1}
\DoxyCodeLine{578 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{579             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xwrkt(imed) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{580                   imed = imed + 2}
\DoxyCodeLine{581                   \textcolor{keywordflow}{If} (xwrkt(imed) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{582                      imed = imed -\/ 1}
\DoxyCodeLine{583                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xwrkt(imed) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{584                      imed = imed + 1}
\DoxyCodeLine{585 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{586 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{587             \textcolor{keywordflow}{If} (xwrkt(imed) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{588                nleq = nleq + imed -\/ idon}
\DoxyCodeLine{589                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{590                istrt(idon1) = imed}
\DoxyCodeLine{591             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xwrkt(imed) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{592                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{593                iendt(idon1) = imed}
\DoxyCodeLine{594                istrt(idon1) = imed + 1}
\DoxyCodeLine{595             \textcolor{keywordflow}{Else}                    \textcolor{comment}{!       If (XWRKT (IMED) == XMED7)}}
\DoxyCodeLine{596                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{597                nequ = nequ + 1}
\DoxyCodeLine{598                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{599                \textcolor{keywordflow}{Do} imed1 = imed -\/ 1, idon, -\/1}
\DoxyCodeLine{600                   \textcolor{keywordflow}{If} (xwrkt(imed1) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{601                      nequ = nequ + 1}
\DoxyCodeLine{602                      iendt(idon1) = imed1 -\/ 1}
\DoxyCodeLine{603                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{604                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{605 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{606 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{607                istrt(idon1) = imed + 1}
\DoxyCodeLine{608                \textcolor{keywordflow}{Do} imed1 = imed + 1, idon + 6}
\DoxyCodeLine{609                   \textcolor{keywordflow}{If} (xwrkt(imed1) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{610                      nequ = nequ + 1}
\DoxyCodeLine{611                      nleq = nleq + 1}
\DoxyCodeLine{612                      istrt(idon1) = imed1 + 1}
\DoxyCodeLine{613                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{614                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{615 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{616 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{617 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{618             idon1 = idon1 + 1}
\DoxyCodeLine{619 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{620 \textcolor{comment}{!}}
\DoxyCodeLine{621 \textcolor{comment}{!  Carry out a partial insertion sort to find the Kth smallest of the}}
\DoxyCodeLine{622 \textcolor{comment}{!  large values, or the Kth largest of the small values, according to}}
\DoxyCodeLine{623 \textcolor{comment}{!  what is needed.}}
\DoxyCodeLine{624 \textcolor{comment}{!}}
\DoxyCodeLine{625         \textcolor{keywordflow}{If} (nleq -\/ nequ + 1 <= nmed) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{626             \textcolor{keywordflow}{If} (nleq < nmed) \textcolor{keywordflow}{Then}   \textcolor{comment}{!      Not enough low values}}
\DoxyCodeLine{627                 xwrk1 = xhuge}
\DoxyCodeLine{628                 nord = nmed -\/ nleq}
\DoxyCodeLine{629                 idon1 = 0}
\DoxyCodeLine{630                 icrs1 = 1}
\DoxyCodeLine{631                 icrs2 = 0}
\DoxyCodeLine{632                 idcr = 0}
\DoxyCodeLine{633                \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{634                    idon1 = idon1 + 1}
\DoxyCodeLine{635                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{636                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{637                          \textcolor{keywordflow}{If} (xwrkt(icrs) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{638                             xwrk = xwrkt(icrs)}
\DoxyCodeLine{639                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{640                                \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{641                                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{642 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{643                             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{644                             xwrk1 = xwrkt(icrs1)}
\DoxyCodeLine{645                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{646                            \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{647                               xwrkt(icrs1) = xwrkt(icrs)}
\DoxyCodeLine{648                               xwrk1 = xwrkt(icrs1)}
\DoxyCodeLine{649 \textcolor{keywordflow}{                           Endif}}
\DoxyCodeLine{650 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{651                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{652                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{653 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{654                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{655                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{656                          \textcolor{keywordflow}{If} (xwrkt(icrs) >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{657                          xwrk = xwrkt(icrs)}
\DoxyCodeLine{658                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{659                                \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{660                                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{661 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{662                          xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{663                          xwrk1 = xwrkt(icrs1)}
\DoxyCodeLine{664 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{665 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{666 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{667                 res\_med = xwrk1}
\DoxyCodeLine{668                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{669             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{670                 res\_med = xmed7}
\DoxyCodeLine{671                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{672 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{673          \textcolor{keywordflow}{Else}                       \textcolor{comment}{!      If (NLEQ > NMED)}}
\DoxyCodeLine{674 \textcolor{comment}{!                                          Not enough high values}}
\DoxyCodeLine{675                 xwrk1 = -\/xhuge}
\DoxyCodeLine{676                 nord = nleq -\/ nequ -\/ nmed + 1}
\DoxyCodeLine{677                 idon1 = 0}
\DoxyCodeLine{678                 icrs1 = 1}
\DoxyCodeLine{679                 icrs2 = 0}
\DoxyCodeLine{680                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{681                    idon1 = idon1 + 1}
\DoxyCodeLine{682                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{683 \textcolor{comment}{!}}
\DoxyCodeLine{684                       \textcolor{keywordflow}{Do} icrs = idon, iendt(idon1)}
\DoxyCodeLine{685                          \textcolor{keywordflow}{If} (xwrkt(icrs) > xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{686                             xwrk = xwrkt(icrs)}
\DoxyCodeLine{687                             idcr = icrs1 -\/ 1}
\DoxyCodeLine{688                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{689                                \textcolor{keywordflow}{If} (xwrk <= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{690                                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{691 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{692                             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{693                             xwrk1 = xwrkt(icrs1)}
\DoxyCodeLine{694                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{695                             \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{696                                xwrkt(icrs1) = xwrkt(icrs)}
\DoxyCodeLine{697                                xwrk1 = xwrkt(icrs1)}
\DoxyCodeLine{698 \textcolor{keywordflow}{                            End If}}
\DoxyCodeLine{699 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{700                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{701                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{702 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{703                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{704                       \textcolor{keywordflow}{Do} icrs = iendt(idon1), idon, -\/1}
\DoxyCodeLine{705                          \textcolor{keywordflow}{If} (xwrkt(icrs) > xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{706                             xwrk = xwrkt(icrs)}
\DoxyCodeLine{707                             idcr = icrs1 -\/ 1}
\DoxyCodeLine{708                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{709                                \textcolor{keywordflow}{If} (xwrk <= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{710                                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{711 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{712                             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{713                             xwrk1 = xwrkt(icrs1)}
\DoxyCodeLine{714                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{715                             \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{716 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{717 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{718 \textcolor{keywordflow}{                   Endif}}
\DoxyCodeLine{719 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{720 \textcolor{comment}{!}}
\DoxyCodeLine{721                 res\_med = xwrk1}
\DoxyCodeLine{722                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{723 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{724 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__valmed_a79bfc922a940113afbb31745215b7ddb}\label{namespacem__valmed_a79bfc922a940113afbb31745215b7ddb}} 
\index{m\_valmed@{m\_valmed}!real64\_valmed@{real64\_valmed}}
\index{real64\_valmed@{real64\_valmed}!m\_valmed@{m\_valmed}}
\doxysubsubsection{\texorpdfstring{real64\_valmed()}{real64\_valmed()}}
{\footnotesize\ttfamily recursive real (kind=real64) function m\+\_\+valmed\+::real64\+\_\+valmed (\begin{DoxyParamCaption}\item[{real (kind=real64), dimension (\+:), intent(in)}]{X\+D\+O\+NT }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\hypertarget{namespacem__valmed_autotoc_md138}{}\doxysubsubsection{N\+A\+ME}\label{namespacem__valmed_autotoc_md138}
valmed(3f) -\/ \mbox{[}orderpack\+:M\+E\+D\+I\+AN\mbox{]} finds the median of an array, averaging the two central values when size of array is even.\hypertarget{namespacem__valmed_autotoc_md139}{}\doxysubsubsection{S\+Y\+N\+O\+P\+S\+IS}\label{namespacem__valmed_autotoc_md139}
\begin{DoxyVerb} Recursive Function ${KIND}_valmed (XDONT) Result (res_med)

   ${TYPE} (kind=${KIND}), Dimension (:), Intent (In) :: XDONT
   ${TYPE} (kind=${KIND}) :: res_med

Where ${TYPE}(kind=${KIND}) may be

   o Real(kind=real32)
   o Real(kind=real64)
   o Integer(kind=int32)
\end{DoxyVerb}
\hypertarget{namespacem__valmed_autotoc_md140}{}\doxysubsubsection{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}\label{namespacem__valmed_autotoc_md140}
\begin{DoxyVerb}Finds the median of XDONT using the recursive procedure described in
Knuth, The Art of Computer Programming, vol. 3, 5.3.3 - This procedure
is linear in time, and does not require to be able to interpolate
in the set as the one used in INDNTH. It also has better worst case
behavior than INDNTH, but is about 30% slower on average for random
uniformly distributed values.
\end{DoxyVerb}
\hypertarget{namespacem__valmed_autotoc_md141}{}\doxysubsubsection{O\+P\+T\+I\+O\+NS}\label{namespacem__valmed_autotoc_md141}
X\+D\+O\+NT input array\hypertarget{namespacem__valmed_autotoc_md142}{}\doxysubsubsection{R\+E\+T\+U\+R\+NS}\label{namespacem__valmed_autotoc_md142}
R\+E\+S\+\_\+\+M\+ED the median value of the array X\+D\+O\+NT\hypertarget{namespacem__valmed_autotoc_md143}{}\doxysubsubsection{E\+X\+A\+M\+P\+L\+ES}\label{namespacem__valmed_autotoc_md143}
Sample program\+:

program demo\+\_\+valmed use M\+\_\+valmed, only \+: valmed implicit none real,parameter \+:: xdont($\ast$)=\mbox{[}80.\+0,70.\+0,20.\+0,10.\+0,1000.\+0\mbox{]} real res\+\_\+med write($\ast$,$\ast$)valmed(xdont) write($\ast$, $\ast$)valmed(\mbox{[}11, 22, 33, 44, 55, 66, 77, 88\mbox{]}) write($\ast$, $\ast$)valmed(\mbox{[}11.\+0d0, 22.\+0d0, 33.\+0d0, 66.\+0d0, 77.\+0d0, 88.\+0d0\mbox{]}) end program demo\+\_\+valmed

Results\+:

$>$ 70.\+00000 $>$ 44 $>$ 33.\+0000000000000\hypertarget{namespacem__valmed_autotoc_md144}{}\doxysubsubsection{A\+U\+T\+H\+OR}\label{namespacem__valmed_autotoc_md144}
Michel Olagnon, 2000-\/2012

John Urban, 2022.\+04.\+16 o added man-\/page and reduced to a template using the prep(1) preprocessor.\hypertarget{namespacem__valmed_autotoc_md145}{}\doxysubsubsection{L\+I\+C\+E\+N\+SE}\label{namespacem__valmed_autotoc_md145}
C\+C0-\/1.\+0 
\begin{DoxyCode}{0}
\DoxyCodeLine{73 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{74 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{75 \textcolor{keywordtype}{      Real} (kind=real64) :: res\_med}
\DoxyCodeLine{76 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{77 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Parameter} :: xhuge = huge(xdont)}
\DoxyCodeLine{78 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Dimension (SIZE(XDONT)+6)} :: xwrkt}
\DoxyCodeLine{79 \textcolor{keywordtype}{      Real} (kind=real64) :: xwrk, xwrk1, xmed7}
\DoxyCodeLine{80 \textcolor{comment}{!}}
\DoxyCodeLine{81       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension ((SIZE(XDONT)+6)/7)} :: ISTRT, IENDT, IMEDT}
\DoxyCodeLine{82       \textcolor{keywordtype}{Integer} :: NDON, NTRI, NMED, NORD, NEQU, NLEQ, IMED, IDON, IDON1}
\DoxyCodeLine{83       \textcolor{keywordtype}{Integer} :: IDEB, IWRK, IDCR, ICRS, ICRS1, ICRS2, IMED1}
\DoxyCodeLine{84 \textcolor{comment}{!}}
\DoxyCodeLine{85       ndon = \textcolor{keyword}{SIZE} (xdont)}
\DoxyCodeLine{86       nmed = (ndon+1) / 2}
\DoxyCodeLine{87 \textcolor{comment}{!      write(unit=*,fmt=*) NMED, NDON}}
\DoxyCodeLine{88 \textcolor{comment}{!}}
\DoxyCodeLine{89 \textcolor{comment}{!  If the number of values is small, then use insertion sort}}
\DoxyCodeLine{90 \textcolor{comment}{!}}
\DoxyCodeLine{91       \textcolor{keywordflow}{If} (ndon < 35) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{92 \textcolor{comment}{!}}
\DoxyCodeLine{93 \textcolor{comment}{!  Bring minimum to first location to save test in decreasing loop}}
\DoxyCodeLine{94 \textcolor{comment}{!}}
\DoxyCodeLine{95          idcr = ndon}
\DoxyCodeLine{96          \textcolor{keywordflow}{If} (xdont(1) < xdont(ndon)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{97             xwrk = xdont(1)}
\DoxyCodeLine{98             xwrkt(idcr) = xdont(idcr)}
\DoxyCodeLine{99          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{100             xwrk = xdont(idcr)}
\DoxyCodeLine{101             xwrkt(idcr) = xdont(1)}
\DoxyCodeLine{102 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{103          \textcolor{keywordflow}{Do} iwrk = 1, ndon -\/ 2}
\DoxyCodeLine{104             idcr = idcr -\/ 1}
\DoxyCodeLine{105             xwrk1 = xdont(idcr)}
\DoxyCodeLine{106             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{107                 xwrkt(idcr) = xwrk}
\DoxyCodeLine{108                 xwrk = xwrk1}
\DoxyCodeLine{109             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{110                 xwrkt(idcr) = xwrk1}
\DoxyCodeLine{111 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{112 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{113          xwrkt(1) = xwrk}
\DoxyCodeLine{114 \textcolor{comment}{!}}
\DoxyCodeLine{115 \textcolor{comment}{! Sort the first half, until we have NMED sorted values}}
\DoxyCodeLine{116 \textcolor{comment}{!}}
\DoxyCodeLine{117          \textcolor{keywordflow}{Do} icrs = 3, nmed}
\DoxyCodeLine{118             xwrk = xwrkt(icrs)}
\DoxyCodeLine{119                idcr = icrs -\/ 1}
\DoxyCodeLine{120                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{121                   \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{122                   xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{123                   idcr = idcr -\/ 1}
\DoxyCodeLine{124 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{125             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{126 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{127 \textcolor{comment}{!}}
\DoxyCodeLine{128 \textcolor{comment}{!  Insert any value less than the current median in the first half}}
\DoxyCodeLine{129 \textcolor{comment}{!}}
\DoxyCodeLine{130          \textcolor{keywordflow}{Do} icrs = nmed+1, ndon}
\DoxyCodeLine{131             xwrk = xwrkt(icrs)}
\DoxyCodeLine{132             \textcolor{keywordflow}{If} (xwrk < xwrkt(nmed)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{133                idcr = nmed -\/ 1}
\DoxyCodeLine{134                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{135                   \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{136                   xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{137                   idcr = idcr -\/ 1}
\DoxyCodeLine{138 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{139                xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{140 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{141 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{142          res\_med = xwrkt(nmed)}
\DoxyCodeLine{143          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{144 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{145 \textcolor{comment}{!}}
\DoxyCodeLine{146 \textcolor{comment}{!  Make sorted subsets of 7 elements}}
\DoxyCodeLine{147 \textcolor{comment}{!  This is done by a variant of insertion sort where a first}}
\DoxyCodeLine{148 \textcolor{comment}{!  pass is used to bring the smallest element to the first position}}
\DoxyCodeLine{149 \textcolor{comment}{!  decreasing disorder at the same time, so that we may remove}}
\DoxyCodeLine{150 \textcolor{comment}{!  remove the loop test in the insertion loop.}}
\DoxyCodeLine{151 \textcolor{comment}{!}}
\DoxyCodeLine{152       \textcolor{keywordflow}{DO} ideb = 1, ndon-\/6, 7}
\DoxyCodeLine{153          idcr = ideb + 6}
\DoxyCodeLine{154          \textcolor{keywordflow}{If} (xdont(ideb) < xdont(idcr)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{155             xwrk = xdont(ideb)}
\DoxyCodeLine{156             xwrkt(idcr) = xdont(idcr)}
\DoxyCodeLine{157          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{158             xwrk = xdont(idcr)}
\DoxyCodeLine{159             xwrkt(idcr) = xdont(ideb)}
\DoxyCodeLine{160 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{161          \textcolor{keywordflow}{Do} iwrk = 1, 5}
\DoxyCodeLine{162             idcr = idcr -\/ 1}
\DoxyCodeLine{163             xwrk1 = xdont(idcr)}
\DoxyCodeLine{164             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{165                 xwrkt(idcr) = xwrk}
\DoxyCodeLine{166                 xwrk = xwrk1}
\DoxyCodeLine{167             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{168                 xwrkt(idcr) = xwrk1}
\DoxyCodeLine{169 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{170 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{171          xwrkt(ideb) = xwrk}
\DoxyCodeLine{172          \textcolor{keywordflow}{Do} icrs = ideb+2, ideb+6}
\DoxyCodeLine{173             xwrk = xwrkt(icrs)}
\DoxyCodeLine{174             \textcolor{keywordflow}{If} (xwrk < xwrkt(icrs-\/1)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{175                xwrkt(icrs) = xwrkt(icrs-\/1)}
\DoxyCodeLine{176                idcr = icrs -\/ 1}
\DoxyCodeLine{177                xwrk1 = xwrkt(idcr-\/1)}
\DoxyCodeLine{178                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{179                   \textcolor{keywordflow}{If} (xwrk >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{180                   xwrkt(idcr) = xwrk1}
\DoxyCodeLine{181                   idcr = idcr -\/ 1}
\DoxyCodeLine{182                   xwrk1 = xwrkt(idcr-\/1)}
\DoxyCodeLine{183 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{184                xwrkt(idcr) = xwrk}
\DoxyCodeLine{185 \textcolor{keywordflow}{            EndIf}}
\DoxyCodeLine{186 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{187 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{188 \textcolor{comment}{!}}
\DoxyCodeLine{189 \textcolor{comment}{!  Add-\/up alternatively + and -\/ HUGE values to make the number of data}}
\DoxyCodeLine{190 \textcolor{comment}{!  an exact multiple of 7.}}
\DoxyCodeLine{191 \textcolor{comment}{!}}
\DoxyCodeLine{192       ideb = 7 * (ndon/7)}
\DoxyCodeLine{193       ntri = ndon}
\DoxyCodeLine{194       \textcolor{keywordflow}{If} (ideb < ndon) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{195 \textcolor{comment}{!}}
\DoxyCodeLine{196          xwrk1 = xhuge}
\DoxyCodeLine{197          \textcolor{keywordflow}{Do} icrs = ideb+1, ideb+7}
\DoxyCodeLine{198             \textcolor{keywordflow}{If} (icrs <= ndon) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{199                xwrkt(icrs) = xdont(icrs)}
\DoxyCodeLine{200             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{201                \textcolor{keywordflow}{If} (xwrk1 /= xhuge) nmed = nmed + 1}
\DoxyCodeLine{202                xwrkt(icrs) = xwrk1}
\DoxyCodeLine{203                xwrk1 = -\/ xwrk1}
\DoxyCodeLine{204 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{205 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{206 \textcolor{comment}{!}}
\DoxyCodeLine{207          \textcolor{keywordflow}{Do} icrs = ideb+2, ideb+7}
\DoxyCodeLine{208             xwrk = xwrkt(icrs)}
\DoxyCodeLine{209             \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, ideb+1, -\/ 1}
\DoxyCodeLine{210                \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{211                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{212 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{213             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{214 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{215 \textcolor{comment}{!}}
\DoxyCodeLine{216          ntri = ideb+7}
\DoxyCodeLine{217 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{218 \textcolor{comment}{!}}
\DoxyCodeLine{219 \textcolor{comment}{!  Make the set of the indices of median values of each sorted subset}}
\DoxyCodeLine{220 \textcolor{comment}{!}}
\DoxyCodeLine{221          idon1 = 0}
\DoxyCodeLine{222          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{223             idon1 = idon1 + 1}
\DoxyCodeLine{224             imedt(idon1) = idon + 3}
\DoxyCodeLine{225 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{226 \textcolor{comment}{!}}
\DoxyCodeLine{227 \textcolor{comment}{!  Find XMED7, the median of the medians}}
\DoxyCodeLine{228 \textcolor{comment}{!}}
\DoxyCodeLine{229          xmed7 = real64\_valmed(xwrkt(imedt))}
\DoxyCodeLine{230 \textcolor{comment}{!}}
\DoxyCodeLine{231 \textcolor{comment}{!  Count how many values are not higher than (and how many equal to) XMED7}}
\DoxyCodeLine{232 \textcolor{comment}{!  This number is at least 4 * 1/2 * (N/7) : 4 values in each of the}}
\DoxyCodeLine{233 \textcolor{comment}{!  subsets where the median is lower than the median of medians. For similar}}
\DoxyCodeLine{234 \textcolor{comment}{!  reasons, we also have at least 2N/7 values not lower than XMED7. At the}}
\DoxyCodeLine{235 \textcolor{comment}{!  same time, we find in each subset the index of the last value < XMED7,}}
\DoxyCodeLine{236 \textcolor{comment}{!  and that of the first > XMED7. These indices will be used to restrict the}}
\DoxyCodeLine{237 \textcolor{comment}{!  search for the median as the Kth element in the subset (> or <) where}}
\DoxyCodeLine{238 \textcolor{comment}{!  we know it to be.}}
\DoxyCodeLine{239 \textcolor{comment}{!}}
\DoxyCodeLine{240          idon1 = 1}
\DoxyCodeLine{241          nleq = 0}
\DoxyCodeLine{242          nequ = 0}
\DoxyCodeLine{243          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{244             imed = idon+3}
\DoxyCodeLine{245             \textcolor{keywordflow}{If} (xwrkt(imed) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{246                   imed = imed -\/ 2}
\DoxyCodeLine{247                   \textcolor{keywordflow}{If} (xwrkt(imed) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{248                      imed = imed -\/ 1}
\DoxyCodeLine{249                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xwrkt(imed) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{250                      imed = imed + 1}
\DoxyCodeLine{251 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{252             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xwrkt(imed) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{253                   imed = imed + 2}
\DoxyCodeLine{254                   \textcolor{keywordflow}{If} (xwrkt(imed) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{255                      imed = imed -\/ 1}
\DoxyCodeLine{256                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xwrkt(imed) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{257                      imed = imed + 1}
\DoxyCodeLine{258 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{259 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{260             \textcolor{keywordflow}{If} (xwrkt(imed) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{261                nleq = nleq + imed -\/ idon}
\DoxyCodeLine{262                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{263                istrt(idon1) = imed}
\DoxyCodeLine{264             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xwrkt(imed) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{265                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{266                iendt(idon1) = imed}
\DoxyCodeLine{267                istrt(idon1) = imed + 1}
\DoxyCodeLine{268             \textcolor{keywordflow}{Else}                    \textcolor{comment}{!       If (XWRKT (IMED) == XMED7)}}
\DoxyCodeLine{269                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{270                nequ = nequ + 1}
\DoxyCodeLine{271                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{272                \textcolor{keywordflow}{Do} imed1 = imed -\/ 1, idon, -\/1}
\DoxyCodeLine{273                   \textcolor{keywordflow}{If} (xwrkt(imed1) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{274                      nequ = nequ + 1}
\DoxyCodeLine{275                      iendt(idon1) = imed1 -\/ 1}
\DoxyCodeLine{276                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{277                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{278 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{279 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{280                istrt(idon1) = imed + 1}
\DoxyCodeLine{281                \textcolor{keywordflow}{Do} imed1 = imed + 1, idon + 6}
\DoxyCodeLine{282                   \textcolor{keywordflow}{If} (xwrkt(imed1) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{283                      nequ = nequ + 1}
\DoxyCodeLine{284                      nleq = nleq + 1}
\DoxyCodeLine{285                      istrt(idon1) = imed1 + 1}
\DoxyCodeLine{286                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{287                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{288 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{289 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{290 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{291             idon1 = idon1 + 1}
\DoxyCodeLine{292 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{293 \textcolor{comment}{!}}
\DoxyCodeLine{294 \textcolor{comment}{!  Carry out a partial insertion sort to find the Kth smallest of the}}
\DoxyCodeLine{295 \textcolor{comment}{!  large values, or the Kth largest of the small values, according to}}
\DoxyCodeLine{296 \textcolor{comment}{!  what is needed.}}
\DoxyCodeLine{297 \textcolor{comment}{!}}
\DoxyCodeLine{298         \textcolor{keywordflow}{If} (nleq -\/ nequ + 1 <= nmed) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{299             \textcolor{keywordflow}{If} (nleq < nmed) \textcolor{keywordflow}{Then}   \textcolor{comment}{!      Not enough low values}}
\DoxyCodeLine{300                 xwrk1 = xhuge}
\DoxyCodeLine{301                 nord = nmed -\/ nleq}
\DoxyCodeLine{302                 idon1 = 0}
\DoxyCodeLine{303                 icrs1 = 1}
\DoxyCodeLine{304                 icrs2 = 0}
\DoxyCodeLine{305                 idcr = 0}
\DoxyCodeLine{306                \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{307                    idon1 = idon1 + 1}
\DoxyCodeLine{308                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{309                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{310                          \textcolor{keywordflow}{If} (xwrkt(icrs) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{311                             xwrk = xwrkt(icrs)}
\DoxyCodeLine{312                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{313                                \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{314                                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{315 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{316                             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{317                             xwrk1 = xwrkt(icrs1)}
\DoxyCodeLine{318                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{319                            \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{320                               xwrkt(icrs1) = xwrkt(icrs)}
\DoxyCodeLine{321                               xwrk1 = xwrkt(icrs1)}
\DoxyCodeLine{322 \textcolor{keywordflow}{                           Endif}}
\DoxyCodeLine{323 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{324                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{325                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{326 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{327                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{328                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{329                          \textcolor{keywordflow}{If} (xwrkt(icrs) >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{330                          xwrk = xwrkt(icrs)}
\DoxyCodeLine{331                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{332                                \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{333                                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{334 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{335                          xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{336                          xwrk1 = xwrkt(icrs1)}
\DoxyCodeLine{337 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{338 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{339 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{340                 res\_med = xwrk1}
\DoxyCodeLine{341                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{342             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{343                 res\_med = xmed7}
\DoxyCodeLine{344                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{345 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{346          \textcolor{keywordflow}{Else}                       \textcolor{comment}{!      If (NLEQ > NMED)}}
\DoxyCodeLine{347 \textcolor{comment}{!                                          Not enough high values}}
\DoxyCodeLine{348                 xwrk1 = -\/xhuge}
\DoxyCodeLine{349                 nord = nleq -\/ nequ -\/ nmed + 1}
\DoxyCodeLine{350                 idon1 = 0}
\DoxyCodeLine{351                 icrs1 = 1}
\DoxyCodeLine{352                 icrs2 = 0}
\DoxyCodeLine{353                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{354                    idon1 = idon1 + 1}
\DoxyCodeLine{355                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{356 \textcolor{comment}{!}}
\DoxyCodeLine{357                       \textcolor{keywordflow}{Do} icrs = idon, iendt(idon1)}
\DoxyCodeLine{358                          \textcolor{keywordflow}{If} (xwrkt(icrs) > xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{359                             xwrk = xwrkt(icrs)}
\DoxyCodeLine{360                             idcr = icrs1 -\/ 1}
\DoxyCodeLine{361                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{362                                \textcolor{keywordflow}{If} (xwrk <= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{363                                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{364 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{365                             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{366                             xwrk1 = xwrkt(icrs1)}
\DoxyCodeLine{367                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{368                             \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{369                                xwrkt(icrs1) = xwrkt(icrs)}
\DoxyCodeLine{370                                xwrk1 = xwrkt(icrs1)}
\DoxyCodeLine{371 \textcolor{keywordflow}{                            End If}}
\DoxyCodeLine{372 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{373                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{374                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{375 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{376                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{377                       \textcolor{keywordflow}{Do} icrs = iendt(idon1), idon, -\/1}
\DoxyCodeLine{378                          \textcolor{keywordflow}{If} (xwrkt(icrs) > xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{379                             xwrk = xwrkt(icrs)}
\DoxyCodeLine{380                             idcr = icrs1 -\/ 1}
\DoxyCodeLine{381                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{382                                \textcolor{keywordflow}{If} (xwrk <= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{383                                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{384 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{385                             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{386                             xwrk1 = xwrkt(icrs1)}
\DoxyCodeLine{387                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{388                             \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{389 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{390 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{391 \textcolor{keywordflow}{                   Endif}}
\DoxyCodeLine{392 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{393 \textcolor{comment}{!}}
\DoxyCodeLine{394                 res\_med = xwrk1}
\DoxyCodeLine{395                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{396 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{397 \textcolor{comment}{!}}

\end{DoxyCode}
