\hypertarget{namespacem__indmed}{}\doxysection{m\+\_\+indmed Module Reference}
\label{namespacem__indmed}\index{m\_indmed@{m\_indmed}}
\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface \mbox{\hyperlink{interfacem__indmed_1_1indmed}{indmed}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacem__indmed_a7a46817d54880450b7e336fd8ff0cda1}{real64\+\_\+indmed}} (X\+D\+O\+NT, I\+N\+DM)
\item 
recursive subroutine \mbox{\hyperlink{namespacem__indmed_a82d4f27afcb6802376dfbebacaf594fc}{real64\+\_\+med}} (X\+D\+A\+TT, I\+D\+A\+TT, ires\+\_\+med)
\item 
subroutine \mbox{\hyperlink{namespacem__indmed_a96f8c79a86271850577766f6c81cde27}{real32\+\_\+indmed}} (X\+D\+O\+NT, I\+N\+DM)
\item 
recursive subroutine \mbox{\hyperlink{namespacem__indmed_abb66bb589821afa90ddd8bda8fcf609b}{real32\+\_\+med}} (X\+D\+A\+TT, I\+D\+A\+TT, ires\+\_\+med)
\item 
subroutine \mbox{\hyperlink{namespacem__indmed_a211456dadf6ffe889bf00b7c5ba77c10}{int32\+\_\+indmed}} (X\+D\+O\+NT, I\+N\+DM)
\item 
recursive subroutine \mbox{\hyperlink{namespacem__indmed_a7a7a1cbb857bc1672280ab38e8abe92b}{int32\+\_\+med}} (X\+D\+A\+TT, I\+D\+A\+TT, ires\+\_\+med)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
integer, dimension(\+:), allocatable, save, private \mbox{\hyperlink{namespacem__indmed_ad17c2a3bf73f372ad2d9ea60e151ee23}{idont}}
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacem__indmed_a211456dadf6ffe889bf00b7c5ba77c10}\label{namespacem__indmed_a211456dadf6ffe889bf00b7c5ba77c10}} 
\index{m\_indmed@{m\_indmed}!int32\_indmed@{int32\_indmed}}
\index{int32\_indmed@{int32\_indmed}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{int32\_indmed()}{int32\_indmed()}}
{\footnotesize\ttfamily subroutine m\+\_\+indmed\+::int32\+\_\+indmed (\begin{DoxyParamCaption}\item[{integer (kind=int32), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, intent(out)}]{I\+N\+DM }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{854       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDONT}
\DoxyCodeLine{855       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: INDM}
\DoxyCodeLine{856 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{857       \textcolor{keywordtype}{Integer} :: IDON}
\DoxyCodeLine{858 \textcolor{comment}{!}}
\DoxyCodeLine{859       \textcolor{keyword}{Allocate} (idont(\textcolor{keyword}{SIZE}(xdont)))}
\DoxyCodeLine{860       \textcolor{keywordflow}{Do} idon = 1, \textcolor{keyword}{SIZE}(xdont)}
\DoxyCodeLine{861          idont(idon) = idon}
\DoxyCodeLine{862 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{863 \textcolor{comment}{!}}
\DoxyCodeLine{864       \textcolor{keyword}{Call }int32\_med (xdont, idont, indm)}
\DoxyCodeLine{865 \textcolor{comment}{!}}
\DoxyCodeLine{866       \textcolor{keyword}{Deallocate} (idont)}

\end{DoxyCode}


References idont, and int32\+\_\+med().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__indmed_a211456dadf6ffe889bf00b7c5ba77c10_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_a7a7a1cbb857bc1672280ab38e8abe92b}\label{namespacem__indmed_a7a7a1cbb857bc1672280ab38e8abe92b}} 
\index{m\_indmed@{m\_indmed}!int32\_med@{int32\_med}}
\index{int32\_med@{int32\_med}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{int32\_med()}{int32\_med()}}
{\footnotesize\ttfamily recursive subroutine m\+\_\+indmed\+::int32\+\_\+med (\begin{DoxyParamCaption}\item[{integer (kind=int32), dimension (\+:), intent(in)}]{X\+D\+A\+TT,  }\item[{integer, dimension (\+:), intent(in)}]{I\+D\+A\+TT,  }\item[{integer, intent(out)}]{ires\+\_\+med }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{870       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDATT}
\DoxyCodeLine{871       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: IDATT}
\DoxyCodeLine{872       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)}:: ires\_med}
\DoxyCodeLine{873 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{874 \textcolor{comment}{!}}
\DoxyCodeLine{875       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Parameter} :: XHUGE = huge (xdatt)}
\DoxyCodeLine{876       \textcolor{keywordtype}{Integer (kind=int32)} :: XWRK, XWRK1, XMED7, XMAX, XMIN}
\DoxyCodeLine{877 \textcolor{comment}{!}}
\DoxyCodeLine{878       \textcolor{keywordtype}{Integer}, Dimension (7*(((Size (IDATT)+6)/7+6)/7)) :: ISTRT, IENDT,\textcolor{comment}{ IMEDT}}
\DoxyCodeLine{879 \textcolor{comment}{      }\textcolor{keywordtype}{Integer}, Dimension (7*((Size(IDATT)+6)/7)) :: IWRKT}
\DoxyCodeLine{880       \textcolor{keywordtype}{Integer} :: NTRI, NMED, NORD, NEQU, NLEQ, IMED, IDON, IDON1}
\DoxyCodeLine{881       \textcolor{keywordtype}{Integer} :: IDEB, ITMP, IDCR, ICRS, ICRS1, ICRS2, IMAX, IMIN}
\DoxyCodeLine{882       \textcolor{keywordtype}{Integer} :: IWRK, IWRK1, IMED1, IMED7, NDAT}
\DoxyCodeLine{883 \textcolor{comment}{!}}
\DoxyCodeLine{884       ndat = \textcolor{keyword}{Size} (idatt)}
\DoxyCodeLine{885       nmed = (ndat+1) / 2}
\DoxyCodeLine{886       iwrkt = idatt}
\DoxyCodeLine{887 \textcolor{comment}{!}}
\DoxyCodeLine{888 \textcolor{comment}{!  If the number of values is small, then use insertion sort}}
\DoxyCodeLine{889 \textcolor{comment}{!}}
\DoxyCodeLine{890      \textcolor{keywordflow}{If} (ndat < 35) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{891 \textcolor{comment}{!}}
\DoxyCodeLine{892 \textcolor{comment}{!  Bring minimum to first location to save test in decreasing loop}}
\DoxyCodeLine{893 \textcolor{comment}{!}}
\DoxyCodeLine{894          idcr = ndat}
\DoxyCodeLine{895          \textcolor{keywordflow}{If} (xdatt(iwrkt(1)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{896             iwrk = iwrkt(1)}
\DoxyCodeLine{897          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{898             iwrk = iwrkt(idcr)}
\DoxyCodeLine{899             iwrkt(idcr) = iwrkt(1)}
\DoxyCodeLine{900 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{901          xwrk = xdatt(iwrk)}
\DoxyCodeLine{902          \textcolor{keywordflow}{Do} itmp = 1, ndat -\/ 2}
\DoxyCodeLine{903             idcr = idcr -\/ 1}
\DoxyCodeLine{904             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{905             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{906             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{907                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{908                 xwrk = xwrk1}
\DoxyCodeLine{909                 iwrk = iwrk1}
\DoxyCodeLine{910 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{911 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{912          iwrkt(1) = iwrk}
\DoxyCodeLine{913 \textcolor{comment}{!}}
\DoxyCodeLine{914 \textcolor{comment}{! Sort the first half, until we have NMED sorted values}}
\DoxyCodeLine{915 \textcolor{comment}{!}}
\DoxyCodeLine{916          \textcolor{keywordflow}{Do} icrs = 3, nmed}
\DoxyCodeLine{917             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{918             iwrk = iwrkt(icrs)}
\DoxyCodeLine{919             idcr = icrs -\/ 1}
\DoxyCodeLine{920             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{921                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{922                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{923                   idcr = idcr -\/ 1}
\DoxyCodeLine{924 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{925             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{926 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{927 \textcolor{comment}{!}}
\DoxyCodeLine{928 \textcolor{comment}{!  Insert any value less than the current median in the first half}}
\DoxyCodeLine{929 \textcolor{comment}{!}}
\DoxyCodeLine{930          xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{931          \textcolor{keywordflow}{Do} icrs = nmed+1, ndat}
\DoxyCodeLine{932             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{933             iwrk = iwrkt(icrs)}
\DoxyCodeLine{934             \textcolor{keywordflow}{If} (xwrk < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{935                idcr = nmed -\/ 1}
\DoxyCodeLine{936                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{937                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{938                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{939                   idcr = idcr -\/ 1}
\DoxyCodeLine{940 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{941                iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{942                xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{943 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{944 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{945          ires\_med = iwrkt(nmed)}
\DoxyCodeLine{946          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{947 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{948 \textcolor{comment}{!}}
\DoxyCodeLine{949 \textcolor{comment}{!  Make sorted subsets of 7 elements}}
\DoxyCodeLine{950 \textcolor{comment}{!  This is done by a variant of insertion sort where a first}}
\DoxyCodeLine{951 \textcolor{comment}{!  pass is used to bring the smallest element to the first position}}
\DoxyCodeLine{952 \textcolor{comment}{!  decreasing disorder at the same time, so that we may remove}}
\DoxyCodeLine{953 \textcolor{comment}{!  the loop test in the insertion loop.}}
\DoxyCodeLine{954 \textcolor{comment}{!}}
\DoxyCodeLine{955       imax = 1}
\DoxyCodeLine{956       imin = 1}
\DoxyCodeLine{957       xmax = xdatt(iwrkt(imax))}
\DoxyCodeLine{958       xmin = xdatt(iwrkt(imin))}
\DoxyCodeLine{959       \textcolor{keywordflow}{DO} ideb = 1, ndat-\/6, 7}
\DoxyCodeLine{960          idcr = ideb + 6}
\DoxyCodeLine{961          \textcolor{keywordflow}{If} (xdatt(iwrkt(ideb)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{962             iwrk = iwrkt(ideb)}
\DoxyCodeLine{963          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{964             iwrk = iwrkt(idcr)}
\DoxyCodeLine{965             iwrkt(idcr) = iwrkt(ideb)}
\DoxyCodeLine{966 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{967          xwrk = xdatt(iwrk)}
\DoxyCodeLine{968          \textcolor{keywordflow}{Do} itmp = 1, 5}
\DoxyCodeLine{969             idcr = idcr -\/ 1}
\DoxyCodeLine{970             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{971             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{972             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{973                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{974                 iwrk = iwrk1}
\DoxyCodeLine{975                 xwrk = xwrk1}
\DoxyCodeLine{976 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{977 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{978          iwrkt(ideb) = iwrk}
\DoxyCodeLine{979          \textcolor{keywordflow}{If} (xwrk < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{980              imin = iwrk}
\DoxyCodeLine{981              xmin = xwrk}
\DoxyCodeLine{982 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{983          \textcolor{keywordflow}{Do} icrs = ideb+1, ideb+5}
\DoxyCodeLine{984             iwrk = iwrkt(icrs+1)}
\DoxyCodeLine{985             xwrk = xdatt(iwrk)}
\DoxyCodeLine{986             idon = iwrkt(icrs)}
\DoxyCodeLine{987             \textcolor{keywordflow}{If} (xwrk < xdatt(idon)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{988                iwrkt(icrs+1) = idon}
\DoxyCodeLine{989                idcr = icrs}
\DoxyCodeLine{990                iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{991                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{992                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{993                   \textcolor{keywordflow}{If} (xwrk >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{994                   iwrkt(idcr) = iwrk1}
\DoxyCodeLine{995                   idcr = idcr -\/ 1}
\DoxyCodeLine{996                   iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{997                   xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{998 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{999                iwrkt(idcr) = iwrk}
\DoxyCodeLine{1000 \textcolor{keywordflow}{            EndIf}}
\DoxyCodeLine{1001 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1002          \textcolor{keywordflow}{If} (xwrk > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1003              imax = iwrk}
\DoxyCodeLine{1004              xmax = xwrk}
\DoxyCodeLine{1005 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1006 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{1007 \textcolor{comment}{!}}
\DoxyCodeLine{1008 \textcolor{comment}{!  Add-\/up alternatively MAX and MIN values to make the number of data}}
\DoxyCodeLine{1009 \textcolor{comment}{!  an exact multiple of 7.}}
\DoxyCodeLine{1010 \textcolor{comment}{!}}
\DoxyCodeLine{1011       ideb = 7 * (ndat/7)}
\DoxyCodeLine{1012       ntri = ndat}
\DoxyCodeLine{1013       \textcolor{keywordflow}{If} (ideb < ndat) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1014 \textcolor{comment}{!}}
\DoxyCodeLine{1015          \textcolor{keywordflow}{Do} icrs = ideb+1, ndat}
\DoxyCodeLine{1016             xwrk1 = xdatt(iwrkt(icrs))}
\DoxyCodeLine{1017             \textcolor{keywordflow}{IF} (xwrk1 > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1018                imax = iwrkt(icrs)}
\DoxyCodeLine{1019                xmax = xwrk1}
\DoxyCodeLine{1020 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1021             \textcolor{keywordflow}{IF} (xwrk1 < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1022                imin = iwrkt(icrs)}
\DoxyCodeLine{1023                xmin = xwrk1}
\DoxyCodeLine{1024 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1025 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1026          iwrk1 = imax}
\DoxyCodeLine{1027          \textcolor{keywordflow}{Do} icrs = ndat+1, ideb+7}
\DoxyCodeLine{1028                iwrkt(icrs) = iwrk1}
\DoxyCodeLine{1029                \textcolor{keywordflow}{If} (iwrk1 == imax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1030                   iwrk1 = imin}
\DoxyCodeLine{1031                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1032                   nmed = nmed + 1}
\DoxyCodeLine{1033                   iwrk1 = imax}
\DoxyCodeLine{1034 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1035 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1036 \textcolor{comment}{!}}
\DoxyCodeLine{1037          \textcolor{keywordflow}{Do} icrs = ideb+2, ideb+7}
\DoxyCodeLine{1038             iwrk = iwrkt(icrs)}
\DoxyCodeLine{1039             xwrk = xdatt(iwrk)}
\DoxyCodeLine{1040             \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, ideb+1, -\/ 1}
\DoxyCodeLine{1041                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1042                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1043 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1044             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1045 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1046 \textcolor{comment}{!}}
\DoxyCodeLine{1047          ntri = ideb+7}
\DoxyCodeLine{1048 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1049 \textcolor{comment}{!}}
\DoxyCodeLine{1050 \textcolor{comment}{!  Make the set of the indices of median values of each sorted subset}}
\DoxyCodeLine{1051 \textcolor{comment}{!}}
\DoxyCodeLine{1052          idon1 = 0}
\DoxyCodeLine{1053          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1054             idon1 = idon1 + 1}
\DoxyCodeLine{1055             imedt(idon1) = iwrkt(idon + 3)}
\DoxyCodeLine{1056 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1057 \textcolor{comment}{!}}
\DoxyCodeLine{1058 \textcolor{comment}{!  Find XMED7, the median of the medians}}
\DoxyCodeLine{1059 \textcolor{comment}{!}}
\DoxyCodeLine{1060          \textcolor{keyword}{Call }int32\_med (xdatt, imedt(1:idon1), imed7)}
\DoxyCodeLine{1061          xmed7 = xdatt(imed7)}
\DoxyCodeLine{1062 \textcolor{comment}{!}}
\DoxyCodeLine{1063 \textcolor{comment}{!  Count how many values are not higher than (and how many equal to) XMED7}}
\DoxyCodeLine{1064 \textcolor{comment}{!  This number is at least 4 * 1/2 * (N/7) : 4 values in each of the}}
\DoxyCodeLine{1065 \textcolor{comment}{!  subsets where the median is lower than the median of medians. For similar}}
\DoxyCodeLine{1066 \textcolor{comment}{!  reasons, we also have at least 2N/7 values not lower than XMED7. At the}}
\DoxyCodeLine{1067 \textcolor{comment}{!  same time, we find in each subset the index of the last value < XMED7,}}
\DoxyCodeLine{1068 \textcolor{comment}{!  and that of the first > XMED7. These indices will be used to restrict the}}
\DoxyCodeLine{1069 \textcolor{comment}{!  search for the median as the Kth element in the subset (> or <) where}}
\DoxyCodeLine{1070 \textcolor{comment}{!  we know it to be.}}
\DoxyCodeLine{1071 \textcolor{comment}{!}}
\DoxyCodeLine{1072          idon1 = 1}
\DoxyCodeLine{1073          nleq = 0}
\DoxyCodeLine{1074          nequ = 0}
\DoxyCodeLine{1075          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1076             imed = idon+3}
\DoxyCodeLine{1077             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1078                   imed = imed -\/ 2}
\DoxyCodeLine{1079                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1080                      imed = imed -\/ 1}
\DoxyCodeLine{1081                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1082                      imed = imed + 1}
\DoxyCodeLine{1083 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{1084             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1085                   imed = imed + 2}
\DoxyCodeLine{1086                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1087                      imed = imed -\/ 1}
\DoxyCodeLine{1088                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1089                      imed = imed + 1}
\DoxyCodeLine{1090 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{1091 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{1092             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1093                nleq = nleq + imed -\/ idon}
\DoxyCodeLine{1094                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{1095                istrt(idon1) = imed}
\DoxyCodeLine{1096             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1097                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{1098                iendt(idon1) = imed}
\DoxyCodeLine{1099                istrt(idon1) = imed + 1}
\DoxyCodeLine{1100             \textcolor{keywordflow}{Else}                    \textcolor{comment}{!       If (XDATT (IWRKT (IMED)) == XMED7)}}
\DoxyCodeLine{1101                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{1102                nequ = nequ + 1}
\DoxyCodeLine{1103                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{1104                \textcolor{keywordflow}{Do} imed1 = imed -\/ 1, idon, -\/1}
\DoxyCodeLine{1105                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1106                      nequ = nequ + 1}
\DoxyCodeLine{1107                      iendt(idon1) = imed1 -\/ 1}
\DoxyCodeLine{1108                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1109                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1110 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1111 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1112                istrt(idon1) = imed + 1}
\DoxyCodeLine{1113                \textcolor{keywordflow}{Do} imed1 = imed + 1, idon + 6}
\DoxyCodeLine{1114                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1115                      nequ = nequ + 1}
\DoxyCodeLine{1116                      nleq = nleq + 1}
\DoxyCodeLine{1117                      istrt(idon1) = imed1 + 1}
\DoxyCodeLine{1118                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1119                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1120 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1121 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1122 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{1123             idon1 = idon1 + 1}
\DoxyCodeLine{1124 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1125 \textcolor{comment}{!}}
\DoxyCodeLine{1126 \textcolor{comment}{!  Carry out a partial insertion sort to find the Kth smallest of the}}
\DoxyCodeLine{1127 \textcolor{comment}{!  large values, or the Kth largest of the small values, according to}}
\DoxyCodeLine{1128 \textcolor{comment}{!  what is needed.}}
\DoxyCodeLine{1129 \textcolor{comment}{!}}
\DoxyCodeLine{1130 \textcolor{comment}{!}}
\DoxyCodeLine{1131          \textcolor{keywordflow}{If} (nleq -\/ nequ + 1 <= nmed) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1132             \textcolor{keywordflow}{If} (nleq < nmed) \textcolor{keywordflow}{Then}   \textcolor{comment}{!      Not enough low values}}
\DoxyCodeLine{1133                 iwrk1 = imax}
\DoxyCodeLine{1134                 xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1135                 nord = nmed -\/ nleq}
\DoxyCodeLine{1136                 idon1 = 0}
\DoxyCodeLine{1137                 icrs1 = 1}
\DoxyCodeLine{1138                 icrs2 = 0}
\DoxyCodeLine{1139                 idcr = 0}
\DoxyCodeLine{1140                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1141                    idon1 = idon1 + 1}
\DoxyCodeLine{1142                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1143                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{1144                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1145                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{1146                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{1147                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1148                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1149                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1150 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{1151                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1152                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1153                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1154                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1155                            \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1156                               iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{1157                               iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1158                               xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1159 \textcolor{keywordflow}{                           Endif}}
\DoxyCodeLine{1160 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{1161                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{1162                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{1163 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1164                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1165                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{1166                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1167                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{1168                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{1169                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1170                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1171                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1172 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{1173                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1174                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1175                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1176 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1177 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{1178 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{1179                 ires\_med = iwrk1}
\DoxyCodeLine{1180                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1181             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1182                 ires\_med = imed7}
\DoxyCodeLine{1183                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1184 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1185          \textcolor{keywordflow}{Else}                       \textcolor{comment}{!      If (NLEQ > NMED)}}
\DoxyCodeLine{1186 \textcolor{comment}{!                                          Not enough high values}}
\DoxyCodeLine{1187                 xwrk1 = -\/xhuge}
\DoxyCodeLine{1188                 nord = nleq -\/ nequ -\/ nmed + 1}
\DoxyCodeLine{1189                 idon1 = 0}
\DoxyCodeLine{1190                 icrs1 = 1}
\DoxyCodeLine{1191                 icrs2 = 0}
\DoxyCodeLine{1192                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1193                    idon1 = idon1 + 1}
\DoxyCodeLine{1194                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1195 \textcolor{comment}{!}}
\DoxyCodeLine{1196                       \textcolor{keywordflow}{Do} icrs = idon, iendt(idon1)}
\DoxyCodeLine{1197                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) > xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1198                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{1199                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{1200                             idcr = icrs1 -\/ 1}
\DoxyCodeLine{1201                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1202                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1203                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1204 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{1205                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1206                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1207                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1208                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1209                             \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1210                                iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{1211                                iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1212                                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1213 \textcolor{keywordflow}{                            End If}}
\DoxyCodeLine{1214 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{1215                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{1216                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{1217 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1218                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1219                       \textcolor{keywordflow}{Do} icrs = iendt(idon1), idon, -\/1}
\DoxyCodeLine{1220                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) <= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1221                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{1222                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{1223                          idcr = icrs1 -\/ 1}
\DoxyCodeLine{1224                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1225                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1226                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1227 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{1228                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1229                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1230                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1231 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1232 \textcolor{keywordflow}{                   Endif}}
\DoxyCodeLine{1233 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{1234 \textcolor{comment}{!}}
\DoxyCodeLine{1235                 ires\_med = iwrk1}
\DoxyCodeLine{1236                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1237 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1238 \textcolor{comment}{!}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__indmed_a7a7a1cbb857bc1672280ab38e8abe92b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_a96f8c79a86271850577766f6c81cde27}\label{namespacem__indmed_a96f8c79a86271850577766f6c81cde27}} 
\index{m\_indmed@{m\_indmed}!real32\_indmed@{real32\_indmed}}
\index{real32\_indmed@{real32\_indmed}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{real32\_indmed()}{real32\_indmed()}}
{\footnotesize\ttfamily subroutine m\+\_\+indmed\+::real32\+\_\+indmed (\begin{DoxyParamCaption}\item[{real (kind=real32), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, intent(out)}]{I\+N\+DM }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{467 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{468       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: INDM}
\DoxyCodeLine{469 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{470       \textcolor{keywordtype}{Integer} :: IDON}
\DoxyCodeLine{471 \textcolor{comment}{!}}
\DoxyCodeLine{472       \textcolor{keyword}{Allocate} (idont(\textcolor{keyword}{SIZE}(xdont)))}
\DoxyCodeLine{473       \textcolor{keywordflow}{Do} idon = 1, \textcolor{keyword}{SIZE}(xdont)}
\DoxyCodeLine{474          idont(idon) = idon}
\DoxyCodeLine{475 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{476 \textcolor{comment}{!}}
\DoxyCodeLine{477       \textcolor{keyword}{Call }real32\_med (xdont, idont, indm)}
\DoxyCodeLine{478 \textcolor{comment}{!}}
\DoxyCodeLine{479       \textcolor{keyword}{Deallocate} (idont)}

\end{DoxyCode}


References idont, and real32\+\_\+med().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__indmed_a96f8c79a86271850577766f6c81cde27_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_abb66bb589821afa90ddd8bda8fcf609b}\label{namespacem__indmed_abb66bb589821afa90ddd8bda8fcf609b}} 
\index{m\_indmed@{m\_indmed}!real32\_med@{real32\_med}}
\index{real32\_med@{real32\_med}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{real32\_med()}{real32\_med()}}
{\footnotesize\ttfamily recursive subroutine m\+\_\+indmed\+::real32\+\_\+med (\begin{DoxyParamCaption}\item[{real (kind=real32), dimension (\+:), intent(in)}]{X\+D\+A\+TT,  }\item[{integer, dimension (\+:), intent(in)}]{I\+D\+A\+TT,  }\item[{integer, intent(out)}]{ires\+\_\+med }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{483 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdatt}
\DoxyCodeLine{484       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: IDATT}
\DoxyCodeLine{485       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)}:: ires\_med}
\DoxyCodeLine{486 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{487 \textcolor{comment}{!}}
\DoxyCodeLine{488 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Parameter} :: xhuge = huge(xdatt)}
\DoxyCodeLine{489 \textcolor{keywordtype}{      Real} (kind=real32) :: xwrk, xwrk1, xmed7, xmax, xmin}
\DoxyCodeLine{490 \textcolor{comment}{!}}
\DoxyCodeLine{491       \textcolor{keywordtype}{Integer}, Dimension (7*(((Size (IDATT)+6)/7+6)/7)) :: ISTRT, IENDT,\textcolor{comment}{ IMEDT}}
\DoxyCodeLine{492 \textcolor{comment}{      }\textcolor{keywordtype}{Integer}, Dimension (7*((Size(IDATT)+6)/7)) :: IWRKT}
\DoxyCodeLine{493       \textcolor{keywordtype}{Integer} :: NTRI, NMED, NORD, NEQU, NLEQ, IMED, IDON, IDON1}
\DoxyCodeLine{494       \textcolor{keywordtype}{Integer} :: IDEB, ITMP, IDCR, ICRS, ICRS1, ICRS2, IMAX, IMIN}
\DoxyCodeLine{495       \textcolor{keywordtype}{Integer} :: IWRK, IWRK1, IMED1, IMED7, NDAT}
\DoxyCodeLine{496 \textcolor{comment}{!}}
\DoxyCodeLine{497       ndat = \textcolor{keyword}{Size} (idatt)}
\DoxyCodeLine{498       nmed = (ndat+1) / 2}
\DoxyCodeLine{499       iwrkt = idatt}
\DoxyCodeLine{500 \textcolor{comment}{!}}
\DoxyCodeLine{501 \textcolor{comment}{!  If the number of values is small, then use insertion sort}}
\DoxyCodeLine{502 \textcolor{comment}{!}}
\DoxyCodeLine{503      \textcolor{keywordflow}{If} (ndat < 35) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{504 \textcolor{comment}{!}}
\DoxyCodeLine{505 \textcolor{comment}{!  Bring minimum to first location to save test in decreasing loop}}
\DoxyCodeLine{506 \textcolor{comment}{!}}
\DoxyCodeLine{507          idcr = ndat}
\DoxyCodeLine{508          \textcolor{keywordflow}{If} (xdatt(iwrkt(1)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{509             iwrk = iwrkt(1)}
\DoxyCodeLine{510          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{511             iwrk = iwrkt(idcr)}
\DoxyCodeLine{512             iwrkt(idcr) = iwrkt(1)}
\DoxyCodeLine{513 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{514          xwrk = xdatt(iwrk)}
\DoxyCodeLine{515          \textcolor{keywordflow}{Do} itmp = 1, ndat -\/ 2}
\DoxyCodeLine{516             idcr = idcr -\/ 1}
\DoxyCodeLine{517             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{518             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{519             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{520                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{521                 xwrk = xwrk1}
\DoxyCodeLine{522                 iwrk = iwrk1}
\DoxyCodeLine{523 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{524 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{525          iwrkt(1) = iwrk}
\DoxyCodeLine{526 \textcolor{comment}{!}}
\DoxyCodeLine{527 \textcolor{comment}{! Sort the first half, until we have NMED sorted values}}
\DoxyCodeLine{528 \textcolor{comment}{!}}
\DoxyCodeLine{529          \textcolor{keywordflow}{Do} icrs = 3, nmed}
\DoxyCodeLine{530             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{531             iwrk = iwrkt(icrs)}
\DoxyCodeLine{532             idcr = icrs -\/ 1}
\DoxyCodeLine{533             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{534                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{535                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{536                   idcr = idcr -\/ 1}
\DoxyCodeLine{537 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{538             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{539 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{540 \textcolor{comment}{!}}
\DoxyCodeLine{541 \textcolor{comment}{!  Insert any value less than the current median in the first half}}
\DoxyCodeLine{542 \textcolor{comment}{!}}
\DoxyCodeLine{543          xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{544          \textcolor{keywordflow}{Do} icrs = nmed+1, ndat}
\DoxyCodeLine{545             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{546             iwrk = iwrkt(icrs)}
\DoxyCodeLine{547             \textcolor{keywordflow}{If} (xwrk < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{548                idcr = nmed -\/ 1}
\DoxyCodeLine{549                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{550                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{551                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{552                   idcr = idcr -\/ 1}
\DoxyCodeLine{553 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{554                iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{555                xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{556 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{557 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{558          ires\_med = iwrkt(nmed)}
\DoxyCodeLine{559          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{560 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{561 \textcolor{comment}{!}}
\DoxyCodeLine{562 \textcolor{comment}{!  Make sorted subsets of 7 elements}}
\DoxyCodeLine{563 \textcolor{comment}{!  This is done by a variant of insertion sort where a first}}
\DoxyCodeLine{564 \textcolor{comment}{!  pass is used to bring the smallest element to the first position}}
\DoxyCodeLine{565 \textcolor{comment}{!  decreasing disorder at the same time, so that we may remove}}
\DoxyCodeLine{566 \textcolor{comment}{!  the loop test in the insertion loop.}}
\DoxyCodeLine{567 \textcolor{comment}{!}}
\DoxyCodeLine{568       imax = 1}
\DoxyCodeLine{569       imin = 1}
\DoxyCodeLine{570       xmax = xdatt(iwrkt(imax))}
\DoxyCodeLine{571       xmin = xdatt(iwrkt(imin))}
\DoxyCodeLine{572       \textcolor{keywordflow}{DO} ideb = 1, ndat-\/6, 7}
\DoxyCodeLine{573          idcr = ideb + 6}
\DoxyCodeLine{574          \textcolor{keywordflow}{If} (xdatt(iwrkt(ideb)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{575             iwrk = iwrkt(ideb)}
\DoxyCodeLine{576          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{577             iwrk = iwrkt(idcr)}
\DoxyCodeLine{578             iwrkt(idcr) = iwrkt(ideb)}
\DoxyCodeLine{579 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{580          xwrk = xdatt(iwrk)}
\DoxyCodeLine{581          \textcolor{keywordflow}{Do} itmp = 1, 5}
\DoxyCodeLine{582             idcr = idcr -\/ 1}
\DoxyCodeLine{583             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{584             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{585             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{586                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{587                 iwrk = iwrk1}
\DoxyCodeLine{588                 xwrk = xwrk1}
\DoxyCodeLine{589 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{590 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{591          iwrkt(ideb) = iwrk}
\DoxyCodeLine{592          \textcolor{keywordflow}{If} (xwrk < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{593              imin = iwrk}
\DoxyCodeLine{594              xmin = xwrk}
\DoxyCodeLine{595 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{596          \textcolor{keywordflow}{Do} icrs = ideb+1, ideb+5}
\DoxyCodeLine{597             iwrk = iwrkt(icrs+1)}
\DoxyCodeLine{598             xwrk = xdatt(iwrk)}
\DoxyCodeLine{599             idon = iwrkt(icrs)}
\DoxyCodeLine{600             \textcolor{keywordflow}{If} (xwrk < xdatt(idon)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{601                iwrkt(icrs+1) = idon}
\DoxyCodeLine{602                idcr = icrs}
\DoxyCodeLine{603                iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{604                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{605                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{606                   \textcolor{keywordflow}{If} (xwrk >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{607                   iwrkt(idcr) = iwrk1}
\DoxyCodeLine{608                   idcr = idcr -\/ 1}
\DoxyCodeLine{609                   iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{610                   xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{611 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{612                iwrkt(idcr) = iwrk}
\DoxyCodeLine{613 \textcolor{keywordflow}{            EndIf}}
\DoxyCodeLine{614 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{615          \textcolor{keywordflow}{If} (xwrk > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{616              imax = iwrk}
\DoxyCodeLine{617              xmax = xwrk}
\DoxyCodeLine{618 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{619 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{620 \textcolor{comment}{!}}
\DoxyCodeLine{621 \textcolor{comment}{!  Add-\/up alternatively MAX and MIN values to make the number of data}}
\DoxyCodeLine{622 \textcolor{comment}{!  an exact multiple of 7.}}
\DoxyCodeLine{623 \textcolor{comment}{!}}
\DoxyCodeLine{624       ideb = 7 * (ndat/7)}
\DoxyCodeLine{625       ntri = ndat}
\DoxyCodeLine{626       \textcolor{keywordflow}{If} (ideb < ndat) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{627 \textcolor{comment}{!}}
\DoxyCodeLine{628          \textcolor{keywordflow}{Do} icrs = ideb+1, ndat}
\DoxyCodeLine{629             xwrk1 = xdatt(iwrkt(icrs))}
\DoxyCodeLine{630             \textcolor{keywordflow}{IF} (xwrk1 > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{631                imax = iwrkt(icrs)}
\DoxyCodeLine{632                xmax = xwrk1}
\DoxyCodeLine{633 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{634             \textcolor{keywordflow}{IF} (xwrk1 < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{635                imin = iwrkt(icrs)}
\DoxyCodeLine{636                xmin = xwrk1}
\DoxyCodeLine{637 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{638 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{639          iwrk1 = imax}
\DoxyCodeLine{640          \textcolor{keywordflow}{Do} icrs = ndat+1, ideb+7}
\DoxyCodeLine{641                iwrkt(icrs) = iwrk1}
\DoxyCodeLine{642                \textcolor{keywordflow}{If} (iwrk1 == imax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{643                   iwrk1 = imin}
\DoxyCodeLine{644                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{645                   nmed = nmed + 1}
\DoxyCodeLine{646                   iwrk1 = imax}
\DoxyCodeLine{647 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{648 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{649 \textcolor{comment}{!}}
\DoxyCodeLine{650          \textcolor{keywordflow}{Do} icrs = ideb+2, ideb+7}
\DoxyCodeLine{651             iwrk = iwrkt(icrs)}
\DoxyCodeLine{652             xwrk = xdatt(iwrk)}
\DoxyCodeLine{653             \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, ideb+1, -\/ 1}
\DoxyCodeLine{654                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{655                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{656 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{657             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{658 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{659 \textcolor{comment}{!}}
\DoxyCodeLine{660          ntri = ideb+7}
\DoxyCodeLine{661 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{662 \textcolor{comment}{!}}
\DoxyCodeLine{663 \textcolor{comment}{!  Make the set of the indices of median values of each sorted subset}}
\DoxyCodeLine{664 \textcolor{comment}{!}}
\DoxyCodeLine{665          idon1 = 0}
\DoxyCodeLine{666          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{667             idon1 = idon1 + 1}
\DoxyCodeLine{668             imedt(idon1) = iwrkt(idon + 3)}
\DoxyCodeLine{669 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{670 \textcolor{comment}{!}}
\DoxyCodeLine{671 \textcolor{comment}{!  Find XMED7, the median of the medians}}
\DoxyCodeLine{672 \textcolor{comment}{!}}
\DoxyCodeLine{673          \textcolor{keyword}{Call }real32\_med (xdatt, imedt(1:idon1), imed7)}
\DoxyCodeLine{674          xmed7 = xdatt(imed7)}
\DoxyCodeLine{675 \textcolor{comment}{!}}
\DoxyCodeLine{676 \textcolor{comment}{!  Count how many values are not higher than (and how many equal to) XMED7}}
\DoxyCodeLine{677 \textcolor{comment}{!  This number is at least 4 * 1/2 * (N/7) : 4 values in each of the}}
\DoxyCodeLine{678 \textcolor{comment}{!  subsets where the median is lower than the median of medians. For similar}}
\DoxyCodeLine{679 \textcolor{comment}{!  reasons, we also have at least 2N/7 values not lower than XMED7. At the}}
\DoxyCodeLine{680 \textcolor{comment}{!  same time, we find in each subset the index of the last value < XMED7,}}
\DoxyCodeLine{681 \textcolor{comment}{!  and that of the first > XMED7. These indices will be used to restrict the}}
\DoxyCodeLine{682 \textcolor{comment}{!  search for the median as the Kth element in the subset (> or <) where}}
\DoxyCodeLine{683 \textcolor{comment}{!  we know it to be.}}
\DoxyCodeLine{684 \textcolor{comment}{!}}
\DoxyCodeLine{685          idon1 = 1}
\DoxyCodeLine{686          nleq = 0}
\DoxyCodeLine{687          nequ = 0}
\DoxyCodeLine{688          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{689             imed = idon+3}
\DoxyCodeLine{690             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{691                   imed = imed -\/ 2}
\DoxyCodeLine{692                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{693                      imed = imed -\/ 1}
\DoxyCodeLine{694                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{695                      imed = imed + 1}
\DoxyCodeLine{696 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{697             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{698                   imed = imed + 2}
\DoxyCodeLine{699                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{700                      imed = imed -\/ 1}
\DoxyCodeLine{701                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{702                      imed = imed + 1}
\DoxyCodeLine{703 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{704 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{705             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{706                nleq = nleq + imed -\/ idon}
\DoxyCodeLine{707                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{708                istrt(idon1) = imed}
\DoxyCodeLine{709             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{710                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{711                iendt(idon1) = imed}
\DoxyCodeLine{712                istrt(idon1) = imed + 1}
\DoxyCodeLine{713             \textcolor{keywordflow}{Else}                    \textcolor{comment}{!       If (XDATT (IWRKT (IMED)) == XMED7)}}
\DoxyCodeLine{714                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{715                nequ = nequ + 1}
\DoxyCodeLine{716                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{717                \textcolor{keywordflow}{Do} imed1 = imed -\/ 1, idon, -\/1}
\DoxyCodeLine{718                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{719                      nequ = nequ + 1}
\DoxyCodeLine{720                      iendt(idon1) = imed1 -\/ 1}
\DoxyCodeLine{721                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{722                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{723 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{724 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{725                istrt(idon1) = imed + 1}
\DoxyCodeLine{726                \textcolor{keywordflow}{Do} imed1 = imed + 1, idon + 6}
\DoxyCodeLine{727                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{728                      nequ = nequ + 1}
\DoxyCodeLine{729                      nleq = nleq + 1}
\DoxyCodeLine{730                      istrt(idon1) = imed1 + 1}
\DoxyCodeLine{731                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{732                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{733 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{734 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{735 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{736             idon1 = idon1 + 1}
\DoxyCodeLine{737 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{738 \textcolor{comment}{!}}
\DoxyCodeLine{739 \textcolor{comment}{!  Carry out a partial insertion sort to find the Kth smallest of the}}
\DoxyCodeLine{740 \textcolor{comment}{!  large values, or the Kth largest of the small values, according to}}
\DoxyCodeLine{741 \textcolor{comment}{!  what is needed.}}
\DoxyCodeLine{742 \textcolor{comment}{!}}
\DoxyCodeLine{743 \textcolor{comment}{!}}
\DoxyCodeLine{744          \textcolor{keywordflow}{If} (nleq -\/ nequ + 1 <= nmed) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{745             \textcolor{keywordflow}{If} (nleq < nmed) \textcolor{keywordflow}{Then}   \textcolor{comment}{!      Not enough low values}}
\DoxyCodeLine{746                 iwrk1 = imax}
\DoxyCodeLine{747                 xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{748                 nord = nmed -\/ nleq}
\DoxyCodeLine{749                 idon1 = 0}
\DoxyCodeLine{750                 icrs1 = 1}
\DoxyCodeLine{751                 icrs2 = 0}
\DoxyCodeLine{752                 idcr = 0}
\DoxyCodeLine{753                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{754                    idon1 = idon1 + 1}
\DoxyCodeLine{755                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{756                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{757                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{758                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{759                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{760                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{761                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{762                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{763 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{764                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{765                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{766                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{767                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{768                            \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{769                               iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{770                               iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{771                               xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{772 \textcolor{keywordflow}{                           Endif}}
\DoxyCodeLine{773 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{774                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{775                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{776 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{777                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{778                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{779                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{780                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{781                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{782                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{783                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{784                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{785 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{786                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{787                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{788                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{789 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{790 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{791 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{792                 ires\_med = iwrk1}
\DoxyCodeLine{793                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{794             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{795                 ires\_med = imed7}
\DoxyCodeLine{796                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{797 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{798          \textcolor{keywordflow}{Else}                       \textcolor{comment}{!      If (NLEQ > NMED)}}
\DoxyCodeLine{799 \textcolor{comment}{!                                          Not enough high values}}
\DoxyCodeLine{800                 xwrk1 = -\/xhuge}
\DoxyCodeLine{801                 nord = nleq -\/ nequ -\/ nmed + 1}
\DoxyCodeLine{802                 idon1 = 0}
\DoxyCodeLine{803                 icrs1 = 1}
\DoxyCodeLine{804                 icrs2 = 0}
\DoxyCodeLine{805                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{806                    idon1 = idon1 + 1}
\DoxyCodeLine{807                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{808 \textcolor{comment}{!}}
\DoxyCodeLine{809                       \textcolor{keywordflow}{Do} icrs = idon, iendt(idon1)}
\DoxyCodeLine{810                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) > xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{811                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{812                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{813                             idcr = icrs1 -\/ 1}
\DoxyCodeLine{814                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{815                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{816                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{817 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{818                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{819                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{820                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{821                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{822                             \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{823                                iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{824                                iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{825                                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{826 \textcolor{keywordflow}{                            End If}}
\DoxyCodeLine{827 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{828                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{829                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{830 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{831                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{832                       \textcolor{keywordflow}{Do} icrs = iendt(idon1), idon, -\/1}
\DoxyCodeLine{833                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) <= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{834                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{835                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{836                          idcr = icrs1 -\/ 1}
\DoxyCodeLine{837                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{838                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{839                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{840 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{841                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{842                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{843                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{844 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{845 \textcolor{keywordflow}{                   Endif}}
\DoxyCodeLine{846 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{847 \textcolor{comment}{!}}
\DoxyCodeLine{848                 ires\_med = iwrk1}
\DoxyCodeLine{849                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{850 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{851 \textcolor{comment}{!}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__indmed_abb66bb589821afa90ddd8bda8fcf609b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_a7a46817d54880450b7e336fd8ff0cda1}\label{namespacem__indmed_a7a46817d54880450b7e336fd8ff0cda1}} 
\index{m\_indmed@{m\_indmed}!real64\_indmed@{real64\_indmed}}
\index{real64\_indmed@{real64\_indmed}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{real64\_indmed()}{real64\_indmed()}}
{\footnotesize\ttfamily subroutine m\+\_\+indmed\+::real64\+\_\+indmed (\begin{DoxyParamCaption}\item[{real (kind=real64), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, intent(out)}]{I\+N\+DM }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\hypertarget{namespacem__indmed_autotoc_md16}{}\doxysubsubsection{N\+A\+ME}\label{namespacem__indmed_autotoc_md16}
indmed(3f) -\/ \mbox{[}orderpack\+:M\+E\+D\+I\+AN\mbox{]} Returns index of median value of an array.\hypertarget{namespacem__indmed_autotoc_md17}{}\doxysubsubsection{S\+Y\+N\+O\+P\+S\+IS}\label{namespacem__indmed_autotoc_md17}
\begin{DoxyVerb} Subroutine ${KIND}_indmed (XDONT, INDM)

   ${TYPE} (kind=${KIND}), Dimension (:), Intent (In) :: XDONT
   Integer, Intent (Out) :: INDM

Where ${TYPE}(kind=${KIND}) may be

   o Real(kind=real32)
   o Real(kind=real64)
   o Integer(kind=int32)
\end{DoxyVerb}
\hypertarget{namespacem__indmed_autotoc_md18}{}\doxysubsubsection{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}\label{namespacem__indmed_autotoc_md18}
Finds the index of the median of X\+D\+O\+NT using the recursive procedure described in Knuth, The Art of Computer Programming, vol. 3, 5.\+3.\+3 -\/ This procedure is linear in time, and does not require to be able to interpolate in the set as the one used in I\+N\+D\+N\+TH. It also has better worst case behavior than I\+N\+D\+N\+TH, but is about 30\% slower in average for random uniformly distributed values.\hypertarget{namespacem__indmed_autotoc_md19}{}\doxysubsubsection{O\+P\+T\+I\+O\+NS}\label{namespacem__indmed_autotoc_md19}
X\+D\+O\+NT array to find the median value of. I\+N\+DM index of the median value.\hypertarget{namespacem__indmed_autotoc_md20}{}\doxysubsubsection{E\+X\+A\+M\+P\+L\+ES}\label{namespacem__indmed_autotoc_md20}
Sample program\+:

program demo\+\_\+indmed use M\+\_\+indmed, only \+: indmed implicit none real,allocatable \+:: xdont(\+:) integer \+:: ii xdont=\mbox{[}80.\+0,70.\+0,20.\+0,10.\+0,1000.\+0\mbox{]} call indmed(xdont,ii) write($\ast$,$\ast$) ii,xdont(ii) ! xdont=\mbox{[}11, 22, 33, 44, 55, 66, 77, 88\mbox{]} call indmed(xdont,ii) write($\ast$,$\ast$) ii,xdont(ii) ! xdont=\mbox{[}11.\+0d0,77.\+0d0,22.\+0d0,66.\+0d0,33.\+0d0,88.\+0d0\mbox{]} call indmed(xdont,ii) write($\ast$,$\ast$) ii,xdont(ii) ! end program demo\+\_\+indmed

Results\+:

$>$ 2 70.\+0000000 $>$ 4 44.\+0000000 $>$ 5 33.\+0000000\hypertarget{namespacem__indmed_autotoc_md21}{}\doxysubsubsection{A\+U\+T\+H\+OR}\label{namespacem__indmed_autotoc_md21}
Michel Olagnon, 2000-\/2012

John Urban, 2022.\+04.\+16 o added man-\/page and reduced to a template using the prep(1) preprocessor.\hypertarget{namespacem__indmed_autotoc_md22}{}\doxysubsubsection{L\+I\+C\+E\+N\+SE}\label{namespacem__indmed_autotoc_md22}
C\+C0-\/1.\+0 
\begin{DoxyCode}{0}
\DoxyCodeLine{80 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{81       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: INDM}
\DoxyCodeLine{82 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{83       \textcolor{keywordtype}{Integer} :: IDON}
\DoxyCodeLine{84 \textcolor{comment}{!}}
\DoxyCodeLine{85       \textcolor{keyword}{Allocate} (idont(\textcolor{keyword}{SIZE}(xdont)))}
\DoxyCodeLine{86       \textcolor{keywordflow}{Do} idon = 1, \textcolor{keyword}{SIZE}(xdont)}
\DoxyCodeLine{87          idont(idon) = idon}
\DoxyCodeLine{88 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{89 \textcolor{comment}{!}}
\DoxyCodeLine{90       \textcolor{keyword}{Call }real64\_med (xdont, idont, indm)}
\DoxyCodeLine{91 \textcolor{comment}{!}}
\DoxyCodeLine{92       \textcolor{keyword}{Deallocate} (idont)}

\end{DoxyCode}


References idont, and real64\+\_\+med().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__indmed_a7a46817d54880450b7e336fd8ff0cda1_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_a82d4f27afcb6802376dfbebacaf594fc}\label{namespacem__indmed_a82d4f27afcb6802376dfbebacaf594fc}} 
\index{m\_indmed@{m\_indmed}!real64\_med@{real64\_med}}
\index{real64\_med@{real64\_med}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{real64\_med()}{real64\_med()}}
{\footnotesize\ttfamily recursive subroutine m\+\_\+indmed\+::real64\+\_\+med (\begin{DoxyParamCaption}\item[{real (kind=real64), dimension (\+:), intent(in)}]{X\+D\+A\+TT,  }\item[{integer, dimension (\+:), intent(in)}]{I\+D\+A\+TT,  }\item[{integer, intent(out)}]{ires\+\_\+med }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{96 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdatt}
\DoxyCodeLine{97       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: IDATT}
\DoxyCodeLine{98       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)}:: ires\_med}
\DoxyCodeLine{99 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{100 \textcolor{comment}{!}}
\DoxyCodeLine{101 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Parameter} :: xhuge = huge(xdatt)}
\DoxyCodeLine{102 \textcolor{keywordtype}{      Real} (kind=real64) :: xwrk, xwrk1, xmed7, xmax, xmin}
\DoxyCodeLine{103 \textcolor{comment}{!}}
\DoxyCodeLine{104       \textcolor{keywordtype}{Integer}, Dimension (7*(((Size (IDATT)+6)/7+6)/7)) :: ISTRT, IENDT,\textcolor{comment}{ IMEDT}}
\DoxyCodeLine{105 \textcolor{comment}{      }\textcolor{keywordtype}{Integer}, Dimension (7*((Size(IDATT)+6)/7)) :: IWRKT}
\DoxyCodeLine{106       \textcolor{keywordtype}{Integer} :: NTRI, NMED, NORD, NEQU, NLEQ, IMED, IDON, IDON1}
\DoxyCodeLine{107       \textcolor{keywordtype}{Integer} :: IDEB, ITMP, IDCR, ICRS, ICRS1, ICRS2, IMAX, IMIN}
\DoxyCodeLine{108       \textcolor{keywordtype}{Integer} :: IWRK, IWRK1, IMED1, IMED7, NDAT}
\DoxyCodeLine{109 \textcolor{comment}{!}}
\DoxyCodeLine{110       ndat = \textcolor{keyword}{Size} (idatt)}
\DoxyCodeLine{111       nmed = (ndat+1) / 2}
\DoxyCodeLine{112       iwrkt = idatt}
\DoxyCodeLine{113 \textcolor{comment}{!}}
\DoxyCodeLine{114 \textcolor{comment}{!  If the number of values is small, then use insertion sort}}
\DoxyCodeLine{115 \textcolor{comment}{!}}
\DoxyCodeLine{116      \textcolor{keywordflow}{If} (ndat < 35) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{117 \textcolor{comment}{!}}
\DoxyCodeLine{118 \textcolor{comment}{!  Bring minimum to first location to save test in decreasing loop}}
\DoxyCodeLine{119 \textcolor{comment}{!}}
\DoxyCodeLine{120          idcr = ndat}
\DoxyCodeLine{121          \textcolor{keywordflow}{If} (xdatt(iwrkt(1)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{122             iwrk = iwrkt(1)}
\DoxyCodeLine{123          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{124             iwrk = iwrkt(idcr)}
\DoxyCodeLine{125             iwrkt(idcr) = iwrkt(1)}
\DoxyCodeLine{126 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{127          xwrk = xdatt(iwrk)}
\DoxyCodeLine{128          \textcolor{keywordflow}{Do} itmp = 1, ndat -\/ 2}
\DoxyCodeLine{129             idcr = idcr -\/ 1}
\DoxyCodeLine{130             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{131             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{132             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{133                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{134                 xwrk = xwrk1}
\DoxyCodeLine{135                 iwrk = iwrk1}
\DoxyCodeLine{136 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{137 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{138          iwrkt(1) = iwrk}
\DoxyCodeLine{139 \textcolor{comment}{!}}
\DoxyCodeLine{140 \textcolor{comment}{! Sort the first half, until we have NMED sorted values}}
\DoxyCodeLine{141 \textcolor{comment}{!}}
\DoxyCodeLine{142          \textcolor{keywordflow}{Do} icrs = 3, nmed}
\DoxyCodeLine{143             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{144             iwrk = iwrkt(icrs)}
\DoxyCodeLine{145             idcr = icrs -\/ 1}
\DoxyCodeLine{146             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{147                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{148                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{149                   idcr = idcr -\/ 1}
\DoxyCodeLine{150 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{151             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{152 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{153 \textcolor{comment}{!}}
\DoxyCodeLine{154 \textcolor{comment}{!  Insert any value less than the current median in the first half}}
\DoxyCodeLine{155 \textcolor{comment}{!}}
\DoxyCodeLine{156          xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{157          \textcolor{keywordflow}{Do} icrs = nmed+1, ndat}
\DoxyCodeLine{158             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{159             iwrk = iwrkt(icrs)}
\DoxyCodeLine{160             \textcolor{keywordflow}{If} (xwrk < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{161                idcr = nmed -\/ 1}
\DoxyCodeLine{162                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{163                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{164                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{165                   idcr = idcr -\/ 1}
\DoxyCodeLine{166 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{167                iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{168                xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{169 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{170 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{171          ires\_med = iwrkt(nmed)}
\DoxyCodeLine{172          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{173 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{174 \textcolor{comment}{!}}
\DoxyCodeLine{175 \textcolor{comment}{!  Make sorted subsets of 7 elements}}
\DoxyCodeLine{176 \textcolor{comment}{!  This is done by a variant of insertion sort where a first}}
\DoxyCodeLine{177 \textcolor{comment}{!  pass is used to bring the smallest element to the first position}}
\DoxyCodeLine{178 \textcolor{comment}{!  decreasing disorder at the same time, so that we may remove}}
\DoxyCodeLine{179 \textcolor{comment}{!  the loop test in the insertion loop.}}
\DoxyCodeLine{180 \textcolor{comment}{!}}
\DoxyCodeLine{181       imax = 1}
\DoxyCodeLine{182       imin = 1}
\DoxyCodeLine{183       xmax = xdatt(iwrkt(imax))}
\DoxyCodeLine{184       xmin = xdatt(iwrkt(imin))}
\DoxyCodeLine{185       \textcolor{keywordflow}{DO} ideb = 1, ndat-\/6, 7}
\DoxyCodeLine{186          idcr = ideb + 6}
\DoxyCodeLine{187          \textcolor{keywordflow}{If} (xdatt(iwrkt(ideb)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{188             iwrk = iwrkt(ideb)}
\DoxyCodeLine{189          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{190             iwrk = iwrkt(idcr)}
\DoxyCodeLine{191             iwrkt(idcr) = iwrkt(ideb)}
\DoxyCodeLine{192 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{193          xwrk = xdatt(iwrk)}
\DoxyCodeLine{194          \textcolor{keywordflow}{Do} itmp = 1, 5}
\DoxyCodeLine{195             idcr = idcr -\/ 1}
\DoxyCodeLine{196             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{197             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{198             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{199                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{200                 iwrk = iwrk1}
\DoxyCodeLine{201                 xwrk = xwrk1}
\DoxyCodeLine{202 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{203 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{204          iwrkt(ideb) = iwrk}
\DoxyCodeLine{205          \textcolor{keywordflow}{If} (xwrk < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{206              imin = iwrk}
\DoxyCodeLine{207              xmin = xwrk}
\DoxyCodeLine{208 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{209          \textcolor{keywordflow}{Do} icrs = ideb+1, ideb+5}
\DoxyCodeLine{210             iwrk = iwrkt(icrs+1)}
\DoxyCodeLine{211             xwrk = xdatt(iwrk)}
\DoxyCodeLine{212             idon = iwrkt(icrs)}
\DoxyCodeLine{213             \textcolor{keywordflow}{If} (xwrk < xdatt(idon)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{214                iwrkt(icrs+1) = idon}
\DoxyCodeLine{215                idcr = icrs}
\DoxyCodeLine{216                iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{217                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{218                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{219                   \textcolor{keywordflow}{If} (xwrk >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{220                   iwrkt(idcr) = iwrk1}
\DoxyCodeLine{221                   idcr = idcr -\/ 1}
\DoxyCodeLine{222                   iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{223                   xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{224 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{225                iwrkt(idcr) = iwrk}
\DoxyCodeLine{226 \textcolor{keywordflow}{            EndIf}}
\DoxyCodeLine{227 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{228          \textcolor{keywordflow}{If} (xwrk > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{229              imax = iwrk}
\DoxyCodeLine{230              xmax = xwrk}
\DoxyCodeLine{231 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{232 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{233 \textcolor{comment}{!}}
\DoxyCodeLine{234 \textcolor{comment}{!  Add-\/up alternatively MAX and MIN values to make the number of data}}
\DoxyCodeLine{235 \textcolor{comment}{!  an exact multiple of 7.}}
\DoxyCodeLine{236 \textcolor{comment}{!}}
\DoxyCodeLine{237       ideb = 7 * (ndat/7)}
\DoxyCodeLine{238       ntri = ndat}
\DoxyCodeLine{239       \textcolor{keywordflow}{If} (ideb < ndat) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{240 \textcolor{comment}{!}}
\DoxyCodeLine{241          \textcolor{keywordflow}{Do} icrs = ideb+1, ndat}
\DoxyCodeLine{242             xwrk1 = xdatt(iwrkt(icrs))}
\DoxyCodeLine{243             \textcolor{keywordflow}{IF} (xwrk1 > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{244                imax = iwrkt(icrs)}
\DoxyCodeLine{245                xmax = xwrk1}
\DoxyCodeLine{246 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{247             \textcolor{keywordflow}{IF} (xwrk1 < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{248                imin = iwrkt(icrs)}
\DoxyCodeLine{249                xmin = xwrk1}
\DoxyCodeLine{250 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{251 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{252          iwrk1 = imax}
\DoxyCodeLine{253          \textcolor{keywordflow}{Do} icrs = ndat+1, ideb+7}
\DoxyCodeLine{254                iwrkt(icrs) = iwrk1}
\DoxyCodeLine{255                \textcolor{keywordflow}{If} (iwrk1 == imax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{256                   iwrk1 = imin}
\DoxyCodeLine{257                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{258                   nmed = nmed + 1}
\DoxyCodeLine{259                   iwrk1 = imax}
\DoxyCodeLine{260 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{261 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{262 \textcolor{comment}{!}}
\DoxyCodeLine{263          \textcolor{keywordflow}{Do} icrs = ideb+2, ideb+7}
\DoxyCodeLine{264             iwrk = iwrkt(icrs)}
\DoxyCodeLine{265             xwrk = xdatt(iwrk)}
\DoxyCodeLine{266             \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, ideb+1, -\/ 1}
\DoxyCodeLine{267                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{268                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{269 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{270             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{271 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{272 \textcolor{comment}{!}}
\DoxyCodeLine{273          ntri = ideb+7}
\DoxyCodeLine{274 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{275 \textcolor{comment}{!}}
\DoxyCodeLine{276 \textcolor{comment}{!  Make the set of the indices of median values of each sorted subset}}
\DoxyCodeLine{277 \textcolor{comment}{!}}
\DoxyCodeLine{278          idon1 = 0}
\DoxyCodeLine{279          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{280             idon1 = idon1 + 1}
\DoxyCodeLine{281             imedt(idon1) = iwrkt(idon + 3)}
\DoxyCodeLine{282 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{283 \textcolor{comment}{!}}
\DoxyCodeLine{284 \textcolor{comment}{!  Find XMED7, the median of the medians}}
\DoxyCodeLine{285 \textcolor{comment}{!}}
\DoxyCodeLine{286          \textcolor{keyword}{Call }real64\_med (xdatt, imedt(1:idon1), imed7)}
\DoxyCodeLine{287          xmed7 = xdatt(imed7)}
\DoxyCodeLine{288 \textcolor{comment}{!}}
\DoxyCodeLine{289 \textcolor{comment}{!  Count how many values are not higher than (and how many equal to) XMED7}}
\DoxyCodeLine{290 \textcolor{comment}{!  This number is at least 4 * 1/2 * (N/7) : 4 values in each of the}}
\DoxyCodeLine{291 \textcolor{comment}{!  subsets where the median is lower than the median of medians. For similar}}
\DoxyCodeLine{292 \textcolor{comment}{!  reasons, we also have at least 2N/7 values not lower than XMED7. At the}}
\DoxyCodeLine{293 \textcolor{comment}{!  same time, we find in each subset the index of the last value < XMED7,}}
\DoxyCodeLine{294 \textcolor{comment}{!  and that of the first > XMED7. These indices will be used to restrict the}}
\DoxyCodeLine{295 \textcolor{comment}{!  search for the median as the Kth element in the subset (> or <) where}}
\DoxyCodeLine{296 \textcolor{comment}{!  we know it to be.}}
\DoxyCodeLine{297 \textcolor{comment}{!}}
\DoxyCodeLine{298          idon1 = 1}
\DoxyCodeLine{299          nleq = 0}
\DoxyCodeLine{300          nequ = 0}
\DoxyCodeLine{301          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{302             imed = idon+3}
\DoxyCodeLine{303             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{304                   imed = imed -\/ 2}
\DoxyCodeLine{305                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{306                      imed = imed -\/ 1}
\DoxyCodeLine{307                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{308                      imed = imed + 1}
\DoxyCodeLine{309 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{310             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{311                   imed = imed + 2}
\DoxyCodeLine{312                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{313                      imed = imed -\/ 1}
\DoxyCodeLine{314                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{315                      imed = imed + 1}
\DoxyCodeLine{316 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{317 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{318             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{319                nleq = nleq + imed -\/ idon}
\DoxyCodeLine{320                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{321                istrt(idon1) = imed}
\DoxyCodeLine{322             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{323                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{324                iendt(idon1) = imed}
\DoxyCodeLine{325                istrt(idon1) = imed + 1}
\DoxyCodeLine{326             \textcolor{keywordflow}{Else}                    \textcolor{comment}{!       If (XDATT (IWRKT (IMED)) == XMED7)}}
\DoxyCodeLine{327                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{328                nequ = nequ + 1}
\DoxyCodeLine{329                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{330                \textcolor{keywordflow}{Do} imed1 = imed -\/ 1, idon, -\/1}
\DoxyCodeLine{331                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{332                      nequ = nequ + 1}
\DoxyCodeLine{333                      iendt(idon1) = imed1 -\/ 1}
\DoxyCodeLine{334                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{335                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{336 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{337 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{338                istrt(idon1) = imed + 1}
\DoxyCodeLine{339                \textcolor{keywordflow}{Do} imed1 = imed + 1, idon + 6}
\DoxyCodeLine{340                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{341                      nequ = nequ + 1}
\DoxyCodeLine{342                      nleq = nleq + 1}
\DoxyCodeLine{343                      istrt(idon1) = imed1 + 1}
\DoxyCodeLine{344                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{345                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{346 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{347 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{348 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{349             idon1 = idon1 + 1}
\DoxyCodeLine{350 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{351 \textcolor{comment}{!}}
\DoxyCodeLine{352 \textcolor{comment}{!  Carry out a partial insertion sort to find the Kth smallest of the}}
\DoxyCodeLine{353 \textcolor{comment}{!  large values, or the Kth largest of the small values, according to}}
\DoxyCodeLine{354 \textcolor{comment}{!  what is needed.}}
\DoxyCodeLine{355 \textcolor{comment}{!}}
\DoxyCodeLine{356 \textcolor{comment}{!}}
\DoxyCodeLine{357          \textcolor{keywordflow}{If} (nleq -\/ nequ + 1 <= nmed) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{358             \textcolor{keywordflow}{If} (nleq < nmed) \textcolor{keywordflow}{Then}   \textcolor{comment}{!      Not enough low values}}
\DoxyCodeLine{359                 iwrk1 = imax}
\DoxyCodeLine{360                 xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{361                 nord = nmed -\/ nleq}
\DoxyCodeLine{362                 idon1 = 0}
\DoxyCodeLine{363                 icrs1 = 1}
\DoxyCodeLine{364                 icrs2 = 0}
\DoxyCodeLine{365                 idcr = 0}
\DoxyCodeLine{366                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{367                    idon1 = idon1 + 1}
\DoxyCodeLine{368                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{369                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{370                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{371                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{372                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{373                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{374                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{375                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{376 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{377                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{378                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{379                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{380                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{381                            \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{382                               iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{383                               iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{384                               xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{385 \textcolor{keywordflow}{                           Endif}}
\DoxyCodeLine{386 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{387                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{388                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{389 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{390                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{391                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{392                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{393                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{394                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{395                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{396                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{397                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{398 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{399                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{400                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{401                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{402 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{403 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{404 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{405                 ires\_med = iwrk1}
\DoxyCodeLine{406                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{407             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{408                 ires\_med = imed7}
\DoxyCodeLine{409                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{410 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{411          \textcolor{keywordflow}{Else}                       \textcolor{comment}{!      If (NLEQ > NMED)}}
\DoxyCodeLine{412 \textcolor{comment}{!                                          Not enough high values}}
\DoxyCodeLine{413                 xwrk1 = -\/xhuge}
\DoxyCodeLine{414                 nord = nleq -\/ nequ -\/ nmed + 1}
\DoxyCodeLine{415                 idon1 = 0}
\DoxyCodeLine{416                 icrs1 = 1}
\DoxyCodeLine{417                 icrs2 = 0}
\DoxyCodeLine{418                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{419                    idon1 = idon1 + 1}
\DoxyCodeLine{420                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{421 \textcolor{comment}{!}}
\DoxyCodeLine{422                       \textcolor{keywordflow}{Do} icrs = idon, iendt(idon1)}
\DoxyCodeLine{423                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) > xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{424                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{425                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{426                             idcr = icrs1 -\/ 1}
\DoxyCodeLine{427                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{428                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{429                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{430 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{431                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{432                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{433                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{434                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{435                             \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{436                                iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{437                                iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{438                                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{439 \textcolor{keywordflow}{                            End If}}
\DoxyCodeLine{440 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{441                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{442                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{443 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{444                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{445                       \textcolor{keywordflow}{Do} icrs = iendt(idon1), idon, -\/1}
\DoxyCodeLine{446                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) <= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{447                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{448                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{449                          idcr = icrs1 -\/ 1}
\DoxyCodeLine{450                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{451                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{452                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{453 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{454                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{455                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{456                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{457 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{458 \textcolor{keywordflow}{                   Endif}}
\DoxyCodeLine{459 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{460 \textcolor{comment}{!}}
\DoxyCodeLine{461                 ires\_med = iwrk1}
\DoxyCodeLine{462                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{463 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{464 \textcolor{comment}{!}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__indmed_a82d4f27afcb6802376dfbebacaf594fc_icgraph}
\end{center}
\end{figure}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacem__indmed_ad17c2a3bf73f372ad2d9ea60e151ee23}\label{namespacem__indmed_ad17c2a3bf73f372ad2d9ea60e151ee23}} 
\index{m\_indmed@{m\_indmed}!idont@{idont}}
\index{idont@{idont}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{idont}{idont}}
{\footnotesize\ttfamily integer, dimension(\+:), allocatable, save, private m\+\_\+indmed\+::idont\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{6 \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Allocatable}, \textcolor{keywordtype}{Dimension(:)}, \textcolor{keywordtype}{Private}, \textcolor{keywordtype}{Save} :: IDONT}

\end{DoxyCode}
