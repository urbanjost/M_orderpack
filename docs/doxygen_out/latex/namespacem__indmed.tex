\hypertarget{namespacem__indmed}{}\doxysection{m\+\_\+indmed Module Reference}
\label{namespacem__indmed}\index{m\_indmed@{m\_indmed}}
\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface \mbox{\hyperlink{interfacem__indmed_1_1indmed}{indmed}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacem__indmed_a0bb2d4445d85331ca5395fd31c914567}{real64\+\_\+indmed}} (I\+N\+V\+A\+LS, O\+U\+T\+O\+RD)
\item 
recursive subroutine \mbox{\hyperlink{namespacem__indmed_a82d4f27afcb6802376dfbebacaf594fc}{real64\+\_\+med}} (X\+D\+A\+TT, I\+D\+A\+TT, ires\+\_\+med)
\item 
subroutine \mbox{\hyperlink{namespacem__indmed_a3e2428b49026a92e90f29c8f1194f9ed}{real32\+\_\+indmed}} (I\+N\+V\+A\+LS, O\+U\+T\+O\+RD)
\item 
recursive subroutine \mbox{\hyperlink{namespacem__indmed_abb66bb589821afa90ddd8bda8fcf609b}{real32\+\_\+med}} (X\+D\+A\+TT, I\+D\+A\+TT, ires\+\_\+med)
\item 
subroutine \mbox{\hyperlink{namespacem__indmed_a9da950c4d7af4db3c506d2d4644df3b7}{int32\+\_\+indmed}} (I\+N\+V\+A\+LS, O\+U\+T\+O\+RD)
\item 
recursive subroutine \mbox{\hyperlink{namespacem__indmed_a7a7a1cbb857bc1672280ab38e8abe92b}{int32\+\_\+med}} (X\+D\+A\+TT, I\+D\+A\+TT, ires\+\_\+med)
\item 
subroutine \mbox{\hyperlink{namespacem__indmed_ad74898f299942bce88c6176a7f77ca7a}{f\+\_\+char\+\_\+indmed}} (I\+N\+V\+A\+LS, O\+U\+T\+O\+RD)
\item 
recursive subroutine \mbox{\hyperlink{namespacem__indmed_aa5d0f86c27fd1bb30075f4f8750a51a7}{f\+\_\+char\+\_\+med}} (X\+D\+A\+TT, I\+D\+A\+TT, ires\+\_\+med)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
integer, parameter \mbox{\hyperlink{namespacem__indmed_ac9df52d05b93b36c223ca81db7b24958}{f\+\_\+char}} =selected\+\_\+char\+\_\+kind(\char`\"{}D\+E\+F\+A\+U\+LT\char`\"{})
\item 
integer, dimension(\+:), allocatable, save, private \mbox{\hyperlink{namespacem__indmed_ad17c2a3bf73f372ad2d9ea60e151ee23}{idont}}
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacem__indmed_ad74898f299942bce88c6176a7f77ca7a}\label{namespacem__indmed_ad74898f299942bce88c6176a7f77ca7a}} 
\index{m\_indmed@{m\_indmed}!f\_char\_indmed@{f\_char\_indmed}}
\index{f\_char\_indmed@{f\_char\_indmed}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{f\_char\_indmed()}{f\_char\_indmed()}}
{\footnotesize\ttfamily subroutine m\+\_\+indmed\+::f\+\_\+char\+\_\+indmed (\begin{DoxyParamCaption}\item[{character (kind=\mbox{\hyperlink{namespacem__indmed_ac9df52d05b93b36c223ca81db7b24958}{f\+\_\+char}},len=$\ast$), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, intent(out)}]{O\+U\+T\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{1257       \textcolor{keywordtype}{character (kind=f\_char,len=*)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: INVALS}
\DoxyCodeLine{1258       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: OUTORD}
\DoxyCodeLine{1259 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1260       \textcolor{keywordtype}{Integer} :: IDON}
\DoxyCodeLine{1261 \textcolor{comment}{!}}
\DoxyCodeLine{1262       \textcolor{keyword}{Allocate} (idont(\textcolor{keyword}{SIZE}(invals)))}
\DoxyCodeLine{1263       \textcolor{keywordflow}{Do} idon = 1, \textcolor{keyword}{SIZE}(invals)}
\DoxyCodeLine{1264          idont(idon) = idon}
\DoxyCodeLine{1265 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{1266 \textcolor{comment}{!}}
\DoxyCodeLine{1267       \textcolor{keyword}{Call }f\_char\_med (invals, idont, outord)}
\DoxyCodeLine{1268 \textcolor{comment}{!}}
\DoxyCodeLine{1269       \textcolor{keyword}{Deallocate} (idont)}

\end{DoxyCode}


References f\+\_\+char\+\_\+med(), and idont.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__indmed_ad74898f299942bce88c6176a7f77ca7a_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_aa5d0f86c27fd1bb30075f4f8750a51a7}\label{namespacem__indmed_aa5d0f86c27fd1bb30075f4f8750a51a7}} 
\index{m\_indmed@{m\_indmed}!f\_char\_med@{f\_char\_med}}
\index{f\_char\_med@{f\_char\_med}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{f\_char\_med()}{f\_char\_med()}}
{\footnotesize\ttfamily recursive subroutine m\+\_\+indmed\+::f\+\_\+char\+\_\+med (\begin{DoxyParamCaption}\item[{character (kind=\mbox{\hyperlink{namespacem__indmed_ac9df52d05b93b36c223ca81db7b24958}{f\+\_\+char}},len=$\ast$), dimension (\+:), intent(in)}]{X\+D\+A\+TT,  }\item[{integer, dimension (\+:), intent(in)}]{I\+D\+A\+TT,  }\item[{integer, intent(out)}]{ires\+\_\+med }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{1273       \textcolor{keywordtype}{character (kind=f\_char,len=*)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDATT}
\DoxyCodeLine{1274       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: IDATT}
\DoxyCodeLine{1275       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)}:: ires\_med}
\DoxyCodeLine{1276 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{1277 \textcolor{comment}{!}}
\DoxyCodeLine{1278       \textcolor{keywordtype}{character (kind=f\_char,len=len(XDATT))} :: XHUGE}
\DoxyCodeLine{1279       \textcolor{keywordtype}{character (kind=f\_char,len=len(XDATT))} :: XWRK, XWRK1, XMED7, XMAX, XMIN}
\DoxyCodeLine{1280 \textcolor{comment}{!}}
\DoxyCodeLine{1281       \textcolor{keywordtype}{Integer}, Dimension (7*(((Size (IDATT)+6)/7+6)/7)) :: ISTRT, IENDT, IMEDT}
\DoxyCodeLine{1282       \textcolor{keywordtype}{Integer}, Dimension (7*((Size(IDATT)+6)/7)) :: IWRKT}
\DoxyCodeLine{1283       \textcolor{keywordtype}{Integer} :: NTRI, NMED, NORD, NEQU, NLEQ, IMED, IDON, IDON1}
\DoxyCodeLine{1284       \textcolor{keywordtype}{Integer} :: IDEB, ITMP, IDCR, ICRS, ICRS1, ICRS2, IMAX, IMIN}
\DoxyCodeLine{1285       \textcolor{keywordtype}{Integer} :: IWRK, IWRK1, IMED1, IMED7, NDAT}
\DoxyCodeLine{1286 \textcolor{comment}{!}}
\DoxyCodeLine{1287       xhuge=repeat(char(0),len(xdatt))}
\DoxyCodeLine{1288       ndat = \textcolor{keyword}{Size} (idatt)}
\DoxyCodeLine{1289       nmed = (ndat+1) / 2}
\DoxyCodeLine{1290       iwrkt(:\textcolor{keyword}{size}(idatt)) = idatt}
\DoxyCodeLine{1291 \textcolor{comment}{!}}
\DoxyCodeLine{1292 \textcolor{comment}{!  If the number of values is small, then use insertion sort}}
\DoxyCodeLine{1293 \textcolor{comment}{!}}
\DoxyCodeLine{1294      \textcolor{keywordflow}{If} (ndat < 35) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1295 \textcolor{comment}{!}}
\DoxyCodeLine{1296 \textcolor{comment}{!  Bring minimum to first location to save test in decreasing loop}}
\DoxyCodeLine{1297 \textcolor{comment}{!}}
\DoxyCodeLine{1298          idcr = ndat}
\DoxyCodeLine{1299          \textcolor{keywordflow}{If} (xdatt(iwrkt(1)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1300             iwrk = iwrkt(1)}
\DoxyCodeLine{1301          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1302             iwrk = iwrkt(idcr)}
\DoxyCodeLine{1303             iwrkt(idcr) = iwrkt(1)}
\DoxyCodeLine{1304 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{1305          xwrk = xdatt(iwrk)}
\DoxyCodeLine{1306          \textcolor{keywordflow}{Do} itmp = 1, ndat -\/ 2}
\DoxyCodeLine{1307             idcr = idcr -\/ 1}
\DoxyCodeLine{1308             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{1309             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1310             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1311                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{1312                 xwrk = xwrk1}
\DoxyCodeLine{1313                 iwrk = iwrk1}
\DoxyCodeLine{1314 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{1315 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1316          iwrkt(1) = iwrk}
\DoxyCodeLine{1317 \textcolor{comment}{!}}
\DoxyCodeLine{1318 \textcolor{comment}{! Sort the first half, until we have NMED sorted values}}
\DoxyCodeLine{1319 \textcolor{comment}{!}}
\DoxyCodeLine{1320          \textcolor{keywordflow}{Do} icrs = 3, nmed}
\DoxyCodeLine{1321             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{1322             iwrk = iwrkt(icrs)}
\DoxyCodeLine{1323             idcr = icrs -\/ 1}
\DoxyCodeLine{1324             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{1325                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1326                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1327                   idcr = idcr -\/ 1}
\DoxyCodeLine{1328 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1329             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1330 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1331 \textcolor{comment}{!}}
\DoxyCodeLine{1332 \textcolor{comment}{!  Insert any value less than the current median in the first half}}
\DoxyCodeLine{1333 \textcolor{comment}{!}}
\DoxyCodeLine{1334          xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{1335          \textcolor{keywordflow}{Do} icrs = nmed+1, ndat}
\DoxyCodeLine{1336             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{1337             iwrk = iwrkt(icrs)}
\DoxyCodeLine{1338             \textcolor{keywordflow}{If} (xwrk < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1339                idcr = nmed -\/ 1}
\DoxyCodeLine{1340                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{1341                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1342                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1343                   idcr = idcr -\/ 1}
\DoxyCodeLine{1344 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1345                iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1346                xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{1347 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1348 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1349          ires\_med = iwrkt(nmed)}
\DoxyCodeLine{1350          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1351 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1352 \textcolor{comment}{!}}
\DoxyCodeLine{1353 \textcolor{comment}{!  Make sorted subsets of 7 elements}}
\DoxyCodeLine{1354 \textcolor{comment}{!  This is done by a variant of insertion sort where a first}}
\DoxyCodeLine{1355 \textcolor{comment}{!  pass is used to bring the smallest element to the first position}}
\DoxyCodeLine{1356 \textcolor{comment}{!  decreasing disorder at the same time, so that we may remove}}
\DoxyCodeLine{1357 \textcolor{comment}{!  the loop test in the insertion loop.}}
\DoxyCodeLine{1358 \textcolor{comment}{!}}
\DoxyCodeLine{1359       imax = 1}
\DoxyCodeLine{1360       imin = 1}
\DoxyCodeLine{1361       xmax = xdatt(iwrkt(imax))}
\DoxyCodeLine{1362       xmin = xdatt(iwrkt(imin))}
\DoxyCodeLine{1363       \textcolor{keywordflow}{DO} ideb = 1, ndat-\/6, 7}
\DoxyCodeLine{1364          idcr = ideb + 6}
\DoxyCodeLine{1365          \textcolor{keywordflow}{If} (xdatt(iwrkt(ideb)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1366             iwrk = iwrkt(ideb)}
\DoxyCodeLine{1367          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1368             iwrk = iwrkt(idcr)}
\DoxyCodeLine{1369             iwrkt(idcr) = iwrkt(ideb)}
\DoxyCodeLine{1370 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{1371          xwrk = xdatt(iwrk)}
\DoxyCodeLine{1372          \textcolor{keywordflow}{Do} itmp = 1, 5}
\DoxyCodeLine{1373             idcr = idcr -\/ 1}
\DoxyCodeLine{1374             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{1375             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1376             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1377                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{1378                 iwrk = iwrk1}
\DoxyCodeLine{1379                 xwrk = xwrk1}
\DoxyCodeLine{1380 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{1381 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1382          iwrkt(ideb) = iwrk}
\DoxyCodeLine{1383          \textcolor{keywordflow}{If} (xwrk < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1384              imin = iwrk}
\DoxyCodeLine{1385              xmin = xwrk}
\DoxyCodeLine{1386 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1387          \textcolor{keywordflow}{Do} icrs = ideb+1, ideb+5}
\DoxyCodeLine{1388             iwrk = iwrkt(icrs+1)}
\DoxyCodeLine{1389             xwrk = xdatt(iwrk)}
\DoxyCodeLine{1390             idon = iwrkt(icrs)}
\DoxyCodeLine{1391             \textcolor{keywordflow}{If} (xwrk < xdatt(idon)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1392                iwrkt(icrs+1) = idon}
\DoxyCodeLine{1393                idcr = icrs}
\DoxyCodeLine{1394                iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{1395                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1396                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{1397                   \textcolor{keywordflow}{If} (xwrk >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1398                   iwrkt(idcr) = iwrk1}
\DoxyCodeLine{1399                   idcr = idcr -\/ 1}
\DoxyCodeLine{1400                   iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{1401                   xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1402 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1403                iwrkt(idcr) = iwrk}
\DoxyCodeLine{1404 \textcolor{keywordflow}{            EndIf}}
\DoxyCodeLine{1405 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1406          \textcolor{keywordflow}{If} (xwrk > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1407              imax = iwrk}
\DoxyCodeLine{1408              xmax = xwrk}
\DoxyCodeLine{1409 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1410 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{1411 \textcolor{comment}{!}}
\DoxyCodeLine{1412 \textcolor{comment}{!  Add-\/up alternatively MAX and MIN values to make the number of data}}
\DoxyCodeLine{1413 \textcolor{comment}{!  an exact multiple of 7.}}
\DoxyCodeLine{1414 \textcolor{comment}{!}}
\DoxyCodeLine{1415       ideb = 7 * (ndat/7)}
\DoxyCodeLine{1416       ntri = ndat}
\DoxyCodeLine{1417       \textcolor{keywordflow}{If} (ideb < ndat) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1418 \textcolor{comment}{!}}
\DoxyCodeLine{1419          \textcolor{keywordflow}{Do} icrs = ideb+1, ndat}
\DoxyCodeLine{1420             xwrk1 = xdatt(iwrkt(icrs))}
\DoxyCodeLine{1421             \textcolor{keywordflow}{IF} (xwrk1 > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1422                imax = iwrkt(icrs)}
\DoxyCodeLine{1423                xmax = xwrk1}
\DoxyCodeLine{1424 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1425             \textcolor{keywordflow}{IF} (xwrk1 < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1426                imin = iwrkt(icrs)}
\DoxyCodeLine{1427                xmin = xwrk1}
\DoxyCodeLine{1428 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1429 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1430          iwrk1 = imax}
\DoxyCodeLine{1431          \textcolor{keywordflow}{Do} icrs = ndat+1, ideb+7}
\DoxyCodeLine{1432                iwrkt(icrs) = iwrk1}
\DoxyCodeLine{1433                \textcolor{keywordflow}{If} (iwrk1 == imax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1434                   iwrk1 = imin}
\DoxyCodeLine{1435                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1436                   nmed = nmed + 1}
\DoxyCodeLine{1437                   iwrk1 = imax}
\DoxyCodeLine{1438 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1439 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1440 \textcolor{comment}{!}}
\DoxyCodeLine{1441          \textcolor{keywordflow}{Do} icrs = ideb+2, ideb+7}
\DoxyCodeLine{1442             iwrk = iwrkt(icrs)}
\DoxyCodeLine{1443             xwrk = xdatt(iwrk)}
\DoxyCodeLine{1444             \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, ideb+1, -\/ 1}
\DoxyCodeLine{1445                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1446                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1447 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1448             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1449 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1450 \textcolor{comment}{!}}
\DoxyCodeLine{1451          ntri = ideb+7}
\DoxyCodeLine{1452 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1453 \textcolor{comment}{!}}
\DoxyCodeLine{1454 \textcolor{comment}{!  Make the set of the indices of median values of each sorted subset}}
\DoxyCodeLine{1455 \textcolor{comment}{!}}
\DoxyCodeLine{1456          idon1 = 0}
\DoxyCodeLine{1457          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1458             idon1 = idon1 + 1}
\DoxyCodeLine{1459             imedt(idon1) = iwrkt(idon + 3)}
\DoxyCodeLine{1460 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1461 \textcolor{comment}{!}}
\DoxyCodeLine{1462 \textcolor{comment}{!  Find XMED7, the median of the medians}}
\DoxyCodeLine{1463 \textcolor{comment}{!}}
\DoxyCodeLine{1464          \textcolor{keyword}{Call }f\_char\_med (xdatt, imedt(1:idon1), imed7)}
\DoxyCodeLine{1465          xmed7 = xdatt(imed7)}
\DoxyCodeLine{1466 \textcolor{comment}{!}}
\DoxyCodeLine{1467 \textcolor{comment}{!  Count how many values are not higher than (and how many equal to) XMED7}}
\DoxyCodeLine{1468 \textcolor{comment}{!  This number is at least 4 * 1/2 * (N/7) : 4 values in each of the}}
\DoxyCodeLine{1469 \textcolor{comment}{!  subsets where the median is lower than the median of medians. For similar}}
\DoxyCodeLine{1470 \textcolor{comment}{!  reasons, we also have at least 2N/7 values not lower than XMED7. At the}}
\DoxyCodeLine{1471 \textcolor{comment}{!  same time, we find in each subset the index of the last value < XMED7,}}
\DoxyCodeLine{1472 \textcolor{comment}{!  and that of the first > XMED7. These indices will be used to restrict the}}
\DoxyCodeLine{1473 \textcolor{comment}{!  search for the median as the Kth element in the subset (> or <) where}}
\DoxyCodeLine{1474 \textcolor{comment}{!  we know it to be.}}
\DoxyCodeLine{1475 \textcolor{comment}{!}}
\DoxyCodeLine{1476          idon1 = 1}
\DoxyCodeLine{1477          nleq = 0}
\DoxyCodeLine{1478          nequ = 0}
\DoxyCodeLine{1479          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1480             imed = idon+3}
\DoxyCodeLine{1481             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1482                   imed = imed -\/ 2}
\DoxyCodeLine{1483                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1484                      imed = imed -\/ 1}
\DoxyCodeLine{1485                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1486                      imed = imed + 1}
\DoxyCodeLine{1487 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{1488             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1489                   imed = imed + 2}
\DoxyCodeLine{1490                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1491                      imed = imed -\/ 1}
\DoxyCodeLine{1492                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1493                      imed = imed + 1}
\DoxyCodeLine{1494 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{1495 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{1496             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1497                nleq = nleq + imed -\/ idon}
\DoxyCodeLine{1498                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{1499                istrt(idon1) = imed}
\DoxyCodeLine{1500             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1501                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{1502                iendt(idon1) = imed}
\DoxyCodeLine{1503                istrt(idon1) = imed + 1}
\DoxyCodeLine{1504             \textcolor{keywordflow}{Else}                    \textcolor{comment}{!       If (XDATT (IWRKT (IMED)) == XMED7)}}
\DoxyCodeLine{1505                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{1506                nequ = nequ + 1}
\DoxyCodeLine{1507                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{1508                \textcolor{keywordflow}{Do} imed1 = imed -\/ 1, idon, -\/1}
\DoxyCodeLine{1509                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1510                      nequ = nequ + 1}
\DoxyCodeLine{1511                      iendt(idon1) = imed1 -\/ 1}
\DoxyCodeLine{1512                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1513                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1514 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1515 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1516                istrt(idon1) = imed + 1}
\DoxyCodeLine{1517                \textcolor{keywordflow}{Do} imed1 = imed + 1, idon + 6}
\DoxyCodeLine{1518                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1519                      nequ = nequ + 1}
\DoxyCodeLine{1520                      nleq = nleq + 1}
\DoxyCodeLine{1521                      istrt(idon1) = imed1 + 1}
\DoxyCodeLine{1522                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1523                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1524 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1525 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1526 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{1527             idon1 = idon1 + 1}
\DoxyCodeLine{1528 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1529 \textcolor{comment}{!}}
\DoxyCodeLine{1530 \textcolor{comment}{!  Carry out a partial insertion sort to find the Kth smallest of the}}
\DoxyCodeLine{1531 \textcolor{comment}{!  large values, or the Kth largest of the small values, according to}}
\DoxyCodeLine{1532 \textcolor{comment}{!  what is needed.}}
\DoxyCodeLine{1533 \textcolor{comment}{!}}
\DoxyCodeLine{1534 \textcolor{comment}{!}}
\DoxyCodeLine{1535          \textcolor{keywordflow}{If} (nleq -\/ nequ + 1 <= nmed) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1536             \textcolor{keywordflow}{If} (nleq < nmed) \textcolor{keywordflow}{Then}   \textcolor{comment}{!      Not enough low values}}
\DoxyCodeLine{1537                 iwrk1 = imax}
\DoxyCodeLine{1538                 xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1539                 nord = nmed -\/ nleq}
\DoxyCodeLine{1540                 idon1 = 0}
\DoxyCodeLine{1541                 icrs1 = 1}
\DoxyCodeLine{1542                 icrs2 = 0}
\DoxyCodeLine{1543                 idcr = 0}
\DoxyCodeLine{1544                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1545                    idon1 = idon1 + 1}
\DoxyCodeLine{1546                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1547                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{1548                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1549                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{1550                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{1551                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1552                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1553                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1554 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{1555                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1556                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1557                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1558                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1559                            \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1560                               iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{1561                               iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1562                               xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1563 \textcolor{keywordflow}{                           Endif}}
\DoxyCodeLine{1564 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{1565                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{1566                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{1567 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1568                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1569                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{1570                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1571                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{1572                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{1573                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1574                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1575                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1576 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{1577                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1578                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1579                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1580 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1581 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{1582 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{1583                 ires\_med = iwrk1}
\DoxyCodeLine{1584                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1585             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1586                 ires\_med = imed7}
\DoxyCodeLine{1587                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1588 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1589          \textcolor{keywordflow}{Else}                       \textcolor{comment}{!      If (NLEQ > NMED)}}
\DoxyCodeLine{1590 \textcolor{comment}{!                                          Not enough high values}}
\DoxyCodeLine{1591                 xwrk1 = xhuge}
\DoxyCodeLine{1592                 nord = nleq -\/ nequ -\/ nmed + 1}
\DoxyCodeLine{1593                 idon1 = 0}
\DoxyCodeLine{1594                 icrs1 = 1}
\DoxyCodeLine{1595                 icrs2 = 0}
\DoxyCodeLine{1596                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1597                    idon1 = idon1 + 1}
\DoxyCodeLine{1598                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1599 \textcolor{comment}{!}}
\DoxyCodeLine{1600                       \textcolor{keywordflow}{Do} icrs = idon, iendt(idon1)}
\DoxyCodeLine{1601                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) > xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1602                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{1603                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{1604                             idcr = icrs1 -\/ 1}
\DoxyCodeLine{1605                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1606                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1607                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1608 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{1609                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1610                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1611                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1612                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1613                             \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1614                                iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{1615                                iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1616                                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1617 \textcolor{keywordflow}{                            End If}}
\DoxyCodeLine{1618 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{1619                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{1620                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{1621 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1622                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1623                       \textcolor{keywordflow}{Do} icrs = iendt(idon1), idon, -\/1}
\DoxyCodeLine{1624                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) <= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1625                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{1626                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{1627                          idcr = icrs1 -\/ 1}
\DoxyCodeLine{1628                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1629                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1630                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1631 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{1632                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1633                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1634                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1635 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1636 \textcolor{keywordflow}{                   Endif}}
\DoxyCodeLine{1637 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{1638 \textcolor{comment}{!}}
\DoxyCodeLine{1639                 ires\_med = iwrk1}
\DoxyCodeLine{1640                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1641 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1642 \textcolor{comment}{!}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__indmed_aa5d0f86c27fd1bb30075f4f8750a51a7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_a9da950c4d7af4db3c506d2d4644df3b7}\label{namespacem__indmed_a9da950c4d7af4db3c506d2d4644df3b7}} 
\index{m\_indmed@{m\_indmed}!int32\_indmed@{int32\_indmed}}
\index{int32\_indmed@{int32\_indmed}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{int32\_indmed()}{int32\_indmed()}}
{\footnotesize\ttfamily subroutine m\+\_\+indmed\+::int32\+\_\+indmed (\begin{DoxyParamCaption}\item[{integer (kind=int32), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, intent(out)}]{O\+U\+T\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{870       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: INVALS}
\DoxyCodeLine{871       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: OUTORD}
\DoxyCodeLine{872 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{873       \textcolor{keywordtype}{Integer} :: IDON}
\DoxyCodeLine{874 \textcolor{comment}{!}}
\DoxyCodeLine{875       \textcolor{keyword}{Allocate} (idont(\textcolor{keyword}{SIZE}(invals)))}
\DoxyCodeLine{876       \textcolor{keywordflow}{Do} idon = 1, \textcolor{keyword}{SIZE}(invals)}
\DoxyCodeLine{877          idont(idon) = idon}
\DoxyCodeLine{878 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{879 \textcolor{comment}{!}}
\DoxyCodeLine{880       \textcolor{keyword}{Call }int32\_med (invals, idont, outord)}
\DoxyCodeLine{881 \textcolor{comment}{!}}
\DoxyCodeLine{882       \textcolor{keyword}{Deallocate} (idont)}

\end{DoxyCode}


References idont, and int32\+\_\+med().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__indmed_a9da950c4d7af4db3c506d2d4644df3b7_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_a7a7a1cbb857bc1672280ab38e8abe92b}\label{namespacem__indmed_a7a7a1cbb857bc1672280ab38e8abe92b}} 
\index{m\_indmed@{m\_indmed}!int32\_med@{int32\_med}}
\index{int32\_med@{int32\_med}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{int32\_med()}{int32\_med()}}
{\footnotesize\ttfamily recursive subroutine m\+\_\+indmed\+::int32\+\_\+med (\begin{DoxyParamCaption}\item[{integer (kind=int32), dimension (\+:), intent(in)}]{X\+D\+A\+TT,  }\item[{integer, dimension (\+:), intent(in)}]{I\+D\+A\+TT,  }\item[{integer, intent(out)}]{ires\+\_\+med }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{886       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDATT}
\DoxyCodeLine{887       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: IDATT}
\DoxyCodeLine{888       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)}:: ires\_med}
\DoxyCodeLine{889 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{890 \textcolor{comment}{!}}
\DoxyCodeLine{891       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Parameter} :: XHUGE = -\/huge (xdatt)}
\DoxyCodeLine{892       \textcolor{keywordtype}{Integer (kind=int32)} :: XWRK, XWRK1, XMED7, XMAX, XMIN}
\DoxyCodeLine{893 \textcolor{comment}{!}}
\DoxyCodeLine{894       \textcolor{keywordtype}{Integer}, Dimension (7*(((Size (IDATT)+6)/7+6)/7)) :: ISTRT, IENDT,\textcolor{comment}{ IMEDT}}
\DoxyCodeLine{895 \textcolor{comment}{      }\textcolor{keywordtype}{Integer}, Dimension (7*((Size(IDATT)+6)/7)) :: IWRKT}
\DoxyCodeLine{896       \textcolor{keywordtype}{Integer} :: NTRI, NMED, NORD, NEQU, NLEQ, IMED, IDON, IDON1}
\DoxyCodeLine{897       \textcolor{keywordtype}{Integer} :: IDEB, ITMP, IDCR, ICRS, ICRS1, ICRS2, IMAX, IMIN}
\DoxyCodeLine{898       \textcolor{keywordtype}{Integer} :: IWRK, IWRK1, IMED1, IMED7, NDAT}
\DoxyCodeLine{899 \textcolor{comment}{!}}
\DoxyCodeLine{900       ndat = \textcolor{keyword}{Size} (idatt)}
\DoxyCodeLine{901       nmed = (ndat+1) / 2}
\DoxyCodeLine{902       iwrkt(:\textcolor{keyword}{size}(idatt)) = idatt}
\DoxyCodeLine{903 \textcolor{comment}{!}}
\DoxyCodeLine{904 \textcolor{comment}{!  If the number of values is small, then use insertion sort}}
\DoxyCodeLine{905 \textcolor{comment}{!}}
\DoxyCodeLine{906      \textcolor{keywordflow}{If} (ndat < 35) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{907 \textcolor{comment}{!}}
\DoxyCodeLine{908 \textcolor{comment}{!  Bring minimum to first location to save test in decreasing loop}}
\DoxyCodeLine{909 \textcolor{comment}{!}}
\DoxyCodeLine{910          idcr = ndat}
\DoxyCodeLine{911          \textcolor{keywordflow}{If} (xdatt(iwrkt(1)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{912             iwrk = iwrkt(1)}
\DoxyCodeLine{913          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{914             iwrk = iwrkt(idcr)}
\DoxyCodeLine{915             iwrkt(idcr) = iwrkt(1)}
\DoxyCodeLine{916 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{917          xwrk = xdatt(iwrk)}
\DoxyCodeLine{918          \textcolor{keywordflow}{Do} itmp = 1, ndat -\/ 2}
\DoxyCodeLine{919             idcr = idcr -\/ 1}
\DoxyCodeLine{920             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{921             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{922             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{923                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{924                 xwrk = xwrk1}
\DoxyCodeLine{925                 iwrk = iwrk1}
\DoxyCodeLine{926 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{927 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{928          iwrkt(1) = iwrk}
\DoxyCodeLine{929 \textcolor{comment}{!}}
\DoxyCodeLine{930 \textcolor{comment}{! Sort the first half, until we have NMED sorted values}}
\DoxyCodeLine{931 \textcolor{comment}{!}}
\DoxyCodeLine{932          \textcolor{keywordflow}{Do} icrs = 3, nmed}
\DoxyCodeLine{933             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{934             iwrk = iwrkt(icrs)}
\DoxyCodeLine{935             idcr = icrs -\/ 1}
\DoxyCodeLine{936             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{937                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{938                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{939                   idcr = idcr -\/ 1}
\DoxyCodeLine{940 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{941             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{942 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{943 \textcolor{comment}{!}}
\DoxyCodeLine{944 \textcolor{comment}{!  Insert any value less than the current median in the first half}}
\DoxyCodeLine{945 \textcolor{comment}{!}}
\DoxyCodeLine{946          xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{947          \textcolor{keywordflow}{Do} icrs = nmed+1, ndat}
\DoxyCodeLine{948             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{949             iwrk = iwrkt(icrs)}
\DoxyCodeLine{950             \textcolor{keywordflow}{If} (xwrk < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{951                idcr = nmed -\/ 1}
\DoxyCodeLine{952                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{953                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{954                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{955                   idcr = idcr -\/ 1}
\DoxyCodeLine{956 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{957                iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{958                xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{959 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{960 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{961          ires\_med = iwrkt(nmed)}
\DoxyCodeLine{962          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{963 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{964 \textcolor{comment}{!}}
\DoxyCodeLine{965 \textcolor{comment}{!  Make sorted subsets of 7 elements}}
\DoxyCodeLine{966 \textcolor{comment}{!  This is done by a variant of insertion sort where a first}}
\DoxyCodeLine{967 \textcolor{comment}{!  pass is used to bring the smallest element to the first position}}
\DoxyCodeLine{968 \textcolor{comment}{!  decreasing disorder at the same time, so that we may remove}}
\DoxyCodeLine{969 \textcolor{comment}{!  the loop test in the insertion loop.}}
\DoxyCodeLine{970 \textcolor{comment}{!}}
\DoxyCodeLine{971       imax = 1}
\DoxyCodeLine{972       imin = 1}
\DoxyCodeLine{973       xmax = xdatt(iwrkt(imax))}
\DoxyCodeLine{974       xmin = xdatt(iwrkt(imin))}
\DoxyCodeLine{975       \textcolor{keywordflow}{DO} ideb = 1, ndat-\/6, 7}
\DoxyCodeLine{976          idcr = ideb + 6}
\DoxyCodeLine{977          \textcolor{keywordflow}{If} (xdatt(iwrkt(ideb)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{978             iwrk = iwrkt(ideb)}
\DoxyCodeLine{979          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{980             iwrk = iwrkt(idcr)}
\DoxyCodeLine{981             iwrkt(idcr) = iwrkt(ideb)}
\DoxyCodeLine{982 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{983          xwrk = xdatt(iwrk)}
\DoxyCodeLine{984          \textcolor{keywordflow}{Do} itmp = 1, 5}
\DoxyCodeLine{985             idcr = idcr -\/ 1}
\DoxyCodeLine{986             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{987             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{988             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{989                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{990                 iwrk = iwrk1}
\DoxyCodeLine{991                 xwrk = xwrk1}
\DoxyCodeLine{992 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{993 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{994          iwrkt(ideb) = iwrk}
\DoxyCodeLine{995          \textcolor{keywordflow}{If} (xwrk < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{996              imin = iwrk}
\DoxyCodeLine{997              xmin = xwrk}
\DoxyCodeLine{998 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{999          \textcolor{keywordflow}{Do} icrs = ideb+1, ideb+5}
\DoxyCodeLine{1000             iwrk = iwrkt(icrs+1)}
\DoxyCodeLine{1001             xwrk = xdatt(iwrk)}
\DoxyCodeLine{1002             idon = iwrkt(icrs)}
\DoxyCodeLine{1003             \textcolor{keywordflow}{If} (xwrk < xdatt(idon)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1004                iwrkt(icrs+1) = idon}
\DoxyCodeLine{1005                idcr = icrs}
\DoxyCodeLine{1006                iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{1007                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1008                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{1009                   \textcolor{keywordflow}{If} (xwrk >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1010                   iwrkt(idcr) = iwrk1}
\DoxyCodeLine{1011                   idcr = idcr -\/ 1}
\DoxyCodeLine{1012                   iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{1013                   xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1014 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1015                iwrkt(idcr) = iwrk}
\DoxyCodeLine{1016 \textcolor{keywordflow}{            EndIf}}
\DoxyCodeLine{1017 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1018          \textcolor{keywordflow}{If} (xwrk > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1019              imax = iwrk}
\DoxyCodeLine{1020              xmax = xwrk}
\DoxyCodeLine{1021 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1022 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{1023 \textcolor{comment}{!}}
\DoxyCodeLine{1024 \textcolor{comment}{!  Add-\/up alternatively MAX and MIN values to make the number of data}}
\DoxyCodeLine{1025 \textcolor{comment}{!  an exact multiple of 7.}}
\DoxyCodeLine{1026 \textcolor{comment}{!}}
\DoxyCodeLine{1027       ideb = 7 * (ndat/7)}
\DoxyCodeLine{1028       ntri = ndat}
\DoxyCodeLine{1029       \textcolor{keywordflow}{If} (ideb < ndat) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1030 \textcolor{comment}{!}}
\DoxyCodeLine{1031          \textcolor{keywordflow}{Do} icrs = ideb+1, ndat}
\DoxyCodeLine{1032             xwrk1 = xdatt(iwrkt(icrs))}
\DoxyCodeLine{1033             \textcolor{keywordflow}{IF} (xwrk1 > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1034                imax = iwrkt(icrs)}
\DoxyCodeLine{1035                xmax = xwrk1}
\DoxyCodeLine{1036 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1037             \textcolor{keywordflow}{IF} (xwrk1 < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1038                imin = iwrkt(icrs)}
\DoxyCodeLine{1039                xmin = xwrk1}
\DoxyCodeLine{1040 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1041 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1042          iwrk1 = imax}
\DoxyCodeLine{1043          \textcolor{keywordflow}{Do} icrs = ndat+1, ideb+7}
\DoxyCodeLine{1044                iwrkt(icrs) = iwrk1}
\DoxyCodeLine{1045                \textcolor{keywordflow}{If} (iwrk1 == imax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1046                   iwrk1 = imin}
\DoxyCodeLine{1047                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1048                   nmed = nmed + 1}
\DoxyCodeLine{1049                   iwrk1 = imax}
\DoxyCodeLine{1050 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1051 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1052 \textcolor{comment}{!}}
\DoxyCodeLine{1053          \textcolor{keywordflow}{Do} icrs = ideb+2, ideb+7}
\DoxyCodeLine{1054             iwrk = iwrkt(icrs)}
\DoxyCodeLine{1055             xwrk = xdatt(iwrk)}
\DoxyCodeLine{1056             \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, ideb+1, -\/ 1}
\DoxyCodeLine{1057                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1058                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1059 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1060             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1061 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1062 \textcolor{comment}{!}}
\DoxyCodeLine{1063          ntri = ideb+7}
\DoxyCodeLine{1064 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1065 \textcolor{comment}{!}}
\DoxyCodeLine{1066 \textcolor{comment}{!  Make the set of the indices of median values of each sorted subset}}
\DoxyCodeLine{1067 \textcolor{comment}{!}}
\DoxyCodeLine{1068          idon1 = 0}
\DoxyCodeLine{1069          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1070             idon1 = idon1 + 1}
\DoxyCodeLine{1071             imedt(idon1) = iwrkt(idon + 3)}
\DoxyCodeLine{1072 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1073 \textcolor{comment}{!}}
\DoxyCodeLine{1074 \textcolor{comment}{!  Find XMED7, the median of the medians}}
\DoxyCodeLine{1075 \textcolor{comment}{!}}
\DoxyCodeLine{1076          \textcolor{keyword}{Call }int32\_med (xdatt, imedt(1:idon1), imed7)}
\DoxyCodeLine{1077          xmed7 = xdatt(imed7)}
\DoxyCodeLine{1078 \textcolor{comment}{!}}
\DoxyCodeLine{1079 \textcolor{comment}{!  Count how many values are not higher than (and how many equal to) XMED7}}
\DoxyCodeLine{1080 \textcolor{comment}{!  This number is at least 4 * 1/2 * (N/7) : 4 values in each of the}}
\DoxyCodeLine{1081 \textcolor{comment}{!  subsets where the median is lower than the median of medians. For similar}}
\DoxyCodeLine{1082 \textcolor{comment}{!  reasons, we also have at least 2N/7 values not lower than XMED7. At the}}
\DoxyCodeLine{1083 \textcolor{comment}{!  same time, we find in each subset the index of the last value < XMED7,}}
\DoxyCodeLine{1084 \textcolor{comment}{!  and that of the first > XMED7. These indices will be used to restrict the}}
\DoxyCodeLine{1085 \textcolor{comment}{!  search for the median as the Kth element in the subset (> or <) where}}
\DoxyCodeLine{1086 \textcolor{comment}{!  we know it to be.}}
\DoxyCodeLine{1087 \textcolor{comment}{!}}
\DoxyCodeLine{1088          idon1 = 1}
\DoxyCodeLine{1089          nleq = 0}
\DoxyCodeLine{1090          nequ = 0}
\DoxyCodeLine{1091          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1092             imed = idon+3}
\DoxyCodeLine{1093             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1094                   imed = imed -\/ 2}
\DoxyCodeLine{1095                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1096                      imed = imed -\/ 1}
\DoxyCodeLine{1097                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1098                      imed = imed + 1}
\DoxyCodeLine{1099 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{1100             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1101                   imed = imed + 2}
\DoxyCodeLine{1102                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1103                      imed = imed -\/ 1}
\DoxyCodeLine{1104                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1105                      imed = imed + 1}
\DoxyCodeLine{1106 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{1107 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{1108             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1109                nleq = nleq + imed -\/ idon}
\DoxyCodeLine{1110                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{1111                istrt(idon1) = imed}
\DoxyCodeLine{1112             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1113                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{1114                iendt(idon1) = imed}
\DoxyCodeLine{1115                istrt(idon1) = imed + 1}
\DoxyCodeLine{1116             \textcolor{keywordflow}{Else}                    \textcolor{comment}{!       If (XDATT (IWRKT (IMED)) == XMED7)}}
\DoxyCodeLine{1117                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{1118                nequ = nequ + 1}
\DoxyCodeLine{1119                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{1120                \textcolor{keywordflow}{Do} imed1 = imed -\/ 1, idon, -\/1}
\DoxyCodeLine{1121                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1122                      nequ = nequ + 1}
\DoxyCodeLine{1123                      iendt(idon1) = imed1 -\/ 1}
\DoxyCodeLine{1124                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1125                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1126 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1127 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1128                istrt(idon1) = imed + 1}
\DoxyCodeLine{1129                \textcolor{keywordflow}{Do} imed1 = imed + 1, idon + 6}
\DoxyCodeLine{1130                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1131                      nequ = nequ + 1}
\DoxyCodeLine{1132                      nleq = nleq + 1}
\DoxyCodeLine{1133                      istrt(idon1) = imed1 + 1}
\DoxyCodeLine{1134                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1135                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1136 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1137 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1138 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{1139             idon1 = idon1 + 1}
\DoxyCodeLine{1140 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1141 \textcolor{comment}{!}}
\DoxyCodeLine{1142 \textcolor{comment}{!  Carry out a partial insertion sort to find the Kth smallest of the}}
\DoxyCodeLine{1143 \textcolor{comment}{!  large values, or the Kth largest of the small values, according to}}
\DoxyCodeLine{1144 \textcolor{comment}{!  what is needed.}}
\DoxyCodeLine{1145 \textcolor{comment}{!}}
\DoxyCodeLine{1146 \textcolor{comment}{!}}
\DoxyCodeLine{1147          \textcolor{keywordflow}{If} (nleq -\/ nequ + 1 <= nmed) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1148             \textcolor{keywordflow}{If} (nleq < nmed) \textcolor{keywordflow}{Then}   \textcolor{comment}{!      Not enough low values}}
\DoxyCodeLine{1149                 iwrk1 = imax}
\DoxyCodeLine{1150                 xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1151                 nord = nmed -\/ nleq}
\DoxyCodeLine{1152                 idon1 = 0}
\DoxyCodeLine{1153                 icrs1 = 1}
\DoxyCodeLine{1154                 icrs2 = 0}
\DoxyCodeLine{1155                 idcr = 0}
\DoxyCodeLine{1156                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1157                    idon1 = idon1 + 1}
\DoxyCodeLine{1158                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1159                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{1160                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1161                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{1162                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{1163                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1164                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1165                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1166 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{1167                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1168                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1169                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1170                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1171                            \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1172                               iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{1173                               iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1174                               xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1175 \textcolor{keywordflow}{                           Endif}}
\DoxyCodeLine{1176 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{1177                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{1178                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{1179 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1180                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1181                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{1182                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1183                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{1184                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{1185                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1186                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1187                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1188 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{1189                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1190                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1191                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1192 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1193 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{1194 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{1195                 ires\_med = iwrk1}
\DoxyCodeLine{1196                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1197             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1198                 ires\_med = imed7}
\DoxyCodeLine{1199                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1200 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1201          \textcolor{keywordflow}{Else}                       \textcolor{comment}{!      If (NLEQ > NMED)}}
\DoxyCodeLine{1202 \textcolor{comment}{!                                          Not enough high values}}
\DoxyCodeLine{1203                 xwrk1 = xhuge}
\DoxyCodeLine{1204                 nord = nleq -\/ nequ -\/ nmed + 1}
\DoxyCodeLine{1205                 idon1 = 0}
\DoxyCodeLine{1206                 icrs1 = 1}
\DoxyCodeLine{1207                 icrs2 = 0}
\DoxyCodeLine{1208                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1209                    idon1 = idon1 + 1}
\DoxyCodeLine{1210                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1211 \textcolor{comment}{!}}
\DoxyCodeLine{1212                       \textcolor{keywordflow}{Do} icrs = idon, iendt(idon1)}
\DoxyCodeLine{1213                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) > xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1214                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{1215                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{1216                             idcr = icrs1 -\/ 1}
\DoxyCodeLine{1217                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1218                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1219                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1220 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{1221                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1222                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1223                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1224                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1225                             \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1226                                iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{1227                                iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1228                                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1229 \textcolor{keywordflow}{                            End If}}
\DoxyCodeLine{1230 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{1231                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{1232                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{1233 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1234                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1235                       \textcolor{keywordflow}{Do} icrs = iendt(idon1), idon, -\/1}
\DoxyCodeLine{1236                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) <= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1237                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{1238                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{1239                          idcr = icrs1 -\/ 1}
\DoxyCodeLine{1240                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1241                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1242                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1243 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{1244                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1245                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1246                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1247 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1248 \textcolor{keywordflow}{                   Endif}}
\DoxyCodeLine{1249 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{1250 \textcolor{comment}{!}}
\DoxyCodeLine{1251                 ires\_med = iwrk1}
\DoxyCodeLine{1252                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1253 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1254 \textcolor{comment}{!}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__indmed_a7a7a1cbb857bc1672280ab38e8abe92b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_a3e2428b49026a92e90f29c8f1194f9ed}\label{namespacem__indmed_a3e2428b49026a92e90f29c8f1194f9ed}} 
\index{m\_indmed@{m\_indmed}!real32\_indmed@{real32\_indmed}}
\index{real32\_indmed@{real32\_indmed}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{real32\_indmed()}{real32\_indmed()}}
{\footnotesize\ttfamily subroutine m\+\_\+indmed\+::real32\+\_\+indmed (\begin{DoxyParamCaption}\item[{real (kind=real32), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, intent(out)}]{O\+U\+T\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{483 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: invals}
\DoxyCodeLine{484       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: OUTORD}
\DoxyCodeLine{485 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{486       \textcolor{keywordtype}{Integer} :: IDON}
\DoxyCodeLine{487 \textcolor{comment}{!}}
\DoxyCodeLine{488       \textcolor{keyword}{Allocate} (idont(\textcolor{keyword}{SIZE}(invals)))}
\DoxyCodeLine{489       \textcolor{keywordflow}{Do} idon = 1, \textcolor{keyword}{SIZE}(invals)}
\DoxyCodeLine{490          idont(idon) = idon}
\DoxyCodeLine{491 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{492 \textcolor{comment}{!}}
\DoxyCodeLine{493       \textcolor{keyword}{Call }real32\_med (invals, idont, outord)}
\DoxyCodeLine{494 \textcolor{comment}{!}}
\DoxyCodeLine{495       \textcolor{keyword}{Deallocate} (idont)}

\end{DoxyCode}


References idont, and real32\+\_\+med().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__indmed_a3e2428b49026a92e90f29c8f1194f9ed_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_abb66bb589821afa90ddd8bda8fcf609b}\label{namespacem__indmed_abb66bb589821afa90ddd8bda8fcf609b}} 
\index{m\_indmed@{m\_indmed}!real32\_med@{real32\_med}}
\index{real32\_med@{real32\_med}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{real32\_med()}{real32\_med()}}
{\footnotesize\ttfamily recursive subroutine m\+\_\+indmed\+::real32\+\_\+med (\begin{DoxyParamCaption}\item[{real (kind=real32), dimension (\+:), intent(in)}]{X\+D\+A\+TT,  }\item[{integer, dimension (\+:), intent(in)}]{I\+D\+A\+TT,  }\item[{integer, intent(out)}]{ires\+\_\+med }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{499 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdatt}
\DoxyCodeLine{500       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: IDATT}
\DoxyCodeLine{501       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)}:: ires\_med}
\DoxyCodeLine{502 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{503 \textcolor{comment}{!}}
\DoxyCodeLine{504 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Parameter} :: xhuge = -\/huge(xdatt)}
\DoxyCodeLine{505 \textcolor{keywordtype}{      Real} (kind=real32) :: xwrk, xwrk1, xmed7, xmax, xmin}
\DoxyCodeLine{506 \textcolor{comment}{!}}
\DoxyCodeLine{507       \textcolor{keywordtype}{Integer}, Dimension (7*(((Size (IDATT)+6)/7+6)/7)) :: ISTRT, IENDT,\textcolor{comment}{ IMEDT}}
\DoxyCodeLine{508 \textcolor{comment}{      }\textcolor{keywordtype}{Integer}, Dimension (7*((Size(IDATT)+6)/7)) :: IWRKT}
\DoxyCodeLine{509       \textcolor{keywordtype}{Integer} :: NTRI, NMED, NORD, NEQU, NLEQ, IMED, IDON, IDON1}
\DoxyCodeLine{510       \textcolor{keywordtype}{Integer} :: IDEB, ITMP, IDCR, ICRS, ICRS1, ICRS2, IMAX, IMIN}
\DoxyCodeLine{511       \textcolor{keywordtype}{Integer} :: IWRK, IWRK1, IMED1, IMED7, NDAT}
\DoxyCodeLine{512 \textcolor{comment}{!}}
\DoxyCodeLine{513       ndat = \textcolor{keyword}{Size} (idatt)}
\DoxyCodeLine{514       nmed = (ndat+1) / 2}
\DoxyCodeLine{515       iwrkt(:\textcolor{keyword}{size}(idatt)) = idatt}
\DoxyCodeLine{516 \textcolor{comment}{!}}
\DoxyCodeLine{517 \textcolor{comment}{!  If the number of values is small, then use insertion sort}}
\DoxyCodeLine{518 \textcolor{comment}{!}}
\DoxyCodeLine{519      \textcolor{keywordflow}{If} (ndat < 35) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{520 \textcolor{comment}{!}}
\DoxyCodeLine{521 \textcolor{comment}{!  Bring minimum to first location to save test in decreasing loop}}
\DoxyCodeLine{522 \textcolor{comment}{!}}
\DoxyCodeLine{523          idcr = ndat}
\DoxyCodeLine{524          \textcolor{keywordflow}{If} (xdatt(iwrkt(1)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{525             iwrk = iwrkt(1)}
\DoxyCodeLine{526          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{527             iwrk = iwrkt(idcr)}
\DoxyCodeLine{528             iwrkt(idcr) = iwrkt(1)}
\DoxyCodeLine{529 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{530          xwrk = xdatt(iwrk)}
\DoxyCodeLine{531          \textcolor{keywordflow}{Do} itmp = 1, ndat -\/ 2}
\DoxyCodeLine{532             idcr = idcr -\/ 1}
\DoxyCodeLine{533             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{534             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{535             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{536                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{537                 xwrk = xwrk1}
\DoxyCodeLine{538                 iwrk = iwrk1}
\DoxyCodeLine{539 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{540 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{541          iwrkt(1) = iwrk}
\DoxyCodeLine{542 \textcolor{comment}{!}}
\DoxyCodeLine{543 \textcolor{comment}{! Sort the first half, until we have NMED sorted values}}
\DoxyCodeLine{544 \textcolor{comment}{!}}
\DoxyCodeLine{545          \textcolor{keywordflow}{Do} icrs = 3, nmed}
\DoxyCodeLine{546             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{547             iwrk = iwrkt(icrs)}
\DoxyCodeLine{548             idcr = icrs -\/ 1}
\DoxyCodeLine{549             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{550                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{551                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{552                   idcr = idcr -\/ 1}
\DoxyCodeLine{553 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{554             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{555 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{556 \textcolor{comment}{!}}
\DoxyCodeLine{557 \textcolor{comment}{!  Insert any value less than the current median in the first half}}
\DoxyCodeLine{558 \textcolor{comment}{!}}
\DoxyCodeLine{559          xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{560          \textcolor{keywordflow}{Do} icrs = nmed+1, ndat}
\DoxyCodeLine{561             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{562             iwrk = iwrkt(icrs)}
\DoxyCodeLine{563             \textcolor{keywordflow}{If} (xwrk < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{564                idcr = nmed -\/ 1}
\DoxyCodeLine{565                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{566                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{567                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{568                   idcr = idcr -\/ 1}
\DoxyCodeLine{569 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{570                iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{571                xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{572 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{573 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{574          ires\_med = iwrkt(nmed)}
\DoxyCodeLine{575          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{576 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{577 \textcolor{comment}{!}}
\DoxyCodeLine{578 \textcolor{comment}{!  Make sorted subsets of 7 elements}}
\DoxyCodeLine{579 \textcolor{comment}{!  This is done by a variant of insertion sort where a first}}
\DoxyCodeLine{580 \textcolor{comment}{!  pass is used to bring the smallest element to the first position}}
\DoxyCodeLine{581 \textcolor{comment}{!  decreasing disorder at the same time, so that we may remove}}
\DoxyCodeLine{582 \textcolor{comment}{!  the loop test in the insertion loop.}}
\DoxyCodeLine{583 \textcolor{comment}{!}}
\DoxyCodeLine{584       imax = 1}
\DoxyCodeLine{585       imin = 1}
\DoxyCodeLine{586       xmax = xdatt(iwrkt(imax))}
\DoxyCodeLine{587       xmin = xdatt(iwrkt(imin))}
\DoxyCodeLine{588       \textcolor{keywordflow}{DO} ideb = 1, ndat-\/6, 7}
\DoxyCodeLine{589          idcr = ideb + 6}
\DoxyCodeLine{590          \textcolor{keywordflow}{If} (xdatt(iwrkt(ideb)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{591             iwrk = iwrkt(ideb)}
\DoxyCodeLine{592          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{593             iwrk = iwrkt(idcr)}
\DoxyCodeLine{594             iwrkt(idcr) = iwrkt(ideb)}
\DoxyCodeLine{595 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{596          xwrk = xdatt(iwrk)}
\DoxyCodeLine{597          \textcolor{keywordflow}{Do} itmp = 1, 5}
\DoxyCodeLine{598             idcr = idcr -\/ 1}
\DoxyCodeLine{599             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{600             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{601             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{602                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{603                 iwrk = iwrk1}
\DoxyCodeLine{604                 xwrk = xwrk1}
\DoxyCodeLine{605 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{606 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{607          iwrkt(ideb) = iwrk}
\DoxyCodeLine{608          \textcolor{keywordflow}{If} (xwrk < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{609              imin = iwrk}
\DoxyCodeLine{610              xmin = xwrk}
\DoxyCodeLine{611 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{612          \textcolor{keywordflow}{Do} icrs = ideb+1, ideb+5}
\DoxyCodeLine{613             iwrk = iwrkt(icrs+1)}
\DoxyCodeLine{614             xwrk = xdatt(iwrk)}
\DoxyCodeLine{615             idon = iwrkt(icrs)}
\DoxyCodeLine{616             \textcolor{keywordflow}{If} (xwrk < xdatt(idon)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{617                iwrkt(icrs+1) = idon}
\DoxyCodeLine{618                idcr = icrs}
\DoxyCodeLine{619                iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{620                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{621                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{622                   \textcolor{keywordflow}{If} (xwrk >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{623                   iwrkt(idcr) = iwrk1}
\DoxyCodeLine{624                   idcr = idcr -\/ 1}
\DoxyCodeLine{625                   iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{626                   xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{627 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{628                iwrkt(idcr) = iwrk}
\DoxyCodeLine{629 \textcolor{keywordflow}{            EndIf}}
\DoxyCodeLine{630 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{631          \textcolor{keywordflow}{If} (xwrk > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{632              imax = iwrk}
\DoxyCodeLine{633              xmax = xwrk}
\DoxyCodeLine{634 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{635 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{636 \textcolor{comment}{!}}
\DoxyCodeLine{637 \textcolor{comment}{!  Add-\/up alternatively MAX and MIN values to make the number of data}}
\DoxyCodeLine{638 \textcolor{comment}{!  an exact multiple of 7.}}
\DoxyCodeLine{639 \textcolor{comment}{!}}
\DoxyCodeLine{640       ideb = 7 * (ndat/7)}
\DoxyCodeLine{641       ntri = ndat}
\DoxyCodeLine{642       \textcolor{keywordflow}{If} (ideb < ndat) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{643 \textcolor{comment}{!}}
\DoxyCodeLine{644          \textcolor{keywordflow}{Do} icrs = ideb+1, ndat}
\DoxyCodeLine{645             xwrk1 = xdatt(iwrkt(icrs))}
\DoxyCodeLine{646             \textcolor{keywordflow}{IF} (xwrk1 > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{647                imax = iwrkt(icrs)}
\DoxyCodeLine{648                xmax = xwrk1}
\DoxyCodeLine{649 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{650             \textcolor{keywordflow}{IF} (xwrk1 < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{651                imin = iwrkt(icrs)}
\DoxyCodeLine{652                xmin = xwrk1}
\DoxyCodeLine{653 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{654 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{655          iwrk1 = imax}
\DoxyCodeLine{656          \textcolor{keywordflow}{Do} icrs = ndat+1, ideb+7}
\DoxyCodeLine{657                iwrkt(icrs) = iwrk1}
\DoxyCodeLine{658                \textcolor{keywordflow}{If} (iwrk1 == imax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{659                   iwrk1 = imin}
\DoxyCodeLine{660                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{661                   nmed = nmed + 1}
\DoxyCodeLine{662                   iwrk1 = imax}
\DoxyCodeLine{663 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{664 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{665 \textcolor{comment}{!}}
\DoxyCodeLine{666          \textcolor{keywordflow}{Do} icrs = ideb+2, ideb+7}
\DoxyCodeLine{667             iwrk = iwrkt(icrs)}
\DoxyCodeLine{668             xwrk = xdatt(iwrk)}
\DoxyCodeLine{669             \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, ideb+1, -\/ 1}
\DoxyCodeLine{670                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{671                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{672 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{673             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{674 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{675 \textcolor{comment}{!}}
\DoxyCodeLine{676          ntri = ideb+7}
\DoxyCodeLine{677 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{678 \textcolor{comment}{!}}
\DoxyCodeLine{679 \textcolor{comment}{!  Make the set of the indices of median values of each sorted subset}}
\DoxyCodeLine{680 \textcolor{comment}{!}}
\DoxyCodeLine{681          idon1 = 0}
\DoxyCodeLine{682          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{683             idon1 = idon1 + 1}
\DoxyCodeLine{684             imedt(idon1) = iwrkt(idon + 3)}
\DoxyCodeLine{685 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{686 \textcolor{comment}{!}}
\DoxyCodeLine{687 \textcolor{comment}{!  Find XMED7, the median of the medians}}
\DoxyCodeLine{688 \textcolor{comment}{!}}
\DoxyCodeLine{689          \textcolor{keyword}{Call }real32\_med (xdatt, imedt(1:idon1), imed7)}
\DoxyCodeLine{690          xmed7 = xdatt(imed7)}
\DoxyCodeLine{691 \textcolor{comment}{!}}
\DoxyCodeLine{692 \textcolor{comment}{!  Count how many values are not higher than (and how many equal to) XMED7}}
\DoxyCodeLine{693 \textcolor{comment}{!  This number is at least 4 * 1/2 * (N/7) : 4 values in each of the}}
\DoxyCodeLine{694 \textcolor{comment}{!  subsets where the median is lower than the median of medians. For similar}}
\DoxyCodeLine{695 \textcolor{comment}{!  reasons, we also have at least 2N/7 values not lower than XMED7. At the}}
\DoxyCodeLine{696 \textcolor{comment}{!  same time, we find in each subset the index of the last value < XMED7,}}
\DoxyCodeLine{697 \textcolor{comment}{!  and that of the first > XMED7. These indices will be used to restrict the}}
\DoxyCodeLine{698 \textcolor{comment}{!  search for the median as the Kth element in the subset (> or <) where}}
\DoxyCodeLine{699 \textcolor{comment}{!  we know it to be.}}
\DoxyCodeLine{700 \textcolor{comment}{!}}
\DoxyCodeLine{701          idon1 = 1}
\DoxyCodeLine{702          nleq = 0}
\DoxyCodeLine{703          nequ = 0}
\DoxyCodeLine{704          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{705             imed = idon+3}
\DoxyCodeLine{706             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{707                   imed = imed -\/ 2}
\DoxyCodeLine{708                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{709                      imed = imed -\/ 1}
\DoxyCodeLine{710                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{711                      imed = imed + 1}
\DoxyCodeLine{712 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{713             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{714                   imed = imed + 2}
\DoxyCodeLine{715                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{716                      imed = imed -\/ 1}
\DoxyCodeLine{717                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{718                      imed = imed + 1}
\DoxyCodeLine{719 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{720 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{721             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{722                nleq = nleq + imed -\/ idon}
\DoxyCodeLine{723                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{724                istrt(idon1) = imed}
\DoxyCodeLine{725             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{726                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{727                iendt(idon1) = imed}
\DoxyCodeLine{728                istrt(idon1) = imed + 1}
\DoxyCodeLine{729             \textcolor{keywordflow}{Else}                    \textcolor{comment}{!       If (XDATT (IWRKT (IMED)) == XMED7)}}
\DoxyCodeLine{730                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{731                nequ = nequ + 1}
\DoxyCodeLine{732                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{733                \textcolor{keywordflow}{Do} imed1 = imed -\/ 1, idon, -\/1}
\DoxyCodeLine{734                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{735                      nequ = nequ + 1}
\DoxyCodeLine{736                      iendt(idon1) = imed1 -\/ 1}
\DoxyCodeLine{737                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{738                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{739 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{740 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{741                istrt(idon1) = imed + 1}
\DoxyCodeLine{742                \textcolor{keywordflow}{Do} imed1 = imed + 1, idon + 6}
\DoxyCodeLine{743                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{744                      nequ = nequ + 1}
\DoxyCodeLine{745                      nleq = nleq + 1}
\DoxyCodeLine{746                      istrt(idon1) = imed1 + 1}
\DoxyCodeLine{747                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{748                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{749 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{750 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{751 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{752             idon1 = idon1 + 1}
\DoxyCodeLine{753 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{754 \textcolor{comment}{!}}
\DoxyCodeLine{755 \textcolor{comment}{!  Carry out a partial insertion sort to find the Kth smallest of the}}
\DoxyCodeLine{756 \textcolor{comment}{!  large values, or the Kth largest of the small values, according to}}
\DoxyCodeLine{757 \textcolor{comment}{!  what is needed.}}
\DoxyCodeLine{758 \textcolor{comment}{!}}
\DoxyCodeLine{759 \textcolor{comment}{!}}
\DoxyCodeLine{760          \textcolor{keywordflow}{If} (nleq -\/ nequ + 1 <= nmed) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{761             \textcolor{keywordflow}{If} (nleq < nmed) \textcolor{keywordflow}{Then}   \textcolor{comment}{!      Not enough low values}}
\DoxyCodeLine{762                 iwrk1 = imax}
\DoxyCodeLine{763                 xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{764                 nord = nmed -\/ nleq}
\DoxyCodeLine{765                 idon1 = 0}
\DoxyCodeLine{766                 icrs1 = 1}
\DoxyCodeLine{767                 icrs2 = 0}
\DoxyCodeLine{768                 idcr = 0}
\DoxyCodeLine{769                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{770                    idon1 = idon1 + 1}
\DoxyCodeLine{771                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{772                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{773                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{774                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{775                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{776                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{777                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{778                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{779 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{780                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{781                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{782                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{783                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{784                            \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{785                               iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{786                               iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{787                               xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{788 \textcolor{keywordflow}{                           Endif}}
\DoxyCodeLine{789 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{790                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{791                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{792 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{793                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{794                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{795                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{796                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{797                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{798                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{799                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{800                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{801 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{802                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{803                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{804                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{805 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{806 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{807 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{808                 ires\_med = iwrk1}
\DoxyCodeLine{809                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{810             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{811                 ires\_med = imed7}
\DoxyCodeLine{812                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{813 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{814          \textcolor{keywordflow}{Else}                       \textcolor{comment}{!      If (NLEQ > NMED)}}
\DoxyCodeLine{815 \textcolor{comment}{!                                          Not enough high values}}
\DoxyCodeLine{816                 xwrk1 = xhuge}
\DoxyCodeLine{817                 nord = nleq -\/ nequ -\/ nmed + 1}
\DoxyCodeLine{818                 idon1 = 0}
\DoxyCodeLine{819                 icrs1 = 1}
\DoxyCodeLine{820                 icrs2 = 0}
\DoxyCodeLine{821                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{822                    idon1 = idon1 + 1}
\DoxyCodeLine{823                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{824 \textcolor{comment}{!}}
\DoxyCodeLine{825                       \textcolor{keywordflow}{Do} icrs = idon, iendt(idon1)}
\DoxyCodeLine{826                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) > xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{827                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{828                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{829                             idcr = icrs1 -\/ 1}
\DoxyCodeLine{830                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{831                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{832                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{833 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{834                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{835                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{836                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{837                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{838                             \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{839                                iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{840                                iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{841                                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{842 \textcolor{keywordflow}{                            End If}}
\DoxyCodeLine{843 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{844                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{845                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{846 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{847                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{848                       \textcolor{keywordflow}{Do} icrs = iendt(idon1), idon, -\/1}
\DoxyCodeLine{849                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) <= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{850                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{851                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{852                          idcr = icrs1 -\/ 1}
\DoxyCodeLine{853                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{854                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{855                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{856 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{857                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{858                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{859                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{860 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{861 \textcolor{keywordflow}{                   Endif}}
\DoxyCodeLine{862 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{863 \textcolor{comment}{!}}
\DoxyCodeLine{864                 ires\_med = iwrk1}
\DoxyCodeLine{865                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{866 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{867 \textcolor{comment}{!}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__indmed_abb66bb589821afa90ddd8bda8fcf609b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_a0bb2d4445d85331ca5395fd31c914567}\label{namespacem__indmed_a0bb2d4445d85331ca5395fd31c914567}} 
\index{m\_indmed@{m\_indmed}!real64\_indmed@{real64\_indmed}}
\index{real64\_indmed@{real64\_indmed}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{real64\_indmed()}{real64\_indmed()}}
{\footnotesize\ttfamily subroutine m\+\_\+indmed\+::real64\+\_\+indmed (\begin{DoxyParamCaption}\item[{real (kind=real64), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, intent(out)}]{O\+U\+T\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\hypertarget{namespacem__indmed_autotoc_md18}{}\doxysubsubsection{N\+A\+ME}\label{namespacem__indmed_autotoc_md18}
medianloc(3f) -\/ \mbox{[}orderpack\+:M\+E\+D\+I\+AN\mbox{]} Returns median value\textquotesingle{}s I\+N\+D\+EX.\hypertarget{namespacem__indmed_autotoc_md19}{}\doxysubsubsection{S\+Y\+N\+O\+P\+S\+IS}\label{namespacem__indmed_autotoc_md19}
\begin{DoxyVerb} Subroutine MedianLoc (INVALS, OUTORD)

   ${TYPE} (kind=${KIND}), Intent (In) :: INVALS(:)
   Integer, Intent (Out)               :: OUTORD

Where ${TYPE}(kind=${KIND}) may be

   o Real(kind=real32)
   o Real(kind=real64)
   o Integer(kind=int32)
   o Character(kind=selected_char_kind("DEFAULT"),len=*)
\end{DoxyVerb}
\hypertarget{namespacem__indmed_autotoc_md20}{}\doxysubsubsection{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}\label{namespacem__indmed_autotoc_md20}
M\+E\+D\+I\+A\+N\+L\+O\+C(3f) Returns the index of the median (((Size(\+I\+N\+V\+A\+L\+S)+1))/2$^\wedge$th value).

\begin{DoxyVerb}Internally, MEDIANLOC(3f) Finds the index of the median of the array
INVALS() using the recursive procedure described in Knuth, The Art of
Computer Programming, vol. 3, 5.3.3.

This procedure is linear in time, and does not require to be able
to interpolate in the set as the one used in INDNTH(3f), which can
also be used to calculate a median. It also has better worst-case
behavior than INDNTH(3f), but is about 10% slower on average for
random uniformly distributed values.
\end{DoxyVerb}
\hypertarget{namespacem__indmed_autotoc_md21}{}\doxysubsubsection{O\+P\+T\+I\+O\+NS}\label{namespacem__indmed_autotoc_md21}
I\+N\+V\+A\+LS array to find the median value of. O\+U\+T\+O\+RD index of the median value.\hypertarget{namespacem__indmed_autotoc_md22}{}\doxysubsubsection{E\+X\+A\+M\+P\+L\+ES}\label{namespacem__indmed_autotoc_md22}
Sample program\+:

program demo\+\_\+medianloc ! return index of median value use M\+\_\+orderpack, only \+: medianloc implicit none real,allocatable \+:: I\+N\+V\+A\+L\+S(\+:) character(len=\+:),allocatable \+:: cdont(\+:) character(len=$\ast$),parameter \+:: fmt=\textquotesingle{}(i5,t11,g0)\textquotesingle{} integer \+:: ii write($\ast$,$\ast$) \textquotesingle{}location median\textquotesingle{}

I\+N\+V\+A\+LS=\mbox{[}80.\+0,70.\+0,20.\+0,10.\+0,1000.\+0\mbox{]} call medianloc(\+I\+N\+V\+A\+L\+S,ii) write($\ast$,fmt) ii,I\+N\+V\+A\+L\+S(ii) ! I\+N\+V\+A\+LS=\mbox{[}11, 22, 33, 44, 55, 66, 77, 88\mbox{]} call medianloc(\+I\+N\+V\+A\+L\+S,ii) write($\ast$,fmt) ii,I\+N\+V\+A\+L\+S(ii) ! I\+N\+V\+A\+LS=\mbox{[}11.\+0d0,77.\+0d0,22.\+0d0,66.\+0d0,33.\+0d0,88.\+0d0\mbox{]} call medianloc(\+I\+N\+V\+A\+L\+S,ii) write($\ast$,fmt) ii,I\+N\+V\+A\+L\+S(ii) ! cdont=\mbox{[}character(len=20) \+:: \textquotesingle{}apple\textquotesingle{},\textquotesingle{}bee\textquotesingle{},\textquotesingle{}cherry\textquotesingle{},\textquotesingle{}duck\textquotesingle{},\& \textquotesingle{}elephant\textquotesingle{},\textquotesingle{}finger\textquotesingle{},\textquotesingle{}goose\textquotesingle{},\textquotesingle{}h\textquotesingle{},\textquotesingle{}insect\textquotesingle{},\textquotesingle{}j\textquotesingle{}\mbox{]} call medianloc(cdont,ii) write($\ast$,fmt) ii,cdont(ii) ! end program demo\+\_\+medianloc

Results\+:

location median 2 70.\+00000 4 44.\+00000 5 33.\+00000 5 elephant\hypertarget{namespacem__indmed_autotoc_md23}{}\doxysubsubsection{A\+U\+T\+H\+OR}\label{namespacem__indmed_autotoc_md23}
Michel Olagnon, 2000-\/2012 \hypertarget{namespacem__indmed_autotoc_md24}{}\doxysubsubsection{M\+A\+I\+N\+T\+A\+I\+N\+ER}\label{namespacem__indmed_autotoc_md24}
John Urban, 2022.\+04.\+16 \hypertarget{namespacem__indmed_autotoc_md25}{}\doxysubsubsection{L\+I\+C\+E\+N\+SE}\label{namespacem__indmed_autotoc_md25}
C\+C0-\/1.\+0 
\begin{DoxyCode}{0}
\DoxyCodeLine{96 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: invals}
\DoxyCodeLine{97       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: OUTORD}
\DoxyCodeLine{98 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{99       \textcolor{keywordtype}{Integer} :: IDON}
\DoxyCodeLine{100 \textcolor{comment}{!}}
\DoxyCodeLine{101       \textcolor{keyword}{Allocate} (idont(\textcolor{keyword}{SIZE}(invals)))}
\DoxyCodeLine{102       \textcolor{keywordflow}{Do} idon = 1, \textcolor{keyword}{SIZE}(invals)}
\DoxyCodeLine{103          idont(idon) = idon}
\DoxyCodeLine{104 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{105 \textcolor{comment}{!}}
\DoxyCodeLine{106       \textcolor{keyword}{Call }real64\_med (invals, idont, outord)}
\DoxyCodeLine{107 \textcolor{comment}{!}}
\DoxyCodeLine{108       \textcolor{keyword}{Deallocate} (idont)}

\end{DoxyCode}


References idont, and real64\+\_\+med().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__indmed_a0bb2d4445d85331ca5395fd31c914567_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_a82d4f27afcb6802376dfbebacaf594fc}\label{namespacem__indmed_a82d4f27afcb6802376dfbebacaf594fc}} 
\index{m\_indmed@{m\_indmed}!real64\_med@{real64\_med}}
\index{real64\_med@{real64\_med}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{real64\_med()}{real64\_med()}}
{\footnotesize\ttfamily recursive subroutine m\+\_\+indmed\+::real64\+\_\+med (\begin{DoxyParamCaption}\item[{real (kind=real64), dimension (\+:), intent(in)}]{X\+D\+A\+TT,  }\item[{integer, dimension (\+:), intent(in)}]{I\+D\+A\+TT,  }\item[{integer, intent(out)}]{ires\+\_\+med }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{112 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdatt}
\DoxyCodeLine{113       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: IDATT}
\DoxyCodeLine{114       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)}:: ires\_med}
\DoxyCodeLine{115 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{116 \textcolor{comment}{!}}
\DoxyCodeLine{117 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Parameter} :: xhuge = -\/huge(xdatt)}
\DoxyCodeLine{118 \textcolor{keywordtype}{      Real} (kind=real64) :: xwrk, xwrk1, xmed7, xmax, xmin}
\DoxyCodeLine{119 \textcolor{comment}{!}}
\DoxyCodeLine{120       \textcolor{keywordtype}{Integer}, Dimension (7*(((Size (IDATT)+6)/7+6)/7)) :: ISTRT, IENDT,\textcolor{comment}{ IMEDT}}
\DoxyCodeLine{121 \textcolor{comment}{      }\textcolor{keywordtype}{Integer}, Dimension (7*((Size(IDATT)+6)/7)) :: IWRKT}
\DoxyCodeLine{122       \textcolor{keywordtype}{Integer} :: NTRI, NMED, NORD, NEQU, NLEQ, IMED, IDON, IDON1}
\DoxyCodeLine{123       \textcolor{keywordtype}{Integer} :: IDEB, ITMP, IDCR, ICRS, ICRS1, ICRS2, IMAX, IMIN}
\DoxyCodeLine{124       \textcolor{keywordtype}{Integer} :: IWRK, IWRK1, IMED1, IMED7, NDAT}
\DoxyCodeLine{125 \textcolor{comment}{!}}
\DoxyCodeLine{126       ndat = \textcolor{keyword}{Size} (idatt)}
\DoxyCodeLine{127       nmed = (ndat+1) / 2}
\DoxyCodeLine{128       iwrkt(:\textcolor{keyword}{size}(idatt)) = idatt}
\DoxyCodeLine{129 \textcolor{comment}{!}}
\DoxyCodeLine{130 \textcolor{comment}{!  If the number of values is small, then use insertion sort}}
\DoxyCodeLine{131 \textcolor{comment}{!}}
\DoxyCodeLine{132      \textcolor{keywordflow}{If} (ndat < 35) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{133 \textcolor{comment}{!}}
\DoxyCodeLine{134 \textcolor{comment}{!  Bring minimum to first location to save test in decreasing loop}}
\DoxyCodeLine{135 \textcolor{comment}{!}}
\DoxyCodeLine{136          idcr = ndat}
\DoxyCodeLine{137          \textcolor{keywordflow}{If} (xdatt(iwrkt(1)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{138             iwrk = iwrkt(1)}
\DoxyCodeLine{139          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{140             iwrk = iwrkt(idcr)}
\DoxyCodeLine{141             iwrkt(idcr) = iwrkt(1)}
\DoxyCodeLine{142 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{143          xwrk = xdatt(iwrk)}
\DoxyCodeLine{144          \textcolor{keywordflow}{Do} itmp = 1, ndat -\/ 2}
\DoxyCodeLine{145             idcr = idcr -\/ 1}
\DoxyCodeLine{146             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{147             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{148             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{149                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{150                 xwrk = xwrk1}
\DoxyCodeLine{151                 iwrk = iwrk1}
\DoxyCodeLine{152 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{153 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{154          iwrkt(1) = iwrk}
\DoxyCodeLine{155 \textcolor{comment}{!}}
\DoxyCodeLine{156 \textcolor{comment}{! Sort the first half, until we have NMED sorted values}}
\DoxyCodeLine{157 \textcolor{comment}{!}}
\DoxyCodeLine{158          \textcolor{keywordflow}{Do} icrs = 3, nmed}
\DoxyCodeLine{159             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{160             iwrk = iwrkt(icrs)}
\DoxyCodeLine{161             idcr = icrs -\/ 1}
\DoxyCodeLine{162             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{163                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{164                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{165                   idcr = idcr -\/ 1}
\DoxyCodeLine{166 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{167             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{168 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{169 \textcolor{comment}{!}}
\DoxyCodeLine{170 \textcolor{comment}{!  Insert any value less than the current median in the first half}}
\DoxyCodeLine{171 \textcolor{comment}{!}}
\DoxyCodeLine{172          xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{173          \textcolor{keywordflow}{Do} icrs = nmed+1, ndat}
\DoxyCodeLine{174             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{175             iwrk = iwrkt(icrs)}
\DoxyCodeLine{176             \textcolor{keywordflow}{If} (xwrk < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{177                idcr = nmed -\/ 1}
\DoxyCodeLine{178                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{179                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{180                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{181                   idcr = idcr -\/ 1}
\DoxyCodeLine{182 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{183                iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{184                xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{185 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{186 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{187          ires\_med = iwrkt(nmed)}
\DoxyCodeLine{188          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{189 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{190 \textcolor{comment}{!}}
\DoxyCodeLine{191 \textcolor{comment}{!  Make sorted subsets of 7 elements}}
\DoxyCodeLine{192 \textcolor{comment}{!  This is done by a variant of insertion sort where a first}}
\DoxyCodeLine{193 \textcolor{comment}{!  pass is used to bring the smallest element to the first position}}
\DoxyCodeLine{194 \textcolor{comment}{!  decreasing disorder at the same time, so that we may remove}}
\DoxyCodeLine{195 \textcolor{comment}{!  the loop test in the insertion loop.}}
\DoxyCodeLine{196 \textcolor{comment}{!}}
\DoxyCodeLine{197       imax = 1}
\DoxyCodeLine{198       imin = 1}
\DoxyCodeLine{199       xmax = xdatt(iwrkt(imax))}
\DoxyCodeLine{200       xmin = xdatt(iwrkt(imin))}
\DoxyCodeLine{201       \textcolor{keywordflow}{DO} ideb = 1, ndat-\/6, 7}
\DoxyCodeLine{202          idcr = ideb + 6}
\DoxyCodeLine{203          \textcolor{keywordflow}{If} (xdatt(iwrkt(ideb)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{204             iwrk = iwrkt(ideb)}
\DoxyCodeLine{205          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{206             iwrk = iwrkt(idcr)}
\DoxyCodeLine{207             iwrkt(idcr) = iwrkt(ideb)}
\DoxyCodeLine{208 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{209          xwrk = xdatt(iwrk)}
\DoxyCodeLine{210          \textcolor{keywordflow}{Do} itmp = 1, 5}
\DoxyCodeLine{211             idcr = idcr -\/ 1}
\DoxyCodeLine{212             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{213             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{214             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{215                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{216                 iwrk = iwrk1}
\DoxyCodeLine{217                 xwrk = xwrk1}
\DoxyCodeLine{218 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{219 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{220          iwrkt(ideb) = iwrk}
\DoxyCodeLine{221          \textcolor{keywordflow}{If} (xwrk < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{222              imin = iwrk}
\DoxyCodeLine{223              xmin = xwrk}
\DoxyCodeLine{224 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{225          \textcolor{keywordflow}{Do} icrs = ideb+1, ideb+5}
\DoxyCodeLine{226             iwrk = iwrkt(icrs+1)}
\DoxyCodeLine{227             xwrk = xdatt(iwrk)}
\DoxyCodeLine{228             idon = iwrkt(icrs)}
\DoxyCodeLine{229             \textcolor{keywordflow}{If} (xwrk < xdatt(idon)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{230                iwrkt(icrs+1) = idon}
\DoxyCodeLine{231                idcr = icrs}
\DoxyCodeLine{232                iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{233                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{234                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{235                   \textcolor{keywordflow}{If} (xwrk >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{236                   iwrkt(idcr) = iwrk1}
\DoxyCodeLine{237                   idcr = idcr -\/ 1}
\DoxyCodeLine{238                   iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{239                   xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{240 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{241                iwrkt(idcr) = iwrk}
\DoxyCodeLine{242 \textcolor{keywordflow}{            EndIf}}
\DoxyCodeLine{243 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{244          \textcolor{keywordflow}{If} (xwrk > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{245              imax = iwrk}
\DoxyCodeLine{246              xmax = xwrk}
\DoxyCodeLine{247 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{248 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{249 \textcolor{comment}{!}}
\DoxyCodeLine{250 \textcolor{comment}{!  Add-\/up alternatively MAX and MIN values to make the number of data}}
\DoxyCodeLine{251 \textcolor{comment}{!  an exact multiple of 7.}}
\DoxyCodeLine{252 \textcolor{comment}{!}}
\DoxyCodeLine{253       ideb = 7 * (ndat/7)}
\DoxyCodeLine{254       ntri = ndat}
\DoxyCodeLine{255       \textcolor{keywordflow}{If} (ideb < ndat) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{256 \textcolor{comment}{!}}
\DoxyCodeLine{257          \textcolor{keywordflow}{Do} icrs = ideb+1, ndat}
\DoxyCodeLine{258             xwrk1 = xdatt(iwrkt(icrs))}
\DoxyCodeLine{259             \textcolor{keywordflow}{IF} (xwrk1 > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{260                imax = iwrkt(icrs)}
\DoxyCodeLine{261                xmax = xwrk1}
\DoxyCodeLine{262 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{263             \textcolor{keywordflow}{IF} (xwrk1 < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{264                imin = iwrkt(icrs)}
\DoxyCodeLine{265                xmin = xwrk1}
\DoxyCodeLine{266 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{267 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{268          iwrk1 = imax}
\DoxyCodeLine{269          \textcolor{keywordflow}{Do} icrs = ndat+1, ideb+7}
\DoxyCodeLine{270                iwrkt(icrs) = iwrk1}
\DoxyCodeLine{271                \textcolor{keywordflow}{If} (iwrk1 == imax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{272                   iwrk1 = imin}
\DoxyCodeLine{273                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{274                   nmed = nmed + 1}
\DoxyCodeLine{275                   iwrk1 = imax}
\DoxyCodeLine{276 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{277 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{278 \textcolor{comment}{!}}
\DoxyCodeLine{279          \textcolor{keywordflow}{Do} icrs = ideb+2, ideb+7}
\DoxyCodeLine{280             iwrk = iwrkt(icrs)}
\DoxyCodeLine{281             xwrk = xdatt(iwrk)}
\DoxyCodeLine{282             \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, ideb+1, -\/ 1}
\DoxyCodeLine{283                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{284                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{285 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{286             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{287 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{288 \textcolor{comment}{!}}
\DoxyCodeLine{289          ntri = ideb+7}
\DoxyCodeLine{290 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{291 \textcolor{comment}{!}}
\DoxyCodeLine{292 \textcolor{comment}{!  Make the set of the indices of median values of each sorted subset}}
\DoxyCodeLine{293 \textcolor{comment}{!}}
\DoxyCodeLine{294          idon1 = 0}
\DoxyCodeLine{295          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{296             idon1 = idon1 + 1}
\DoxyCodeLine{297             imedt(idon1) = iwrkt(idon + 3)}
\DoxyCodeLine{298 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{299 \textcolor{comment}{!}}
\DoxyCodeLine{300 \textcolor{comment}{!  Find XMED7, the median of the medians}}
\DoxyCodeLine{301 \textcolor{comment}{!}}
\DoxyCodeLine{302          \textcolor{keyword}{Call }real64\_med (xdatt, imedt(1:idon1), imed7)}
\DoxyCodeLine{303          xmed7 = xdatt(imed7)}
\DoxyCodeLine{304 \textcolor{comment}{!}}
\DoxyCodeLine{305 \textcolor{comment}{!  Count how many values are not higher than (and how many equal to) XMED7}}
\DoxyCodeLine{306 \textcolor{comment}{!  This number is at least 4 * 1/2 * (N/7) : 4 values in each of the}}
\DoxyCodeLine{307 \textcolor{comment}{!  subsets where the median is lower than the median of medians. For similar}}
\DoxyCodeLine{308 \textcolor{comment}{!  reasons, we also have at least 2N/7 values not lower than XMED7. At the}}
\DoxyCodeLine{309 \textcolor{comment}{!  same time, we find in each subset the index of the last value < XMED7,}}
\DoxyCodeLine{310 \textcolor{comment}{!  and that of the first > XMED7. These indices will be used to restrict the}}
\DoxyCodeLine{311 \textcolor{comment}{!  search for the median as the Kth element in the subset (> or <) where}}
\DoxyCodeLine{312 \textcolor{comment}{!  we know it to be.}}
\DoxyCodeLine{313 \textcolor{comment}{!}}
\DoxyCodeLine{314          idon1 = 1}
\DoxyCodeLine{315          nleq = 0}
\DoxyCodeLine{316          nequ = 0}
\DoxyCodeLine{317          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{318             imed = idon+3}
\DoxyCodeLine{319             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{320                   imed = imed -\/ 2}
\DoxyCodeLine{321                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{322                      imed = imed -\/ 1}
\DoxyCodeLine{323                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{324                      imed = imed + 1}
\DoxyCodeLine{325 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{326             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{327                   imed = imed + 2}
\DoxyCodeLine{328                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{329                      imed = imed -\/ 1}
\DoxyCodeLine{330                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{331                      imed = imed + 1}
\DoxyCodeLine{332 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{333 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{334             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{335                nleq = nleq + imed -\/ idon}
\DoxyCodeLine{336                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{337                istrt(idon1) = imed}
\DoxyCodeLine{338             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{339                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{340                iendt(idon1) = imed}
\DoxyCodeLine{341                istrt(idon1) = imed + 1}
\DoxyCodeLine{342             \textcolor{keywordflow}{Else}                    \textcolor{comment}{!       If (XDATT (IWRKT (IMED)) == XMED7)}}
\DoxyCodeLine{343                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{344                nequ = nequ + 1}
\DoxyCodeLine{345                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{346                \textcolor{keywordflow}{Do} imed1 = imed -\/ 1, idon, -\/1}
\DoxyCodeLine{347                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{348                      nequ = nequ + 1}
\DoxyCodeLine{349                      iendt(idon1) = imed1 -\/ 1}
\DoxyCodeLine{350                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{351                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{352 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{353 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{354                istrt(idon1) = imed + 1}
\DoxyCodeLine{355                \textcolor{keywordflow}{Do} imed1 = imed + 1, idon + 6}
\DoxyCodeLine{356                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{357                      nequ = nequ + 1}
\DoxyCodeLine{358                      nleq = nleq + 1}
\DoxyCodeLine{359                      istrt(idon1) = imed1 + 1}
\DoxyCodeLine{360                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{361                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{362 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{363 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{364 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{365             idon1 = idon1 + 1}
\DoxyCodeLine{366 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{367 \textcolor{comment}{!}}
\DoxyCodeLine{368 \textcolor{comment}{!  Carry out a partial insertion sort to find the Kth smallest of the}}
\DoxyCodeLine{369 \textcolor{comment}{!  large values, or the Kth largest of the small values, according to}}
\DoxyCodeLine{370 \textcolor{comment}{!  what is needed.}}
\DoxyCodeLine{371 \textcolor{comment}{!}}
\DoxyCodeLine{372 \textcolor{comment}{!}}
\DoxyCodeLine{373          \textcolor{keywordflow}{If} (nleq -\/ nequ + 1 <= nmed) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{374             \textcolor{keywordflow}{If} (nleq < nmed) \textcolor{keywordflow}{Then}   \textcolor{comment}{!      Not enough low values}}
\DoxyCodeLine{375                 iwrk1 = imax}
\DoxyCodeLine{376                 xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{377                 nord = nmed -\/ nleq}
\DoxyCodeLine{378                 idon1 = 0}
\DoxyCodeLine{379                 icrs1 = 1}
\DoxyCodeLine{380                 icrs2 = 0}
\DoxyCodeLine{381                 idcr = 0}
\DoxyCodeLine{382                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{383                    idon1 = idon1 + 1}
\DoxyCodeLine{384                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{385                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{386                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{387                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{388                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{389                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{390                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{391                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{392 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{393                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{394                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{395                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{396                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{397                            \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{398                               iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{399                               iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{400                               xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{401 \textcolor{keywordflow}{                           Endif}}
\DoxyCodeLine{402 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{403                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{404                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{405 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{406                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{407                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{408                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{409                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{410                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{411                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{412                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{413                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{414 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{415                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{416                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{417                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{418 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{419 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{420 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{421                 ires\_med = iwrk1}
\DoxyCodeLine{422                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{423             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{424                 ires\_med = imed7}
\DoxyCodeLine{425                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{426 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{427          \textcolor{keywordflow}{Else}                       \textcolor{comment}{!      If (NLEQ > NMED)}}
\DoxyCodeLine{428 \textcolor{comment}{!                                          Not enough high values}}
\DoxyCodeLine{429                 xwrk1 = xhuge}
\DoxyCodeLine{430                 nord = nleq -\/ nequ -\/ nmed + 1}
\DoxyCodeLine{431                 idon1 = 0}
\DoxyCodeLine{432                 icrs1 = 1}
\DoxyCodeLine{433                 icrs2 = 0}
\DoxyCodeLine{434                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{435                    idon1 = idon1 + 1}
\DoxyCodeLine{436                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{437 \textcolor{comment}{!}}
\DoxyCodeLine{438                       \textcolor{keywordflow}{Do} icrs = idon, iendt(idon1)}
\DoxyCodeLine{439                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) > xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{440                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{441                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{442                             idcr = icrs1 -\/ 1}
\DoxyCodeLine{443                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{444                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{445                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{446 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{447                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{448                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{449                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{450                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{451                             \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{452                                iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{453                                iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{454                                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{455 \textcolor{keywordflow}{                            End If}}
\DoxyCodeLine{456 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{457                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{458                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{459 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{460                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{461                       \textcolor{keywordflow}{Do} icrs = iendt(idon1), idon, -\/1}
\DoxyCodeLine{462                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) <= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{463                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{464                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{465                          idcr = icrs1 -\/ 1}
\DoxyCodeLine{466                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{467                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{468                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{469 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{470                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{471                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{472                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{473 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{474 \textcolor{keywordflow}{                   Endif}}
\DoxyCodeLine{475 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{476 \textcolor{comment}{!}}
\DoxyCodeLine{477                 ires\_med = iwrk1}
\DoxyCodeLine{478                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{479 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{480 \textcolor{comment}{!}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__indmed_a82d4f27afcb6802376dfbebacaf594fc_icgraph}
\end{center}
\end{figure}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacem__indmed_ac9df52d05b93b36c223ca81db7b24958}\label{namespacem__indmed_ac9df52d05b93b36c223ca81db7b24958}} 
\index{m\_indmed@{m\_indmed}!f\_char@{f\_char}}
\index{f\_char@{f\_char}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{f\_char}{f\_char}}
{\footnotesize\ttfamily integer, parameter m\+\_\+indmed\+::f\+\_\+char =selected\+\_\+char\+\_\+kind(\char`\"{}D\+E\+F\+A\+U\+LT\char`\"{})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{5 \textcolor{keywordtype}{integer},\textcolor{keywordtype}{parameter} :: f\_char=selected\_char\_kind(\textcolor{stringliteral}{"DEFAULT"})}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__indmed_ad17c2a3bf73f372ad2d9ea60e151ee23}\label{namespacem__indmed_ad17c2a3bf73f372ad2d9ea60e151ee23}} 
\index{m\_indmed@{m\_indmed}!idont@{idont}}
\index{idont@{idont}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{idont}{idont}}
{\footnotesize\ttfamily integer, dimension(\+:), allocatable, save, private m\+\_\+indmed\+::idont\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{7 \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Allocatable}, \textcolor{keywordtype}{Dimension(:)}, \textcolor{keywordtype}{Private}, \textcolor{keywordtype}{Save} :: IDONT}

\end{DoxyCode}
