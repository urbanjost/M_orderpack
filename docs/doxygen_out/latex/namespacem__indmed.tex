\hypertarget{namespacem__indmed}{}\doxysection{m\+\_\+indmed Module Reference}
\label{namespacem__indmed}\index{m\_indmed@{m\_indmed}}
\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface \mbox{\hyperlink{interfacem__indmed_1_1indmed}{indmed}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacem__indmed_a7a46817d54880450b7e336fd8ff0cda1}{real64\+\_\+indmed}} (X\+D\+O\+NT, I\+N\+DM)
\item 
recursive subroutine \mbox{\hyperlink{namespacem__indmed_a82d4f27afcb6802376dfbebacaf594fc}{real64\+\_\+med}} (X\+D\+A\+TT, I\+D\+A\+TT, ires\+\_\+med)
\item 
subroutine \mbox{\hyperlink{namespacem__indmed_a96f8c79a86271850577766f6c81cde27}{real32\+\_\+indmed}} (X\+D\+O\+NT, I\+N\+DM)
\item 
recursive subroutine \mbox{\hyperlink{namespacem__indmed_abb66bb589821afa90ddd8bda8fcf609b}{real32\+\_\+med}} (X\+D\+A\+TT, I\+D\+A\+TT, ires\+\_\+med)
\item 
subroutine \mbox{\hyperlink{namespacem__indmed_a211456dadf6ffe889bf00b7c5ba77c10}{int32\+\_\+indmed}} (X\+D\+O\+NT, I\+N\+DM)
\item 
recursive subroutine \mbox{\hyperlink{namespacem__indmed_a7a7a1cbb857bc1672280ab38e8abe92b}{int32\+\_\+med}} (X\+D\+A\+TT, I\+D\+A\+TT, ires\+\_\+med)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
integer, dimension(\+:), allocatable, save, private \mbox{\hyperlink{namespacem__indmed_ad17c2a3bf73f372ad2d9ea60e151ee23}{idont}}
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacem__indmed_a211456dadf6ffe889bf00b7c5ba77c10}\label{namespacem__indmed_a211456dadf6ffe889bf00b7c5ba77c10}} 
\index{m\_indmed@{m\_indmed}!int32\_indmed@{int32\_indmed}}
\index{int32\_indmed@{int32\_indmed}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{int32\_indmed()}{int32\_indmed()}}
{\footnotesize\ttfamily subroutine m\+\_\+indmed\+::int32\+\_\+indmed (\begin{DoxyParamCaption}\item[{integer (kind=int32), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, intent(out)}]{I\+N\+DM }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{838       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDONT}
\DoxyCodeLine{839       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: INDM}
\DoxyCodeLine{840 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{841       \textcolor{keywordtype}{Integer} :: IDON}
\DoxyCodeLine{842 \textcolor{comment}{!}}
\DoxyCodeLine{843       \textcolor{keyword}{Allocate} (idont(\textcolor{keyword}{SIZE}(xdont)))}
\DoxyCodeLine{844       \textcolor{keywordflow}{Do} idon = 1, \textcolor{keyword}{SIZE}(xdont)}
\DoxyCodeLine{845          idont(idon) = idon}
\DoxyCodeLine{846 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{847 \textcolor{comment}{!}}
\DoxyCodeLine{848       \textcolor{keyword}{Call }int32\_med (xdont, idont, indm)}
\DoxyCodeLine{849 \textcolor{comment}{!}}
\DoxyCodeLine{850       \textcolor{keyword}{Deallocate} (idont)}

\end{DoxyCode}


References idont, and int32\+\_\+med().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__indmed_a211456dadf6ffe889bf00b7c5ba77c10_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_a7a7a1cbb857bc1672280ab38e8abe92b}\label{namespacem__indmed_a7a7a1cbb857bc1672280ab38e8abe92b}} 
\index{m\_indmed@{m\_indmed}!int32\_med@{int32\_med}}
\index{int32\_med@{int32\_med}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{int32\_med()}{int32\_med()}}
{\footnotesize\ttfamily recursive subroutine m\+\_\+indmed\+::int32\+\_\+med (\begin{DoxyParamCaption}\item[{integer (kind=int32), dimension (\+:), intent(in)}]{X\+D\+A\+TT,  }\item[{integer, dimension (\+:), intent(in)}]{I\+D\+A\+TT,  }\item[{integer, intent(out)}]{ires\+\_\+med }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{854       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDATT}
\DoxyCodeLine{855       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: IDATT}
\DoxyCodeLine{856       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)}:: ires\_med}
\DoxyCodeLine{857 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{858 \textcolor{comment}{!}}
\DoxyCodeLine{859       \textcolor{keywordtype}{Integer (kind=int32)}, \textcolor{keywordtype}{Parameter} :: XHUGE = huge (xdatt)}
\DoxyCodeLine{860       \textcolor{keywordtype}{Integer (kind=int32)} :: XWRK, XWRK1, XMED7, XMAX, XMIN}
\DoxyCodeLine{861 \textcolor{comment}{!}}
\DoxyCodeLine{862       \textcolor{keywordtype}{Integer}, Dimension (7*(((Size (IDATT)+6)/7+6)/7)) :: ISTRT, IENDT,\textcolor{comment}{ IMEDT}}
\DoxyCodeLine{863 \textcolor{comment}{      }\textcolor{keywordtype}{Integer}, Dimension (7*((Size(IDATT)+6)/7)) :: IWRKT}
\DoxyCodeLine{864       \textcolor{keywordtype}{Integer} :: NTRI, NMED, NORD, NEQU, NLEQ, IMED, IDON, IDON1}
\DoxyCodeLine{865       \textcolor{keywordtype}{Integer} :: IDEB, ITMP, IDCR, ICRS, ICRS1, ICRS2, IMAX, IMIN}
\DoxyCodeLine{866       \textcolor{keywordtype}{Integer} :: IWRK, IWRK1, IMED1, IMED7, NDAT}
\DoxyCodeLine{867 \textcolor{comment}{!}}
\DoxyCodeLine{868       ndat = \textcolor{keyword}{Size} (idatt)}
\DoxyCodeLine{869       nmed = (ndat+1) / 2}
\DoxyCodeLine{870       iwrkt = idatt}
\DoxyCodeLine{871 \textcolor{comment}{!}}
\DoxyCodeLine{872 \textcolor{comment}{!  If the number of values is small, then use insertion sort}}
\DoxyCodeLine{873 \textcolor{comment}{!}}
\DoxyCodeLine{874      \textcolor{keywordflow}{If} (ndat < 35) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{875 \textcolor{comment}{!}}
\DoxyCodeLine{876 \textcolor{comment}{!  Bring minimum to first location to save test in decreasing loop}}
\DoxyCodeLine{877 \textcolor{comment}{!}}
\DoxyCodeLine{878          idcr = ndat}
\DoxyCodeLine{879          \textcolor{keywordflow}{If} (xdatt(iwrkt(1)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{880             iwrk = iwrkt(1)}
\DoxyCodeLine{881          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{882             iwrk = iwrkt(idcr)}
\DoxyCodeLine{883             iwrkt(idcr) = iwrkt(1)}
\DoxyCodeLine{884 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{885          xwrk = xdatt(iwrk)}
\DoxyCodeLine{886          \textcolor{keywordflow}{Do} itmp = 1, ndat -\/ 2}
\DoxyCodeLine{887             idcr = idcr -\/ 1}
\DoxyCodeLine{888             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{889             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{890             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{891                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{892                 xwrk = xwrk1}
\DoxyCodeLine{893                 iwrk = iwrk1}
\DoxyCodeLine{894 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{895 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{896          iwrkt(1) = iwrk}
\DoxyCodeLine{897 \textcolor{comment}{!}}
\DoxyCodeLine{898 \textcolor{comment}{! Sort the first half, until we have NMED sorted values}}
\DoxyCodeLine{899 \textcolor{comment}{!}}
\DoxyCodeLine{900          \textcolor{keywordflow}{Do} icrs = 3, nmed}
\DoxyCodeLine{901             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{902             iwrk = iwrkt(icrs)}
\DoxyCodeLine{903             idcr = icrs -\/ 1}
\DoxyCodeLine{904             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{905                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{906                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{907                   idcr = idcr -\/ 1}
\DoxyCodeLine{908 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{909             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{910 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{911 \textcolor{comment}{!}}
\DoxyCodeLine{912 \textcolor{comment}{!  Insert any value less than the current median in the first half}}
\DoxyCodeLine{913 \textcolor{comment}{!}}
\DoxyCodeLine{914          xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{915          \textcolor{keywordflow}{Do} icrs = nmed+1, ndat}
\DoxyCodeLine{916             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{917             iwrk = iwrkt(icrs)}
\DoxyCodeLine{918             \textcolor{keywordflow}{If} (xwrk < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{919                idcr = nmed -\/ 1}
\DoxyCodeLine{920                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{921                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{922                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{923                   idcr = idcr -\/ 1}
\DoxyCodeLine{924 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{925                iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{926                xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{927 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{928 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{929          ires\_med = iwrkt(nmed)}
\DoxyCodeLine{930          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{931 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{932 \textcolor{comment}{!}}
\DoxyCodeLine{933 \textcolor{comment}{!  Make sorted subsets of 7 elements}}
\DoxyCodeLine{934 \textcolor{comment}{!  This is done by a variant of insertion sort where a first}}
\DoxyCodeLine{935 \textcolor{comment}{!  pass is used to bring the smallest element to the first position}}
\DoxyCodeLine{936 \textcolor{comment}{!  decreasing disorder at the same time, so that we may remove}}
\DoxyCodeLine{937 \textcolor{comment}{!  the loop test in the insertion loop.}}
\DoxyCodeLine{938 \textcolor{comment}{!}}
\DoxyCodeLine{939       imax = 1}
\DoxyCodeLine{940       imin = 1}
\DoxyCodeLine{941       xmax = xdatt(iwrkt(imax))}
\DoxyCodeLine{942       xmin = xdatt(iwrkt(imin))}
\DoxyCodeLine{943       \textcolor{keywordflow}{DO} ideb = 1, ndat-\/6, 7}
\DoxyCodeLine{944          idcr = ideb + 6}
\DoxyCodeLine{945          \textcolor{keywordflow}{If} (xdatt(iwrkt(ideb)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{946             iwrk = iwrkt(ideb)}
\DoxyCodeLine{947          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{948             iwrk = iwrkt(idcr)}
\DoxyCodeLine{949             iwrkt(idcr) = iwrkt(ideb)}
\DoxyCodeLine{950 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{951          xwrk = xdatt(iwrk)}
\DoxyCodeLine{952          \textcolor{keywordflow}{Do} itmp = 1, 5}
\DoxyCodeLine{953             idcr = idcr -\/ 1}
\DoxyCodeLine{954             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{955             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{956             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{957                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{958                 iwrk = iwrk1}
\DoxyCodeLine{959                 xwrk = xwrk1}
\DoxyCodeLine{960 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{961 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{962          iwrkt(ideb) = iwrk}
\DoxyCodeLine{963          \textcolor{keywordflow}{If} (xwrk < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{964              imin = iwrk}
\DoxyCodeLine{965              xmin = xwrk}
\DoxyCodeLine{966 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{967          \textcolor{keywordflow}{Do} icrs = ideb+1, ideb+5}
\DoxyCodeLine{968             iwrk = iwrkt(icrs+1)}
\DoxyCodeLine{969             xwrk = xdatt(iwrk)}
\DoxyCodeLine{970             idon = iwrkt(icrs)}
\DoxyCodeLine{971             \textcolor{keywordflow}{If} (xwrk < xdatt(idon)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{972                iwrkt(icrs+1) = idon}
\DoxyCodeLine{973                idcr = icrs}
\DoxyCodeLine{974                iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{975                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{976                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{977                   \textcolor{keywordflow}{If} (xwrk >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{978                   iwrkt(idcr) = iwrk1}
\DoxyCodeLine{979                   idcr = idcr -\/ 1}
\DoxyCodeLine{980                   iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{981                   xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{982 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{983                iwrkt(idcr) = iwrk}
\DoxyCodeLine{984 \textcolor{keywordflow}{            EndIf}}
\DoxyCodeLine{985 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{986          \textcolor{keywordflow}{If} (xwrk > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{987              imax = iwrk}
\DoxyCodeLine{988              xmax = xwrk}
\DoxyCodeLine{989 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{990 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{991 \textcolor{comment}{!}}
\DoxyCodeLine{992 \textcolor{comment}{!  Add-\/up alternatively MAX and MIN values to make the number of data}}
\DoxyCodeLine{993 \textcolor{comment}{!  an exact multiple of 7.}}
\DoxyCodeLine{994 \textcolor{comment}{!}}
\DoxyCodeLine{995       ideb = 7 * (ndat/7)}
\DoxyCodeLine{996       ntri = ndat}
\DoxyCodeLine{997       \textcolor{keywordflow}{If} (ideb < ndat) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{998 \textcolor{comment}{!}}
\DoxyCodeLine{999          \textcolor{keywordflow}{Do} icrs = ideb+1, ndat}
\DoxyCodeLine{1000             xwrk1 = xdatt(iwrkt(icrs))}
\DoxyCodeLine{1001             \textcolor{keywordflow}{IF} (xwrk1 > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1002                imax = iwrkt(icrs)}
\DoxyCodeLine{1003                xmax = xwrk1}
\DoxyCodeLine{1004 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1005             \textcolor{keywordflow}{IF} (xwrk1 < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1006                imin = iwrkt(icrs)}
\DoxyCodeLine{1007                xmin = xwrk1}
\DoxyCodeLine{1008 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1009 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1010          iwrk1 = imax}
\DoxyCodeLine{1011          \textcolor{keywordflow}{Do} icrs = ndat+1, ideb+7}
\DoxyCodeLine{1012                iwrkt(icrs) = iwrk1}
\DoxyCodeLine{1013                \textcolor{keywordflow}{If} (iwrk1 == imax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1014                   iwrk1 = imin}
\DoxyCodeLine{1015                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1016                   nmed = nmed + 1}
\DoxyCodeLine{1017                   iwrk1 = imax}
\DoxyCodeLine{1018 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1019 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1020 \textcolor{comment}{!}}
\DoxyCodeLine{1021          \textcolor{keywordflow}{Do} icrs = ideb+2, ideb+7}
\DoxyCodeLine{1022             iwrk = iwrkt(icrs)}
\DoxyCodeLine{1023             xwrk = xdatt(iwrk)}
\DoxyCodeLine{1024             \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, ideb+1, -\/ 1}
\DoxyCodeLine{1025                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1026                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1027 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1028             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1029 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1030 \textcolor{comment}{!}}
\DoxyCodeLine{1031          ntri = ideb+7}
\DoxyCodeLine{1032 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1033 \textcolor{comment}{!}}
\DoxyCodeLine{1034 \textcolor{comment}{!  Make the set of the indices of median values of each sorted subset}}
\DoxyCodeLine{1035 \textcolor{comment}{!}}
\DoxyCodeLine{1036          idon1 = 0}
\DoxyCodeLine{1037          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1038             idon1 = idon1 + 1}
\DoxyCodeLine{1039             imedt(idon1) = iwrkt(idon + 3)}
\DoxyCodeLine{1040 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1041 \textcolor{comment}{!}}
\DoxyCodeLine{1042 \textcolor{comment}{!  Find XMED7, the median of the medians}}
\DoxyCodeLine{1043 \textcolor{comment}{!}}
\DoxyCodeLine{1044          \textcolor{keyword}{Call }int32\_med (xdatt, imedt(1:idon1), imed7)}
\DoxyCodeLine{1045          xmed7 = xdatt(imed7)}
\DoxyCodeLine{1046 \textcolor{comment}{!}}
\DoxyCodeLine{1047 \textcolor{comment}{!  Count how many values are not higher than (and how many equal to) XMED7}}
\DoxyCodeLine{1048 \textcolor{comment}{!  This number is at least 4 * 1/2 * (N/7) : 4 values in each of the}}
\DoxyCodeLine{1049 \textcolor{comment}{!  subsets where the median is lower than the median of medians. For similar}}
\DoxyCodeLine{1050 \textcolor{comment}{!  reasons, we also have at least 2N/7 values not lower than XMED7. At the}}
\DoxyCodeLine{1051 \textcolor{comment}{!  same time, we find in each subset the index of the last value < XMED7,}}
\DoxyCodeLine{1052 \textcolor{comment}{!  and that of the first > XMED7. These indices will be used to restrict the}}
\DoxyCodeLine{1053 \textcolor{comment}{!  search for the median as the Kth element in the subset (> or <) where}}
\DoxyCodeLine{1054 \textcolor{comment}{!  we know it to be.}}
\DoxyCodeLine{1055 \textcolor{comment}{!}}
\DoxyCodeLine{1056          idon1 = 1}
\DoxyCodeLine{1057          nleq = 0}
\DoxyCodeLine{1058          nequ = 0}
\DoxyCodeLine{1059          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1060             imed = idon+3}
\DoxyCodeLine{1061             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1062                   imed = imed -\/ 2}
\DoxyCodeLine{1063                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1064                      imed = imed -\/ 1}
\DoxyCodeLine{1065                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1066                      imed = imed + 1}
\DoxyCodeLine{1067 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{1068             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1069                   imed = imed + 2}
\DoxyCodeLine{1070                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1071                      imed = imed -\/ 1}
\DoxyCodeLine{1072                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1073                      imed = imed + 1}
\DoxyCodeLine{1074 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{1075 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{1076             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1077                nleq = nleq + imed -\/ idon}
\DoxyCodeLine{1078                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{1079                istrt(idon1) = imed}
\DoxyCodeLine{1080             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1081                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{1082                iendt(idon1) = imed}
\DoxyCodeLine{1083                istrt(idon1) = imed + 1}
\DoxyCodeLine{1084             \textcolor{keywordflow}{Else}                    \textcolor{comment}{!       If (XDATT (IWRKT (IMED)) == XMED7)}}
\DoxyCodeLine{1085                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{1086                nequ = nequ + 1}
\DoxyCodeLine{1087                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{1088                \textcolor{keywordflow}{Do} imed1 = imed -\/ 1, idon, -\/1}
\DoxyCodeLine{1089                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1090                      nequ = nequ + 1}
\DoxyCodeLine{1091                      iendt(idon1) = imed1 -\/ 1}
\DoxyCodeLine{1092                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1093                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1094 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1095 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1096                istrt(idon1) = imed + 1}
\DoxyCodeLine{1097                \textcolor{keywordflow}{Do} imed1 = imed + 1, idon + 6}
\DoxyCodeLine{1098                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1099                      nequ = nequ + 1}
\DoxyCodeLine{1100                      nleq = nleq + 1}
\DoxyCodeLine{1101                      istrt(idon1) = imed1 + 1}
\DoxyCodeLine{1102                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1103                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1104 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1105 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1106 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{1107             idon1 = idon1 + 1}
\DoxyCodeLine{1108 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1109 \textcolor{comment}{!}}
\DoxyCodeLine{1110 \textcolor{comment}{!  Carry out a partial insertion sort to find the Kth smallest of the}}
\DoxyCodeLine{1111 \textcolor{comment}{!  large values, or the Kth largest of the small values, according to}}
\DoxyCodeLine{1112 \textcolor{comment}{!  what is needed.}}
\DoxyCodeLine{1113 \textcolor{comment}{!}}
\DoxyCodeLine{1114 \textcolor{comment}{!}}
\DoxyCodeLine{1115          \textcolor{keywordflow}{If} (nleq -\/ nequ + 1 <= nmed) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1116             \textcolor{keywordflow}{If} (nleq < nmed) \textcolor{keywordflow}{Then}   \textcolor{comment}{!      Not enough low values}}
\DoxyCodeLine{1117                 iwrk1 = imax}
\DoxyCodeLine{1118                 xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1119                 nord = nmed -\/ nleq}
\DoxyCodeLine{1120                 idon1 = 0}
\DoxyCodeLine{1121                 icrs1 = 1}
\DoxyCodeLine{1122                 icrs2 = 0}
\DoxyCodeLine{1123                 idcr = 0}
\DoxyCodeLine{1124                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1125                    idon1 = idon1 + 1}
\DoxyCodeLine{1126                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1127                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{1128                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1129                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{1130                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{1131                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1132                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1133                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1134 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{1135                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1136                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1137                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1138                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1139                            \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1140                               iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{1141                               iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1142                               xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1143 \textcolor{keywordflow}{                           Endif}}
\DoxyCodeLine{1144 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{1145                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{1146                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{1147 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1148                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1149                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{1150                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1151                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{1152                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{1153                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1154                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1155                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1156 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{1157                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1158                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1159                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1160 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1161 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{1162 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{1163                 ires\_med = iwrk1}
\DoxyCodeLine{1164                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1165             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1166                 ires\_med = imed7}
\DoxyCodeLine{1167                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1168 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1169          \textcolor{keywordflow}{Else}                       \textcolor{comment}{!      If (NLEQ > NMED)}}
\DoxyCodeLine{1170 \textcolor{comment}{!                                          Not enough high values}}
\DoxyCodeLine{1171                 xwrk1 = -\/xhuge}
\DoxyCodeLine{1172                 nord = nleq -\/ nequ -\/ nmed + 1}
\DoxyCodeLine{1173                 idon1 = 0}
\DoxyCodeLine{1174                 icrs1 = 1}
\DoxyCodeLine{1175                 icrs2 = 0}
\DoxyCodeLine{1176                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1177                    idon1 = idon1 + 1}
\DoxyCodeLine{1178                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1179 \textcolor{comment}{!}}
\DoxyCodeLine{1180                       \textcolor{keywordflow}{Do} icrs = idon, iendt(idon1)}
\DoxyCodeLine{1181                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) > xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1182                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{1183                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{1184                             idcr = icrs1 -\/ 1}
\DoxyCodeLine{1185                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1186                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1187                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1188 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{1189                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1190                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1191                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1192                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1193                             \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1194                                iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{1195                                iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1196                                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1197 \textcolor{keywordflow}{                            End If}}
\DoxyCodeLine{1198 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{1199                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{1200                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{1201 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1202                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1203                       \textcolor{keywordflow}{Do} icrs = iendt(idon1), idon, -\/1}
\DoxyCodeLine{1204                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) <= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1205                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{1206                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{1207                          idcr = icrs1 -\/ 1}
\DoxyCodeLine{1208                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1209                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1210                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1211 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{1212                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1213                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1214                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1215 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1216 \textcolor{keywordflow}{                   Endif}}
\DoxyCodeLine{1217 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{1218 \textcolor{comment}{!}}
\DoxyCodeLine{1219                 ires\_med = iwrk1}
\DoxyCodeLine{1220                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1221 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1222 \textcolor{comment}{!}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__indmed_a7a7a1cbb857bc1672280ab38e8abe92b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_a96f8c79a86271850577766f6c81cde27}\label{namespacem__indmed_a96f8c79a86271850577766f6c81cde27}} 
\index{m\_indmed@{m\_indmed}!real32\_indmed@{real32\_indmed}}
\index{real32\_indmed@{real32\_indmed}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{real32\_indmed()}{real32\_indmed()}}
{\footnotesize\ttfamily subroutine m\+\_\+indmed\+::real32\+\_\+indmed (\begin{DoxyParamCaption}\item[{real (kind=real32), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, intent(out)}]{I\+N\+DM }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{451 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{452       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: INDM}
\DoxyCodeLine{453 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{454       \textcolor{keywordtype}{Integer} :: IDON}
\DoxyCodeLine{455 \textcolor{comment}{!}}
\DoxyCodeLine{456       \textcolor{keyword}{Allocate} (idont(\textcolor{keyword}{SIZE}(xdont)))}
\DoxyCodeLine{457       \textcolor{keywordflow}{Do} idon = 1, \textcolor{keyword}{SIZE}(xdont)}
\DoxyCodeLine{458          idont(idon) = idon}
\DoxyCodeLine{459 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{460 \textcolor{comment}{!}}
\DoxyCodeLine{461       \textcolor{keyword}{Call }real32\_med (xdont, idont, indm)}
\DoxyCodeLine{462 \textcolor{comment}{!}}
\DoxyCodeLine{463       \textcolor{keyword}{Deallocate} (idont)}

\end{DoxyCode}


References idont, and real32\+\_\+med().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__indmed_a96f8c79a86271850577766f6c81cde27_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_abb66bb589821afa90ddd8bda8fcf609b}\label{namespacem__indmed_abb66bb589821afa90ddd8bda8fcf609b}} 
\index{m\_indmed@{m\_indmed}!real32\_med@{real32\_med}}
\index{real32\_med@{real32\_med}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{real32\_med()}{real32\_med()}}
{\footnotesize\ttfamily recursive subroutine m\+\_\+indmed\+::real32\+\_\+med (\begin{DoxyParamCaption}\item[{real (kind=real32), dimension (\+:), intent(in)}]{X\+D\+A\+TT,  }\item[{integer, dimension (\+:), intent(in)}]{I\+D\+A\+TT,  }\item[{integer, intent(out)}]{ires\+\_\+med }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{467 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdatt}
\DoxyCodeLine{468       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: IDATT}
\DoxyCodeLine{469       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)}:: ires\_med}
\DoxyCodeLine{470 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{471 \textcolor{comment}{!}}
\DoxyCodeLine{472 \textcolor{keywordtype}{      Real} (kind=real32), \textcolor{keywordtype}{Parameter} :: xhuge = huge(xdatt)}
\DoxyCodeLine{473 \textcolor{keywordtype}{      Real} (kind=real32) :: xwrk, xwrk1, xmed7, xmax, xmin}
\DoxyCodeLine{474 \textcolor{comment}{!}}
\DoxyCodeLine{475       \textcolor{keywordtype}{Integer}, Dimension (7*(((Size (IDATT)+6)/7+6)/7)) :: ISTRT, IENDT,\textcolor{comment}{ IMEDT}}
\DoxyCodeLine{476 \textcolor{comment}{      }\textcolor{keywordtype}{Integer}, Dimension (7*((Size(IDATT)+6)/7)) :: IWRKT}
\DoxyCodeLine{477       \textcolor{keywordtype}{Integer} :: NTRI, NMED, NORD, NEQU, NLEQ, IMED, IDON, IDON1}
\DoxyCodeLine{478       \textcolor{keywordtype}{Integer} :: IDEB, ITMP, IDCR, ICRS, ICRS1, ICRS2, IMAX, IMIN}
\DoxyCodeLine{479       \textcolor{keywordtype}{Integer} :: IWRK, IWRK1, IMED1, IMED7, NDAT}
\DoxyCodeLine{480 \textcolor{comment}{!}}
\DoxyCodeLine{481       ndat = \textcolor{keyword}{Size} (idatt)}
\DoxyCodeLine{482       nmed = (ndat+1) / 2}
\DoxyCodeLine{483       iwrkt = idatt}
\DoxyCodeLine{484 \textcolor{comment}{!}}
\DoxyCodeLine{485 \textcolor{comment}{!  If the number of values is small, then use insertion sort}}
\DoxyCodeLine{486 \textcolor{comment}{!}}
\DoxyCodeLine{487      \textcolor{keywordflow}{If} (ndat < 35) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{488 \textcolor{comment}{!}}
\DoxyCodeLine{489 \textcolor{comment}{!  Bring minimum to first location to save test in decreasing loop}}
\DoxyCodeLine{490 \textcolor{comment}{!}}
\DoxyCodeLine{491          idcr = ndat}
\DoxyCodeLine{492          \textcolor{keywordflow}{If} (xdatt(iwrkt(1)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{493             iwrk = iwrkt(1)}
\DoxyCodeLine{494          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{495             iwrk = iwrkt(idcr)}
\DoxyCodeLine{496             iwrkt(idcr) = iwrkt(1)}
\DoxyCodeLine{497 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{498          xwrk = xdatt(iwrk)}
\DoxyCodeLine{499          \textcolor{keywordflow}{Do} itmp = 1, ndat -\/ 2}
\DoxyCodeLine{500             idcr = idcr -\/ 1}
\DoxyCodeLine{501             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{502             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{503             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{504                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{505                 xwrk = xwrk1}
\DoxyCodeLine{506                 iwrk = iwrk1}
\DoxyCodeLine{507 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{508 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{509          iwrkt(1) = iwrk}
\DoxyCodeLine{510 \textcolor{comment}{!}}
\DoxyCodeLine{511 \textcolor{comment}{! Sort the first half, until we have NMED sorted values}}
\DoxyCodeLine{512 \textcolor{comment}{!}}
\DoxyCodeLine{513          \textcolor{keywordflow}{Do} icrs = 3, nmed}
\DoxyCodeLine{514             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{515             iwrk = iwrkt(icrs)}
\DoxyCodeLine{516             idcr = icrs -\/ 1}
\DoxyCodeLine{517             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{518                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{519                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{520                   idcr = idcr -\/ 1}
\DoxyCodeLine{521 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{522             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{523 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{524 \textcolor{comment}{!}}
\DoxyCodeLine{525 \textcolor{comment}{!  Insert any value less than the current median in the first half}}
\DoxyCodeLine{526 \textcolor{comment}{!}}
\DoxyCodeLine{527          xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{528          \textcolor{keywordflow}{Do} icrs = nmed+1, ndat}
\DoxyCodeLine{529             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{530             iwrk = iwrkt(icrs)}
\DoxyCodeLine{531             \textcolor{keywordflow}{If} (xwrk < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{532                idcr = nmed -\/ 1}
\DoxyCodeLine{533                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{534                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{535                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{536                   idcr = idcr -\/ 1}
\DoxyCodeLine{537 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{538                iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{539                xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{540 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{541 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{542          ires\_med = iwrkt(nmed)}
\DoxyCodeLine{543          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{544 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{545 \textcolor{comment}{!}}
\DoxyCodeLine{546 \textcolor{comment}{!  Make sorted subsets of 7 elements}}
\DoxyCodeLine{547 \textcolor{comment}{!  This is done by a variant of insertion sort where a first}}
\DoxyCodeLine{548 \textcolor{comment}{!  pass is used to bring the smallest element to the first position}}
\DoxyCodeLine{549 \textcolor{comment}{!  decreasing disorder at the same time, so that we may remove}}
\DoxyCodeLine{550 \textcolor{comment}{!  the loop test in the insertion loop.}}
\DoxyCodeLine{551 \textcolor{comment}{!}}
\DoxyCodeLine{552       imax = 1}
\DoxyCodeLine{553       imin = 1}
\DoxyCodeLine{554       xmax = xdatt(iwrkt(imax))}
\DoxyCodeLine{555       xmin = xdatt(iwrkt(imin))}
\DoxyCodeLine{556       \textcolor{keywordflow}{DO} ideb = 1, ndat-\/6, 7}
\DoxyCodeLine{557          idcr = ideb + 6}
\DoxyCodeLine{558          \textcolor{keywordflow}{If} (xdatt(iwrkt(ideb)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{559             iwrk = iwrkt(ideb)}
\DoxyCodeLine{560          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{561             iwrk = iwrkt(idcr)}
\DoxyCodeLine{562             iwrkt(idcr) = iwrkt(ideb)}
\DoxyCodeLine{563 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{564          xwrk = xdatt(iwrk)}
\DoxyCodeLine{565          \textcolor{keywordflow}{Do} itmp = 1, 5}
\DoxyCodeLine{566             idcr = idcr -\/ 1}
\DoxyCodeLine{567             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{568             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{569             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{570                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{571                 iwrk = iwrk1}
\DoxyCodeLine{572                 xwrk = xwrk1}
\DoxyCodeLine{573 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{574 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{575          iwrkt(ideb) = iwrk}
\DoxyCodeLine{576          \textcolor{keywordflow}{If} (xwrk < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{577              imin = iwrk}
\DoxyCodeLine{578              xmin = xwrk}
\DoxyCodeLine{579 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{580          \textcolor{keywordflow}{Do} icrs = ideb+1, ideb+5}
\DoxyCodeLine{581             iwrk = iwrkt(icrs+1)}
\DoxyCodeLine{582             xwrk = xdatt(iwrk)}
\DoxyCodeLine{583             idon = iwrkt(icrs)}
\DoxyCodeLine{584             \textcolor{keywordflow}{If} (xwrk < xdatt(idon)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{585                iwrkt(icrs+1) = idon}
\DoxyCodeLine{586                idcr = icrs}
\DoxyCodeLine{587                iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{588                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{589                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{590                   \textcolor{keywordflow}{If} (xwrk >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{591                   iwrkt(idcr) = iwrk1}
\DoxyCodeLine{592                   idcr = idcr -\/ 1}
\DoxyCodeLine{593                   iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{594                   xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{595 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{596                iwrkt(idcr) = iwrk}
\DoxyCodeLine{597 \textcolor{keywordflow}{            EndIf}}
\DoxyCodeLine{598 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{599          \textcolor{keywordflow}{If} (xwrk > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{600              imax = iwrk}
\DoxyCodeLine{601              xmax = xwrk}
\DoxyCodeLine{602 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{603 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{604 \textcolor{comment}{!}}
\DoxyCodeLine{605 \textcolor{comment}{!  Add-\/up alternatively MAX and MIN values to make the number of data}}
\DoxyCodeLine{606 \textcolor{comment}{!  an exact multiple of 7.}}
\DoxyCodeLine{607 \textcolor{comment}{!}}
\DoxyCodeLine{608       ideb = 7 * (ndat/7)}
\DoxyCodeLine{609       ntri = ndat}
\DoxyCodeLine{610       \textcolor{keywordflow}{If} (ideb < ndat) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{611 \textcolor{comment}{!}}
\DoxyCodeLine{612          \textcolor{keywordflow}{Do} icrs = ideb+1, ndat}
\DoxyCodeLine{613             xwrk1 = xdatt(iwrkt(icrs))}
\DoxyCodeLine{614             \textcolor{keywordflow}{IF} (xwrk1 > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{615                imax = iwrkt(icrs)}
\DoxyCodeLine{616                xmax = xwrk1}
\DoxyCodeLine{617 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{618             \textcolor{keywordflow}{IF} (xwrk1 < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{619                imin = iwrkt(icrs)}
\DoxyCodeLine{620                xmin = xwrk1}
\DoxyCodeLine{621 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{622 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{623          iwrk1 = imax}
\DoxyCodeLine{624          \textcolor{keywordflow}{Do} icrs = ndat+1, ideb+7}
\DoxyCodeLine{625                iwrkt(icrs) = iwrk1}
\DoxyCodeLine{626                \textcolor{keywordflow}{If} (iwrk1 == imax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{627                   iwrk1 = imin}
\DoxyCodeLine{628                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{629                   nmed = nmed + 1}
\DoxyCodeLine{630                   iwrk1 = imax}
\DoxyCodeLine{631 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{632 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{633 \textcolor{comment}{!}}
\DoxyCodeLine{634          \textcolor{keywordflow}{Do} icrs = ideb+2, ideb+7}
\DoxyCodeLine{635             iwrk = iwrkt(icrs)}
\DoxyCodeLine{636             xwrk = xdatt(iwrk)}
\DoxyCodeLine{637             \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, ideb+1, -\/ 1}
\DoxyCodeLine{638                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{639                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{640 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{641             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{642 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{643 \textcolor{comment}{!}}
\DoxyCodeLine{644          ntri = ideb+7}
\DoxyCodeLine{645 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{646 \textcolor{comment}{!}}
\DoxyCodeLine{647 \textcolor{comment}{!  Make the set of the indices of median values of each sorted subset}}
\DoxyCodeLine{648 \textcolor{comment}{!}}
\DoxyCodeLine{649          idon1 = 0}
\DoxyCodeLine{650          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{651             idon1 = idon1 + 1}
\DoxyCodeLine{652             imedt(idon1) = iwrkt(idon + 3)}
\DoxyCodeLine{653 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{654 \textcolor{comment}{!}}
\DoxyCodeLine{655 \textcolor{comment}{!  Find XMED7, the median of the medians}}
\DoxyCodeLine{656 \textcolor{comment}{!}}
\DoxyCodeLine{657          \textcolor{keyword}{Call }real32\_med (xdatt, imedt(1:idon1), imed7)}
\DoxyCodeLine{658          xmed7 = xdatt(imed7)}
\DoxyCodeLine{659 \textcolor{comment}{!}}
\DoxyCodeLine{660 \textcolor{comment}{!  Count how many values are not higher than (and how many equal to) XMED7}}
\DoxyCodeLine{661 \textcolor{comment}{!  This number is at least 4 * 1/2 * (N/7) : 4 values in each of the}}
\DoxyCodeLine{662 \textcolor{comment}{!  subsets where the median is lower than the median of medians. For similar}}
\DoxyCodeLine{663 \textcolor{comment}{!  reasons, we also have at least 2N/7 values not lower than XMED7. At the}}
\DoxyCodeLine{664 \textcolor{comment}{!  same time, we find in each subset the index of the last value < XMED7,}}
\DoxyCodeLine{665 \textcolor{comment}{!  and that of the first > XMED7. These indices will be used to restrict the}}
\DoxyCodeLine{666 \textcolor{comment}{!  search for the median as the Kth element in the subset (> or <) where}}
\DoxyCodeLine{667 \textcolor{comment}{!  we know it to be.}}
\DoxyCodeLine{668 \textcolor{comment}{!}}
\DoxyCodeLine{669          idon1 = 1}
\DoxyCodeLine{670          nleq = 0}
\DoxyCodeLine{671          nequ = 0}
\DoxyCodeLine{672          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{673             imed = idon+3}
\DoxyCodeLine{674             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{675                   imed = imed -\/ 2}
\DoxyCodeLine{676                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{677                      imed = imed -\/ 1}
\DoxyCodeLine{678                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{679                      imed = imed + 1}
\DoxyCodeLine{680 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{681             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{682                   imed = imed + 2}
\DoxyCodeLine{683                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{684                      imed = imed -\/ 1}
\DoxyCodeLine{685                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{686                      imed = imed + 1}
\DoxyCodeLine{687 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{688 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{689             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{690                nleq = nleq + imed -\/ idon}
\DoxyCodeLine{691                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{692                istrt(idon1) = imed}
\DoxyCodeLine{693             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{694                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{695                iendt(idon1) = imed}
\DoxyCodeLine{696                istrt(idon1) = imed + 1}
\DoxyCodeLine{697             \textcolor{keywordflow}{Else}                    \textcolor{comment}{!       If (XDATT (IWRKT (IMED)) == XMED7)}}
\DoxyCodeLine{698                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{699                nequ = nequ + 1}
\DoxyCodeLine{700                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{701                \textcolor{keywordflow}{Do} imed1 = imed -\/ 1, idon, -\/1}
\DoxyCodeLine{702                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{703                      nequ = nequ + 1}
\DoxyCodeLine{704                      iendt(idon1) = imed1 -\/ 1}
\DoxyCodeLine{705                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{706                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{707 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{708 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{709                istrt(idon1) = imed + 1}
\DoxyCodeLine{710                \textcolor{keywordflow}{Do} imed1 = imed + 1, idon + 6}
\DoxyCodeLine{711                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{712                      nequ = nequ + 1}
\DoxyCodeLine{713                      nleq = nleq + 1}
\DoxyCodeLine{714                      istrt(idon1) = imed1 + 1}
\DoxyCodeLine{715                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{716                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{717 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{718 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{719 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{720             idon1 = idon1 + 1}
\DoxyCodeLine{721 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{722 \textcolor{comment}{!}}
\DoxyCodeLine{723 \textcolor{comment}{!  Carry out a partial insertion sort to find the Kth smallest of the}}
\DoxyCodeLine{724 \textcolor{comment}{!  large values, or the Kth largest of the small values, according to}}
\DoxyCodeLine{725 \textcolor{comment}{!  what is needed.}}
\DoxyCodeLine{726 \textcolor{comment}{!}}
\DoxyCodeLine{727 \textcolor{comment}{!}}
\DoxyCodeLine{728          \textcolor{keywordflow}{If} (nleq -\/ nequ + 1 <= nmed) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{729             \textcolor{keywordflow}{If} (nleq < nmed) \textcolor{keywordflow}{Then}   \textcolor{comment}{!      Not enough low values}}
\DoxyCodeLine{730                 iwrk1 = imax}
\DoxyCodeLine{731                 xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{732                 nord = nmed -\/ nleq}
\DoxyCodeLine{733                 idon1 = 0}
\DoxyCodeLine{734                 icrs1 = 1}
\DoxyCodeLine{735                 icrs2 = 0}
\DoxyCodeLine{736                 idcr = 0}
\DoxyCodeLine{737                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{738                    idon1 = idon1 + 1}
\DoxyCodeLine{739                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{740                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{741                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{742                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{743                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{744                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{745                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{746                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{747 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{748                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{749                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{750                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{751                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{752                            \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{753                               iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{754                               iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{755                               xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{756 \textcolor{keywordflow}{                           Endif}}
\DoxyCodeLine{757 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{758                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{759                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{760 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{761                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{762                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{763                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{764                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{765                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{766                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{767                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{768                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{769 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{770                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{771                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{772                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{773 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{774 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{775 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{776                 ires\_med = iwrk1}
\DoxyCodeLine{777                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{778             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{779                 ires\_med = imed7}
\DoxyCodeLine{780                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{781 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{782          \textcolor{keywordflow}{Else}                       \textcolor{comment}{!      If (NLEQ > NMED)}}
\DoxyCodeLine{783 \textcolor{comment}{!                                          Not enough high values}}
\DoxyCodeLine{784                 xwrk1 = -\/xhuge}
\DoxyCodeLine{785                 nord = nleq -\/ nequ -\/ nmed + 1}
\DoxyCodeLine{786                 idon1 = 0}
\DoxyCodeLine{787                 icrs1 = 1}
\DoxyCodeLine{788                 icrs2 = 0}
\DoxyCodeLine{789                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{790                    idon1 = idon1 + 1}
\DoxyCodeLine{791                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{792 \textcolor{comment}{!}}
\DoxyCodeLine{793                       \textcolor{keywordflow}{Do} icrs = idon, iendt(idon1)}
\DoxyCodeLine{794                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) > xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{795                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{796                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{797                             idcr = icrs1 -\/ 1}
\DoxyCodeLine{798                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{799                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{800                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{801 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{802                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{803                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{804                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{805                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{806                             \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{807                                iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{808                                iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{809                                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{810 \textcolor{keywordflow}{                            End If}}
\DoxyCodeLine{811 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{812                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{813                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{814 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{815                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{816                       \textcolor{keywordflow}{Do} icrs = iendt(idon1), idon, -\/1}
\DoxyCodeLine{817                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) <= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{818                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{819                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{820                          idcr = icrs1 -\/ 1}
\DoxyCodeLine{821                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{822                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{823                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{824 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{825                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{826                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{827                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{828 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{829 \textcolor{keywordflow}{                   Endif}}
\DoxyCodeLine{830 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{831 \textcolor{comment}{!}}
\DoxyCodeLine{832                 ires\_med = iwrk1}
\DoxyCodeLine{833                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{834 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{835 \textcolor{comment}{!}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__indmed_abb66bb589821afa90ddd8bda8fcf609b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_a7a46817d54880450b7e336fd8ff0cda1}\label{namespacem__indmed_a7a46817d54880450b7e336fd8ff0cda1}} 
\index{m\_indmed@{m\_indmed}!real64\_indmed@{real64\_indmed}}
\index{real64\_indmed@{real64\_indmed}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{real64\_indmed()}{real64\_indmed()}}
{\footnotesize\ttfamily subroutine m\+\_\+indmed\+::real64\+\_\+indmed (\begin{DoxyParamCaption}\item[{real (kind=real64), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, intent(out)}]{I\+N\+DM }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\hypertarget{namespacem__indmed_autotoc_md16}{}\doxysubsubsection{N\+A\+ME}\label{namespacem__indmed_autotoc_md16}
indmed(3f) -\/ \mbox{[}orderpack\+:M\+E\+D\+I\+AN\mbox{]} Returns index of median value of an array. (L\+I\+C\+E\+N\+SE\+:C\+C0-\/1.\+0)\hypertarget{namespacem__indmed_autotoc_md17}{}\doxysubsubsection{S\+Y\+N\+O\+P\+S\+IS}\label{namespacem__indmed_autotoc_md17}
\begin{DoxyVerb} Subroutine ${KIND}_indmed (XDONT, INDM)

   ${TYPE} (kind=${KIND}), Dimension (:), Intent (In) :: XDONT
   Integer, Intent (Out) :: INDM

Where ${TYPE}(kind=${KIND}) may be

   o Real(kind=real32)
   o Real(kind=real64)
   o Integer(kind=int32)
\end{DoxyVerb}
\hypertarget{namespacem__indmed_autotoc_md18}{}\doxysubsubsection{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}\label{namespacem__indmed_autotoc_md18}
Finds the index of the median of X\+D\+O\+NT using the recursive procedure described in Knuth, The Art of Computer Programming, vol. 3, 5.\+3.\+3 -\/ This procedure is linear in time, and does not require to be able to interpolate in the set as the one used in I\+N\+D\+N\+TH. It also has better worst case behavior than I\+N\+D\+N\+TH, but is about 30\% slower in average for random uniformly distributed values.\hypertarget{namespacem__indmed_autotoc_md19}{}\doxysubsubsection{O\+P\+T\+I\+O\+NS}\label{namespacem__indmed_autotoc_md19}
X\+D\+O\+NT array to find the median value of. I\+N\+DM index of the median value.\hypertarget{namespacem__indmed_autotoc_md20}{}\doxysubsubsection{E\+X\+A\+M\+P\+L\+ES}\label{namespacem__indmed_autotoc_md20}
Sample program\+:

program demo\+\_\+indmed use M\+\_\+indmed, only \+: indmed implicit none !x!call indmed(yyyyyy) end program demo\+\_\+indmed

Results\+:\hypertarget{namespacem__indmed_autotoc_md21}{}\doxysubsubsection{A\+U\+T\+H\+OR}\label{namespacem__indmed_autotoc_md21}
Michel Olagnon, 2000-\/2012

John Urban, 2022.\+04.\+16 o added man-\/page and reduced to a template using the prep(1) preprocessor.\hypertarget{namespacem__indmed_autotoc_md22}{}\doxysubsubsection{L\+I\+C\+E\+N\+SE}\label{namespacem__indmed_autotoc_md22}
C\+C0-\/1.\+0 
\begin{DoxyCode}{0}
\DoxyCodeLine{64 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{65       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: INDM}
\DoxyCodeLine{66 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{67       \textcolor{keywordtype}{Integer} :: IDON}
\DoxyCodeLine{68 \textcolor{comment}{!}}
\DoxyCodeLine{69       \textcolor{keyword}{Allocate} (idont(\textcolor{keyword}{SIZE}(xdont)))}
\DoxyCodeLine{70       \textcolor{keywordflow}{Do} idon = 1, \textcolor{keyword}{SIZE}(xdont)}
\DoxyCodeLine{71          idont(idon) = idon}
\DoxyCodeLine{72 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{73 \textcolor{comment}{!}}
\DoxyCodeLine{74       \textcolor{keyword}{Call }real64\_med (xdont, idont, indm)}
\DoxyCodeLine{75 \textcolor{comment}{!}}
\DoxyCodeLine{76       \textcolor{keyword}{Deallocate} (idont)}

\end{DoxyCode}


References idont, and real64\+\_\+med().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__indmed_a7a46817d54880450b7e336fd8ff0cda1_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_a82d4f27afcb6802376dfbebacaf594fc}\label{namespacem__indmed_a82d4f27afcb6802376dfbebacaf594fc}} 
\index{m\_indmed@{m\_indmed}!real64\_med@{real64\_med}}
\index{real64\_med@{real64\_med}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{real64\_med()}{real64\_med()}}
{\footnotesize\ttfamily recursive subroutine m\+\_\+indmed\+::real64\+\_\+med (\begin{DoxyParamCaption}\item[{real (kind=real64), dimension (\+:), intent(in)}]{X\+D\+A\+TT,  }\item[{integer, dimension (\+:), intent(in)}]{I\+D\+A\+TT,  }\item[{integer, intent(out)}]{ires\+\_\+med }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{80 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdatt}
\DoxyCodeLine{81       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: IDATT}
\DoxyCodeLine{82       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)}:: ires\_med}
\DoxyCodeLine{83 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{84 \textcolor{comment}{!}}
\DoxyCodeLine{85 \textcolor{keywordtype}{      Real} (kind=real64), \textcolor{keywordtype}{Parameter} :: xhuge = huge(xdatt)}
\DoxyCodeLine{86 \textcolor{keywordtype}{      Real} (kind=real64) :: xwrk, xwrk1, xmed7, xmax, xmin}
\DoxyCodeLine{87 \textcolor{comment}{!}}
\DoxyCodeLine{88       \textcolor{keywordtype}{Integer}, Dimension (7*(((Size (IDATT)+6)/7+6)/7)) :: ISTRT, IENDT,\textcolor{comment}{ IMEDT}}
\DoxyCodeLine{89 \textcolor{comment}{      }\textcolor{keywordtype}{Integer}, Dimension (7*((Size(IDATT)+6)/7)) :: IWRKT}
\DoxyCodeLine{90       \textcolor{keywordtype}{Integer} :: NTRI, NMED, NORD, NEQU, NLEQ, IMED, IDON, IDON1}
\DoxyCodeLine{91       \textcolor{keywordtype}{Integer} :: IDEB, ITMP, IDCR, ICRS, ICRS1, ICRS2, IMAX, IMIN}
\DoxyCodeLine{92       \textcolor{keywordtype}{Integer} :: IWRK, IWRK1, IMED1, IMED7, NDAT}
\DoxyCodeLine{93 \textcolor{comment}{!}}
\DoxyCodeLine{94       ndat = \textcolor{keyword}{Size} (idatt)}
\DoxyCodeLine{95       nmed = (ndat+1) / 2}
\DoxyCodeLine{96       iwrkt = idatt}
\DoxyCodeLine{97 \textcolor{comment}{!}}
\DoxyCodeLine{98 \textcolor{comment}{!  If the number of values is small, then use insertion sort}}
\DoxyCodeLine{99 \textcolor{comment}{!}}
\DoxyCodeLine{100      \textcolor{keywordflow}{If} (ndat < 35) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{101 \textcolor{comment}{!}}
\DoxyCodeLine{102 \textcolor{comment}{!  Bring minimum to first location to save test in decreasing loop}}
\DoxyCodeLine{103 \textcolor{comment}{!}}
\DoxyCodeLine{104          idcr = ndat}
\DoxyCodeLine{105          \textcolor{keywordflow}{If} (xdatt(iwrkt(1)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{106             iwrk = iwrkt(1)}
\DoxyCodeLine{107          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{108             iwrk = iwrkt(idcr)}
\DoxyCodeLine{109             iwrkt(idcr) = iwrkt(1)}
\DoxyCodeLine{110 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{111          xwrk = xdatt(iwrk)}
\DoxyCodeLine{112          \textcolor{keywordflow}{Do} itmp = 1, ndat -\/ 2}
\DoxyCodeLine{113             idcr = idcr -\/ 1}
\DoxyCodeLine{114             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{115             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{116             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{117                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{118                 xwrk = xwrk1}
\DoxyCodeLine{119                 iwrk = iwrk1}
\DoxyCodeLine{120 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{121 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{122          iwrkt(1) = iwrk}
\DoxyCodeLine{123 \textcolor{comment}{!}}
\DoxyCodeLine{124 \textcolor{comment}{! Sort the first half, until we have NMED sorted values}}
\DoxyCodeLine{125 \textcolor{comment}{!}}
\DoxyCodeLine{126          \textcolor{keywordflow}{Do} icrs = 3, nmed}
\DoxyCodeLine{127             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{128             iwrk = iwrkt(icrs)}
\DoxyCodeLine{129             idcr = icrs -\/ 1}
\DoxyCodeLine{130             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{131                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{132                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{133                   idcr = idcr -\/ 1}
\DoxyCodeLine{134 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{135             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{136 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{137 \textcolor{comment}{!}}
\DoxyCodeLine{138 \textcolor{comment}{!  Insert any value less than the current median in the first half}}
\DoxyCodeLine{139 \textcolor{comment}{!}}
\DoxyCodeLine{140          xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{141          \textcolor{keywordflow}{Do} icrs = nmed+1, ndat}
\DoxyCodeLine{142             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{143             iwrk = iwrkt(icrs)}
\DoxyCodeLine{144             \textcolor{keywordflow}{If} (xwrk < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{145                idcr = nmed -\/ 1}
\DoxyCodeLine{146                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{147                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{148                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{149                   idcr = idcr -\/ 1}
\DoxyCodeLine{150 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{151                iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{152                xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{153 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{154 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{155          ires\_med = iwrkt(nmed)}
\DoxyCodeLine{156          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{157 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{158 \textcolor{comment}{!}}
\DoxyCodeLine{159 \textcolor{comment}{!  Make sorted subsets of 7 elements}}
\DoxyCodeLine{160 \textcolor{comment}{!  This is done by a variant of insertion sort where a first}}
\DoxyCodeLine{161 \textcolor{comment}{!  pass is used to bring the smallest element to the first position}}
\DoxyCodeLine{162 \textcolor{comment}{!  decreasing disorder at the same time, so that we may remove}}
\DoxyCodeLine{163 \textcolor{comment}{!  the loop test in the insertion loop.}}
\DoxyCodeLine{164 \textcolor{comment}{!}}
\DoxyCodeLine{165       imax = 1}
\DoxyCodeLine{166       imin = 1}
\DoxyCodeLine{167       xmax = xdatt(iwrkt(imax))}
\DoxyCodeLine{168       xmin = xdatt(iwrkt(imin))}
\DoxyCodeLine{169       \textcolor{keywordflow}{DO} ideb = 1, ndat-\/6, 7}
\DoxyCodeLine{170          idcr = ideb + 6}
\DoxyCodeLine{171          \textcolor{keywordflow}{If} (xdatt(iwrkt(ideb)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{172             iwrk = iwrkt(ideb)}
\DoxyCodeLine{173          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{174             iwrk = iwrkt(idcr)}
\DoxyCodeLine{175             iwrkt(idcr) = iwrkt(ideb)}
\DoxyCodeLine{176 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{177          xwrk = xdatt(iwrk)}
\DoxyCodeLine{178          \textcolor{keywordflow}{Do} itmp = 1, 5}
\DoxyCodeLine{179             idcr = idcr -\/ 1}
\DoxyCodeLine{180             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{181             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{182             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{183                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{184                 iwrk = iwrk1}
\DoxyCodeLine{185                 xwrk = xwrk1}
\DoxyCodeLine{186 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{187 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{188          iwrkt(ideb) = iwrk}
\DoxyCodeLine{189          \textcolor{keywordflow}{If} (xwrk < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{190              imin = iwrk}
\DoxyCodeLine{191              xmin = xwrk}
\DoxyCodeLine{192 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{193          \textcolor{keywordflow}{Do} icrs = ideb+1, ideb+5}
\DoxyCodeLine{194             iwrk = iwrkt(icrs+1)}
\DoxyCodeLine{195             xwrk = xdatt(iwrk)}
\DoxyCodeLine{196             idon = iwrkt(icrs)}
\DoxyCodeLine{197             \textcolor{keywordflow}{If} (xwrk < xdatt(idon)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{198                iwrkt(icrs+1) = idon}
\DoxyCodeLine{199                idcr = icrs}
\DoxyCodeLine{200                iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{201                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{202                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{203                   \textcolor{keywordflow}{If} (xwrk >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{204                   iwrkt(idcr) = iwrk1}
\DoxyCodeLine{205                   idcr = idcr -\/ 1}
\DoxyCodeLine{206                   iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{207                   xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{208 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{209                iwrkt(idcr) = iwrk}
\DoxyCodeLine{210 \textcolor{keywordflow}{            EndIf}}
\DoxyCodeLine{211 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{212          \textcolor{keywordflow}{If} (xwrk > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{213              imax = iwrk}
\DoxyCodeLine{214              xmax = xwrk}
\DoxyCodeLine{215 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{216 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{217 \textcolor{comment}{!}}
\DoxyCodeLine{218 \textcolor{comment}{!  Add-\/up alternatively MAX and MIN values to make the number of data}}
\DoxyCodeLine{219 \textcolor{comment}{!  an exact multiple of 7.}}
\DoxyCodeLine{220 \textcolor{comment}{!}}
\DoxyCodeLine{221       ideb = 7 * (ndat/7)}
\DoxyCodeLine{222       ntri = ndat}
\DoxyCodeLine{223       \textcolor{keywordflow}{If} (ideb < ndat) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{224 \textcolor{comment}{!}}
\DoxyCodeLine{225          \textcolor{keywordflow}{Do} icrs = ideb+1, ndat}
\DoxyCodeLine{226             xwrk1 = xdatt(iwrkt(icrs))}
\DoxyCodeLine{227             \textcolor{keywordflow}{IF} (xwrk1 > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{228                imax = iwrkt(icrs)}
\DoxyCodeLine{229                xmax = xwrk1}
\DoxyCodeLine{230 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{231             \textcolor{keywordflow}{IF} (xwrk1 < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{232                imin = iwrkt(icrs)}
\DoxyCodeLine{233                xmin = xwrk1}
\DoxyCodeLine{234 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{235 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{236          iwrk1 = imax}
\DoxyCodeLine{237          \textcolor{keywordflow}{Do} icrs = ndat+1, ideb+7}
\DoxyCodeLine{238                iwrkt(icrs) = iwrk1}
\DoxyCodeLine{239                \textcolor{keywordflow}{If} (iwrk1 == imax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{240                   iwrk1 = imin}
\DoxyCodeLine{241                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{242                   nmed = nmed + 1}
\DoxyCodeLine{243                   iwrk1 = imax}
\DoxyCodeLine{244 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{245 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{246 \textcolor{comment}{!}}
\DoxyCodeLine{247          \textcolor{keywordflow}{Do} icrs = ideb+2, ideb+7}
\DoxyCodeLine{248             iwrk = iwrkt(icrs)}
\DoxyCodeLine{249             xwrk = xdatt(iwrk)}
\DoxyCodeLine{250             \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, ideb+1, -\/ 1}
\DoxyCodeLine{251                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{252                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{253 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{254             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{255 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{256 \textcolor{comment}{!}}
\DoxyCodeLine{257          ntri = ideb+7}
\DoxyCodeLine{258 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{259 \textcolor{comment}{!}}
\DoxyCodeLine{260 \textcolor{comment}{!  Make the set of the indices of median values of each sorted subset}}
\DoxyCodeLine{261 \textcolor{comment}{!}}
\DoxyCodeLine{262          idon1 = 0}
\DoxyCodeLine{263          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{264             idon1 = idon1 + 1}
\DoxyCodeLine{265             imedt(idon1) = iwrkt(idon + 3)}
\DoxyCodeLine{266 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{267 \textcolor{comment}{!}}
\DoxyCodeLine{268 \textcolor{comment}{!  Find XMED7, the median of the medians}}
\DoxyCodeLine{269 \textcolor{comment}{!}}
\DoxyCodeLine{270          \textcolor{keyword}{Call }real64\_med (xdatt, imedt(1:idon1), imed7)}
\DoxyCodeLine{271          xmed7 = xdatt(imed7)}
\DoxyCodeLine{272 \textcolor{comment}{!}}
\DoxyCodeLine{273 \textcolor{comment}{!  Count how many values are not higher than (and how many equal to) XMED7}}
\DoxyCodeLine{274 \textcolor{comment}{!  This number is at least 4 * 1/2 * (N/7) : 4 values in each of the}}
\DoxyCodeLine{275 \textcolor{comment}{!  subsets where the median is lower than the median of medians. For similar}}
\DoxyCodeLine{276 \textcolor{comment}{!  reasons, we also have at least 2N/7 values not lower than XMED7. At the}}
\DoxyCodeLine{277 \textcolor{comment}{!  same time, we find in each subset the index of the last value < XMED7,}}
\DoxyCodeLine{278 \textcolor{comment}{!  and that of the first > XMED7. These indices will be used to restrict the}}
\DoxyCodeLine{279 \textcolor{comment}{!  search for the median as the Kth element in the subset (> or <) where}}
\DoxyCodeLine{280 \textcolor{comment}{!  we know it to be.}}
\DoxyCodeLine{281 \textcolor{comment}{!}}
\DoxyCodeLine{282          idon1 = 1}
\DoxyCodeLine{283          nleq = 0}
\DoxyCodeLine{284          nequ = 0}
\DoxyCodeLine{285          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{286             imed = idon+3}
\DoxyCodeLine{287             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{288                   imed = imed -\/ 2}
\DoxyCodeLine{289                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{290                      imed = imed -\/ 1}
\DoxyCodeLine{291                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{292                      imed = imed + 1}
\DoxyCodeLine{293 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{294             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{295                   imed = imed + 2}
\DoxyCodeLine{296                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{297                      imed = imed -\/ 1}
\DoxyCodeLine{298                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{299                      imed = imed + 1}
\DoxyCodeLine{300 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{301 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{302             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{303                nleq = nleq + imed -\/ idon}
\DoxyCodeLine{304                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{305                istrt(idon1) = imed}
\DoxyCodeLine{306             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{307                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{308                iendt(idon1) = imed}
\DoxyCodeLine{309                istrt(idon1) = imed + 1}
\DoxyCodeLine{310             \textcolor{keywordflow}{Else}                    \textcolor{comment}{!       If (XDATT (IWRKT (IMED)) == XMED7)}}
\DoxyCodeLine{311                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{312                nequ = nequ + 1}
\DoxyCodeLine{313                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{314                \textcolor{keywordflow}{Do} imed1 = imed -\/ 1, idon, -\/1}
\DoxyCodeLine{315                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{316                      nequ = nequ + 1}
\DoxyCodeLine{317                      iendt(idon1) = imed1 -\/ 1}
\DoxyCodeLine{318                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{319                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{320 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{321 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{322                istrt(idon1) = imed + 1}
\DoxyCodeLine{323                \textcolor{keywordflow}{Do} imed1 = imed + 1, idon + 6}
\DoxyCodeLine{324                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{325                      nequ = nequ + 1}
\DoxyCodeLine{326                      nleq = nleq + 1}
\DoxyCodeLine{327                      istrt(idon1) = imed1 + 1}
\DoxyCodeLine{328                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{329                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{330 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{331 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{332 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{333             idon1 = idon1 + 1}
\DoxyCodeLine{334 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{335 \textcolor{comment}{!}}
\DoxyCodeLine{336 \textcolor{comment}{!  Carry out a partial insertion sort to find the Kth smallest of the}}
\DoxyCodeLine{337 \textcolor{comment}{!  large values, or the Kth largest of the small values, according to}}
\DoxyCodeLine{338 \textcolor{comment}{!  what is needed.}}
\DoxyCodeLine{339 \textcolor{comment}{!}}
\DoxyCodeLine{340 \textcolor{comment}{!}}
\DoxyCodeLine{341          \textcolor{keywordflow}{If} (nleq -\/ nequ + 1 <= nmed) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{342             \textcolor{keywordflow}{If} (nleq < nmed) \textcolor{keywordflow}{Then}   \textcolor{comment}{!      Not enough low values}}
\DoxyCodeLine{343                 iwrk1 = imax}
\DoxyCodeLine{344                 xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{345                 nord = nmed -\/ nleq}
\DoxyCodeLine{346                 idon1 = 0}
\DoxyCodeLine{347                 icrs1 = 1}
\DoxyCodeLine{348                 icrs2 = 0}
\DoxyCodeLine{349                 idcr = 0}
\DoxyCodeLine{350                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{351                    idon1 = idon1 + 1}
\DoxyCodeLine{352                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{353                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{354                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{355                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{356                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{357                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{358                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{359                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{360 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{361                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{362                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{363                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{364                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{365                            \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{366                               iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{367                               iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{368                               xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{369 \textcolor{keywordflow}{                           Endif}}
\DoxyCodeLine{370 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{371                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{372                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{373 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{374                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{375                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{376                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{377                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{378                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{379                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{380                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{381                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{382 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{383                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{384                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{385                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{386 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{387 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{388 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{389                 ires\_med = iwrk1}
\DoxyCodeLine{390                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{391             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{392                 ires\_med = imed7}
\DoxyCodeLine{393                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{394 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{395          \textcolor{keywordflow}{Else}                       \textcolor{comment}{!      If (NLEQ > NMED)}}
\DoxyCodeLine{396 \textcolor{comment}{!                                          Not enough high values}}
\DoxyCodeLine{397                 xwrk1 = -\/xhuge}
\DoxyCodeLine{398                 nord = nleq -\/ nequ -\/ nmed + 1}
\DoxyCodeLine{399                 idon1 = 0}
\DoxyCodeLine{400                 icrs1 = 1}
\DoxyCodeLine{401                 icrs2 = 0}
\DoxyCodeLine{402                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{403                    idon1 = idon1 + 1}
\DoxyCodeLine{404                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{405 \textcolor{comment}{!}}
\DoxyCodeLine{406                       \textcolor{keywordflow}{Do} icrs = idon, iendt(idon1)}
\DoxyCodeLine{407                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) > xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{408                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{409                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{410                             idcr = icrs1 -\/ 1}
\DoxyCodeLine{411                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{412                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{413                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{414 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{415                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{416                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{417                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{418                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{419                             \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{420                                iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{421                                iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{422                                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{423 \textcolor{keywordflow}{                            End If}}
\DoxyCodeLine{424 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{425                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{426                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{427 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{428                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{429                       \textcolor{keywordflow}{Do} icrs = iendt(idon1), idon, -\/1}
\DoxyCodeLine{430                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) <= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{431                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{432                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{433                          idcr = icrs1 -\/ 1}
\DoxyCodeLine{434                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{435                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{436                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{437 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{438                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{439                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{440                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{441 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{442 \textcolor{keywordflow}{                   Endif}}
\DoxyCodeLine{443 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{444 \textcolor{comment}{!}}
\DoxyCodeLine{445                 ires\_med = iwrk1}
\DoxyCodeLine{446                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{447 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{448 \textcolor{comment}{!}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacem__indmed_a82d4f27afcb6802376dfbebacaf594fc_icgraph}
\end{center}
\end{figure}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacem__indmed_ad17c2a3bf73f372ad2d9ea60e151ee23}\label{namespacem__indmed_ad17c2a3bf73f372ad2d9ea60e151ee23}} 
\index{m\_indmed@{m\_indmed}!idont@{idont}}
\index{idont@{idont}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{idont}{idont}}
{\footnotesize\ttfamily integer, dimension(\+:), allocatable, save, private m\+\_\+indmed\+::idont\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{6 \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Allocatable}, \textcolor{keywordtype}{Dimension(:)}, \textcolor{keywordtype}{Private}, \textcolor{keywordtype}{Save} :: IDONT}

\end{DoxyCode}
