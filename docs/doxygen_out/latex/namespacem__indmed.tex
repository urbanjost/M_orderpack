\hypertarget{namespacem__indmed}{}\doxysection{m\+\_\+indmed Module Reference}
\label{namespacem__indmed}\index{m\_indmed@{m\_indmed}}
\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface \mbox{\hyperlink{interfacem__indmed_1_1indmed}{indmed}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, private \mbox{\hyperlink{namespacem__indmed_a796f80158b0794322d6e9032193d8753}{d\+\_\+indmed}} (X\+D\+O\+NT, I\+N\+DM)
\item 
recursive subroutine, private \mbox{\hyperlink{namespacem__indmed_a8ea11e494102978f926fd8009e5289f2}{d\+\_\+med}} (X\+D\+A\+TT, I\+D\+A\+TT, ires\+\_\+med)
\item 
subroutine, private \mbox{\hyperlink{namespacem__indmed_ad773929cbb9e2777aaa071f931332c82}{r\+\_\+indmed}} (X\+D\+O\+NT, I\+N\+DM)
\item 
recursive subroutine, private \mbox{\hyperlink{namespacem__indmed_a06ba48e291f2b49f3f20a859657638be}{r\+\_\+med}} (X\+D\+A\+TT, I\+D\+A\+TT, ires\+\_\+med)
\item 
subroutine, private \mbox{\hyperlink{namespacem__indmed_a6806292390a76d9c0a2ba90f95480301}{i\+\_\+indmed}} (X\+D\+O\+NT, I\+N\+DM)
\item 
recursive subroutine, private \mbox{\hyperlink{namespacem__indmed_af3a3214a291d18eefafc17269ec90dd6}{i\+\_\+med}} (X\+D\+A\+TT, I\+D\+A\+TT, ires\+\_\+med)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
integer, parameter, private \mbox{\hyperlink{namespacem__indmed_a9a57777f2d73827dcf6eeaaa4c2bb397}{kdp}} = selected\+\_\+real\+\_\+kind(15)
\item 
integer, dimension(\+:), allocatable, save, private \mbox{\hyperlink{namespacem__indmed_ad17c2a3bf73f372ad2d9ea60e151ee23}{idont}}
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacem__indmed_a796f80158b0794322d6e9032193d8753}\label{namespacem__indmed_a796f80158b0794322d6e9032193d8753}} 
\index{m\_indmed@{m\_indmed}!d\_indmed@{d\_indmed}}
\index{d\_indmed@{d\_indmed}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{d\_indmed()}{d\_indmed()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+indmed\+::d\+\_\+indmed (\begin{DoxyParamCaption}\item[{real (kind=\mbox{\hyperlink{namespacem__indmed_a9a57777f2d73827dcf6eeaaa4c2bb397}{kdp}}), dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, intent(out)}]{I\+N\+DM }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\hypertarget{namespacem__indmed_autotoc_md15}{}\doxysubsubsection{N\+A\+ME}\label{namespacem__indmed_autotoc_md15}
indmed(3f) -\/ \mbox{[}orderpack\mbox{]} do stuff (L\+I\+C\+E\+N\+SE\+:C\+C0-\/1.\+0)\hypertarget{namespacem__indmed_autotoc_md16}{}\doxysubsubsection{S\+Y\+N\+O\+P\+S\+IS}\label{namespacem__indmed_autotoc_md16}
\begin{DoxyVerb} Subroutine indmed (yyyyyy)

  ${TYPE} (kind=${KIND}), Intent (InOut) :: yyyyyy(:)

Where ${TYPE}(kind=${KIND}) may be

   o Real(kind=real32)
   o Real(kind=real64)
   o Integer(kind=int32)
\end{DoxyVerb}
\hypertarget{namespacem__indmed_autotoc_md17}{}\doxysubsubsection{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}\label{namespacem__indmed_autotoc_md17}
\hypertarget{namespacem__indmed_autotoc_md18}{}\doxysubsubsection{O\+P\+T\+I\+O\+NS}\label{namespacem__indmed_autotoc_md18}
X\+X\+X\+XX description Y\+Y\+Y\+YY description\hypertarget{namespacem__indmed_autotoc_md19}{}\doxysubsubsection{E\+X\+A\+M\+P\+L\+ES}\label{namespacem__indmed_autotoc_md19}
Sample program\+:

program demo\+\_\+indmed use M\+\_\+indmed, only \+: indmed implicit none call indmed(yyyyyy) end program demo\+\_\+indmed

Results\+:\hypertarget{namespacem__indmed_autotoc_md20}{}\doxysubsubsection{A\+U\+T\+H\+OR}\label{namespacem__indmed_autotoc_md20}
Michel Olagnon, 2000-\/2012

John Urban, 2022.\+04.\+16 o added man-\/page and reduced to a template using the prep(1) preprocessor.\hypertarget{namespacem__indmed_autotoc_md21}{}\doxysubsubsection{L\+I\+C\+E\+N\+SE}\label{namespacem__indmed_autotoc_md21}
C\+C0-\/1.\+0 
\begin{DoxyCode}{0}
\DoxyCodeLine{61 \textcolor{comment}{!! Returns index of median value of XDONT.}}
\DoxyCodeLine{62 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{63 \textcolor{keywordtype}{      Real} (kind=kdp), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdont}
\DoxyCodeLine{64       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: INDM}
\DoxyCodeLine{65 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{66       \textcolor{keywordtype}{Integer} :: IDON}
\DoxyCodeLine{67 \textcolor{comment}{!}}
\DoxyCodeLine{68       \textcolor{keyword}{Allocate} (idont(\textcolor{keyword}{SIZE}(xdont)))}
\DoxyCodeLine{69       \textcolor{keywordflow}{Do} idon = 1, \textcolor{keyword}{SIZE}(xdont)}
\DoxyCodeLine{70          idont(idon) = idon}
\DoxyCodeLine{71 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{72 \textcolor{comment}{!}}
\DoxyCodeLine{73       \textcolor{keyword}{Call }d\_med (xdont, idont, indm)}
\DoxyCodeLine{74 \textcolor{comment}{!}}
\DoxyCodeLine{75       \textcolor{keyword}{Deallocate} (idont)}

\end{DoxyCode}


References d\+\_\+med(), and idont.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=345pt]{namespacem__indmed_a796f80158b0794322d6e9032193d8753_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_a8ea11e494102978f926fd8009e5289f2}\label{namespacem__indmed_a8ea11e494102978f926fd8009e5289f2}} 
\index{m\_indmed@{m\_indmed}!d\_med@{d\_med}}
\index{d\_med@{d\_med}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{d\_med()}{d\_med()}}
{\footnotesize\ttfamily recursive subroutine, private m\+\_\+indmed\+::d\+\_\+med (\begin{DoxyParamCaption}\item[{real (kind=\mbox{\hyperlink{namespacem__indmed_a9a57777f2d73827dcf6eeaaa4c2bb397}{kdp}}), dimension (\+:), intent(in)}]{X\+D\+A\+TT,  }\item[{integer, dimension (\+:), intent(in)}]{I\+D\+A\+TT,  }\item[{integer, intent(out)}]{ires\+\_\+med }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{78 \textcolor{comment}{!! Finds the index of the median of XDONT using the recursive procedure}}
\DoxyCodeLine{79 \textcolor{comment}{!! described in Knuth, The Art of Computer Programming,}}
\DoxyCodeLine{80 \textcolor{comment}{!! vol. 3, 5.3.3 -\/ This procedure is linear in time, and}}
\DoxyCodeLine{81 \textcolor{comment}{!! does not require to be able to interpolate in the}}
\DoxyCodeLine{82 \textcolor{comment}{!! set as the one used in INDNTH. It also has better worst}}
\DoxyCodeLine{83 \textcolor{comment}{!! case behavior than INDNTH, but is about 30\% slower in}}
\DoxyCodeLine{84 \textcolor{comment}{!! average for random uniformly distributed values.}}
\DoxyCodeLine{85 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{86 \textcolor{keywordtype}{      Real} (kind=kdp), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: xdatt}
\DoxyCodeLine{87       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: IDATT}
\DoxyCodeLine{88       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)}:: ires\_med}
\DoxyCodeLine{89 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{90 \textcolor{comment}{!}}
\DoxyCodeLine{91 \textcolor{keywordtype}{      Real} (kind=kdp), \textcolor{keywordtype}{Parameter} :: xhuge = huge(xdatt)}
\DoxyCodeLine{92 \textcolor{keywordtype}{      Real} (kind=kdp) :: xwrk, xwrk1, xmed7, xmax, xmin}
\DoxyCodeLine{93 \textcolor{comment}{!}}
\DoxyCodeLine{94       \textcolor{keywordtype}{Integer}, Dimension (7*(((Size (IDATT)+6)/7+6)/7)) :: ISTRT, IENDT, IMEDT}
\DoxyCodeLine{95       \textcolor{keywordtype}{Integer}, Dimension (7*((Size(IDATT)+6)/7)) :: IWRKT}
\DoxyCodeLine{96       \textcolor{keywordtype}{Integer} :: NTRI, NMED, NORD, NEQU, NLEQ, IMED, IDON, IDON1}
\DoxyCodeLine{97       \textcolor{keywordtype}{Integer} :: IDEB, ITMP, IDCR, ICRS, ICRS1, ICRS2, IMAX, IMIN}
\DoxyCodeLine{98       \textcolor{keywordtype}{Integer} :: IWRK, IWRK1, IMED1, IMED7, NDAT}
\DoxyCodeLine{99 \textcolor{comment}{!}}
\DoxyCodeLine{100       ndat = \textcolor{keyword}{Size} (idatt)}
\DoxyCodeLine{101       nmed = (ndat+1) / 2}
\DoxyCodeLine{102       iwrkt = idatt}
\DoxyCodeLine{103 \textcolor{comment}{!}}
\DoxyCodeLine{104 \textcolor{comment}{!  If the number of values is small, then use insertion sort}}
\DoxyCodeLine{105 \textcolor{comment}{!}}
\DoxyCodeLine{106      \textcolor{keywordflow}{If} (ndat < 35) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{107 \textcolor{comment}{!}}
\DoxyCodeLine{108 \textcolor{comment}{!  Bring minimum to first location to save test in decreasing loop}}
\DoxyCodeLine{109 \textcolor{comment}{!}}
\DoxyCodeLine{110          idcr = ndat}
\DoxyCodeLine{111          \textcolor{keywordflow}{If} (xdatt(iwrkt(1)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{112             iwrk = iwrkt(1)}
\DoxyCodeLine{113          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{114             iwrk = iwrkt(idcr)}
\DoxyCodeLine{115             iwrkt(idcr) = iwrkt(1)}
\DoxyCodeLine{116 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{117          xwrk = xdatt(iwrk)}
\DoxyCodeLine{118          \textcolor{keywordflow}{Do} itmp = 1, ndat -\/ 2}
\DoxyCodeLine{119             idcr = idcr -\/ 1}
\DoxyCodeLine{120             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{121             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{122             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{123                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{124                 xwrk = xwrk1}
\DoxyCodeLine{125                 iwrk = iwrk1}
\DoxyCodeLine{126 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{127 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{128          iwrkt(1) = iwrk}
\DoxyCodeLine{129 \textcolor{comment}{!}}
\DoxyCodeLine{130 \textcolor{comment}{! Sort the first half, until we have NMED sorted values}}
\DoxyCodeLine{131 \textcolor{comment}{!}}
\DoxyCodeLine{132          \textcolor{keywordflow}{Do} icrs = 3, nmed}
\DoxyCodeLine{133             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{134             iwrk = iwrkt(icrs)}
\DoxyCodeLine{135             idcr = icrs -\/ 1}
\DoxyCodeLine{136             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{137                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{138                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{139                   idcr = idcr -\/ 1}
\DoxyCodeLine{140 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{141             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{142 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{143 \textcolor{comment}{!}}
\DoxyCodeLine{144 \textcolor{comment}{!  Insert any value less than the current median in the first half}}
\DoxyCodeLine{145 \textcolor{comment}{!}}
\DoxyCodeLine{146          xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{147          \textcolor{keywordflow}{Do} icrs = nmed+1, ndat}
\DoxyCodeLine{148             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{149             iwrk = iwrkt(icrs)}
\DoxyCodeLine{150             \textcolor{keywordflow}{If} (xwrk < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{151                idcr = nmed -\/ 1}
\DoxyCodeLine{152                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{153                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{154                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{155                   idcr = idcr -\/ 1}
\DoxyCodeLine{156 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{157                iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{158                xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{159 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{160 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{161          ires\_med = iwrkt(nmed)}
\DoxyCodeLine{162          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{163 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{164 \textcolor{comment}{!}}
\DoxyCodeLine{165 \textcolor{comment}{!  Make sorted subsets of 7 elements}}
\DoxyCodeLine{166 \textcolor{comment}{!  This is done by a variant of insertion sort where a first}}
\DoxyCodeLine{167 \textcolor{comment}{!  pass is used to bring the smallest element to the first position}}
\DoxyCodeLine{168 \textcolor{comment}{!  decreasing disorder at the same time, so that we may remove}}
\DoxyCodeLine{169 \textcolor{comment}{!  the loop test in the insertion loop.}}
\DoxyCodeLine{170 \textcolor{comment}{!}}
\DoxyCodeLine{171       imax = 1}
\DoxyCodeLine{172       imin = 1}
\DoxyCodeLine{173       xmax = xdatt(iwrkt(imax))}
\DoxyCodeLine{174       xmin = xdatt(iwrkt(imin))}
\DoxyCodeLine{175       \textcolor{keywordflow}{DO} ideb = 1, ndat-\/6, 7}
\DoxyCodeLine{176          idcr = ideb + 6}
\DoxyCodeLine{177          \textcolor{keywordflow}{If} (xdatt(iwrkt(ideb)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{178             iwrk = iwrkt(ideb)}
\DoxyCodeLine{179          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{180             iwrk = iwrkt(idcr)}
\DoxyCodeLine{181             iwrkt(idcr) = iwrkt(ideb)}
\DoxyCodeLine{182 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{183          xwrk = xdatt(iwrk)}
\DoxyCodeLine{184          \textcolor{keywordflow}{Do} itmp = 1, 5}
\DoxyCodeLine{185             idcr = idcr -\/ 1}
\DoxyCodeLine{186             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{187             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{188             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{189                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{190                 iwrk = iwrk1}
\DoxyCodeLine{191                 xwrk = xwrk1}
\DoxyCodeLine{192 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{193 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{194          iwrkt(ideb) = iwrk}
\DoxyCodeLine{195          \textcolor{keywordflow}{If} (xwrk < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{196              imin = iwrk}
\DoxyCodeLine{197              xmin = xwrk}
\DoxyCodeLine{198 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{199          \textcolor{keywordflow}{Do} icrs = ideb+1, ideb+5}
\DoxyCodeLine{200             iwrk = iwrkt(icrs+1)}
\DoxyCodeLine{201             xwrk = xdatt(iwrk)}
\DoxyCodeLine{202             idon = iwrkt(icrs)}
\DoxyCodeLine{203             \textcolor{keywordflow}{If} (xwrk < xdatt(idon)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{204                iwrkt(icrs+1) = idon}
\DoxyCodeLine{205                idcr = icrs}
\DoxyCodeLine{206                iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{207                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{208                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{209                   \textcolor{keywordflow}{If} (xwrk >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{210                   iwrkt(idcr) = iwrk1}
\DoxyCodeLine{211                   idcr = idcr -\/ 1}
\DoxyCodeLine{212                   iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{213                   xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{214 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{215                iwrkt(idcr) = iwrk}
\DoxyCodeLine{216 \textcolor{keywordflow}{            EndIf}}
\DoxyCodeLine{217 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{218          \textcolor{keywordflow}{If} (xwrk > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{219              imax = iwrk}
\DoxyCodeLine{220              xmax = xwrk}
\DoxyCodeLine{221 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{222 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{223 \textcolor{comment}{!}}
\DoxyCodeLine{224 \textcolor{comment}{!  Add-\/up alternatively MAX and MIN values to make the number of data}}
\DoxyCodeLine{225 \textcolor{comment}{!  an exact multiple of 7.}}
\DoxyCodeLine{226 \textcolor{comment}{!}}
\DoxyCodeLine{227       ideb = 7 * (ndat/7)}
\DoxyCodeLine{228       ntri = ndat}
\DoxyCodeLine{229       \textcolor{keywordflow}{If} (ideb < ndat) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{230 \textcolor{comment}{!}}
\DoxyCodeLine{231          \textcolor{keywordflow}{Do} icrs = ideb+1, ndat}
\DoxyCodeLine{232             xwrk1 = xdatt(iwrkt(icrs))}
\DoxyCodeLine{233             \textcolor{keywordflow}{IF} (xwrk1 > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{234                imax = iwrkt(icrs)}
\DoxyCodeLine{235                xmax = xwrk1}
\DoxyCodeLine{236 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{237             \textcolor{keywordflow}{IF} (xwrk1 < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{238                imin = iwrkt(icrs)}
\DoxyCodeLine{239                xmin = xwrk1}
\DoxyCodeLine{240 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{241 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{242          iwrk1 = imax}
\DoxyCodeLine{243          \textcolor{keywordflow}{Do} icrs = ndat+1, ideb+7}
\DoxyCodeLine{244                iwrkt(icrs) = iwrk1}
\DoxyCodeLine{245                \textcolor{keywordflow}{If} (iwrk1 == imax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{246                   iwrk1 = imin}
\DoxyCodeLine{247                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{248                   nmed = nmed + 1}
\DoxyCodeLine{249                   iwrk1 = imax}
\DoxyCodeLine{250 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{251 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{252 \textcolor{comment}{!}}
\DoxyCodeLine{253          \textcolor{keywordflow}{Do} icrs = ideb+2, ideb+7}
\DoxyCodeLine{254             iwrk = iwrkt(icrs)}
\DoxyCodeLine{255             xwrk = xdatt(iwrk)}
\DoxyCodeLine{256             \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, ideb+1, -\/ 1}
\DoxyCodeLine{257                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{258                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{259 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{260             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{261 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{262 \textcolor{comment}{!}}
\DoxyCodeLine{263          ntri = ideb+7}
\DoxyCodeLine{264 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{265 \textcolor{comment}{!}}
\DoxyCodeLine{266 \textcolor{comment}{!  Make the set of the indices of median values of each sorted subset}}
\DoxyCodeLine{267 \textcolor{comment}{!}}
\DoxyCodeLine{268          idon1 = 0}
\DoxyCodeLine{269          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{270             idon1 = idon1 + 1}
\DoxyCodeLine{271             imedt(idon1) = iwrkt(idon + 3)}
\DoxyCodeLine{272 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{273 \textcolor{comment}{!}}
\DoxyCodeLine{274 \textcolor{comment}{!  Find XMED7, the median of the medians}}
\DoxyCodeLine{275 \textcolor{comment}{!}}
\DoxyCodeLine{276          \textcolor{keyword}{Call }d\_med (xdatt, imedt(1:idon1), imed7)}
\DoxyCodeLine{277          xmed7 = xdatt(imed7)}
\DoxyCodeLine{278 \textcolor{comment}{!}}
\DoxyCodeLine{279 \textcolor{comment}{!  Count how many values are not higher than (and how many equal to) XMED7}}
\DoxyCodeLine{280 \textcolor{comment}{!  This number is at least 4 * 1/2 * (N/7) : 4 values in each of the}}
\DoxyCodeLine{281 \textcolor{comment}{!  subsets where the median is lower than the median of medians. For similar}}
\DoxyCodeLine{282 \textcolor{comment}{!  reasons, we also have at least 2N/7 values not lower than XMED7. At the}}
\DoxyCodeLine{283 \textcolor{comment}{!  same time, we find in each subset the index of the last value < XMED7,}}
\DoxyCodeLine{284 \textcolor{comment}{!  and that of the first > XMED7. These indices will be used to restrict the}}
\DoxyCodeLine{285 \textcolor{comment}{!  search for the median as the Kth element in the subset (> or <) where}}
\DoxyCodeLine{286 \textcolor{comment}{!  we know it to be.}}
\DoxyCodeLine{287 \textcolor{comment}{!}}
\DoxyCodeLine{288          idon1 = 1}
\DoxyCodeLine{289          nleq = 0}
\DoxyCodeLine{290          nequ = 0}
\DoxyCodeLine{291          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{292             imed = idon+3}
\DoxyCodeLine{293             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{294                   imed = imed -\/ 2}
\DoxyCodeLine{295                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{296                      imed = imed -\/ 1}
\DoxyCodeLine{297                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{298                      imed = imed + 1}
\DoxyCodeLine{299 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{300             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{301                   imed = imed + 2}
\DoxyCodeLine{302                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{303                      imed = imed -\/ 1}
\DoxyCodeLine{304                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{305                      imed = imed + 1}
\DoxyCodeLine{306 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{307 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{308             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{309                nleq = nleq + imed -\/ idon}
\DoxyCodeLine{310                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{311                istrt(idon1) = imed}
\DoxyCodeLine{312             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{313                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{314                iendt(idon1) = imed}
\DoxyCodeLine{315                istrt(idon1) = imed + 1}
\DoxyCodeLine{316             \textcolor{keywordflow}{Else}                    \textcolor{comment}{!       If (XDATT (IWRKT (IMED)) == XMED7)}}
\DoxyCodeLine{317                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{318                nequ = nequ + 1}
\DoxyCodeLine{319                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{320                \textcolor{keywordflow}{Do} imed1 = imed -\/ 1, idon, -\/1}
\DoxyCodeLine{321                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{322                      nequ = nequ + 1}
\DoxyCodeLine{323                      iendt(idon1) = imed1 -\/ 1}
\DoxyCodeLine{324                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{325                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{326 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{327 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{328                istrt(idon1) = imed + 1}
\DoxyCodeLine{329                \textcolor{keywordflow}{Do} imed1 = imed + 1, idon + 6}
\DoxyCodeLine{330                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{331                      nequ = nequ + 1}
\DoxyCodeLine{332                      nleq = nleq + 1}
\DoxyCodeLine{333                      istrt(idon1) = imed1 + 1}
\DoxyCodeLine{334                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{335                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{336 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{337 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{338 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{339             idon1 = idon1 + 1}
\DoxyCodeLine{340 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{341 \textcolor{comment}{!}}
\DoxyCodeLine{342 \textcolor{comment}{!  Carry out a partial insertion sort to find the Kth smallest of the}}
\DoxyCodeLine{343 \textcolor{comment}{!  large values, or the Kth largest of the small values, according to}}
\DoxyCodeLine{344 \textcolor{comment}{!  what is needed.}}
\DoxyCodeLine{345 \textcolor{comment}{!}}
\DoxyCodeLine{346 \textcolor{comment}{!}}
\DoxyCodeLine{347          \textcolor{keywordflow}{If} (nleq -\/ nequ + 1 <= nmed) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{348             \textcolor{keywordflow}{If} (nleq < nmed) \textcolor{keywordflow}{Then}   \textcolor{comment}{!      Not enough low values}}
\DoxyCodeLine{349                 iwrk1 = imax}
\DoxyCodeLine{350                 xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{351                 nord = nmed -\/ nleq}
\DoxyCodeLine{352                 idon1 = 0}
\DoxyCodeLine{353                 icrs1 = 1}
\DoxyCodeLine{354                 icrs2 = 0}
\DoxyCodeLine{355                 idcr = 0}
\DoxyCodeLine{356                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{357                    idon1 = idon1 + 1}
\DoxyCodeLine{358                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{359                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{360                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{361                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{362                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{363                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{364                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{365                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{366 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{367                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{368                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{369                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{370                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{371                            \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{372                               iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{373                               iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{374                               xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{375 \textcolor{keywordflow}{                           Endif}}
\DoxyCodeLine{376 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{377                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{378                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{379 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{380                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{381                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{382                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{383                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{384                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{385                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{386                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{387                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{388 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{389                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{390                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{391                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{392 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{393 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{394 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{395                 ires\_med = iwrk1}
\DoxyCodeLine{396                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{397             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{398                 ires\_med = imed7}
\DoxyCodeLine{399                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{400 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{401          \textcolor{keywordflow}{Else}                       \textcolor{comment}{!      If (NLEQ > NMED)}}
\DoxyCodeLine{402 \textcolor{comment}{!                                          Not enough high values}}
\DoxyCodeLine{403                 xwrk1 = -\/xhuge}
\DoxyCodeLine{404                 nord = nleq -\/ nequ -\/ nmed + 1}
\DoxyCodeLine{405                 idon1 = 0}
\DoxyCodeLine{406                 icrs1 = 1}
\DoxyCodeLine{407                 icrs2 = 0}
\DoxyCodeLine{408                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{409                    idon1 = idon1 + 1}
\DoxyCodeLine{410                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{411 \textcolor{comment}{!}}
\DoxyCodeLine{412                       \textcolor{keywordflow}{Do} icrs = idon, iendt(idon1)}
\DoxyCodeLine{413                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) > xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{414                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{415                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{416                             idcr = icrs1 -\/ 1}
\DoxyCodeLine{417                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{418                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{419                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{420 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{421                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{422                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{423                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{424                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{425                             \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{426                                iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{427                                iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{428                                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{429 \textcolor{keywordflow}{                            End If}}
\DoxyCodeLine{430 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{431                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{432                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{433 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{434                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{435                       \textcolor{keywordflow}{Do} icrs = iendt(idon1), idon, -\/1}
\DoxyCodeLine{436                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) <= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{437                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{438                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{439                          idcr = icrs1 -\/ 1}
\DoxyCodeLine{440                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{441                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{442                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{443 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{444                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{445                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{446                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{447 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{448 \textcolor{keywordflow}{                   Endif}}
\DoxyCodeLine{449 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{450 \textcolor{comment}{!}}
\DoxyCodeLine{451                 ires\_med = iwrk1}
\DoxyCodeLine{452                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{453 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{454 \textcolor{comment}{!}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=345pt]{namespacem__indmed_a8ea11e494102978f926fd8009e5289f2_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_a6806292390a76d9c0a2ba90f95480301}\label{namespacem__indmed_a6806292390a76d9c0a2ba90f95480301}} 
\index{m\_indmed@{m\_indmed}!i\_indmed@{i\_indmed}}
\index{i\_indmed@{i\_indmed}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{i\_indmed()}{i\_indmed()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+indmed\+::i\+\_\+indmed (\begin{DoxyParamCaption}\item[{integer, dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, intent(out)}]{I\+N\+DM }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{854 \textcolor{comment}{!! Returns index of median value of XDONT.}}
\DoxyCodeLine{855 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{856       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDONT}
\DoxyCodeLine{857       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: INDM}
\DoxyCodeLine{858 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{859       \textcolor{keywordtype}{Integer} :: IDON}
\DoxyCodeLine{860 \textcolor{comment}{!}}
\DoxyCodeLine{861       \textcolor{keyword}{Allocate} (idont(\textcolor{keyword}{SIZE}(xdont)))}
\DoxyCodeLine{862       \textcolor{keywordflow}{Do} idon = 1, \textcolor{keyword}{SIZE}(xdont)}
\DoxyCodeLine{863          idont(idon) = idon}
\DoxyCodeLine{864 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{865 \textcolor{comment}{!}}
\DoxyCodeLine{866       \textcolor{keyword}{Call }i\_med (xdont, idont, indm)}
\DoxyCodeLine{867 \textcolor{comment}{!}}
\DoxyCodeLine{868       \textcolor{keyword}{Deallocate} (idont)}

\end{DoxyCode}


References i\+\_\+med(), and idont.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=339pt]{namespacem__indmed_a6806292390a76d9c0a2ba90f95480301_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_af3a3214a291d18eefafc17269ec90dd6}\label{namespacem__indmed_af3a3214a291d18eefafc17269ec90dd6}} 
\index{m\_indmed@{m\_indmed}!i\_med@{i\_med}}
\index{i\_med@{i\_med}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{i\_med()}{i\_med()}}
{\footnotesize\ttfamily recursive subroutine, private m\+\_\+indmed\+::i\+\_\+med (\begin{DoxyParamCaption}\item[{integer, dimension (\+:), intent(in)}]{X\+D\+A\+TT,  }\item[{integer, dimension (\+:), intent(in)}]{I\+D\+A\+TT,  }\item[{integer, intent(out)}]{ires\+\_\+med }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{871 \textcolor{comment}{!! Finds the index of the median of XDONT using the recursive procedure}}
\DoxyCodeLine{872 \textcolor{comment}{!! described in Knuth, The Art of Computer Programming,}}
\DoxyCodeLine{873 \textcolor{comment}{!! vol. 3, 5.3.3 -\/ This procedure is linear in time, and}}
\DoxyCodeLine{874 \textcolor{comment}{!! does not require to be able to interpolate in the}}
\DoxyCodeLine{875 \textcolor{comment}{!! set as the one used in INDNTH. It also has better worst}}
\DoxyCodeLine{876 \textcolor{comment}{!! case behavior than INDNTH, but is about 30\% slower in}}
\DoxyCodeLine{877 \textcolor{comment}{!! average for random uniformly distributed values.}}
\DoxyCodeLine{878 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{879       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDATT}
\DoxyCodeLine{880       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: IDATT}
\DoxyCodeLine{881       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: ires\_med}
\DoxyCodeLine{882 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{883 \textcolor{comment}{!}}
\DoxyCodeLine{884       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Parameter} :: XHUGE = huge (xdatt)}
\DoxyCodeLine{885       \textcolor{keywordtype}{Integer} :: XWRK, XWRK1, XMED7, XMAX, XMIN}
\DoxyCodeLine{886 \textcolor{comment}{!}}
\DoxyCodeLine{887       \textcolor{keywordtype}{Integer}, Dimension (7*(((Size (IDATT)+6)/7+6)/7)) :: ISTRT, IENDT, IMEDT}
\DoxyCodeLine{888       \textcolor{keywordtype}{Integer}, Dimension (7*((Size(IDATT)+6)/7)) :: IWRKT}
\DoxyCodeLine{889       \textcolor{keywordtype}{Integer} :: NTRI, NMED, NORD, NEQU, NLEQ, IMED, IDON, IDON1}
\DoxyCodeLine{890       \textcolor{keywordtype}{Integer} :: IDEB, ITMP, IDCR, ICRS, ICRS1, ICRS2, IMAX, IMIN}
\DoxyCodeLine{891       \textcolor{keywordtype}{Integer} :: IWRK, IWRK1, IMED1, IMED7, NDAT}
\DoxyCodeLine{892 \textcolor{comment}{!}}
\DoxyCodeLine{893       ndat = \textcolor{keyword}{Size} (idatt)}
\DoxyCodeLine{894       nmed = (ndat+1) / 2}
\DoxyCodeLine{895       iwrkt = idatt}
\DoxyCodeLine{896 \textcolor{comment}{!}}
\DoxyCodeLine{897 \textcolor{comment}{!  If the number of values is small, then use insertion sort}}
\DoxyCodeLine{898 \textcolor{comment}{!}}
\DoxyCodeLine{899      \textcolor{keywordflow}{If} (ndat < 35) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{900 \textcolor{comment}{!}}
\DoxyCodeLine{901 \textcolor{comment}{!  Bring minimum to first location to save test in decreasing loop}}
\DoxyCodeLine{902 \textcolor{comment}{!}}
\DoxyCodeLine{903          idcr = ndat}
\DoxyCodeLine{904          \textcolor{keywordflow}{If} (xdatt(iwrkt(1)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{905             iwrk = iwrkt(1)}
\DoxyCodeLine{906          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{907             iwrk = iwrkt(idcr)}
\DoxyCodeLine{908             iwrkt(idcr) = iwrkt(1)}
\DoxyCodeLine{909 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{910          xwrk = xdatt(iwrk)}
\DoxyCodeLine{911          \textcolor{keywordflow}{Do} itmp = 1, ndat -\/ 2}
\DoxyCodeLine{912             idcr = idcr -\/ 1}
\DoxyCodeLine{913             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{914             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{915             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{916                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{917                 xwrk = xwrk1}
\DoxyCodeLine{918                 iwrk = iwrk1}
\DoxyCodeLine{919 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{920 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{921          iwrkt(1) = iwrk}
\DoxyCodeLine{922 \textcolor{comment}{!}}
\DoxyCodeLine{923 \textcolor{comment}{! Sort the first half, until we have NMED sorted values}}
\DoxyCodeLine{924 \textcolor{comment}{!}}
\DoxyCodeLine{925          \textcolor{keywordflow}{Do} icrs = 3, nmed}
\DoxyCodeLine{926             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{927             iwrk = iwrkt(icrs)}
\DoxyCodeLine{928             idcr = icrs -\/ 1}
\DoxyCodeLine{929             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{930                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{931                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{932                   idcr = idcr -\/ 1}
\DoxyCodeLine{933 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{934             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{935 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{936 \textcolor{comment}{!}}
\DoxyCodeLine{937 \textcolor{comment}{!  Insert any value less than the current median in the first half}}
\DoxyCodeLine{938 \textcolor{comment}{!}}
\DoxyCodeLine{939          xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{940          \textcolor{keywordflow}{Do} icrs = nmed+1, ndat}
\DoxyCodeLine{941             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{942             iwrk = iwrkt(icrs)}
\DoxyCodeLine{943             \textcolor{keywordflow}{If} (xwrk < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{944                idcr = nmed -\/ 1}
\DoxyCodeLine{945                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{946                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{947                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{948                   idcr = idcr -\/ 1}
\DoxyCodeLine{949 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{950                iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{951                xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{952 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{953 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{954          ires\_med = iwrkt(nmed)}
\DoxyCodeLine{955          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{956 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{957 \textcolor{comment}{!}}
\DoxyCodeLine{958 \textcolor{comment}{!  Make sorted subsets of 7 elements}}
\DoxyCodeLine{959 \textcolor{comment}{!  This is done by a variant of insertion sort where a first}}
\DoxyCodeLine{960 \textcolor{comment}{!  pass is used to bring the smallest element to the first position}}
\DoxyCodeLine{961 \textcolor{comment}{!  decreasing disorder at the same time, so that we may remove}}
\DoxyCodeLine{962 \textcolor{comment}{!  remove the loop test in the insertion loop.}}
\DoxyCodeLine{963 \textcolor{comment}{!}}
\DoxyCodeLine{964       imax = 1}
\DoxyCodeLine{965       imin = 1}
\DoxyCodeLine{966       xmax = xdatt(iwrkt(imax))}
\DoxyCodeLine{967       xmin = xdatt(iwrkt(imin))}
\DoxyCodeLine{968       \textcolor{keywordflow}{DO} ideb = 1, ndat-\/6, 7}
\DoxyCodeLine{969          idcr = ideb + 6}
\DoxyCodeLine{970          \textcolor{keywordflow}{If} (xdatt(iwrkt(ideb)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{971             iwrk = iwrkt(ideb)}
\DoxyCodeLine{972          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{973             iwrk = iwrkt(idcr)}
\DoxyCodeLine{974             iwrkt(idcr) = iwrkt(ideb)}
\DoxyCodeLine{975 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{976          xwrk = xdatt(iwrk)}
\DoxyCodeLine{977          \textcolor{keywordflow}{Do} itmp = 1, 5}
\DoxyCodeLine{978             idcr = idcr -\/ 1}
\DoxyCodeLine{979             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{980             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{981             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{982                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{983                 iwrk = iwrk1}
\DoxyCodeLine{984                 xwrk = xwrk1}
\DoxyCodeLine{985 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{986 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{987          iwrkt(ideb) = iwrk}
\DoxyCodeLine{988          \textcolor{keywordflow}{If} (xwrk < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{989              imin = iwrk}
\DoxyCodeLine{990              xmin = xwrk}
\DoxyCodeLine{991 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{992          \textcolor{keywordflow}{Do} icrs = ideb+1, ideb+5}
\DoxyCodeLine{993             iwrk = iwrkt(icrs+1)}
\DoxyCodeLine{994             xwrk = xdatt(iwrk)}
\DoxyCodeLine{995             idon = iwrkt(icrs)}
\DoxyCodeLine{996             \textcolor{keywordflow}{If} (xwrk < xdatt(idon)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{997                iwrkt(icrs+1) = idon}
\DoxyCodeLine{998                idcr = icrs}
\DoxyCodeLine{999                iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{1000                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1001                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{1002                   \textcolor{keywordflow}{If} (xwrk >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1003                   iwrkt(idcr) = iwrk1}
\DoxyCodeLine{1004                   idcr = idcr -\/ 1}
\DoxyCodeLine{1005                   iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{1006                   xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1007 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1008                iwrkt(idcr) = iwrk}
\DoxyCodeLine{1009 \textcolor{keywordflow}{            EndIf}}
\DoxyCodeLine{1010 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1011          \textcolor{keywordflow}{If} (xwrk > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1012              imax = iwrk}
\DoxyCodeLine{1013              xmax = xwrk}
\DoxyCodeLine{1014 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1015 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{1016 \textcolor{comment}{!}}
\DoxyCodeLine{1017 \textcolor{comment}{!  Add-\/up alternatively MAX and MIN values to make the number of data}}
\DoxyCodeLine{1018 \textcolor{comment}{!  an exact multiple of 7.}}
\DoxyCodeLine{1019 \textcolor{comment}{!}}
\DoxyCodeLine{1020       ideb = 7 * (ndat/7)}
\DoxyCodeLine{1021       ntri = ndat}
\DoxyCodeLine{1022       \textcolor{keywordflow}{If} (ideb < ndat) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1023 \textcolor{comment}{!}}
\DoxyCodeLine{1024          \textcolor{keywordflow}{Do} icrs = ideb+1, ndat}
\DoxyCodeLine{1025             xwrk1 = xdatt(iwrkt(icrs))}
\DoxyCodeLine{1026             \textcolor{keywordflow}{IF} (xwrk1 > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1027                imax = iwrkt(icrs)}
\DoxyCodeLine{1028                xmax = xwrk1}
\DoxyCodeLine{1029 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1030             \textcolor{keywordflow}{IF} (xwrk1 < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1031                imin = iwrkt(icrs)}
\DoxyCodeLine{1032                xmin = xwrk1}
\DoxyCodeLine{1033 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1034 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1035          iwrk1 = imax}
\DoxyCodeLine{1036          \textcolor{keywordflow}{Do} icrs = ndat+1, ideb+7}
\DoxyCodeLine{1037                iwrkt(icrs) = iwrk1}
\DoxyCodeLine{1038                \textcolor{keywordflow}{If} (iwrk1 == imax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1039                   iwrk1 = imin}
\DoxyCodeLine{1040                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1041                   nmed = nmed + 1}
\DoxyCodeLine{1042                   iwrk1 = imax}
\DoxyCodeLine{1043 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{1044 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1045 \textcolor{comment}{!}}
\DoxyCodeLine{1046          \textcolor{keywordflow}{Do} icrs = ideb+2, ideb+7}
\DoxyCodeLine{1047             iwrk = iwrkt(icrs)}
\DoxyCodeLine{1048             xwrk = xdatt(iwrk)}
\DoxyCodeLine{1049             \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, ideb+1, -\/ 1}
\DoxyCodeLine{1050                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1051                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1052 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{1053             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1054 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1055 \textcolor{comment}{!}}
\DoxyCodeLine{1056          ntri = ideb+7}
\DoxyCodeLine{1057 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{1058 \textcolor{comment}{!}}
\DoxyCodeLine{1059 \textcolor{comment}{!  Make the set of the indices of median values of each sorted subset}}
\DoxyCodeLine{1060 \textcolor{comment}{!}}
\DoxyCodeLine{1061          idon1 = 0}
\DoxyCodeLine{1062          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1063             idon1 = idon1 + 1}
\DoxyCodeLine{1064             imedt(idon1) = iwrkt(idon + 3)}
\DoxyCodeLine{1065 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1066 \textcolor{comment}{!}}
\DoxyCodeLine{1067 \textcolor{comment}{!  Find XMED7, the median of the medians}}
\DoxyCodeLine{1068 \textcolor{comment}{!}}
\DoxyCodeLine{1069          \textcolor{keyword}{Call }i\_med (xdatt, imedt(1:idon1), imed7)}
\DoxyCodeLine{1070          xmed7 = xdatt(imed7)}
\DoxyCodeLine{1071 \textcolor{comment}{!}}
\DoxyCodeLine{1072 \textcolor{comment}{!  Count how many values are not higher than (and how many equal to) XMED7}}
\DoxyCodeLine{1073 \textcolor{comment}{!  This number is at least 4 * 1/2 * (N/7) : 4 values in each of the}}
\DoxyCodeLine{1074 \textcolor{comment}{!  subsets where the median is lower than the median of medians. For similar}}
\DoxyCodeLine{1075 \textcolor{comment}{!  reasons, we also have at least 2N/7 values not lower than XMED7. At the}}
\DoxyCodeLine{1076 \textcolor{comment}{!  same time, we find in each subset the index of the last value < XMED7,}}
\DoxyCodeLine{1077 \textcolor{comment}{!  and that of the first > XMED7. These indices will be used to restrict the}}
\DoxyCodeLine{1078 \textcolor{comment}{!  search for the median as the Kth element in the subset (> or <) where}}
\DoxyCodeLine{1079 \textcolor{comment}{!  we know it to be.}}
\DoxyCodeLine{1080 \textcolor{comment}{!}}
\DoxyCodeLine{1081          idon1 = 1}
\DoxyCodeLine{1082          nleq = 0}
\DoxyCodeLine{1083          nequ = 0}
\DoxyCodeLine{1084          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1085             imed = idon+3}
\DoxyCodeLine{1086             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1087                   imed = imed -\/ 2}
\DoxyCodeLine{1088                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1089                      imed = imed -\/ 1}
\DoxyCodeLine{1090                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1091                      imed = imed + 1}
\DoxyCodeLine{1092 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{1093             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1094                   imed = imed + 2}
\DoxyCodeLine{1095                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1096                      imed = imed -\/ 1}
\DoxyCodeLine{1097                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1098                      imed = imed + 1}
\DoxyCodeLine{1099 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{1100 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{1101             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1102                nleq = nleq + imed -\/ idon}
\DoxyCodeLine{1103                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{1104                istrt(idon1) = imed}
\DoxyCodeLine{1105             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1106                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{1107                iendt(idon1) = imed}
\DoxyCodeLine{1108                istrt(idon1) = imed + 1}
\DoxyCodeLine{1109             \textcolor{keywordflow}{Else}                    \textcolor{comment}{!       If (XDATT (IWRKT (IMED)) == XMED7)}}
\DoxyCodeLine{1110                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{1111                nequ = nequ + 1}
\DoxyCodeLine{1112                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{1113                \textcolor{keywordflow}{Do} imed1 = imed -\/ 1, idon, -\/1}
\DoxyCodeLine{1114                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1115                      nequ = nequ + 1}
\DoxyCodeLine{1116                      iendt(idon1) = imed1 -\/ 1}
\DoxyCodeLine{1117                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1118                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1119 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1120 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1121                istrt(idon1) = imed + 1}
\DoxyCodeLine{1122                \textcolor{keywordflow}{Do} imed1 = imed + 1, idon + 6}
\DoxyCodeLine{1123                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1124                      nequ = nequ + 1}
\DoxyCodeLine{1125                      nleq = nleq + 1}
\DoxyCodeLine{1126                      istrt(idon1) = imed1 + 1}
\DoxyCodeLine{1127                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1128                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1129 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{1130 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{1131 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{1132             idon1 = idon1 + 1}
\DoxyCodeLine{1133 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{1134 \textcolor{comment}{!}}
\DoxyCodeLine{1135 \textcolor{comment}{!  Carry out a partial insertion sort to find the Kth smallest of the}}
\DoxyCodeLine{1136 \textcolor{comment}{!  large values, or the Kth largest of the small values, according to}}
\DoxyCodeLine{1137 \textcolor{comment}{!  what is needed.}}
\DoxyCodeLine{1138 \textcolor{comment}{!}}
\DoxyCodeLine{1139 \textcolor{comment}{!}}
\DoxyCodeLine{1140          \textcolor{keywordflow}{If} (nleq -\/ nequ + 1 <= nmed) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1141             \textcolor{keywordflow}{If} (nleq < nmed) \textcolor{keywordflow}{Then}   \textcolor{comment}{!      Not enough low values}}
\DoxyCodeLine{1142                 iwrk1 = imax}
\DoxyCodeLine{1143                 xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1144                 nord = nmed -\/ nleq}
\DoxyCodeLine{1145                 idon1 = 0}
\DoxyCodeLine{1146                 icrs1 = 1}
\DoxyCodeLine{1147                 icrs2 = 0}
\DoxyCodeLine{1148                 idcr = 0}
\DoxyCodeLine{1149                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1150                    idon1 = idon1 + 1}
\DoxyCodeLine{1151                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1152                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{1153                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1154                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{1155                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{1156                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1157                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1158                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1159 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{1160                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1161                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1162                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1163                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1164                            \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1165                               iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{1166                               iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1167                               xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1168 \textcolor{keywordflow}{                           Endif}}
\DoxyCodeLine{1169 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{1170                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{1171                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{1172 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1173                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1174                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{1175                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1176                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{1177                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{1178                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1179                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1180                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1181 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{1182                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1183                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1184                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1185 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1186 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{1187 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{1188                 ires\_med = iwrk1}
\DoxyCodeLine{1189                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1190             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1191                 ires\_med = imed7}
\DoxyCodeLine{1192                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1193 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{1194          \textcolor{keywordflow}{Else}                       \textcolor{comment}{!      If (NLEQ > NMED)}}
\DoxyCodeLine{1195 \textcolor{comment}{!                                          Not enough high values}}
\DoxyCodeLine{1196                 xwrk1 = -\/xhuge}
\DoxyCodeLine{1197                 nord = nleq -\/ nequ -\/ nmed + 1}
\DoxyCodeLine{1198                 idon1 = 0}
\DoxyCodeLine{1199                 icrs1 = 1}
\DoxyCodeLine{1200                 icrs2 = 0}
\DoxyCodeLine{1201                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{1202                    idon1 = idon1 + 1}
\DoxyCodeLine{1203                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1204 \textcolor{comment}{!}}
\DoxyCodeLine{1205                       \textcolor{keywordflow}{Do} icrs = idon, iendt(idon1)}
\DoxyCodeLine{1206                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) > xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1207                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{1208                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{1209                             idcr = icrs1 -\/ 1}
\DoxyCodeLine{1210                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1211                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1212                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1213 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{1214                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1215                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1216                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1217                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1218                             \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{1219                                iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{1220                                iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1221                                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1222 \textcolor{keywordflow}{                            End If}}
\DoxyCodeLine{1223 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{1224                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{1225                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{1226 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1227                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{1228                       \textcolor{keywordflow}{Do} icrs = iendt(idon1), idon, -\/1}
\DoxyCodeLine{1229                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) <= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1230                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{1231                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{1232                          idcr = icrs1 -\/ 1}
\DoxyCodeLine{1233                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{1234                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{1235                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{1236 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{1237                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{1238                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{1239                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{1240 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{1241 \textcolor{keywordflow}{                   Endif}}
\DoxyCodeLine{1242 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{1243 \textcolor{comment}{!}}
\DoxyCodeLine{1244                 ires\_med = iwrk1}
\DoxyCodeLine{1245                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{1246 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{1247 \textcolor{comment}{!}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=339pt]{namespacem__indmed_af3a3214a291d18eefafc17269ec90dd6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_ad773929cbb9e2777aaa071f931332c82}\label{namespacem__indmed_ad773929cbb9e2777aaa071f931332c82}} 
\index{m\_indmed@{m\_indmed}!r\_indmed@{r\_indmed}}
\index{r\_indmed@{r\_indmed}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{r\_indmed()}{r\_indmed()}}
{\footnotesize\ttfamily subroutine, private m\+\_\+indmed\+::r\+\_\+indmed (\begin{DoxyParamCaption}\item[{real, dimension (\+:), intent(in)}]{X\+D\+O\+NT,  }\item[{integer, intent(out)}]{I\+N\+DM }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{458 \textcolor{comment}{!  Returns index of median value of XDONT.}}
\DoxyCodeLine{459 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{460 \textcolor{keywordtype}{      Real}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDONT}
\DoxyCodeLine{461       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: INDM}
\DoxyCodeLine{462 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{463       \textcolor{keywordtype}{Integer} :: IDON}
\DoxyCodeLine{464 \textcolor{comment}{!}}
\DoxyCodeLine{465       \textcolor{keyword}{Allocate} (idont(\textcolor{keyword}{SIZE}(xdont)))}
\DoxyCodeLine{466       \textcolor{keywordflow}{Do} idon = 1, \textcolor{keyword}{SIZE}(xdont)}
\DoxyCodeLine{467          idont(idon) = idon}
\DoxyCodeLine{468 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{469 \textcolor{comment}{!}}
\DoxyCodeLine{470       \textcolor{keyword}{Call }r\_med (xdont, idont, indm)}
\DoxyCodeLine{471 \textcolor{comment}{!}}
\DoxyCodeLine{472       \textcolor{keyword}{Deallocate} (idont)}

\end{DoxyCode}


References idont, and r\+\_\+med().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=341pt]{namespacem__indmed_ad773929cbb9e2777aaa071f931332c82_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacem__indmed_a06ba48e291f2b49f3f20a859657638be}\label{namespacem__indmed_a06ba48e291f2b49f3f20a859657638be}} 
\index{m\_indmed@{m\_indmed}!r\_med@{r\_med}}
\index{r\_med@{r\_med}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{r\_med()}{r\_med()}}
{\footnotesize\ttfamily recursive subroutine, private m\+\_\+indmed\+::r\+\_\+med (\begin{DoxyParamCaption}\item[{real, dimension (\+:), intent(in)}]{X\+D\+A\+TT,  }\item[{integer, dimension (\+:), intent(in)}]{I\+D\+A\+TT,  }\item[{integer, intent(out)}]{ires\+\_\+med }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{475 \textcolor{comment}{!! Finds the index of the median of XDONT using the recursive procedure}}
\DoxyCodeLine{476 \textcolor{comment}{!! described in Knuth, The Art of Computer Programming,}}
\DoxyCodeLine{477 \textcolor{comment}{!! vol. 3, 5.3.3 -\/ This procedure is linear in time, and}}
\DoxyCodeLine{478 \textcolor{comment}{!! does not require to be able to interpolate in the}}
\DoxyCodeLine{479 \textcolor{comment}{!! set as the one used in INDNTH. It also has better worst}}
\DoxyCodeLine{480 \textcolor{comment}{!! case behavior than INDNTH, but is about 30\% slower in}}
\DoxyCodeLine{481 \textcolor{comment}{!! average for random uniformly distributed values.}}
\DoxyCodeLine{482 \textcolor{comment}{!!\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{483 \textcolor{keywordtype}{      Real}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: XDATT}
\DoxyCodeLine{484       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: IDATT}
\DoxyCodeLine{485       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: ires\_med}
\DoxyCodeLine{486 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{487 \textcolor{comment}{!}}
\DoxyCodeLine{488 \textcolor{keywordtype}{      Real}, \textcolor{keywordtype}{Parameter} :: XHUGE = huge (xdatt)}
\DoxyCodeLine{489 \textcolor{keywordtype}{      Real} :: XWRK, XWRK1, XMED7, XMAX, XMIN}
\DoxyCodeLine{490 \textcolor{comment}{!}}
\DoxyCodeLine{491       \textcolor{keywordtype}{Integer}, Dimension (7*(((Size (IDATT)+6)/7+6)/7)) :: ISTRT, IENDT, IMEDT}
\DoxyCodeLine{492       \textcolor{keywordtype}{Integer}, Dimension (7*((Size(IDATT)+6)/7)) :: IWRKT}
\DoxyCodeLine{493       \textcolor{keywordtype}{Integer} :: NTRI, NMED, NORD, NEQU, NLEQ, IMED, IDON, IDON1}
\DoxyCodeLine{494       \textcolor{keywordtype}{Integer} :: IDEB, ITMP, IDCR, ICRS, ICRS1, ICRS2, IMAX, IMIN}
\DoxyCodeLine{495       \textcolor{keywordtype}{Integer} :: IWRK, IWRK1, IMED1, IMED7, NDAT}
\DoxyCodeLine{496 \textcolor{comment}{!}}
\DoxyCodeLine{497       ndat = \textcolor{keyword}{Size} (idatt)}
\DoxyCodeLine{498       nmed = (ndat+1) / 2}
\DoxyCodeLine{499       iwrkt = idatt}
\DoxyCodeLine{500 \textcolor{comment}{!}}
\DoxyCodeLine{501 \textcolor{comment}{!  If the number of values is small, then use insertion sort}}
\DoxyCodeLine{502 \textcolor{comment}{!}}
\DoxyCodeLine{503      \textcolor{keywordflow}{If} (ndat < 35) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{504 \textcolor{comment}{!}}
\DoxyCodeLine{505 \textcolor{comment}{!  Bring minimum to first location to save test in decreasing loop}}
\DoxyCodeLine{506 \textcolor{comment}{!}}
\DoxyCodeLine{507          idcr = ndat}
\DoxyCodeLine{508          \textcolor{keywordflow}{If} (xdatt(iwrkt(1)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{509             iwrk = iwrkt(1)}
\DoxyCodeLine{510          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{511             iwrk = iwrkt(idcr)}
\DoxyCodeLine{512             iwrkt(idcr) = iwrkt(1)}
\DoxyCodeLine{513 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{514          xwrk = xdatt(iwrk)}
\DoxyCodeLine{515          \textcolor{keywordflow}{Do} itmp = 1, ndat -\/ 2}
\DoxyCodeLine{516             idcr = idcr -\/ 1}
\DoxyCodeLine{517             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{518             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{519             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{520                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{521                 xwrk = xwrk1}
\DoxyCodeLine{522                 iwrk = iwrk1}
\DoxyCodeLine{523 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{524 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{525          iwrkt(1) = iwrk}
\DoxyCodeLine{526 \textcolor{comment}{!}}
\DoxyCodeLine{527 \textcolor{comment}{! Sort the first half, until we have NMED sorted values}}
\DoxyCodeLine{528 \textcolor{comment}{!}}
\DoxyCodeLine{529          \textcolor{keywordflow}{Do} icrs = 3, nmed}
\DoxyCodeLine{530             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{531             iwrk = iwrkt(icrs)}
\DoxyCodeLine{532             idcr = icrs -\/ 1}
\DoxyCodeLine{533             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{534                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{535                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{536                   idcr = idcr -\/ 1}
\DoxyCodeLine{537 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{538             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{539 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{540 \textcolor{comment}{!}}
\DoxyCodeLine{541 \textcolor{comment}{!  Insert any value less than the current median in the first half}}
\DoxyCodeLine{542 \textcolor{comment}{!}}
\DoxyCodeLine{543          xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{544          \textcolor{keywordflow}{Do} icrs = nmed+1, ndat}
\DoxyCodeLine{545             xwrk = xdatt(iwrkt(icrs))}
\DoxyCodeLine{546             iwrk = iwrkt(icrs)}
\DoxyCodeLine{547             \textcolor{keywordflow}{If} (xwrk < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{548                idcr = nmed -\/ 1}
\DoxyCodeLine{549                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{550                   \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{551                   iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{552                   idcr = idcr -\/ 1}
\DoxyCodeLine{553 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{554                iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{555                xwrk1 = xdatt(iwrkt(nmed))}
\DoxyCodeLine{556 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{557 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{558          ires\_med = iwrkt(nmed)}
\DoxyCodeLine{559          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{560 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{561 \textcolor{comment}{!}}
\DoxyCodeLine{562 \textcolor{comment}{!  Make sorted subsets of 7 elements}}
\DoxyCodeLine{563 \textcolor{comment}{!  This is done by a variant of insertion sort where a first}}
\DoxyCodeLine{564 \textcolor{comment}{!  pass is used to bring the smallest element to the first position}}
\DoxyCodeLine{565 \textcolor{comment}{!  decreasing disorder at the same time, so that we may remove}}
\DoxyCodeLine{566 \textcolor{comment}{!  remove the loop test in the insertion loop.}}
\DoxyCodeLine{567 \textcolor{comment}{!}}
\DoxyCodeLine{568       imax = 1}
\DoxyCodeLine{569       imin = 1}
\DoxyCodeLine{570       xmax = xdatt(iwrkt(imax))}
\DoxyCodeLine{571       xmin = xdatt(iwrkt(imin))}
\DoxyCodeLine{572       \textcolor{keywordflow}{DO} ideb = 1, ndat-\/6, 7}
\DoxyCodeLine{573          idcr = ideb + 6}
\DoxyCodeLine{574          \textcolor{keywordflow}{If} (xdatt(iwrkt(ideb)) < xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{575             iwrk = iwrkt(ideb)}
\DoxyCodeLine{576          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{577             iwrk = iwrkt(idcr)}
\DoxyCodeLine{578             iwrkt(idcr) = iwrkt(ideb)}
\DoxyCodeLine{579 \textcolor{keywordflow}{         Endif}}
\DoxyCodeLine{580          xwrk = xdatt(iwrk)}
\DoxyCodeLine{581          \textcolor{keywordflow}{Do} itmp = 1, 5}
\DoxyCodeLine{582             idcr = idcr -\/ 1}
\DoxyCodeLine{583             iwrk1 = iwrkt(idcr)}
\DoxyCodeLine{584             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{585             \textcolor{keywordflow}{If} (xwrk1 < xwrk) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{586                 iwrkt(idcr) = iwrk}
\DoxyCodeLine{587                 iwrk = iwrk1}
\DoxyCodeLine{588                 xwrk = xwrk1}
\DoxyCodeLine{589 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{590 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{591          iwrkt(ideb) = iwrk}
\DoxyCodeLine{592          \textcolor{keywordflow}{If} (xwrk < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{593              imin = iwrk}
\DoxyCodeLine{594              xmin = xwrk}
\DoxyCodeLine{595 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{596          \textcolor{keywordflow}{Do} icrs = ideb+1, ideb+5}
\DoxyCodeLine{597             iwrk = iwrkt(icrs+1)}
\DoxyCodeLine{598             xwrk = xdatt(iwrk)}
\DoxyCodeLine{599             idon = iwrkt(icrs)}
\DoxyCodeLine{600             \textcolor{keywordflow}{If} (xwrk < xdatt(idon)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{601                iwrkt(icrs+1) = idon}
\DoxyCodeLine{602                idcr = icrs}
\DoxyCodeLine{603                iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{604                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{605                \textcolor{keywordflow}{Do}}
\DoxyCodeLine{606                   \textcolor{keywordflow}{If} (xwrk >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{607                   iwrkt(idcr) = iwrk1}
\DoxyCodeLine{608                   idcr = idcr -\/ 1}
\DoxyCodeLine{609                   iwrk1 = iwrkt(idcr-\/1)}
\DoxyCodeLine{610                   xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{611 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{612                iwrkt(idcr) = iwrk}
\DoxyCodeLine{613 \textcolor{keywordflow}{            EndIf}}
\DoxyCodeLine{614 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{615          \textcolor{keywordflow}{If} (xwrk > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{616              imax = iwrk}
\DoxyCodeLine{617              xmax = xwrk}
\DoxyCodeLine{618 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{619 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{620 \textcolor{comment}{!}}
\DoxyCodeLine{621 \textcolor{comment}{!  Add-\/up alternatively MAX and MIN values to make the number of data}}
\DoxyCodeLine{622 \textcolor{comment}{!  an exact multiple of 7.}}
\DoxyCodeLine{623 \textcolor{comment}{!}}
\DoxyCodeLine{624       ideb = 7 * (ndat/7)}
\DoxyCodeLine{625       ntri = ndat}
\DoxyCodeLine{626       \textcolor{keywordflow}{If} (ideb < ndat) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{627 \textcolor{comment}{!}}
\DoxyCodeLine{628          \textcolor{keywordflow}{Do} icrs = ideb+1, ndat}
\DoxyCodeLine{629             xwrk1 = xdatt(iwrkt(icrs))}
\DoxyCodeLine{630             \textcolor{keywordflow}{IF} (xwrk1 > xmax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{631                imax = iwrkt(icrs)}
\DoxyCodeLine{632                xmax = xwrk1}
\DoxyCodeLine{633 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{634             \textcolor{keywordflow}{IF} (xwrk1 < xmin) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{635                imin = iwrkt(icrs)}
\DoxyCodeLine{636                xmin = xwrk1}
\DoxyCodeLine{637 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{638 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{639          iwrk1 = imax}
\DoxyCodeLine{640          \textcolor{keywordflow}{Do} icrs = ndat+1, ideb+7}
\DoxyCodeLine{641                iwrkt(icrs) = iwrk1}
\DoxyCodeLine{642                \textcolor{keywordflow}{If} (iwrk1 == imax) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{643                   iwrk1 = imin}
\DoxyCodeLine{644                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{645                   nmed = nmed + 1}
\DoxyCodeLine{646                   iwrk1 = imax}
\DoxyCodeLine{647 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{648 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{649 \textcolor{comment}{!}}
\DoxyCodeLine{650          \textcolor{keywordflow}{Do} icrs = ideb+2, ideb+7}
\DoxyCodeLine{651             iwrk = iwrkt(icrs)}
\DoxyCodeLine{652             xwrk = xdatt(iwrk)}
\DoxyCodeLine{653             \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, ideb+1, -\/ 1}
\DoxyCodeLine{654                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{655                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{656 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{657             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{658 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{659 \textcolor{comment}{!}}
\DoxyCodeLine{660          ntri = ideb+7}
\DoxyCodeLine{661 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{662 \textcolor{comment}{!}}
\DoxyCodeLine{663 \textcolor{comment}{!  Make the set of the indices of median values of each sorted subset}}
\DoxyCodeLine{664 \textcolor{comment}{!}}
\DoxyCodeLine{665          idon1 = 0}
\DoxyCodeLine{666          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{667             idon1 = idon1 + 1}
\DoxyCodeLine{668             imedt(idon1) = iwrkt(idon + 3)}
\DoxyCodeLine{669 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{670 \textcolor{comment}{!}}
\DoxyCodeLine{671 \textcolor{comment}{!  Find XMED7, the median of the medians}}
\DoxyCodeLine{672 \textcolor{comment}{!}}
\DoxyCodeLine{673          \textcolor{keyword}{Call }r\_med (xdatt, imedt(1:idon1), imed7)}
\DoxyCodeLine{674          xmed7 = xdatt(imed7)}
\DoxyCodeLine{675 \textcolor{comment}{!}}
\DoxyCodeLine{676 \textcolor{comment}{!  Count how many values are not higher than (and how many equal to) XMED7}}
\DoxyCodeLine{677 \textcolor{comment}{!  This number is at least 4 * 1/2 * (N/7) : 4 values in each of the}}
\DoxyCodeLine{678 \textcolor{comment}{!  subsets where the median is lower than the median of medians. For similar}}
\DoxyCodeLine{679 \textcolor{comment}{!  reasons, we also have at least 2N/7 values not lower than XMED7. At the}}
\DoxyCodeLine{680 \textcolor{comment}{!  same time, we find in each subset the index of the last value < XMED7,}}
\DoxyCodeLine{681 \textcolor{comment}{!  and that of the first > XMED7. These indices will be used to restrict the}}
\DoxyCodeLine{682 \textcolor{comment}{!  search for the median as the Kth element in the subset (> or <) where}}
\DoxyCodeLine{683 \textcolor{comment}{!  we know it to be.}}
\DoxyCodeLine{684 \textcolor{comment}{!}}
\DoxyCodeLine{685          idon1 = 1}
\DoxyCodeLine{686          nleq = 0}
\DoxyCodeLine{687          nequ = 0}
\DoxyCodeLine{688          \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{689             imed = idon+3}
\DoxyCodeLine{690             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{691                   imed = imed -\/ 2}
\DoxyCodeLine{692                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{693                      imed = imed -\/ 1}
\DoxyCodeLine{694                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{695                      imed = imed + 1}
\DoxyCodeLine{696 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{697             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{698                   imed = imed + 2}
\DoxyCodeLine{699                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{700                      imed = imed -\/ 1}
\DoxyCodeLine{701                   \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{702                      imed = imed + 1}
\DoxyCodeLine{703 \textcolor{keywordflow}{                  Endif}}
\DoxyCodeLine{704 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{705             \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) > xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{706                nleq = nleq + imed -\/ idon}
\DoxyCodeLine{707                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{708                istrt(idon1) = imed}
\DoxyCodeLine{709             \textcolor{keywordflow}{Else} \textcolor{keywordflow}{If} (xdatt(iwrkt(imed)) < xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{710                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{711                iendt(idon1) = imed}
\DoxyCodeLine{712                istrt(idon1) = imed + 1}
\DoxyCodeLine{713             \textcolor{keywordflow}{Else}                    \textcolor{comment}{!       If (XDATT (IWRKT (IMED)) == XMED7)}}
\DoxyCodeLine{714                nleq = nleq + imed -\/ idon + 1}
\DoxyCodeLine{715                nequ = nequ + 1}
\DoxyCodeLine{716                iendt(idon1) = imed -\/ 1}
\DoxyCodeLine{717                \textcolor{keywordflow}{Do} imed1 = imed -\/ 1, idon, -\/1}
\DoxyCodeLine{718                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{719                      nequ = nequ + 1}
\DoxyCodeLine{720                      iendt(idon1) = imed1 -\/ 1}
\DoxyCodeLine{721                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{722                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{723 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{724 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{725                istrt(idon1) = imed + 1}
\DoxyCodeLine{726                \textcolor{keywordflow}{Do} imed1 = imed + 1, idon + 6}
\DoxyCodeLine{727                   \textcolor{keywordflow}{If} (xdatt(iwrkt(imed1)) == xmed7) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{728                      nequ = nequ + 1}
\DoxyCodeLine{729                      nleq = nleq + 1}
\DoxyCodeLine{730                      istrt(idon1) = imed1 + 1}
\DoxyCodeLine{731                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{732                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{733 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{734 \textcolor{keywordflow}{               End Do}}
\DoxyCodeLine{735 \textcolor{keywordflow}{            Endif}}
\DoxyCodeLine{736             idon1 = idon1 + 1}
\DoxyCodeLine{737 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{738 \textcolor{comment}{!}}
\DoxyCodeLine{739 \textcolor{comment}{!  Carry out a partial insertion sort to find the Kth smallest of the}}
\DoxyCodeLine{740 \textcolor{comment}{!  large values, or the Kth largest of the small values, according to}}
\DoxyCodeLine{741 \textcolor{comment}{!  what is needed.}}
\DoxyCodeLine{742 \textcolor{comment}{!}}
\DoxyCodeLine{743 \textcolor{comment}{!}}
\DoxyCodeLine{744          \textcolor{keywordflow}{If} (nleq -\/ nequ + 1 <= nmed) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{745             \textcolor{keywordflow}{If} (nleq < nmed) \textcolor{keywordflow}{Then}   \textcolor{comment}{!      Not enough low values}}
\DoxyCodeLine{746                 iwrk1 = imax}
\DoxyCodeLine{747                 xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{748                 nord = nmed -\/ nleq}
\DoxyCodeLine{749                 idon1 = 0}
\DoxyCodeLine{750                 icrs1 = 1}
\DoxyCodeLine{751                 icrs2 = 0}
\DoxyCodeLine{752                 idcr = 0}
\DoxyCodeLine{753                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{754                    idon1 = idon1 + 1}
\DoxyCodeLine{755                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{756                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{757                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{758                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{759                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{760                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{761                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{762                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{763 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{764                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{765                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{766                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{767                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{768                            \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{769                               iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{770                               iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{771                               xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{772 \textcolor{keywordflow}{                           Endif}}
\DoxyCodeLine{773 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{774                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{775                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{776 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{777                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{778                       \textcolor{keywordflow}{Do} icrs = istrt(idon1), idon + 6}
\DoxyCodeLine{779                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) >= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{780                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{781                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{782                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{783                                \textcolor{keywordflow}{If} (xwrk >= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{784                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{785 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{786                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{787                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{788                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{789 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{790 \textcolor{keywordflow}{                   End If}}
\DoxyCodeLine{791 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{792                 ires\_med = iwrk1}
\DoxyCodeLine{793                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{794             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{795                 ires\_med = imed7}
\DoxyCodeLine{796                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{797 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{798          \textcolor{keywordflow}{Else}                       \textcolor{comment}{!      If (NLEQ > NMED)}}
\DoxyCodeLine{799 \textcolor{comment}{!                                          Not enough high values}}
\DoxyCodeLine{800                 xwrk1 = -\/xhuge}
\DoxyCodeLine{801                 nord = nleq -\/ nequ -\/ nmed + 1}
\DoxyCodeLine{802                 idon1 = 0}
\DoxyCodeLine{803                 icrs1 = 1}
\DoxyCodeLine{804                 icrs2 = 0}
\DoxyCodeLine{805                 \textcolor{keywordflow}{Do} idon = 1, ntri, 7}
\DoxyCodeLine{806                    idon1 = idon1 + 1}
\DoxyCodeLine{807                    \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{808 \textcolor{comment}{!}}
\DoxyCodeLine{809                       \textcolor{keywordflow}{Do} icrs = idon, iendt(idon1)}
\DoxyCodeLine{810                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) > xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{811                             iwrk = iwrkt(icrs)}
\DoxyCodeLine{812                             xwrk = xdatt(iwrk)}
\DoxyCodeLine{813                             idcr = icrs1 -\/ 1}
\DoxyCodeLine{814                             \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{815                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{816                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{817 \textcolor{keywordflow}{                            End Do}}
\DoxyCodeLine{818                             iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{819                             iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{820                             xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{821                          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{822                             \textcolor{keywordflow}{If} (icrs2 < nord) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{823                                iwrkt(icrs1) = iwrkt(icrs)}
\DoxyCodeLine{824                                iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{825                                xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{826 \textcolor{keywordflow}{                            End If}}
\DoxyCodeLine{827 \textcolor{keywordflow}{                         End If}}
\DoxyCodeLine{828                          icrs1 = min(nord, icrs1 + 1)}
\DoxyCodeLine{829                          icrs2 = min(nord, icrs2 + 1)}
\DoxyCodeLine{830 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{831                    \textcolor{keywordflow}{Else}}
\DoxyCodeLine{832                       \textcolor{keywordflow}{Do} icrs = iendt(idon1), idon, -\/1}
\DoxyCodeLine{833                          \textcolor{keywordflow}{If} (xdatt(iwrkt(icrs)) <= xwrk1) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{834                          iwrk = iwrkt(icrs)}
\DoxyCodeLine{835                          xwrk = xdatt(iwrk)}
\DoxyCodeLine{836                          idcr = icrs1 -\/ 1}
\DoxyCodeLine{837                          \textcolor{keywordflow}{Do} idcr = icrs1 -\/ 1, 1, -\/ 1}
\DoxyCodeLine{838                                \textcolor{keywordflow}{If} (xwrk <= xdatt(iwrkt(idcr))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{839                                iwrkt(idcr+1) = iwrkt(idcr)}
\DoxyCodeLine{840 \textcolor{keywordflow}{                         End Do}}
\DoxyCodeLine{841                          iwrkt(idcr+1) = iwrk}
\DoxyCodeLine{842                          iwrk1 = iwrkt(icrs1)}
\DoxyCodeLine{843                          xwrk1 = xdatt(iwrk1)}
\DoxyCodeLine{844 \textcolor{keywordflow}{                      End Do}}
\DoxyCodeLine{845 \textcolor{keywordflow}{                   Endif}}
\DoxyCodeLine{846 \textcolor{keywordflow}{                End Do}}
\DoxyCodeLine{847 \textcolor{comment}{!}}
\DoxyCodeLine{848                 ires\_med = iwrk1}
\DoxyCodeLine{849                 \textcolor{keywordflow}{Return}}
\DoxyCodeLine{850 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{851 \textcolor{comment}{!}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=341pt]{namespacem__indmed_a06ba48e291f2b49f3f20a859657638be_icgraph}
\end{center}
\end{figure}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacem__indmed_ad17c2a3bf73f372ad2d9ea60e151ee23}\label{namespacem__indmed_ad17c2a3bf73f372ad2d9ea60e151ee23}} 
\index{m\_indmed@{m\_indmed}!idont@{idont}}
\index{idont@{idont}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{idont}{idont}}
{\footnotesize\ttfamily integer, dimension(\+:), allocatable, save, private m\+\_\+indmed\+::idont\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{10 \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Allocatable}, \textcolor{keywordtype}{Dimension(:)}, \textcolor{keywordtype}{Private}, \textcolor{keywordtype}{Save} :: IDONT}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__indmed_a9a57777f2d73827dcf6eeaaa4c2bb397}\label{namespacem__indmed_a9a57777f2d73827dcf6eeaaa4c2bb397}} 
\index{m\_indmed@{m\_indmed}!kdp@{kdp}}
\index{kdp@{kdp}!m\_indmed@{m\_indmed}}
\doxysubsubsection{\texorpdfstring{kdp}{kdp}}
{\footnotesize\ttfamily integer, parameter, private m\+\_\+indmed\+::kdp = selected\+\_\+real\+\_\+kind(15)\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{5 \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Parameter} :: kdp = selected\_real\_kind(15)}

\end{DoxyCode}
