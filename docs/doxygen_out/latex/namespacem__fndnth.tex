\hypertarget{namespacem__fndnth}{}\doxysection{m\+\_\+fndnth Module Reference}
\label{namespacem__fndnth}\index{m\_fndnth@{m\_fndnth}}
\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface \mbox{\hyperlink{interfacem__fndnth_1_1fndnth}{fndnth}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
real(kind=real64) function \mbox{\hyperlink{namespacem__fndnth_a6daf4ef0ccb7d162bc76feedcad0bafe}{real64\+\_\+fndnth}} (I\+N\+V\+A\+LS, I\+N\+O\+RD)
\item 
real(kind=real32) function \mbox{\hyperlink{namespacem__fndnth_ab5b4bae24021657852ac36ec2f4b5174}{real32\+\_\+fndnth}} (I\+N\+V\+A\+LS, I\+N\+O\+RD)
\item 
integer(kind=int32) function \mbox{\hyperlink{namespacem__fndnth_adf9dc64a79d6901843a09ca0d804f96a}{int32\+\_\+fndnth}} (I\+N\+V\+A\+LS, I\+N\+O\+RD)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
integer, parameter \mbox{\hyperlink{namespacem__fndnth_acc337af7d3cc48fa0c83181f3c578ad0}{f\+\_\+char}} =selected\+\_\+char\+\_\+kind(\char`\"{}D\+E\+F\+A\+U\+LT\char`\"{})
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacem__fndnth_adf9dc64a79d6901843a09ca0d804f96a}\label{namespacem__fndnth_adf9dc64a79d6901843a09ca0d804f96a}} 
\index{m\_fndnth@{m\_fndnth}!int32\_fndnth@{int32\_fndnth}}
\index{int32\_fndnth@{int32\_fndnth}!m\_fndnth@{m\_fndnth}}
\doxysubsubsection{\texorpdfstring{int32\_fndnth()}{int32\_fndnth()}}
{\footnotesize\ttfamily integer (kind=int32) function m\+\_\+fndnth\+::int32\+\_\+fndnth (\begin{DoxyParamCaption}\item[{integer (kind=int32), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, intent(in)}]{I\+N\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{192 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{193       \textcolor{keywordtype}{Integer (Kind=int32)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: INVALS}
\DoxyCodeLine{194       \textcolor{keywordtype}{Integer (Kind=int32)} :: FNDNTH}
\DoxyCodeLine{195       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (In)} :: INORD}
\DoxyCodeLine{196 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{197       \textcolor{keywordtype}{Integer (Kind=int32)}, \textcolor{keywordtype}{Dimension (INORD)} :: XWRKT}
\DoxyCodeLine{198       \textcolor{keywordtype}{Integer (Kind=int32)} :: XWRK, XWRK1}
\DoxyCodeLine{199 \textcolor{comment}{!}}
\DoxyCodeLine{200       \textcolor{keywordtype}{Integer} :: ICRS, IDCR, ILOW, NDON}
\DoxyCodeLine{201 \textcolor{comment}{!}}
\DoxyCodeLine{202       xwrkt(1) = invals(1)}
\DoxyCodeLine{203       \textcolor{keywordflow}{Do} icrs = 2, inord}
\DoxyCodeLine{204          xwrk = invals(icrs)}
\DoxyCodeLine{205          \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{206             \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{207             xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{208 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{209          xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{210 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{211 \textcolor{comment}{!}}
\DoxyCodeLine{212       ndon = \textcolor{keyword}{SIZE} (invals)}
\DoxyCodeLine{213       xwrk1 = xwrkt(inord)}
\DoxyCodeLine{214       ilow = 2*inord -\/ ndon}
\DoxyCodeLine{215       \textcolor{keywordflow}{Do} icrs = inord + 1, ndon}
\DoxyCodeLine{216          \textcolor{keywordflow}{If} (invals(icrs) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{217             xwrk = invals(icrs)}
\DoxyCodeLine{218             \textcolor{keywordflow}{Do} idcr = inord -\/ 1, max(1, ilow) , -\/ 1}
\DoxyCodeLine{219                \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{220                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{221 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{222             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{223             xwrk1 = xwrkt(inord)}
\DoxyCodeLine{224 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{225          ilow = ilow + 1}
\DoxyCodeLine{226 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{227       fndnth = xwrk1}
\DoxyCodeLine{228 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__fndnth_ab5b4bae24021657852ac36ec2f4b5174}\label{namespacem__fndnth_ab5b4bae24021657852ac36ec2f4b5174}} 
\index{m\_fndnth@{m\_fndnth}!real32\_fndnth@{real32\_fndnth}}
\index{real32\_fndnth@{real32\_fndnth}!m\_fndnth@{m\_fndnth}}
\doxysubsubsection{\texorpdfstring{real32\_fndnth()}{real32\_fndnth()}}
{\footnotesize\ttfamily real (kind=real32) function m\+\_\+fndnth\+::real32\+\_\+fndnth (\begin{DoxyParamCaption}\item[{real (kind=real32), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, intent(in)}]{I\+N\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{153 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{154 \textcolor{keywordtype}{      Real} (Kind=real32), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: invals}
\DoxyCodeLine{155 \textcolor{keywordtype}{      Real} (Kind=real32) :: fndnth}
\DoxyCodeLine{156       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (In)} :: INORD}
\DoxyCodeLine{157 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{158 \textcolor{keywordtype}{      Real} (Kind=real32), \textcolor{keywordtype}{Dimension (INORD)} :: xwrkt}
\DoxyCodeLine{159 \textcolor{keywordtype}{      Real} (Kind=real32) :: xwrk, xwrk1}
\DoxyCodeLine{160 \textcolor{comment}{!}}
\DoxyCodeLine{161       \textcolor{keywordtype}{Integer} :: ICRS, IDCR, ILOW, NDON}
\DoxyCodeLine{162 \textcolor{comment}{!}}
\DoxyCodeLine{163       xwrkt(1) = invals(1)}
\DoxyCodeLine{164       \textcolor{keywordflow}{Do} icrs = 2, inord}
\DoxyCodeLine{165          xwrk = invals(icrs)}
\DoxyCodeLine{166          \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{167             \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{168             xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{169 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{170          xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{171 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{172 \textcolor{comment}{!}}
\DoxyCodeLine{173       ndon = \textcolor{keyword}{SIZE} (invals)}
\DoxyCodeLine{174       xwrk1 = xwrkt(inord)}
\DoxyCodeLine{175       ilow = 2*inord -\/ ndon}
\DoxyCodeLine{176       \textcolor{keywordflow}{Do} icrs = inord + 1, ndon}
\DoxyCodeLine{177          \textcolor{keywordflow}{If} (invals(icrs) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{178             xwrk = invals(icrs)}
\DoxyCodeLine{179             \textcolor{keywordflow}{Do} idcr = inord -\/ 1, max(1, ilow) , -\/ 1}
\DoxyCodeLine{180                \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{181                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{182 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{183             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{184             xwrk1 = xwrkt(inord)}
\DoxyCodeLine{185 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{186          ilow = ilow + 1}
\DoxyCodeLine{187 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{188       fndnth = xwrk1}
\DoxyCodeLine{189 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacem__fndnth_a6daf4ef0ccb7d162bc76feedcad0bafe}\label{namespacem__fndnth_a6daf4ef0ccb7d162bc76feedcad0bafe}} 
\index{m\_fndnth@{m\_fndnth}!real64\_fndnth@{real64\_fndnth}}
\index{real64\_fndnth@{real64\_fndnth}!m\_fndnth@{m\_fndnth}}
\doxysubsubsection{\texorpdfstring{real64\_fndnth()}{real64\_fndnth()}}
{\footnotesize\ttfamily real (kind=real64) function m\+\_\+fndnth\+::real64\+\_\+fndnth (\begin{DoxyParamCaption}\item[{real (kind=real64), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, intent(in)}]{I\+N\+O\+RD }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\hypertarget{namespacem__fndnth_autotoc_md8}{}\doxysubsubsection{N\+A\+ME}\label{namespacem__fndnth_autotoc_md8}
orderval\+\_\+special(3f) -\/ \mbox{[}orderpack\+:F\+R\+A\+C\+T\+I\+LE\mbox{]} Return V\+A\+L\+UE of Nth ordered element of array, or \char`\"{}fractile of
                           order N/\+S\+I\+Z\+E(array)\char`\"{} (Insert\+Sort-\/like)\hypertarget{namespacem__fndnth_autotoc_md9}{}\doxysubsubsection{S\+Y\+N\+O\+P\+S\+IS}\label{namespacem__fndnth_autotoc_md9}
\begin{DoxyVerb} Function orderval_special (INVALS, INORD) Result (orderval_special)

  ${TYPE} (Kind=${KIND}), Intent (In) :: INVALS(:)
  Integer, Intent (In)                :: INORD
  ${TYPE} (Kind=${KIND})              :: orderval_special

Where ${TYPE}(kind=${KIND}) may be

o Real(kind=real32)
o Real(kind=real64)
o Integer(kind=int32)
\end{DoxyVerb}
\hypertarget{namespacem__fndnth_autotoc_md10}{}\doxysubsubsection{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}\label{namespacem__fndnth_autotoc_md10}
O\+R\+D\+E\+R\+V\+A\+L\+\_\+\+S\+P\+E\+C\+I\+A\+L(3) returns the I\+N\+O\+R\+Dth lowest value of I\+N\+V\+A\+L\+S(), i.\+e. the fractile of order I\+N\+O\+R\+D/\+S\+I\+ZE(I\+N\+V\+A\+LS).

Internally, This subroutine uses an insertion sort, limiting insertion to the first I\+N\+O\+RD values and even less when one can know that the value that is considered will not be the I\+N\+O\+R\+Dth.

An insertion sort is very fast when I\+N\+O\+RD is very small (2-\/5). Additionally, internally it requires only a work array of size I\+N\+O\+RD (and type of I\+N\+V\+A\+LS),

But worst case behavior can happen fairly probably (e.\+g., initially inverse sorted). Therefore, in many cases, the refined Quick\+Sort method is faster.

so O\+R\+D\+E\+R\+V\+A\+L\+\_\+\+S\+P\+E\+C\+I\+A\+L() should be used when I\+N\+O\+RD is small and I\+N\+V\+A\+LS is likely to be a random array, otherwise consider using I\+N\+D\+N\+T\+H(3) or V\+A\+L\+N\+T\+H(3).\hypertarget{namespacem__fndnth_autotoc_md11}{}\doxysubsubsection{O\+P\+T\+I\+O\+NS}\label{namespacem__fndnth_autotoc_md11}
I\+N\+V\+A\+LS input array of values I\+N\+O\+RD specify Nth value of sorted I\+N\+V\+A\+LS array to return, from 1 to size(\+I\+N\+V\+A\+L\+S). \hypertarget{namespacem__fndnth_autotoc_md12}{}\doxysubsubsection{R\+E\+T\+U\+R\+NS}\label{namespacem__fndnth_autotoc_md12}
O\+R\+D\+E\+R\+V\+A\+L\+\_\+\+S\+P\+E\+C\+I\+AL returned value\hypertarget{namespacem__fndnth_autotoc_md13}{}\doxysubsubsection{E\+X\+A\+M\+P\+L\+ES}\label{namespacem__fndnth_autotoc_md13}
Sample program\+:

program demo\+\_\+orderval\+\_\+special ! return Nth ordered value of an array use M\+\_\+orderpack, only \+: orderval\+\_\+special, medianval implicit none character(len=$\ast$),parameter \+:: list= \textquotesingle{}($\ast$(g0\+:,\char`\"{}, \char`\"{}))\textquotesingle{},sp=\textquotesingle{}($\ast$(g0,1x))\textquotesingle{} integer,allocatable \+:: iarr(\+:) integer \+:: i iarr=\mbox{[}80,70,30,40,-\/50,60,20,10\mbox{]} print sp, \textquotesingle{}O\+R\+I\+G\+I\+N\+AL\+:\textquotesingle{},iarr ! can return the same values as intrinsics minval() and maxval() print sp, \textquotesingle{}minval\textquotesingle{},orderval\+\_\+special(iarr,1), minval(iarr) print sp, \textquotesingle{}maxval\textquotesingle{},orderval\+\_\+special(iarr,size(iarr)), maxval(iarr) ! but more generally it can return the Nth lowest value. print sp, \textquotesingle{}median\textquotesingle{},orderval\+\_\+special(iarr,(size(iarr+1))/2), medianval(iarr) ! so only Nth ordered value can be found print sp,\textquotesingle{}inord=\textquotesingle{},3, \textquotesingle{} fractile=\textquotesingle{},orderval\+\_\+special(iarr,3) ! sorting the hard way print sp, \textquotesingle{}O\+R\+I\+G\+I\+N\+AL\+:\textquotesingle{},iarr do i=1,size(iarr) write($\ast$,list)i,orderval\+\_\+special(iarr,i) enddo print $\ast$ end program demo\+\_\+orderval\+\_\+special

Results\+:

O\+R\+I\+G\+I\+N\+AL\+: 80 70 30 40 -\/50 60 20 10 minval -\/50 -\/50 maxval 80 80 median 30 30 inord= 3 fractile= 20 O\+R\+I\+G\+I\+N\+AL\+: 80 70 30 40 -\/50 60 20 10 1, -\/50 2, 10 3, 20 4, 30 5, 40 6, 60 7, 70 8, 80\hypertarget{namespacem__fndnth_autotoc_md14}{}\doxysubsubsection{S\+E\+E A\+L\+SO}\label{namespacem__fndnth_autotoc_md14}
\begin{DoxyVerb}indnth(3), valnth(3)
\end{DoxyVerb}
\hypertarget{namespacem__fndnth_autotoc_md15}{}\doxysubsubsection{A\+U\+T\+H\+OR}\label{namespacem__fndnth_autotoc_md15}
Michel Olagnon -\/ Aug. 2000 \hypertarget{namespacem__fndnth_autotoc_md16}{}\doxysubsubsection{M\+A\+I\+N\+T\+A\+I\+N\+ER}\label{namespacem__fndnth_autotoc_md16}
John Urban, 2022.\+04.\+16 \hypertarget{namespacem__fndnth_autotoc_md17}{}\doxysubsubsection{L\+I\+C\+E\+N\+SE}\label{namespacem__fndnth_autotoc_md17}
C\+C0-\/1.\+0 
\begin{DoxyCode}{0}
\DoxyCodeLine{114 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{115 \textcolor{keywordtype}{      Real} (Kind=real64), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: invals}
\DoxyCodeLine{116 \textcolor{keywordtype}{      Real} (Kind=real64) :: fndnth}
\DoxyCodeLine{117       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (In)} :: INORD}
\DoxyCodeLine{118 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{119 \textcolor{keywordtype}{      Real} (Kind=real64), \textcolor{keywordtype}{Dimension (INORD)} :: xwrkt}
\DoxyCodeLine{120 \textcolor{keywordtype}{      Real} (Kind=real64) :: xwrk, xwrk1}
\DoxyCodeLine{121 \textcolor{comment}{!}}
\DoxyCodeLine{122       \textcolor{keywordtype}{Integer} :: ICRS, IDCR, ILOW, NDON}
\DoxyCodeLine{123 \textcolor{comment}{!}}
\DoxyCodeLine{124       xwrkt(1) = invals(1)}
\DoxyCodeLine{125       \textcolor{keywordflow}{Do} icrs = 2, inord}
\DoxyCodeLine{126          xwrk = invals(icrs)}
\DoxyCodeLine{127          \textcolor{keywordflow}{Do} idcr = icrs -\/ 1, 1, -\/ 1}
\DoxyCodeLine{128             \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{129             xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{130 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{131          xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{132 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{133 \textcolor{comment}{!}}
\DoxyCodeLine{134       ndon = \textcolor{keyword}{SIZE} (invals)}
\DoxyCodeLine{135       xwrk1 = xwrkt(inord)}
\DoxyCodeLine{136       ilow = 2*inord -\/ ndon}
\DoxyCodeLine{137       \textcolor{keywordflow}{Do} icrs = inord + 1, ndon}
\DoxyCodeLine{138          \textcolor{keywordflow}{If} (invals(icrs) < xwrk1) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{139             xwrk = invals(icrs)}
\DoxyCodeLine{140             \textcolor{keywordflow}{Do} idcr = inord -\/ 1, max(1, ilow) , -\/ 1}
\DoxyCodeLine{141                \textcolor{keywordflow}{If} (xwrk >= xwrkt(idcr)) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{142                xwrkt(idcr+1) = xwrkt(idcr)}
\DoxyCodeLine{143 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{144             xwrkt(idcr+1) = xwrk}
\DoxyCodeLine{145             xwrk1 = xwrkt(inord)}
\DoxyCodeLine{146 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{147          ilow = ilow + 1}
\DoxyCodeLine{148 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{149       fndnth = xwrk1}
\DoxyCodeLine{150 \textcolor{comment}{!}}

\end{DoxyCode}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacem__fndnth_acc337af7d3cc48fa0c83181f3c578ad0}\label{namespacem__fndnth_acc337af7d3cc48fa0c83181f3c578ad0}} 
\index{m\_fndnth@{m\_fndnth}!f\_char@{f\_char}}
\index{f\_char@{f\_char}!m\_fndnth@{m\_fndnth}}
\doxysubsubsection{\texorpdfstring{f\_char}{f\_char}}
{\footnotesize\ttfamily integer, parameter m\+\_\+fndnth\+::f\+\_\+char =selected\+\_\+char\+\_\+kind(\char`\"{}D\+E\+F\+A\+U\+LT\char`\"{})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{5 \textcolor{keywordtype}{integer},\textcolor{keywordtype}{parameter} :: f\_char=selected\_char\_kind(\textcolor{stringliteral}{"DEFAULT"})}

\end{DoxyCode}
