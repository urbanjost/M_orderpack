\hypertarget{interfacem__orderpack____unirnk_1_1unirnk}{}\doxysection{m\+\_\+orderpack\+\_\+\+\_\+unirnk\+::unirnk Interface Reference}
\label{interfacem__orderpack____unirnk_1_1unirnk}\index{m\_orderpack\_\_unirnk::unirnk@{m\_orderpack\_\_unirnk::unirnk}}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{interfacem__orderpack____unirnk_1_1unirnk_aef8c298ff921d6adae7de93fea8778f3}{real64\+\_\+unirnk}} (I\+N\+V\+A\+LS, I\+R\+N\+GT, N\+U\+NI)
\item 
subroutine \mbox{\hyperlink{interfacem__orderpack____unirnk_1_1unirnk_ae1e6e7bc47e9cbdd4cb0e4d80b2da4fc}{real32\+\_\+unirnk}} (I\+N\+V\+A\+LS, I\+R\+N\+GT, N\+U\+NI)
\item 
subroutine \mbox{\hyperlink{interfacem__orderpack____unirnk_1_1unirnk_a1605d524c93acd668bb5a619de2a88b7}{int32\+\_\+unirnk}} (I\+N\+V\+A\+LS, I\+R\+N\+GT, N\+U\+NI)
\end{DoxyCompactItemize}


\doxysubsection{Member Function/\+Subroutine Documentation}
\mbox{\Hypertarget{interfacem__orderpack____unirnk_1_1unirnk_a1605d524c93acd668bb5a619de2a88b7}\label{interfacem__orderpack____unirnk_1_1unirnk_a1605d524c93acd668bb5a619de2a88b7}} 
\index{m\_orderpack\_\_unirnk::unirnk@{m\_orderpack\_\_unirnk::unirnk}!int32\_unirnk@{int32\_unirnk}}
\index{int32\_unirnk@{int32\_unirnk}!m\_orderpack\_\_unirnk::unirnk@{m\_orderpack\_\_unirnk::unirnk}}
\doxysubsubsection{\texorpdfstring{int32\_unirnk()}{int32\_unirnk()}}
{\footnotesize\ttfamily subroutine m\+\_\+orderpack\+\_\+\+\_\+unirnk\+::unirnk\+::int32\+\_\+unirnk (\begin{DoxyParamCaption}\item[{integer (kind=int32), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, dimension (\+:), intent(out)}]{I\+R\+N\+GT,  }\item[{integer, intent(out)}]{N\+U\+NI }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{588       \textcolor{keywordtype}{Integer (Kind=int32)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: INVALS}
\DoxyCodeLine{589       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IRNGT}
\DoxyCodeLine{590       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: NUNI}
\DoxyCodeLine{591 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{592       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IRNGT))} :: JWRKT}
\DoxyCodeLine{593       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2}
\DoxyCodeLine{594       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{595       \textcolor{keywordtype}{Integer (Kind=int32)} :: XTST, XVALA, XVALB}
\DoxyCodeLine{596 \textcolor{comment}{!}}
\DoxyCodeLine{597 \textcolor{comment}{!}}
\DoxyCodeLine{598       nval = min(\textcolor{keyword}{SIZE}(invals), \textcolor{keyword}{SIZE}(irngt))}
\DoxyCodeLine{599       nuni = nval}
\DoxyCodeLine{600 \textcolor{comment}{!}}
\DoxyCodeLine{601       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{602       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{603          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{604       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{605          irngt(1) = 1}
\DoxyCodeLine{606          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{607 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{608          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{609 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{610 \textcolor{comment}{!}}
\DoxyCodeLine{611 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{612 \textcolor{comment}{!}}
\DoxyCodeLine{613       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{614          \textcolor{keywordflow}{If} (invals(iind-\/1) < invals(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{615             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{616             irngt(iind) = iind}
\DoxyCodeLine{617          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{618             irngt(iind-\/1) = iind}
\DoxyCodeLine{619             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{620 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{621 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{622       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{623          irngt(nval) = nval}
\DoxyCodeLine{624 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{625 \textcolor{comment}{!}}
\DoxyCodeLine{626 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{627 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{628 \textcolor{comment}{!}}
\DoxyCodeLine{629       lmtna = 2}
\DoxyCodeLine{630       lmtnc = 4}
\DoxyCodeLine{631 \textcolor{comment}{!}}
\DoxyCodeLine{632 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{633 \textcolor{comment}{!}}
\DoxyCodeLine{634       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{635          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{636 \textcolor{comment}{!}}
\DoxyCodeLine{637 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{638 \textcolor{comment}{!}}
\DoxyCodeLine{639          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{640             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{641                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{642 \textcolor{comment}{!}}
\DoxyCodeLine{643 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{644 \textcolor{comment}{!}}
\DoxyCodeLine{645                \textcolor{keywordflow}{If} (invals(irngt(iwrkd+2)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{646 \textcolor{comment}{!}}
\DoxyCodeLine{647 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{648 \textcolor{comment}{!}}
\DoxyCodeLine{649                \textcolor{keywordflow}{If} (invals(irngt(iwrkd+1)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{650                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{651                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{652                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{653 \textcolor{comment}{!}}
\DoxyCodeLine{654 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{655 \textcolor{comment}{!}}
\DoxyCodeLine{656                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{657                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{658                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{659                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{660                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{661 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{662                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{663 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{664 \textcolor{comment}{!}}
\DoxyCodeLine{665 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{666 \textcolor{comment}{!}}
\DoxyCodeLine{667             \textcolor{keywordflow}{If} (invals(irngt(iwrkd+2)) <= invals(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{668 \textcolor{comment}{!}}
\DoxyCodeLine{669 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{670 \textcolor{comment}{!}}
\DoxyCodeLine{671             \textcolor{keywordflow}{If} (invals(irngt(iwrkd+1)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{672                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{673                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{674                \textcolor{keywordflow}{If} (invals(irng2) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{675 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{676                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{677                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{678 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{679                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{680                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{681 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{682 \textcolor{comment}{!}}
\DoxyCodeLine{683 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{684 \textcolor{comment}{!}}
\DoxyCodeLine{685             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{686                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{687                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{688                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{689                \textcolor{keywordflow}{If} (invals(irng1) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{690                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{691                   \textcolor{keywordflow}{If} (invals(irng2) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{692 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{693                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{694                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{695 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{696                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{697                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{698 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{699                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{700 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{701                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{702                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{703                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{704 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{705 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{706 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{707 \textcolor{comment}{!}}
\DoxyCodeLine{708 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{709 \textcolor{comment}{!}}
\DoxyCodeLine{710          lmtna = 4}
\DoxyCodeLine{711          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{712 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{713 \textcolor{comment}{!}}
\DoxyCodeLine{714 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{715 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{716 \textcolor{comment}{!}}
\DoxyCodeLine{717       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{718          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{719          iwrkf = 0}
\DoxyCodeLine{720          lmtnc = 2 * lmtnc}
\DoxyCodeLine{721 \textcolor{comment}{!}}
\DoxyCodeLine{722 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{723 \textcolor{comment}{!}}
\DoxyCodeLine{724          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{725             iwrk = iwrkf}
\DoxyCodeLine{726             iwrkd = iwrkf + 1}
\DoxyCodeLine{727             jinda = iwrkf + lmtna}
\DoxyCodeLine{728             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{729             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{730                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{731                iwrkf = nval}
\DoxyCodeLine{732 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{733             iinda = 1}
\DoxyCodeLine{734             iindb = jinda + 1}
\DoxyCodeLine{735 \textcolor{comment}{!}}
\DoxyCodeLine{736 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{737 \textcolor{comment}{!}}
\DoxyCodeLine{738 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{739 \textcolor{comment}{!}}
\DoxyCodeLine{740             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{741             xvala = invals(jwrkt(iinda))}
\DoxyCodeLine{742             xvalb = invals(irngt(iindb))}
\DoxyCodeLine{743 \textcolor{comment}{!}}
\DoxyCodeLine{744             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{745                iwrk = iwrk + 1}
\DoxyCodeLine{746 \textcolor{comment}{!}}
\DoxyCodeLine{747 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{748 \textcolor{comment}{!}}
\DoxyCodeLine{749                \textcolor{keywordflow}{If} (xvala > xvalb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{750                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{751                   iindb = iindb + 1}
\DoxyCodeLine{752                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{753 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{754                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{755                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{756 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{757                   xvalb = invals(irngt(iindb))}
\DoxyCodeLine{758                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{759                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{760                   iinda = iinda + 1}
\DoxyCodeLine{761                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{762                   xvala = invals(jwrkt(iinda))}
\DoxyCodeLine{763 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{764 \textcolor{comment}{!}}
\DoxyCodeLine{765 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{766 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{767 \textcolor{comment}{!}}
\DoxyCodeLine{768 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{769 \textcolor{comment}{!}}
\DoxyCodeLine{770          lmtna = 2 * lmtna}
\DoxyCodeLine{771 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{772 \textcolor{comment}{!}}
\DoxyCodeLine{773 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{774 \textcolor{comment}{!}}
\DoxyCodeLine{775       iinda = 1}
\DoxyCodeLine{776       iindb = lmtna + 1}
\DoxyCodeLine{777       nuni = 0}
\DoxyCodeLine{778 \textcolor{comment}{!}}
\DoxyCodeLine{779 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{780 \textcolor{comment}{!}}
\DoxyCodeLine{781       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{782       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{783         xtst = nearless(min(invals(jwrkt(1)), invals(irngt(iindb))))}
\DoxyCodeLine{784       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{785         xtst = nearless(invals(jwrkt(1)))}
\DoxyCodeLine{786 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{787       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{788 \textcolor{comment}{!}}
\DoxyCodeLine{789 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{790 \textcolor{comment}{!}}
\DoxyCodeLine{791          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{792             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{793                \textcolor{keywordflow}{If} (invals(jwrkt(iinda)) > invals(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{794                   irng = irngt(iindb)}
\DoxyCodeLine{795                   iindb = iindb + 1}
\DoxyCodeLine{796                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{797                   irng = jwrkt(iinda)}
\DoxyCodeLine{798                   iinda = iinda + 1}
\DoxyCodeLine{799 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{800             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{801 \textcolor{comment}{!}}
\DoxyCodeLine{802 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{803 \textcolor{comment}{!}}
\DoxyCodeLine{804                irng = jwrkt(iinda)}
\DoxyCodeLine{805                iinda = iinda + 1}
\DoxyCodeLine{806 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{807          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{808 \textcolor{comment}{!}}
\DoxyCodeLine{809 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{810 \textcolor{comment}{!}}
\DoxyCodeLine{811             irng = irngt(iwrk)}
\DoxyCodeLine{812 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{813          \textcolor{keywordflow}{If} (invals(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{814             xtst = invals(irng)}
\DoxyCodeLine{815             nuni = nuni + 1}
\DoxyCodeLine{816             irngt(nuni) = irng}
\DoxyCodeLine{817 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{818 \textcolor{comment}{!}}
\DoxyCodeLine{819 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{820 \textcolor{comment}{!}}
\DoxyCodeLine{821       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{822 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{interfacem__orderpack____unirnk_1_1unirnk_ae1e6e7bc47e9cbdd4cb0e4d80b2da4fc}\label{interfacem__orderpack____unirnk_1_1unirnk_ae1e6e7bc47e9cbdd4cb0e4d80b2da4fc}} 
\index{m\_orderpack\_\_unirnk::unirnk@{m\_orderpack\_\_unirnk::unirnk}!real32\_unirnk@{real32\_unirnk}}
\index{real32\_unirnk@{real32\_unirnk}!m\_orderpack\_\_unirnk::unirnk@{m\_orderpack\_\_unirnk::unirnk}}
\doxysubsubsection{\texorpdfstring{real32\_unirnk()}{real32\_unirnk()}}
{\footnotesize\ttfamily subroutine m\+\_\+orderpack\+\_\+\+\_\+unirnk\+::unirnk\+::real32\+\_\+unirnk (\begin{DoxyParamCaption}\item[{real (kind=real32), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, dimension (\+:), intent(out)}]{I\+R\+N\+GT,  }\item[{integer, intent(out)}]{N\+U\+NI }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{342 \textcolor{keywordtype}{      Real} (Kind=real32), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: invals}
\DoxyCodeLine{343       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IRNGT}
\DoxyCodeLine{344       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: NUNI}
\DoxyCodeLine{345 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{346       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IRNGT))} :: JWRKT}
\DoxyCodeLine{347       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2}
\DoxyCodeLine{348       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{349 \textcolor{keywordtype}{      Real} (Kind=real32) :: xtst, xvala, xvalb}
\DoxyCodeLine{350 \textcolor{comment}{!}}
\DoxyCodeLine{351 \textcolor{comment}{!}}
\DoxyCodeLine{352       nval = min(\textcolor{keyword}{SIZE}(invals), \textcolor{keyword}{SIZE}(irngt))}
\DoxyCodeLine{353       nuni = nval}
\DoxyCodeLine{354 \textcolor{comment}{!}}
\DoxyCodeLine{355       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{356       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{357          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{358       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{359          irngt(1) = 1}
\DoxyCodeLine{360          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{361 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{362          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{363 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{364 \textcolor{comment}{!}}
\DoxyCodeLine{365 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{366 \textcolor{comment}{!}}
\DoxyCodeLine{367       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{368          \textcolor{keywordflow}{If} (invals(iind-\/1) < invals(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{369             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{370             irngt(iind) = iind}
\DoxyCodeLine{371          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{372             irngt(iind-\/1) = iind}
\DoxyCodeLine{373             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{374 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{375 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{376       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{377          irngt(nval) = nval}
\DoxyCodeLine{378 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{379 \textcolor{comment}{!}}
\DoxyCodeLine{380 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{381 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{382 \textcolor{comment}{!}}
\DoxyCodeLine{383       lmtna = 2}
\DoxyCodeLine{384       lmtnc = 4}
\DoxyCodeLine{385 \textcolor{comment}{!}}
\DoxyCodeLine{386 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{387 \textcolor{comment}{!}}
\DoxyCodeLine{388       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{389          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{390 \textcolor{comment}{!}}
\DoxyCodeLine{391 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{392 \textcolor{comment}{!}}
\DoxyCodeLine{393          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{394             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{395                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{396 \textcolor{comment}{!}}
\DoxyCodeLine{397 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{398 \textcolor{comment}{!}}
\DoxyCodeLine{399                \textcolor{keywordflow}{If} (invals(irngt(iwrkd+2)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{400 \textcolor{comment}{!}}
\DoxyCodeLine{401 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{402 \textcolor{comment}{!}}
\DoxyCodeLine{403                \textcolor{keywordflow}{If} (invals(irngt(iwrkd+1)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{404                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{405                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{406                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{407 \textcolor{comment}{!}}
\DoxyCodeLine{408 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{409 \textcolor{comment}{!}}
\DoxyCodeLine{410                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{411                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{412                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{413                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{414                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{415 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{416                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{417 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{418 \textcolor{comment}{!}}
\DoxyCodeLine{419 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{420 \textcolor{comment}{!}}
\DoxyCodeLine{421             \textcolor{keywordflow}{If} (invals(irngt(iwrkd+2)) <= invals(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{422 \textcolor{comment}{!}}
\DoxyCodeLine{423 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{424 \textcolor{comment}{!}}
\DoxyCodeLine{425             \textcolor{keywordflow}{If} (invals(irngt(iwrkd+1)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{426                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{427                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{428                \textcolor{keywordflow}{If} (invals(irng2) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{429 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{430                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{431                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{432 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{433                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{434                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{435 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{436 \textcolor{comment}{!}}
\DoxyCodeLine{437 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{438 \textcolor{comment}{!}}
\DoxyCodeLine{439             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{440                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{441                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{442                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{443                \textcolor{keywordflow}{If} (invals(irng1) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{444                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{445                   \textcolor{keywordflow}{If} (invals(irng2) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{446 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{447                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{448                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{449 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{450                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{451                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{452 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{453                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{454 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{455                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{456                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{457                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{458 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{459 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{460 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{461 \textcolor{comment}{!}}
\DoxyCodeLine{462 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{463 \textcolor{comment}{!}}
\DoxyCodeLine{464          lmtna = 4}
\DoxyCodeLine{465          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{466 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{467 \textcolor{comment}{!}}
\DoxyCodeLine{468 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{469 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{470 \textcolor{comment}{!}}
\DoxyCodeLine{471       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{472          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{473          iwrkf = 0}
\DoxyCodeLine{474          lmtnc = 2 * lmtnc}
\DoxyCodeLine{475 \textcolor{comment}{!}}
\DoxyCodeLine{476 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{477 \textcolor{comment}{!}}
\DoxyCodeLine{478          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{479             iwrk = iwrkf}
\DoxyCodeLine{480             iwrkd = iwrkf + 1}
\DoxyCodeLine{481             jinda = iwrkf + lmtna}
\DoxyCodeLine{482             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{483             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{484                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{485                iwrkf = nval}
\DoxyCodeLine{486 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{487             iinda = 1}
\DoxyCodeLine{488             iindb = jinda + 1}
\DoxyCodeLine{489 \textcolor{comment}{!}}
\DoxyCodeLine{490 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{491 \textcolor{comment}{!}}
\DoxyCodeLine{492 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{493 \textcolor{comment}{!}}
\DoxyCodeLine{494             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{495             xvala = invals(jwrkt(iinda))}
\DoxyCodeLine{496             xvalb = invals(irngt(iindb))}
\DoxyCodeLine{497 \textcolor{comment}{!}}
\DoxyCodeLine{498             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{499                iwrk = iwrk + 1}
\DoxyCodeLine{500 \textcolor{comment}{!}}
\DoxyCodeLine{501 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{502 \textcolor{comment}{!}}
\DoxyCodeLine{503                \textcolor{keywordflow}{If} (xvala > xvalb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{504                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{505                   iindb = iindb + 1}
\DoxyCodeLine{506                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{507 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{508                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{509                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{510 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{511                   xvalb = invals(irngt(iindb))}
\DoxyCodeLine{512                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{513                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{514                   iinda = iinda + 1}
\DoxyCodeLine{515                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{516                   xvala = invals(jwrkt(iinda))}
\DoxyCodeLine{517 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{518 \textcolor{comment}{!}}
\DoxyCodeLine{519 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{520 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{521 \textcolor{comment}{!}}
\DoxyCodeLine{522 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{523 \textcolor{comment}{!}}
\DoxyCodeLine{524          lmtna = 2 * lmtna}
\DoxyCodeLine{525 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{526 \textcolor{comment}{!}}
\DoxyCodeLine{527 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{528 \textcolor{comment}{!}}
\DoxyCodeLine{529       iinda = 1}
\DoxyCodeLine{530       iindb = lmtna + 1}
\DoxyCodeLine{531       nuni = 0}
\DoxyCodeLine{532 \textcolor{comment}{!}}
\DoxyCodeLine{533 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{534 \textcolor{comment}{!}}
\DoxyCodeLine{535       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{536       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{537         xtst = nearless(min(invals(jwrkt(1)), invals(irngt(iindb))))}
\DoxyCodeLine{538       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{539         xtst = nearless(invals(jwrkt(1)))}
\DoxyCodeLine{540 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{541       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{542 \textcolor{comment}{!}}
\DoxyCodeLine{543 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{544 \textcolor{comment}{!}}
\DoxyCodeLine{545          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{546             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{547                \textcolor{keywordflow}{If} (invals(jwrkt(iinda)) > invals(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{548                   irng = irngt(iindb)}
\DoxyCodeLine{549                   iindb = iindb + 1}
\DoxyCodeLine{550                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{551                   irng = jwrkt(iinda)}
\DoxyCodeLine{552                   iinda = iinda + 1}
\DoxyCodeLine{553 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{554             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{555 \textcolor{comment}{!}}
\DoxyCodeLine{556 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{557 \textcolor{comment}{!}}
\DoxyCodeLine{558                irng = jwrkt(iinda)}
\DoxyCodeLine{559                iinda = iinda + 1}
\DoxyCodeLine{560 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{561          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{562 \textcolor{comment}{!}}
\DoxyCodeLine{563 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{564 \textcolor{comment}{!}}
\DoxyCodeLine{565             irng = irngt(iwrk)}
\DoxyCodeLine{566 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{567          \textcolor{keywordflow}{If} (invals(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{568             xtst = invals(irng)}
\DoxyCodeLine{569             nuni = nuni + 1}
\DoxyCodeLine{570             irngt(nuni) = irng}
\DoxyCodeLine{571 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{572 \textcolor{comment}{!}}
\DoxyCodeLine{573 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{574 \textcolor{comment}{!}}
\DoxyCodeLine{575       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{576 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{interfacem__orderpack____unirnk_1_1unirnk_aef8c298ff921d6adae7de93fea8778f3}\label{interfacem__orderpack____unirnk_1_1unirnk_aef8c298ff921d6adae7de93fea8778f3}} 
\index{m\_orderpack\_\_unirnk::unirnk@{m\_orderpack\_\_unirnk::unirnk}!real64\_unirnk@{real64\_unirnk}}
\index{real64\_unirnk@{real64\_unirnk}!m\_orderpack\_\_unirnk::unirnk@{m\_orderpack\_\_unirnk::unirnk}}
\doxysubsubsection{\texorpdfstring{real64\_unirnk()}{real64\_unirnk()}}
{\footnotesize\ttfamily subroutine m\+\_\+orderpack\+\_\+\+\_\+unirnk\+::unirnk\+::real64\+\_\+unirnk (\begin{DoxyParamCaption}\item[{real (kind=real64), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, dimension (\+:), intent(out)}]{I\+R\+N\+GT,  }\item[{integer, intent(out)}]{N\+U\+NI }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{96 \textcolor{keywordtype}{      Real} (Kind=real64), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: invals}
\DoxyCodeLine{97       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IRNGT}
\DoxyCodeLine{98       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: NUNI}
\DoxyCodeLine{99 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{100       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IRNGT))} :: JWRKT}
\DoxyCodeLine{101       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2}
\DoxyCodeLine{102       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{103 \textcolor{keywordtype}{      Real} (Kind=real64) :: xtst, xvala, xvalb}
\DoxyCodeLine{104 \textcolor{comment}{!}}
\DoxyCodeLine{105 \textcolor{comment}{!}}
\DoxyCodeLine{106       nval = min(\textcolor{keyword}{SIZE}(invals), \textcolor{keyword}{SIZE}(irngt))}
\DoxyCodeLine{107       nuni = nval}
\DoxyCodeLine{108 \textcolor{comment}{!}}
\DoxyCodeLine{109       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{110       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{111          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{112       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{113          irngt(1) = 1}
\DoxyCodeLine{114          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{115 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{116          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{117 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{118 \textcolor{comment}{!}}
\DoxyCodeLine{119 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{120 \textcolor{comment}{!}}
\DoxyCodeLine{121       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{122          \textcolor{keywordflow}{If} (invals(iind-\/1) < invals(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{123             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{124             irngt(iind) = iind}
\DoxyCodeLine{125          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{126             irngt(iind-\/1) = iind}
\DoxyCodeLine{127             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{128 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{129 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{130       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{131          irngt(nval) = nval}
\DoxyCodeLine{132 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{133 \textcolor{comment}{!}}
\DoxyCodeLine{134 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{135 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{136 \textcolor{comment}{!}}
\DoxyCodeLine{137       lmtna = 2}
\DoxyCodeLine{138       lmtnc = 4}
\DoxyCodeLine{139 \textcolor{comment}{!}}
\DoxyCodeLine{140 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{141 \textcolor{comment}{!}}
\DoxyCodeLine{142       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{143          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{144 \textcolor{comment}{!}}
\DoxyCodeLine{145 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{146 \textcolor{comment}{!}}
\DoxyCodeLine{147          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{148             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{149                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{150 \textcolor{comment}{!}}
\DoxyCodeLine{151 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{152 \textcolor{comment}{!}}
\DoxyCodeLine{153                \textcolor{keywordflow}{If} (invals(irngt(iwrkd+2)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{154 \textcolor{comment}{!}}
\DoxyCodeLine{155 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{156 \textcolor{comment}{!}}
\DoxyCodeLine{157                \textcolor{keywordflow}{If} (invals(irngt(iwrkd+1)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{158                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{159                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{160                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{161 \textcolor{comment}{!}}
\DoxyCodeLine{162 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{163 \textcolor{comment}{!}}
\DoxyCodeLine{164                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{165                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{166                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{167                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{168                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{169 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{170                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{171 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{172 \textcolor{comment}{!}}
\DoxyCodeLine{173 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{174 \textcolor{comment}{!}}
\DoxyCodeLine{175             \textcolor{keywordflow}{If} (invals(irngt(iwrkd+2)) <= invals(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{176 \textcolor{comment}{!}}
\DoxyCodeLine{177 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{178 \textcolor{comment}{!}}
\DoxyCodeLine{179             \textcolor{keywordflow}{If} (invals(irngt(iwrkd+1)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{180                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{181                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{182                \textcolor{keywordflow}{If} (invals(irng2) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{183 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{184                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{185                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{186 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{187                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{188                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{189 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{190 \textcolor{comment}{!}}
\DoxyCodeLine{191 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{192 \textcolor{comment}{!}}
\DoxyCodeLine{193             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{194                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{195                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{196                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{197                \textcolor{keywordflow}{If} (invals(irng1) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{198                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{199                   \textcolor{keywordflow}{If} (invals(irng2) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{200 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{201                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{202                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{203 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{204                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{205                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{206 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{207                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{208 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{209                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{210                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{211                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{212 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{213 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{214 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{215 \textcolor{comment}{!}}
\DoxyCodeLine{216 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{217 \textcolor{comment}{!}}
\DoxyCodeLine{218          lmtna = 4}
\DoxyCodeLine{219          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{220 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{221 \textcolor{comment}{!}}
\DoxyCodeLine{222 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{223 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{224 \textcolor{comment}{!}}
\DoxyCodeLine{225       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{226          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{227          iwrkf = 0}
\DoxyCodeLine{228          lmtnc = 2 * lmtnc}
\DoxyCodeLine{229 \textcolor{comment}{!}}
\DoxyCodeLine{230 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{231 \textcolor{comment}{!}}
\DoxyCodeLine{232          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{233             iwrk = iwrkf}
\DoxyCodeLine{234             iwrkd = iwrkf + 1}
\DoxyCodeLine{235             jinda = iwrkf + lmtna}
\DoxyCodeLine{236             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{237             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{238                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{239                iwrkf = nval}
\DoxyCodeLine{240 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{241             iinda = 1}
\DoxyCodeLine{242             iindb = jinda + 1}
\DoxyCodeLine{243 \textcolor{comment}{!}}
\DoxyCodeLine{244 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{245 \textcolor{comment}{!}}
\DoxyCodeLine{246 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{247 \textcolor{comment}{!}}
\DoxyCodeLine{248             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{249             xvala = invals(jwrkt(iinda))}
\DoxyCodeLine{250             xvalb = invals(irngt(iindb))}
\DoxyCodeLine{251 \textcolor{comment}{!}}
\DoxyCodeLine{252             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{253                iwrk = iwrk + 1}
\DoxyCodeLine{254 \textcolor{comment}{!}}
\DoxyCodeLine{255 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{256 \textcolor{comment}{!}}
\DoxyCodeLine{257                \textcolor{keywordflow}{If} (xvala > xvalb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{258                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{259                   iindb = iindb + 1}
\DoxyCodeLine{260                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{261 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{262                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{263                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{264 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{265                   xvalb = invals(irngt(iindb))}
\DoxyCodeLine{266                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{267                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{268                   iinda = iinda + 1}
\DoxyCodeLine{269                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{270                   xvala = invals(jwrkt(iinda))}
\DoxyCodeLine{271 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{272 \textcolor{comment}{!}}
\DoxyCodeLine{273 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{274 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{275 \textcolor{comment}{!}}
\DoxyCodeLine{276 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{277 \textcolor{comment}{!}}
\DoxyCodeLine{278          lmtna = 2 * lmtna}
\DoxyCodeLine{279 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{280 \textcolor{comment}{!}}
\DoxyCodeLine{281 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{282 \textcolor{comment}{!}}
\DoxyCodeLine{283       iinda = 1}
\DoxyCodeLine{284       iindb = lmtna + 1}
\DoxyCodeLine{285       nuni = 0}
\DoxyCodeLine{286 \textcolor{comment}{!}}
\DoxyCodeLine{287 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{288 \textcolor{comment}{!}}
\DoxyCodeLine{289       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{290       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{291         xtst = nearless(min(invals(jwrkt(1)), invals(irngt(iindb))))}
\DoxyCodeLine{292       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{293         xtst = nearless(invals(jwrkt(1)))}
\DoxyCodeLine{294 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{295       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{296 \textcolor{comment}{!}}
\DoxyCodeLine{297 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{298 \textcolor{comment}{!}}
\DoxyCodeLine{299          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{300             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{301                \textcolor{keywordflow}{If} (invals(jwrkt(iinda)) > invals(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{302                   irng = irngt(iindb)}
\DoxyCodeLine{303                   iindb = iindb + 1}
\DoxyCodeLine{304                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{305                   irng = jwrkt(iinda)}
\DoxyCodeLine{306                   iinda = iinda + 1}
\DoxyCodeLine{307 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{308             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{309 \textcolor{comment}{!}}
\DoxyCodeLine{310 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{311 \textcolor{comment}{!}}
\DoxyCodeLine{312                irng = jwrkt(iinda)}
\DoxyCodeLine{313                iinda = iinda + 1}
\DoxyCodeLine{314 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{315          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{316 \textcolor{comment}{!}}
\DoxyCodeLine{317 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{318 \textcolor{comment}{!}}
\DoxyCodeLine{319             irng = irngt(iwrk)}
\DoxyCodeLine{320 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{321          \textcolor{keywordflow}{If} (invals(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{322             xtst = invals(irng)}
\DoxyCodeLine{323             nuni = nuni + 1}
\DoxyCodeLine{324             irngt(nuni) = irng}
\DoxyCodeLine{325 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{326 \textcolor{comment}{!}}
\DoxyCodeLine{327 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{328 \textcolor{comment}{!}}
\DoxyCodeLine{329       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{330 \textcolor{comment}{!}}

\end{DoxyCode}


The documentation for this interface was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/home/urbanjs/venus/\+V600/github/\+M\+\_\+orderpack/src/\mbox{\hyperlink{M__orderpack____unirnk_8f90}{M\+\_\+orderpack\+\_\+\+\_\+unirnk.\+f90}}\end{DoxyCompactItemize}
