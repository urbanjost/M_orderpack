\hypertarget{interfacem__unirnk_1_1unirnk}{}\doxysection{m\+\_\+unirnk\+::unirnk Interface Reference}
\label{interfacem__unirnk_1_1unirnk}\index{m\_unirnk::unirnk@{m\_unirnk::unirnk}}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{interfacem__unirnk_1_1unirnk_afaca91b343aa9984020990bf0f6e62f7}{real64\+\_\+unirnk}} (I\+N\+V\+A\+LS, I\+R\+N\+GT, N\+U\+NI)
\item 
subroutine \mbox{\hyperlink{interfacem__unirnk_1_1unirnk_a844abc2717a82da711b7c06414ac843d}{real32\+\_\+unirnk}} (I\+N\+V\+A\+LS, I\+R\+N\+GT, N\+U\+NI)
\item 
subroutine \mbox{\hyperlink{interfacem__unirnk_1_1unirnk_a902361f8438cf992d29a480311e7787e}{int32\+\_\+unirnk}} (I\+N\+V\+A\+LS, I\+R\+N\+GT, N\+U\+NI)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\hypertarget{interfacem__unirnk_1_1unirnk_autotoc_md159}{}\doxysubsubsection{N\+A\+ME}\label{interfacem__unirnk_1_1unirnk_autotoc_md159}
Rank\+\_\+\+Unique(3f) -\/ \mbox{[}orderpack\+:\+R\+A\+NK\+:U\+N\+I\+Q\+UE\mbox{]} ranks an array, with removal of duplicate entries (Merge\+Sort)\hypertarget{interfacem__unirnk_1_1unirnk_autotoc_md160}{}\doxysubsubsection{S\+Y\+N\+O\+P\+S\+IS}\label{interfacem__unirnk_1_1unirnk_autotoc_md160}
\begin{DoxyVerb} Subroutine rank_unique (INVALS, IRNGT, NUNI)

   ${TYPE} (Kind=${KIND}), Intent (In) :: INVALS(:)
   Integer, Intent (Out)               :: IRNGT(:)
   Integer, Intent (Out)               :: NUNI

Where ${TYPE}(kind=${KIND}) may be

   o Real(kind=real32)
   o Real(kind=real64)
   o Integer(kind=int32)
\end{DoxyVerb}
\hypertarget{interfacem__unirnk_1_1unirnk_autotoc_md161}{}\doxysubsubsection{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}\label{interfacem__unirnk_1_1unirnk_autotoc_md161}
\begin{DoxyVerb}Ranks an array, removing duplicate entries.

Internally, RANK_UNIQUE(3f) performs a Merge-sort ranking of an array,
with removal of duplicate entries.

The routine is similar to pure merge-sort ranking, but on the last
pass, it discards indices that correspond to duplicate entries.

For performance reasons, the first two passes are taken out of the
standard loop, and use dedicated coding.
\end{DoxyVerb}
\hypertarget{interfacem__unirnk_1_1unirnk_autotoc_md162}{}\doxysubsubsection{O\+P\+T\+I\+O\+NS}\label{interfacem__unirnk_1_1unirnk_autotoc_md162}
I\+N\+V\+A\+LS array to index I\+R\+N\+GT rank index returned pointing to unique values N\+U\+NI the number of unique values found\hypertarget{interfacem__unirnk_1_1unirnk_autotoc_md163}{}\doxysubsubsection{E\+X\+A\+M\+P\+L\+ES}\label{interfacem__unirnk_1_1unirnk_autotoc_md163}
Sample program\+:

program demo\+\_\+rank\+\_\+unique ! rank an array, with removal of duplicate entries. use M\+\_\+orderpack, only \+: rank\+\_\+unique implicit none character(len=$\ast$),parameter \+:: g=\textquotesingle{}($\ast$(g0,1x))\textquotesingle{} integer,allocatable \+:: I\+N\+V\+A\+L\+S(\+:) ! I\+N\+V\+A\+LS=\mbox{[}10,5,7,1,4,5,6,8,9,10,1\mbox{]} call printme() I\+N\+V\+A\+LS=\mbox{[}-\/1,0,-\/2,0,-\/3,0,-\/4\mbox{]} call printme() contains subroutine printme() integer,allocatable \+:: irngt(\+:) integer \+:: nuni if(allocated(irngt))deallocate(irngt) allocate(irngt(size(\+I\+N\+V\+A\+L\+S))) write($\ast$,g)\textquotesingle{}O\+R\+I\+G\+I\+N\+AL\+:\textquotesingle{},I\+N\+V\+A\+LS call rank\+\_\+unique(\+I\+N\+V\+A\+L\+S,irngt,nuni) write($\ast$,g)\textquotesingle{}N\+U\+M\+B\+ER OF U\+N\+I\+Q\+UE I\+N\+D\+I\+C\+ES\+:\textquotesingle{},nuni write($\ast$,g)\textquotesingle{}R\+E\+T\+U\+R\+N\+ED I\+N\+D\+I\+C\+ES\+:\textquotesingle{},irngt(\+:nuni) write($\ast$,g)\textquotesingle{}S\+O\+R\+T\+ED D\+A\+TA\+:\textquotesingle{},I\+N\+V\+A\+L\+S(irngt(\+:nuni)) end subroutine end program demo\+\_\+rank\+\_\+unique

Results\+:

O\+R\+I\+G\+I\+N\+AL\+: 10 5 7 1 4 5 6 8 9 10 1 N\+U\+M\+B\+ER OF U\+N\+I\+Q\+UE I\+N\+D\+I\+C\+ES\+: 8 R\+E\+T\+U\+R\+N\+ED I\+N\+D\+I\+C\+ES\+: 4 5 2 7 3 8 9 1 S\+O\+R\+T\+ED D\+A\+TA\+: 1 4 5 6 7 8 9 10 O\+R\+I\+G\+I\+N\+AL\+: -\/1 0 -\/2 0 -\/3 0 -\/4 N\+U\+M\+B\+ER OF U\+N\+I\+Q\+UE I\+N\+D\+I\+C\+ES\+: 5 R\+E\+T\+U\+R\+N\+ED I\+N\+D\+I\+C\+ES\+: 7 5 3 1 2 S\+O\+R\+T\+ED D\+A\+TA\+: -\/4 -\/3 -\/2 -\/1 0\hypertarget{interfacem__unirnk_1_1unirnk_autotoc_md164}{}\doxysubsubsection{A\+U\+T\+H\+OR}\label{interfacem__unirnk_1_1unirnk_autotoc_md164}
Michel Olagnon, 2000-\/2012 \hypertarget{interfacem__unirnk_1_1unirnk_autotoc_md165}{}\doxysubsubsection{M\+A\+I\+N\+T\+A\+I\+N\+ER}\label{interfacem__unirnk_1_1unirnk_autotoc_md165}
John Urban, 2022.\+04.\+16 \hypertarget{interfacem__unirnk_1_1unirnk_autotoc_md166}{}\doxysubsubsection{L\+I\+C\+E\+N\+SE}\label{interfacem__unirnk_1_1unirnk_autotoc_md166}
C\+C0-\/1.\+0 

\doxysubsection{Member Function/\+Subroutine Documentation}
\mbox{\Hypertarget{interfacem__unirnk_1_1unirnk_a902361f8438cf992d29a480311e7787e}\label{interfacem__unirnk_1_1unirnk_a902361f8438cf992d29a480311e7787e}} 
\index{m\_unirnk::unirnk@{m\_unirnk::unirnk}!int32\_unirnk@{int32\_unirnk}}
\index{int32\_unirnk@{int32\_unirnk}!m\_unirnk::unirnk@{m\_unirnk::unirnk}}
\doxysubsubsection{\texorpdfstring{int32\_unirnk()}{int32\_unirnk()}}
{\footnotesize\ttfamily subroutine m\+\_\+unirnk\+::unirnk\+::int32\+\_\+unirnk (\begin{DoxyParamCaption}\item[{integer (kind=int32), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, dimension (\+:), intent(out)}]{I\+R\+N\+GT,  }\item[{integer, intent(out)}]{N\+U\+NI }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{591       \textcolor{keywordtype}{Integer (Kind=int32)}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: INVALS}
\DoxyCodeLine{592       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IRNGT}
\DoxyCodeLine{593       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: NUNI}
\DoxyCodeLine{594 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{595       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IRNGT))} :: JWRKT}
\DoxyCodeLine{596       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2}
\DoxyCodeLine{597       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{598       \textcolor{keywordtype}{Integer (Kind=int32)} :: XTST, XVALA, XVALB}
\DoxyCodeLine{599 \textcolor{comment}{!}}
\DoxyCodeLine{600 \textcolor{comment}{!}}
\DoxyCodeLine{601       nval = min(\textcolor{keyword}{SIZE}(invals), \textcolor{keyword}{SIZE}(irngt))}
\DoxyCodeLine{602       nuni = nval}
\DoxyCodeLine{603 \textcolor{comment}{!}}
\DoxyCodeLine{604       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{605       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{606          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{607       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{608          irngt(1) = 1}
\DoxyCodeLine{609          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{610 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{611          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{612 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{613 \textcolor{comment}{!}}
\DoxyCodeLine{614 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{615 \textcolor{comment}{!}}
\DoxyCodeLine{616       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{617          \textcolor{keywordflow}{If} (invals(iind-\/1) < invals(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{618             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{619             irngt(iind) = iind}
\DoxyCodeLine{620          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{621             irngt(iind-\/1) = iind}
\DoxyCodeLine{622             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{623 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{624 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{625       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{626          irngt(nval) = nval}
\DoxyCodeLine{627 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{628 \textcolor{comment}{!}}
\DoxyCodeLine{629 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{630 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{631 \textcolor{comment}{!}}
\DoxyCodeLine{632       lmtna = 2}
\DoxyCodeLine{633       lmtnc = 4}
\DoxyCodeLine{634 \textcolor{comment}{!}}
\DoxyCodeLine{635 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{636 \textcolor{comment}{!}}
\DoxyCodeLine{637       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{638          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{639 \textcolor{comment}{!}}
\DoxyCodeLine{640 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{641 \textcolor{comment}{!}}
\DoxyCodeLine{642          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{643             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{644                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{645 \textcolor{comment}{!}}
\DoxyCodeLine{646 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{647 \textcolor{comment}{!}}
\DoxyCodeLine{648                \textcolor{keywordflow}{If} (invals(irngt(iwrkd+2)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{649 \textcolor{comment}{!}}
\DoxyCodeLine{650 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{651 \textcolor{comment}{!}}
\DoxyCodeLine{652                \textcolor{keywordflow}{If} (invals(irngt(iwrkd+1)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{653                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{654                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{655                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{656 \textcolor{comment}{!}}
\DoxyCodeLine{657 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{658 \textcolor{comment}{!}}
\DoxyCodeLine{659                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{660                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{661                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{662                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{663                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{664 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{665                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{666 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{667 \textcolor{comment}{!}}
\DoxyCodeLine{668 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{669 \textcolor{comment}{!}}
\DoxyCodeLine{670             \textcolor{keywordflow}{If} (invals(irngt(iwrkd+2)) <= invals(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{671 \textcolor{comment}{!}}
\DoxyCodeLine{672 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{673 \textcolor{comment}{!}}
\DoxyCodeLine{674             \textcolor{keywordflow}{If} (invals(irngt(iwrkd+1)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{675                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{676                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{677                \textcolor{keywordflow}{If} (invals(irng2) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{678 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{679                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{680                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{681 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{682                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{683                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{684 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{685 \textcolor{comment}{!}}
\DoxyCodeLine{686 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{687 \textcolor{comment}{!}}
\DoxyCodeLine{688             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{689                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{690                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{691                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{692                \textcolor{keywordflow}{If} (invals(irng1) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{693                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{694                   \textcolor{keywordflow}{If} (invals(irng2) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{695 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{696                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{697                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{698 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{699                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{700                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{701 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{702                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{703 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{704                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{705                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{706                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{707 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{708 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{709 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{710 \textcolor{comment}{!}}
\DoxyCodeLine{711 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{712 \textcolor{comment}{!}}
\DoxyCodeLine{713          lmtna = 4}
\DoxyCodeLine{714          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{715 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{716 \textcolor{comment}{!}}
\DoxyCodeLine{717 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{718 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{719 \textcolor{comment}{!}}
\DoxyCodeLine{720       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{721          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{722          iwrkf = 0}
\DoxyCodeLine{723          lmtnc = 2 * lmtnc}
\DoxyCodeLine{724 \textcolor{comment}{!}}
\DoxyCodeLine{725 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{726 \textcolor{comment}{!}}
\DoxyCodeLine{727          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{728             iwrk = iwrkf}
\DoxyCodeLine{729             iwrkd = iwrkf + 1}
\DoxyCodeLine{730             jinda = iwrkf + lmtna}
\DoxyCodeLine{731             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{732             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{733                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{734                iwrkf = nval}
\DoxyCodeLine{735 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{736             iinda = 1}
\DoxyCodeLine{737             iindb = jinda + 1}
\DoxyCodeLine{738 \textcolor{comment}{!}}
\DoxyCodeLine{739 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{740 \textcolor{comment}{!}}
\DoxyCodeLine{741 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{742 \textcolor{comment}{!}}
\DoxyCodeLine{743             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{744             xvala = invals(jwrkt(iinda))}
\DoxyCodeLine{745             xvalb = invals(irngt(iindb))}
\DoxyCodeLine{746 \textcolor{comment}{!}}
\DoxyCodeLine{747             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{748                iwrk = iwrk + 1}
\DoxyCodeLine{749 \textcolor{comment}{!}}
\DoxyCodeLine{750 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{751 \textcolor{comment}{!}}
\DoxyCodeLine{752                \textcolor{keywordflow}{If} (xvala > xvalb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{753                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{754                   iindb = iindb + 1}
\DoxyCodeLine{755                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{756 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{757                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{758                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{759 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{760                   xvalb = invals(irngt(iindb))}
\DoxyCodeLine{761                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{762                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{763                   iinda = iinda + 1}
\DoxyCodeLine{764                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{765                   xvala = invals(jwrkt(iinda))}
\DoxyCodeLine{766 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{767 \textcolor{comment}{!}}
\DoxyCodeLine{768 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{769 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{770 \textcolor{comment}{!}}
\DoxyCodeLine{771 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{772 \textcolor{comment}{!}}
\DoxyCodeLine{773          lmtna = 2 * lmtna}
\DoxyCodeLine{774 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{775 \textcolor{comment}{!}}
\DoxyCodeLine{776 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{777 \textcolor{comment}{!}}
\DoxyCodeLine{778       iinda = 1}
\DoxyCodeLine{779       iindb = lmtna + 1}
\DoxyCodeLine{780       nuni = 0}
\DoxyCodeLine{781 \textcolor{comment}{!}}
\DoxyCodeLine{782 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{783 \textcolor{comment}{!}}
\DoxyCodeLine{784       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{785       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{786         xtst = nearless(min(invals(jwrkt(1)), invals(irngt(iindb))))}
\DoxyCodeLine{787       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{788         xtst = nearless(invals(jwrkt(1)))}
\DoxyCodeLine{789 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{790       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{791 \textcolor{comment}{!}}
\DoxyCodeLine{792 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{793 \textcolor{comment}{!}}
\DoxyCodeLine{794          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{795             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{796                \textcolor{keywordflow}{If} (invals(jwrkt(iinda)) > invals(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{797                   irng = irngt(iindb)}
\DoxyCodeLine{798                   iindb = iindb + 1}
\DoxyCodeLine{799                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{800                   irng = jwrkt(iinda)}
\DoxyCodeLine{801                   iinda = iinda + 1}
\DoxyCodeLine{802 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{803             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{804 \textcolor{comment}{!}}
\DoxyCodeLine{805 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{806 \textcolor{comment}{!}}
\DoxyCodeLine{807                irng = jwrkt(iinda)}
\DoxyCodeLine{808                iinda = iinda + 1}
\DoxyCodeLine{809 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{810          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{811 \textcolor{comment}{!}}
\DoxyCodeLine{812 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{813 \textcolor{comment}{!}}
\DoxyCodeLine{814             irng = irngt(iwrk)}
\DoxyCodeLine{815 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{816          \textcolor{keywordflow}{If} (invals(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{817             xtst = invals(irng)}
\DoxyCodeLine{818             nuni = nuni + 1}
\DoxyCodeLine{819             irngt(nuni) = irng}
\DoxyCodeLine{820 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{821 \textcolor{comment}{!}}
\DoxyCodeLine{822 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{823 \textcolor{comment}{!}}
\DoxyCodeLine{824       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{825 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{interfacem__unirnk_1_1unirnk_a844abc2717a82da711b7c06414ac843d}\label{interfacem__unirnk_1_1unirnk_a844abc2717a82da711b7c06414ac843d}} 
\index{m\_unirnk::unirnk@{m\_unirnk::unirnk}!real32\_unirnk@{real32\_unirnk}}
\index{real32\_unirnk@{real32\_unirnk}!m\_unirnk::unirnk@{m\_unirnk::unirnk}}
\doxysubsubsection{\texorpdfstring{real32\_unirnk()}{real32\_unirnk()}}
{\footnotesize\ttfamily subroutine m\+\_\+unirnk\+::unirnk\+::real32\+\_\+unirnk (\begin{DoxyParamCaption}\item[{real (kind=real32), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, dimension (\+:), intent(out)}]{I\+R\+N\+GT,  }\item[{integer, intent(out)}]{N\+U\+NI }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{345 \textcolor{keywordtype}{      Real} (Kind=real32), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: invals}
\DoxyCodeLine{346       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IRNGT}
\DoxyCodeLine{347       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: NUNI}
\DoxyCodeLine{348 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{349       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IRNGT))} :: JWRKT}
\DoxyCodeLine{350       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2}
\DoxyCodeLine{351       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{352 \textcolor{keywordtype}{      Real} (Kind=real32) :: xtst, xvala, xvalb}
\DoxyCodeLine{353 \textcolor{comment}{!}}
\DoxyCodeLine{354 \textcolor{comment}{!}}
\DoxyCodeLine{355       nval = min(\textcolor{keyword}{SIZE}(invals), \textcolor{keyword}{SIZE}(irngt))}
\DoxyCodeLine{356       nuni = nval}
\DoxyCodeLine{357 \textcolor{comment}{!}}
\DoxyCodeLine{358       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{359       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{360          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{361       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{362          irngt(1) = 1}
\DoxyCodeLine{363          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{364 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{365          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{366 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{367 \textcolor{comment}{!}}
\DoxyCodeLine{368 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{369 \textcolor{comment}{!}}
\DoxyCodeLine{370       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{371          \textcolor{keywordflow}{If} (invals(iind-\/1) < invals(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{372             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{373             irngt(iind) = iind}
\DoxyCodeLine{374          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{375             irngt(iind-\/1) = iind}
\DoxyCodeLine{376             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{377 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{378 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{379       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{380          irngt(nval) = nval}
\DoxyCodeLine{381 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{382 \textcolor{comment}{!}}
\DoxyCodeLine{383 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{384 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{385 \textcolor{comment}{!}}
\DoxyCodeLine{386       lmtna = 2}
\DoxyCodeLine{387       lmtnc = 4}
\DoxyCodeLine{388 \textcolor{comment}{!}}
\DoxyCodeLine{389 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{390 \textcolor{comment}{!}}
\DoxyCodeLine{391       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{392          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{393 \textcolor{comment}{!}}
\DoxyCodeLine{394 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{395 \textcolor{comment}{!}}
\DoxyCodeLine{396          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{397             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{398                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{399 \textcolor{comment}{!}}
\DoxyCodeLine{400 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{401 \textcolor{comment}{!}}
\DoxyCodeLine{402                \textcolor{keywordflow}{If} (invals(irngt(iwrkd+2)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{403 \textcolor{comment}{!}}
\DoxyCodeLine{404 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{405 \textcolor{comment}{!}}
\DoxyCodeLine{406                \textcolor{keywordflow}{If} (invals(irngt(iwrkd+1)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{407                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{408                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{409                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{410 \textcolor{comment}{!}}
\DoxyCodeLine{411 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{412 \textcolor{comment}{!}}
\DoxyCodeLine{413                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{414                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{415                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{416                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{417                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{418 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{419                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{420 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{421 \textcolor{comment}{!}}
\DoxyCodeLine{422 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{423 \textcolor{comment}{!}}
\DoxyCodeLine{424             \textcolor{keywordflow}{If} (invals(irngt(iwrkd+2)) <= invals(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{425 \textcolor{comment}{!}}
\DoxyCodeLine{426 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{427 \textcolor{comment}{!}}
\DoxyCodeLine{428             \textcolor{keywordflow}{If} (invals(irngt(iwrkd+1)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{429                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{430                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{431                \textcolor{keywordflow}{If} (invals(irng2) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{432 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{433                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{434                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{435 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{436                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{437                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{438 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{439 \textcolor{comment}{!}}
\DoxyCodeLine{440 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{441 \textcolor{comment}{!}}
\DoxyCodeLine{442             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{443                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{444                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{445                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{446                \textcolor{keywordflow}{If} (invals(irng1) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{447                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{448                   \textcolor{keywordflow}{If} (invals(irng2) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{449 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{450                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{451                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{452 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{453                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{454                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{455 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{456                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{457 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{458                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{459                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{460                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{461 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{462 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{463 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{464 \textcolor{comment}{!}}
\DoxyCodeLine{465 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{466 \textcolor{comment}{!}}
\DoxyCodeLine{467          lmtna = 4}
\DoxyCodeLine{468          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{469 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{470 \textcolor{comment}{!}}
\DoxyCodeLine{471 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{472 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{473 \textcolor{comment}{!}}
\DoxyCodeLine{474       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{475          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{476          iwrkf = 0}
\DoxyCodeLine{477          lmtnc = 2 * lmtnc}
\DoxyCodeLine{478 \textcolor{comment}{!}}
\DoxyCodeLine{479 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{480 \textcolor{comment}{!}}
\DoxyCodeLine{481          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{482             iwrk = iwrkf}
\DoxyCodeLine{483             iwrkd = iwrkf + 1}
\DoxyCodeLine{484             jinda = iwrkf + lmtna}
\DoxyCodeLine{485             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{486             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{487                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{488                iwrkf = nval}
\DoxyCodeLine{489 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{490             iinda = 1}
\DoxyCodeLine{491             iindb = jinda + 1}
\DoxyCodeLine{492 \textcolor{comment}{!}}
\DoxyCodeLine{493 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{494 \textcolor{comment}{!}}
\DoxyCodeLine{495 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{496 \textcolor{comment}{!}}
\DoxyCodeLine{497             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{498             xvala = invals(jwrkt(iinda))}
\DoxyCodeLine{499             xvalb = invals(irngt(iindb))}
\DoxyCodeLine{500 \textcolor{comment}{!}}
\DoxyCodeLine{501             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{502                iwrk = iwrk + 1}
\DoxyCodeLine{503 \textcolor{comment}{!}}
\DoxyCodeLine{504 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{505 \textcolor{comment}{!}}
\DoxyCodeLine{506                \textcolor{keywordflow}{If} (xvala > xvalb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{507                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{508                   iindb = iindb + 1}
\DoxyCodeLine{509                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{510 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{511                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{512                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{513 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{514                   xvalb = invals(irngt(iindb))}
\DoxyCodeLine{515                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{516                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{517                   iinda = iinda + 1}
\DoxyCodeLine{518                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{519                   xvala = invals(jwrkt(iinda))}
\DoxyCodeLine{520 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{521 \textcolor{comment}{!}}
\DoxyCodeLine{522 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{523 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{524 \textcolor{comment}{!}}
\DoxyCodeLine{525 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{526 \textcolor{comment}{!}}
\DoxyCodeLine{527          lmtna = 2 * lmtna}
\DoxyCodeLine{528 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{529 \textcolor{comment}{!}}
\DoxyCodeLine{530 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{531 \textcolor{comment}{!}}
\DoxyCodeLine{532       iinda = 1}
\DoxyCodeLine{533       iindb = lmtna + 1}
\DoxyCodeLine{534       nuni = 0}
\DoxyCodeLine{535 \textcolor{comment}{!}}
\DoxyCodeLine{536 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{537 \textcolor{comment}{!}}
\DoxyCodeLine{538       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{539       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{540         xtst = nearless(min(invals(jwrkt(1)), invals(irngt(iindb))))}
\DoxyCodeLine{541       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{542         xtst = nearless(invals(jwrkt(1)))}
\DoxyCodeLine{543 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{544       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{545 \textcolor{comment}{!}}
\DoxyCodeLine{546 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{547 \textcolor{comment}{!}}
\DoxyCodeLine{548          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{549             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{550                \textcolor{keywordflow}{If} (invals(jwrkt(iinda)) > invals(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{551                   irng = irngt(iindb)}
\DoxyCodeLine{552                   iindb = iindb + 1}
\DoxyCodeLine{553                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{554                   irng = jwrkt(iinda)}
\DoxyCodeLine{555                   iinda = iinda + 1}
\DoxyCodeLine{556 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{557             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{558 \textcolor{comment}{!}}
\DoxyCodeLine{559 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{560 \textcolor{comment}{!}}
\DoxyCodeLine{561                irng = jwrkt(iinda)}
\DoxyCodeLine{562                iinda = iinda + 1}
\DoxyCodeLine{563 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{564          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{565 \textcolor{comment}{!}}
\DoxyCodeLine{566 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{567 \textcolor{comment}{!}}
\DoxyCodeLine{568             irng = irngt(iwrk)}
\DoxyCodeLine{569 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{570          \textcolor{keywordflow}{If} (invals(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{571             xtst = invals(irng)}
\DoxyCodeLine{572             nuni = nuni + 1}
\DoxyCodeLine{573             irngt(nuni) = irng}
\DoxyCodeLine{574 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{575 \textcolor{comment}{!}}
\DoxyCodeLine{576 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{577 \textcolor{comment}{!}}
\DoxyCodeLine{578       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{579 \textcolor{comment}{!}}

\end{DoxyCode}
\mbox{\Hypertarget{interfacem__unirnk_1_1unirnk_afaca91b343aa9984020990bf0f6e62f7}\label{interfacem__unirnk_1_1unirnk_afaca91b343aa9984020990bf0f6e62f7}} 
\index{m\_unirnk::unirnk@{m\_unirnk::unirnk}!real64\_unirnk@{real64\_unirnk}}
\index{real64\_unirnk@{real64\_unirnk}!m\_unirnk::unirnk@{m\_unirnk::unirnk}}
\doxysubsubsection{\texorpdfstring{real64\_unirnk()}{real64\_unirnk()}}
{\footnotesize\ttfamily subroutine m\+\_\+unirnk\+::unirnk\+::real64\+\_\+unirnk (\begin{DoxyParamCaption}\item[{real (kind=real64), dimension (\+:), intent(in)}]{I\+N\+V\+A\+LS,  }\item[{integer, dimension (\+:), intent(out)}]{I\+R\+N\+GT,  }\item[{integer, intent(out)}]{N\+U\+NI }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{99 \textcolor{keywordtype}{      Real} (Kind=real64), \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (In)} :: invals}
\DoxyCodeLine{100       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (:)}, \textcolor{keywordtype}{Intent (Out)} :: IRNGT}
\DoxyCodeLine{101       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Intent (Out)} :: NUNI}
\DoxyCodeLine{102 \textcolor{comment}{! \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_}}
\DoxyCodeLine{103       \textcolor{keywordtype}{Integer}, \textcolor{keywordtype}{Dimension (SIZE(IRNGT))} :: JWRKT}
\DoxyCodeLine{104       \textcolor{keywordtype}{Integer} :: LMTNA, LMTNC, IRNG, IRNG1, IRNG2}
\DoxyCodeLine{105       \textcolor{keywordtype}{Integer} :: NVAL, IIND, IWRKD, IWRK, IWRKF, JINDA, IINDA, IINDB}
\DoxyCodeLine{106 \textcolor{keywordtype}{      Real} (Kind=real64) :: xtst, xvala, xvalb}
\DoxyCodeLine{107 \textcolor{comment}{!}}
\DoxyCodeLine{108 \textcolor{comment}{!}}
\DoxyCodeLine{109       nval = min(\textcolor{keyword}{SIZE}(invals), \textcolor{keyword}{SIZE}(irngt))}
\DoxyCodeLine{110       nuni = nval}
\DoxyCodeLine{111 \textcolor{comment}{!}}
\DoxyCodeLine{112       \textcolor{keywordflow}{Select Case} (nval)}
\DoxyCodeLine{113       \textcolor{keywordflow}{Case} (:0)}
\DoxyCodeLine{114          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{115       \textcolor{keywordflow}{Case} (1)}
\DoxyCodeLine{116          irngt(1) = 1}
\DoxyCodeLine{117          \textcolor{keywordflow}{Return}}
\DoxyCodeLine{118 \textcolor{keywordflow}{      Case Default}}
\DoxyCodeLine{119          \textcolor{keywordflow}{Continue}}
\DoxyCodeLine{120 \textcolor{keywordflow}{      End Select}}
\DoxyCodeLine{121 \textcolor{comment}{!}}
\DoxyCodeLine{122 \textcolor{comment}{!  Fill-\/in the index array, creating ordered couples}}
\DoxyCodeLine{123 \textcolor{comment}{!}}
\DoxyCodeLine{124       \textcolor{keywordflow}{Do} iind = 2, nval, 2}
\DoxyCodeLine{125          \textcolor{keywordflow}{If} (invals(iind-\/1) < invals(iind)) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{126             irngt(iind-\/1) = iind -\/ 1}
\DoxyCodeLine{127             irngt(iind) = iind}
\DoxyCodeLine{128          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{129             irngt(iind-\/1) = iind}
\DoxyCodeLine{130             irngt(iind) = iind -\/ 1}
\DoxyCodeLine{131 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{132 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{133       \textcolor{keywordflow}{If} (modulo(nval, 2) /= 0) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{134          irngt(nval) = nval}
\DoxyCodeLine{135 \textcolor{keywordflow}{      End If}}
\DoxyCodeLine{136 \textcolor{comment}{!}}
\DoxyCodeLine{137 \textcolor{comment}{!  We will now have ordered subsets A -\/ B -\/ A -\/ B -\/ ...}}
\DoxyCodeLine{138 \textcolor{comment}{!  and merge A and B couples into     C   -\/   C   -\/ ...}}
\DoxyCodeLine{139 \textcolor{comment}{!}}
\DoxyCodeLine{140       lmtna = 2}
\DoxyCodeLine{141       lmtnc = 4}
\DoxyCodeLine{142 \textcolor{comment}{!}}
\DoxyCodeLine{143 \textcolor{comment}{!  First iteration. The length of the ordered subsets goes from 2 to 4}}
\DoxyCodeLine{144 \textcolor{comment}{!}}
\DoxyCodeLine{145       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{146          \textcolor{keywordflow}{If} (nval <= 4) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{147 \textcolor{comment}{!}}
\DoxyCodeLine{148 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{149 \textcolor{comment}{!}}
\DoxyCodeLine{150          \textcolor{keywordflow}{Do} iwrkd = 0, nval -\/ 1, 4}
\DoxyCodeLine{151             \textcolor{keywordflow}{If} ((iwrkd+4) > nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{152                \textcolor{keywordflow}{If} ((iwrkd+2) >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{153 \textcolor{comment}{!}}
\DoxyCodeLine{154 \textcolor{comment}{!   1 2 3}}
\DoxyCodeLine{155 \textcolor{comment}{!}}
\DoxyCodeLine{156                \textcolor{keywordflow}{If} (invals(irngt(iwrkd+2)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{157 \textcolor{comment}{!}}
\DoxyCodeLine{158 \textcolor{comment}{!   1 3 2}}
\DoxyCodeLine{159 \textcolor{comment}{!}}
\DoxyCodeLine{160                \textcolor{keywordflow}{If} (invals(irngt(iwrkd+1)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{161                   irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{162                   irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{163                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{164 \textcolor{comment}{!}}
\DoxyCodeLine{165 \textcolor{comment}{!   3 1 2}}
\DoxyCodeLine{166 \textcolor{comment}{!}}
\DoxyCodeLine{167                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{168                   irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{169                   irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{170                   irngt(iwrkd+3) = irngt(iwrkd+2)}
\DoxyCodeLine{171                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{172 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{173                \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{174 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{175 \textcolor{comment}{!}}
\DoxyCodeLine{176 \textcolor{comment}{!   1 2 3 4}}
\DoxyCodeLine{177 \textcolor{comment}{!}}
\DoxyCodeLine{178             \textcolor{keywordflow}{If} (invals(irngt(iwrkd+2)) <= invals(irngt(iwrkd+3))) cycle}
\DoxyCodeLine{179 \textcolor{comment}{!}}
\DoxyCodeLine{180 \textcolor{comment}{!   1 3 x x}}
\DoxyCodeLine{181 \textcolor{comment}{!}}
\DoxyCodeLine{182             \textcolor{keywordflow}{If} (invals(irngt(iwrkd+1)) <= invals(irngt(iwrkd+3))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{183                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{184                irngt(iwrkd+2) = irngt(iwrkd+3)}
\DoxyCodeLine{185                \textcolor{keywordflow}{If} (invals(irng2) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{186 \textcolor{comment}{!   1 3 2 4}}
\DoxyCodeLine{187                   irngt(iwrkd+3) = irng2}
\DoxyCodeLine{188                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{189 \textcolor{comment}{!   1 3 4 2}}
\DoxyCodeLine{190                   irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{191                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{192 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{193 \textcolor{comment}{!}}
\DoxyCodeLine{194 \textcolor{comment}{!   3 x x x}}
\DoxyCodeLine{195 \textcolor{comment}{!}}
\DoxyCodeLine{196             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{197                irng1 = irngt(iwrkd+1)}
\DoxyCodeLine{198                irng2 = irngt(iwrkd+2)}
\DoxyCodeLine{199                irngt(iwrkd+1) = irngt(iwrkd+3)}
\DoxyCodeLine{200                \textcolor{keywordflow}{If} (invals(irng1) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{201                   irngt(iwrkd+2) = irng1}
\DoxyCodeLine{202                   \textcolor{keywordflow}{If} (invals(irng2) <= invals(irngt(iwrkd+4))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{203 \textcolor{comment}{!   3 1 2 4}}
\DoxyCodeLine{204                      irngt(iwrkd+3) = irng2}
\DoxyCodeLine{205                   \textcolor{keywordflow}{Else}}
\DoxyCodeLine{206 \textcolor{comment}{!   3 1 4 2}}
\DoxyCodeLine{207                      irngt(iwrkd+3) = irngt(iwrkd+4)}
\DoxyCodeLine{208                      irngt(iwrkd+4) = irng2}
\DoxyCodeLine{209 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{210                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{211 \textcolor{comment}{!   3 4 1 2}}
\DoxyCodeLine{212                   irngt(iwrkd+2) = irngt(iwrkd+4)}
\DoxyCodeLine{213                   irngt(iwrkd+3) = irng1}
\DoxyCodeLine{214                   irngt(iwrkd+4) = irng2}
\DoxyCodeLine{215 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{216 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{217 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{218 \textcolor{comment}{!}}
\DoxyCodeLine{219 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{220 \textcolor{comment}{!}}
\DoxyCodeLine{221          lmtna = 4}
\DoxyCodeLine{222          \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{223 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{224 \textcolor{comment}{!}}
\DoxyCodeLine{225 \textcolor{comment}{!  Iteration loop. Each time, the length of the ordered subsets}}
\DoxyCodeLine{226 \textcolor{comment}{!  is doubled.}}
\DoxyCodeLine{227 \textcolor{comment}{!}}
\DoxyCodeLine{228       \textcolor{keywordflow}{Do}}
\DoxyCodeLine{229          \textcolor{keywordflow}{If} (2*lmtna >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{230          iwrkf = 0}
\DoxyCodeLine{231          lmtnc = 2 * lmtnc}
\DoxyCodeLine{232 \textcolor{comment}{!}}
\DoxyCodeLine{233 \textcolor{comment}{!   Loop on merges of A and B into C}}
\DoxyCodeLine{234 \textcolor{comment}{!}}
\DoxyCodeLine{235          \textcolor{keywordflow}{Do}}
\DoxyCodeLine{236             iwrk = iwrkf}
\DoxyCodeLine{237             iwrkd = iwrkf + 1}
\DoxyCodeLine{238             jinda = iwrkf + lmtna}
\DoxyCodeLine{239             iwrkf = iwrkf + lmtnc}
\DoxyCodeLine{240             \textcolor{keywordflow}{If} (iwrkf >= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{241                \textcolor{keywordflow}{If} (jinda >= nval) \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{242                iwrkf = nval}
\DoxyCodeLine{243 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{244             iinda = 1}
\DoxyCodeLine{245             iindb = jinda + 1}
\DoxyCodeLine{246 \textcolor{comment}{!}}
\DoxyCodeLine{247 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{248 \textcolor{comment}{!}}
\DoxyCodeLine{249 \textcolor{comment}{!  Make a copy of the rank array for the iteration}}
\DoxyCodeLine{250 \textcolor{comment}{!}}
\DoxyCodeLine{251             jwrkt(1:lmtna) = irngt(iwrkd:jinda)}
\DoxyCodeLine{252             xvala = invals(jwrkt(iinda))}
\DoxyCodeLine{253             xvalb = invals(irngt(iindb))}
\DoxyCodeLine{254 \textcolor{comment}{!}}
\DoxyCodeLine{255             \textcolor{keywordflow}{Do}}
\DoxyCodeLine{256                iwrk = iwrk + 1}
\DoxyCodeLine{257 \textcolor{comment}{!}}
\DoxyCodeLine{258 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{259 \textcolor{comment}{!}}
\DoxyCodeLine{260                \textcolor{keywordflow}{If} (xvala > xvalb) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{261                   irngt(iwrk) = irngt(iindb)}
\DoxyCodeLine{262                   iindb = iindb + 1}
\DoxyCodeLine{263                   \textcolor{keywordflow}{If} (iindb > iwrkf) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{264 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{265                      irngt(iwrk+1:iwrkf) = jwrkt(iinda:lmtna)}
\DoxyCodeLine{266                      \textcolor{keywordflow}{Exit}}
\DoxyCodeLine{267 \textcolor{keywordflow}{                  End If}}
\DoxyCodeLine{268                   xvalb = invals(irngt(iindb))}
\DoxyCodeLine{269                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{270                   irngt(iwrk) = jwrkt(iinda)}
\DoxyCodeLine{271                   iinda = iinda + 1}
\DoxyCodeLine{272                   \textcolor{keywordflow}{If} (iinda > lmtna) exit\textcolor{comment}{! Only B still with unprocessed values}}
\DoxyCodeLine{273                   xvala = invals(jwrkt(iinda))}
\DoxyCodeLine{274 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{275 \textcolor{comment}{!}}
\DoxyCodeLine{276 \textcolor{keywordflow}{            End Do}}
\DoxyCodeLine{277 \textcolor{keywordflow}{         End Do}}
\DoxyCodeLine{278 \textcolor{comment}{!}}
\DoxyCodeLine{279 \textcolor{comment}{!  The Cs become As and Bs}}
\DoxyCodeLine{280 \textcolor{comment}{!}}
\DoxyCodeLine{281          lmtna = 2 * lmtna}
\DoxyCodeLine{282 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{283 \textcolor{comment}{!}}
\DoxyCodeLine{284 \textcolor{comment}{!   Last merge of A and B into C, with removal of duplicates.}}
\DoxyCodeLine{285 \textcolor{comment}{!}}
\DoxyCodeLine{286       iinda = 1}
\DoxyCodeLine{287       iindb = lmtna + 1}
\DoxyCodeLine{288       nuni = 0}
\DoxyCodeLine{289 \textcolor{comment}{!}}
\DoxyCodeLine{290 \textcolor{comment}{!  One steps in the C subset, that we create in the final rank array}}
\DoxyCodeLine{291 \textcolor{comment}{!}}
\DoxyCodeLine{292       jwrkt(1:lmtna) = irngt(1:lmtna)}
\DoxyCodeLine{293       \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{294         xtst = nearless(min(invals(jwrkt(1)), invals(irngt(iindb))))}
\DoxyCodeLine{295       \textcolor{keywordflow}{Else}}
\DoxyCodeLine{296         xtst = nearless(invals(jwrkt(1)))}
\DoxyCodeLine{297 \textcolor{keywordflow}{      Endif}}
\DoxyCodeLine{298       \textcolor{keywordflow}{Do} iwrk = 1, nval}
\DoxyCodeLine{299 \textcolor{comment}{!}}
\DoxyCodeLine{300 \textcolor{comment}{!  We still have unprocessed values in both A and B}}
\DoxyCodeLine{301 \textcolor{comment}{!}}
\DoxyCodeLine{302          \textcolor{keywordflow}{If} (iinda <= lmtna) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{303             \textcolor{keywordflow}{If} (iindb <= nval) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{304                \textcolor{keywordflow}{If} (invals(jwrkt(iinda)) > invals(irngt(iindb))) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{305                   irng = irngt(iindb)}
\DoxyCodeLine{306                   iindb = iindb + 1}
\DoxyCodeLine{307                \textcolor{keywordflow}{Else}}
\DoxyCodeLine{308                   irng = jwrkt(iinda)}
\DoxyCodeLine{309                   iinda = iinda + 1}
\DoxyCodeLine{310 \textcolor{keywordflow}{               End If}}
\DoxyCodeLine{311             \textcolor{keywordflow}{Else}}
\DoxyCodeLine{312 \textcolor{comment}{!}}
\DoxyCodeLine{313 \textcolor{comment}{!  Only A still with unprocessed values}}
\DoxyCodeLine{314 \textcolor{comment}{!}}
\DoxyCodeLine{315                irng = jwrkt(iinda)}
\DoxyCodeLine{316                iinda = iinda + 1}
\DoxyCodeLine{317 \textcolor{keywordflow}{            End If}}
\DoxyCodeLine{318          \textcolor{keywordflow}{Else}}
\DoxyCodeLine{319 \textcolor{comment}{!}}
\DoxyCodeLine{320 \textcolor{comment}{!  Only B still with unprocessed values}}
\DoxyCodeLine{321 \textcolor{comment}{!}}
\DoxyCodeLine{322             irng = irngt(iwrk)}
\DoxyCodeLine{323 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{324          \textcolor{keywordflow}{If} (invals(irng) > xtst) \textcolor{keywordflow}{Then}}
\DoxyCodeLine{325             xtst = invals(irng)}
\DoxyCodeLine{326             nuni = nuni + 1}
\DoxyCodeLine{327             irngt(nuni) = irng}
\DoxyCodeLine{328 \textcolor{keywordflow}{         End If}}
\DoxyCodeLine{329 \textcolor{comment}{!}}
\DoxyCodeLine{330 \textcolor{keywordflow}{      End Do}}
\DoxyCodeLine{331 \textcolor{comment}{!}}
\DoxyCodeLine{332       \textcolor{keywordflow}{Return}}
\DoxyCodeLine{333 \textcolor{comment}{!}}

\end{DoxyCode}


The documentation for this interface was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/home/urbanjs/venus/\+V600/github/orderpack/src/\mbox{\hyperlink{M__unirnk_8f90}{M\+\_\+unirnk.\+f90}}\end{DoxyCompactItemize}
