<html> 
<head> 
<title> </title>
<style> 
px {font-family: "Lucida Console", Monaco }
p { font-size:100%; line-height:1.1em; }
body {xfont-style: sans-serif}
body {
color:#333; font-family:Verdana, Arial, Helvetica, sans-serif; font-size:1em; line-height:1.3em; }
a:visited { color:#666; }
h1,h2,h3,h4,h5,h6 { color:#333; font-family:georgia, verdana, sans-serif; }
h1 { font-size:150%; page-break-before:auto;background-color: #aaaaff}
h2 { font-size:143%;color:teal; }
h3 { font-size:134%;color:blue; }
h4 { font-size:120%;color:gray; }
img { max-width: 55em}
p{ padding: 0;margin:0; }
p{ padding-right:1.4em; }
p{ padding-bottom:0.1em; }
p{ padding-top:1em; }
p{ whitespace: pre-wrap; }
h5,h6 { font-size:100% }
a.nav,a:link.nav, a:visited.nav { background-color:#FFF; color:#000; }
XXtable { border:double #000; border-collapse:collapse; }
XXtable { border-collapse:collapse; }
XXtd { border:thin solid #888; }
XXtd { border:none; }
li { margin-bottom:0.5em; }
blockquote { display:block; font-size:100%; line-height:1.1em; margin:0 0 0.5em; padding:0 2.5em; }
pre { background-color:#DDD; font-size:100%; overflow:auto; padding:1em; }
a,li span { color:#000; }
a:hover, a.nav:hover, a:hover math { background-color:#000; color:#FFF; }
#Container { margin:0 10px; text-align:center; background-color: #BBB}
#Content { border-top:none; margin:auto; padding:0.3em; text-align:left; width:100%; max-width:55em; background:#FFF}
span.webName { font-size:.5em; }
textarea#content { font-size: 1em; line-height: 1.125; }
h1#pageName { line-height:1em; margin:0.2em 0 0.2em 0; padding:0; }
.property { color:#666; font-size:100%; }
a.existingWikiWord[title]{ //border: 1px dashed #BBB; }
.byline { color:#666; font-size:1.0em; font-style:italic; margin-bottom:1em; padding-top:1px; } 
</style> 
</head>
<BODY bgcolor=#F0F0F0 text=#000000 link=#0000ff vlink=#C000C0 alink=#ff0000><A NAME=top></A>
<h5><a href="https://github.com/urbanjost/M_mulcnt">[UP]</a></h5>
<div id="Container">
<div id="Content">
<CENTER>
<H1><HR><I>Manual Reference Pages &nbsp;-&nbsp;</I><NOBR>unipar (3orderpack)</NOBR><HR></H1>
</CENTER>
<A name=0>

     <H3>NAME</H3>

</A>
<BLOCKQUOTE>
<B>unipar</B>(3f) - [orderpack:PARTIAL_RANK_UNIQUE] partially rank an array
removing duplicates
<P>
</BLOCKQUOTE>
<A name=contents></A><H3>CONTENTS</H3></A>
<BLOCKQUOTE>
<A HREF=#1>Synopsis</A><BR>
<A HREF=#2>Description</A><BR>
<A HREF=#3>Options</A><BR>
<A HREF=#4>Examples</A><BR>
<A HREF=#5>Author</A><BR>
<A HREF=#6>License</A><BR>
</BLOCKQUOTE>
<A name=7>

     <H3>SYNOPSIS</H3>

</A>
<BLOCKQUOTE>
Subroutine ${KIND}_unipar (<I>XDONT</I>, <I>IRNGT</I>, <I>NORD</I>)
<P>
<PRE>
     ${TYPE} (kind=${KIND}), Dimension (:), Intent (In) :: XDONT
     Integer, Dimension (:), Intent (Out) :: IRNGT
     Integer, Intent (InOut) :: NORD
<P>
</PRE>
</BLOCKQUOTE>
Where ${TYPE}(kind=${KIND}) may be
<BLOCKQUOTE>
<TABLE cellpadding=3><!-- tsb: Where ${TYPE}(kind=${KIND}) may be
 -->
<TR></TR><TR></TR>
<TR valign=top><TD width=3%>
o
</TD><TD>
<B>Real</B>(kind=real32)
</TD></TR>
<TR valign=top><TD width=3%>
o
</TD><TD>
<B>Real</B>(kind=real64)
</TD></TR>
<TR valign=top><TD width=3%>
o
</TD><TD>
<B>Integer</B>(kind=int32)
</TD></TR>
<TR></TR></TABLE></BLOCKQUOTE>
<A name=2>

     <H3>DESCRIPTION</H3>

</A>
<BLOCKQUOTE>
Ranks partially <I>XDONT</I> by <I>IRNGT</I>, up to order <I>NORD</I> at most,
removing duplicate entries
<P>
This routine uses a pivoting strategy such as the one of
finding the median based on the quicksort algorithm, but
we skew the pivot choice to try to bring it to <I>NORD</I> as
quickly as possible. It uses 2 temporary arrays, where it
stores the indices of the values smaller than the pivot
(ILOWT), and the indices of values larger than the pivot
that we might still need later on (IHIGT). It iterates
until it can bring the number of values in ILOWT to
exactly <I>NORD</I>, and then uses an insertion sort to rank
this set, since it is supposedly small. At all times, the
<I>NORD</I> first values in ILOWT correspond to distinct values
of the input array.
</BLOCKQUOTE>
<A name=3>

     <H3>OPTIONS</H3>

</A>
<BLOCKQUOTE>
<TABLE cellpadding=3>
<TR valign=top><TD width=6% nowrap>
<B></B><I>XDONT</I> </TD><TD valign=bottom>
array to partially sort
</TD></TR>
<TR valign=top><TD width=6% nowrap>
<B></B><I>IRNGT</I> </TD><TD valign=bottom>
indices returned that point to lowest values
</TD></TR>
<TR valign=top><TD width=6% nowrap>
<B></B><I>NORD</I> </TD><TD valign=bottom>
number of sorted values to determine before
eliminating duplicates
</TD></TR>
<TR></TR></TABLE></BLOCKQUOTE>
<A name=4>

     <H3>EXAMPLES</H3>

</A>
<BLOCKQUOTE>
Sample program:
<P>
<PRE>
   program demo_unipar
   use M_unipar, only : unipar
   implicit none
   character(len=*),parameter :: g=&#146;(*(g0,1x))&#146;
   integer,allocatable :: xdont(:)
   integer,allocatable :: irngt(:)
   integer :: nord
   !
   write(*,g)&#146;If enough values are unique, will return NORD indices&#146;
   if(allocated(irngt))deallocate(irngt)
   xdont=[10,5,7,1,4,5,6,8,9,10,1]
   nord=5
   allocate(irngt(nord))
   call printme()
   !
   !BUG!write(*,g)&#146;If not enough values are unique, will change NORD&#146;
   !BUG!xdont=[-1,0,-1,0,-1,0,-1]
   !BUG!nord=5
   !BUG!if(allocated(irngt))deallocate(irngt)
   !BUG!allocate(irngt(nord))
   !BUG!call printme()
   contains
   subroutine printme()
      write(*,g)&#146;ORIGINAL:&#146;,xdont
      write(*,g)&#146;NUMBER OF INDICES TO SORT:&#146;,nord
      call unipar(xdont,irngt,nord)
      write(*,g)&#146;NUMBER OF INDICES RETURNED:&#146;,nord
      write(*,g)&#146;RETURNED INDICES:&#146;,irngt(:nord)
      write(*,g)nord,&#146;SMALLEST UNIQUE VALUES:&#146;,xdont(irngt(:nord))
   end subroutine
   end program demo_unipar
<P>
</PRE>
Results:
<P>
<PRE>
   If enough values are unique, will return NORD indices
   ORIGINAL: 10 5 7 1 4 5 6 8 9 10 1
   NUMBER OF INDICES TO SORT: 5
   NUMBER OF INDICES RETURNED: 5
   RETURNED INDICES: 11 5 2 7 3
   5 SMALLEST UNIQUE VALUES: 1 4 5 6 7
   If not enough values are unique, will change NORD
   ORIGINAL: -1 0 -1 0 -1 0 -1
   NUMBER OF INDICES TO SORT: 5
   NUMBER OF INDICES RETURNED: 2
   RETURNED INDICES: 1 2
   2 SMALLEST UNIQUE VALUES: -1 0
<P>
</PRE>
</BLOCKQUOTE>
<A name=5>

     <H3>AUTHOR</H3>

</A>
<BLOCKQUOTE>
Michel Olagnon - Feb. 2000
<P>
John Urban, 2022.04.16
<TABLE cellpadding=3><!-- tsb: John Urban, 2022.04.16
 -->
<TR></TR><TR></TR>
<TR valign=top><TD width=3%>
o
</TD><TD>
added man-page and reduced to a template using the
<B>prep</B>(1) preprocessor.
</TD></TR>
<TR></TR></TABLE></BLOCKQUOTE>
<A name=6>

     <H3>LICENSE</H3>

</A>
<BLOCKQUOTE>
CC0-1.0
</BLOCKQUOTE>
<P><HR>
<TABLE width=100%><TR> <TD width=33%><I>Nemo Release 3.1</I></TD> <TD width=33% align=center>unipar (3orderpack)</TD> <TD align=right width=33%><I>April 19, 2022</I></TD> </TR></TABLE><FONT SIZE=-1>Generated by <A HREF="http://www.squarebox.co.uk/download/manServer.shtml">manServer 1.08</A> from c63882a0-8203-4be4-8ea2-ebcfec752016 using man macros.</FONT>
<br><br><center><img src="images/unipar.gif"></center>
</div>
</div>
</body>
</HTML>
